2015-08-11 10:25:16,388 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-11 10:25:16,389 root:INFO OC3 server keys: {"keys": [{"use": "sig", "y": "r-btbQfvy8oKX2wOO4juoNzoxJoAIT-nvwEn9NaO_yw", "kid": "op2", "crv": "P-256", "kty": "EC", "x": "avpXYHZu9JT6HebMhXp9o_CniUwoGcHxrjd1ANMVKbo"}]}
2015-08-11 10:25:16,389 root:INFO OC3 server keys: {"keys": [{"use": "enc", "y": "HNu5yVJEwaup215Gy9YNyzRgHW0YapoBr4_ZOqDBGys", "kid": "op3", "crv": "P-256", "kty": "EC", "x": "qr-aNqjbglwAY5jtUWHr7Iah6WbpzMaY3V9E1K5fIUc"}]}
2015-08-11 10:25:16,390 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 10:25:28,207 oicServer:INFO callback: <function webfinger at 0x105643d08>
2015-08-11 10:25:30,945 oicServer:INFO callback: <function op_info at 0x105643950>
2015-08-11 10:25:31,370 root:INFO op_info
2015-08-11 10:25:31,370 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 10:25:31,371 oic.oic.provider:INFO provider_info_response: {'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'scopes_supported': ['profile', 'openid', 'phone', 'address', 'email', 'offline_access', 'openid'], 'request_object_signing_alg_values_supported': ['RS384', 'ES256', 'PS256', 'PS384', 'PS521', 'none', 'HS384', 'RS256', 'HS512', 'HS256', 'ES384', 'RS512', 'ES512'], 'claims_supported': ['profile', 'phone_number', 'locale', 'middle_name', 'birthdate', 'zoneinfo', 'address', 'picture', 'email', 'email_verified', 'name', 'family_name', 'gender', 'nickname', 'updated_at', 'preferred_username', 'sub', 'phone_number_verified', 'website', 'given_name'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'ES256', 'PS256', 'PS384', 'PS521', 'HS384', 'RS256', 'HS512', 'HS256', 'ES384', 'RS512', 'ES512'], 'request_parameter_supported': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'token_endpoint': 'https://localhost:8092/token', 'claims_parameter_supported': True, 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_signing_alg_values_supported': ['RS384', 'ES256', 'PS256', 'PS384', 'PS521', 'none', 'HS384', 'RS256', 'HS512', 'HS256', 'ES384', 'RS512', 'ES512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'version': '3.0', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'id_token_signing_alg_values_supported': ['RS384', 'ES256', 'PS256', 'PS384', 'PS521', 'none', 'HS384', 'RS256', 'HS512', 'HS256', 'ES384', 'RS512', 'ES512'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'require_request_uri_registration': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-11 10:25:31,442 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10563d320>
2015-08-11 10:25:31,909 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "post_logout_redirect_uris": ["https://localhost:8666/"], "contacts": ["ops@example.com"], "application_type": "web"}>>
2015-08-11 10:25:31,910 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['https://localhost:8666/'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'application_type': 'web', 'contacts': ['ops@example.com']}
2015-08-11 10:25:31,918 oic.oic.provider:DEBUG _cinfo: {'client_id': 'l9sS6pbPe9vO', 'registration_access_token': 'D9YbXER3KLsRaG2IMAnSAV1X4De4H0D3', 'client_secret_expires_at': 1439364331, 'registration_client_uri': 'https://localhost:8092/registration?client_id=l9sS6pbPe9vO', 'client_id_issued_at': 1439277931, 'client_secret': '1ff59ac3515d516373317119c90cad11a2ca0c8a92e45dfc298388e1'}
2015-08-11 10:25:31,919 oic.utils.keyio:DEBUG loading keys for issuer: l9sS6pbPe9vO
2015-08-11 10:25:31,920 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['https://localhost:8666/'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'application_type': 'web', 'contacts': ['ops@example.com']}
2015-08-11 10:25:31,920 oic.oic.provider:DEBUG keys for l9sS6pbPe9vO: []
2015-08-11 10:25:31,923 oic.oic.provider:INFO Client info: {'client_id': 'l9sS6pbPe9vO', 'application_type': 'web', 'registration_access_token': 'D9YbXER3KLsRaG2IMAnSAV1X4De4H0D3', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'client_secret_expires_at': 1439364331, 'registration_client_uri': 'https://localhost:8092/registration?client_id=l9sS6pbPe9vO', 'contacts': ['ops@example.com'], 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'client_id_issued_at': 1439277931, 'client_secret': '1ff59ac3515d516373317119c90cad11a2ca0c8a92e45dfc298388e1'}
2015-08-11 10:25:31,924 oic.oic.provider:DEBUG registration_response: {'client_id': 'l9sS6pbPe9vO', 'application_type': 'web', 'registration_access_token': 'D9YbXER3KLsRaG2IMAnSAV1X4De4H0D3', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'client_secret_expires_at': 1439364331, 'registration_client_uri': 'https://localhost:8092/registration?client_id=l9sS6pbPe9vO', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'client_id_issued_at': 1439277931, 'client_secret': '1ff59ac3515d516373317119c90cad11a2ca0c8a92e45dfc298388e1'}
2015-08-11 10:25:31,948 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10559fe10>
2015-08-11 10:25:32,405 oic.oauth2.provider:DEBUG Request: 'response_type=code&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A29c2ef87-5ce3-4962-ab8e-47dc5d6becca&acr_values=PASSWORD&client_id=l9sS6pbPe9vO'
2015-08-11 10:25:32,406 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f2400>, <jwkest.jwk.RSAKey object at 0x1057b7b70>, <jwkest.jwk.ECKey object at 0x1057b7eb8>]
2015-08-11 10:25:32,407 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'l9sS6pbPe9vO', 'state': 'urn:uuid:29c2ef87-5ce3-4962-ab8e-47dc5d6becca', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:25:32,409 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'l9sS6pbPe9vO', 'state': 'urn:uuid:29c2ef87-5ce3-4962-ab8e-47dc5d6becca', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:25:32,411 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10579e128>, 'PASSWORD')]
2015-08-11 10:25:32,411 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:25:32,412 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:25:32,413 oic.utils.authn.user:INFO do_authentication argv: {'tos_uri': '', 'logo_uri': '', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'password': '', 'query': 'response_type=code&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A29c2ef87-5ce3-4962-ab8e-47dc5d6becca&acr_values=PASSWORD&client_id=l9sS6pbPe9vO', 'login': '', 'action': 'https://localhost:8092/verify', 'submit_text': 'Submit', 'policy_uri': '', 'title': 'User log in', 'acr': ['PASSWORD'], 'login_title': 'Username'}
2015-08-11 10:25:32,428 oicServer:INFO callback: <function css at 0x1055adbf8>
2015-08-11 10:25:46,283 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105739bf8>
2015-08-11 10:25:53,499 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26state%3Durn%253Auuid%253A29c2ef87-5ce3-4962-ab8e-47dc5d6becca%26acr_values%3DPASSWORD%26client_id%3Dl9sS6pbPe9vO&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 10:25:53,500 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['PASSWORD']"], 'form.commit': ['Submit'], 'password': ['krall'], 'query': ['response_type=code&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A29c2ef87-5ce3-4962-ab8e-47dc5d6becca&acr_values=PASSWORD&client_id=l9sS6pbPe9vO'], 'login': ['diana']}
2015-08-11 10:25:53,501 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-11 10:25:53,503 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'client_id': ['l9sS6pbPe9vO'], 'state': ['urn:uuid:29c2ef87-5ce3-4962-ab8e-47dc5d6becca'], 'response_type': ['code'], 'scope': ['openid profile email address phone'], 'acr_values': ['PASSWORD'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 10:25:53,508 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10559fe10>
2015-08-11 10:25:57,078 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&client_id=l9sS6pbPe9vO&state=urn%3Auuid%3A29c2ef87-5ce3-4962-ab8e-47dc5d6becca&response_type=code&scope=openid+profile+email+address+phone&acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'
2015-08-11 10:25:57,080 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f2400>, <jwkest.jwk.RSAKey object at 0x1057b7b70>, <jwkest.jwk.ECKey object at 0x1057b7eb8>]
2015-08-11 10:25:57,080 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'client_id': 'l9sS6pbPe9vO', 'state': 'urn:uuid:29c2ef87-5ce3-4962-ab8e-47dc5d6becca', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:25:57,082 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'client_id': 'l9sS6pbPe9vO', 'state': 'urn:uuid:29c2ef87-5ce3-4962-ab8e-47dc5d6becca', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:25:57,084 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10579e128>, 'PASSWORD')]
2015-08-11 10:25:57,084 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:25:57,085 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:25:57,086 oic.oic.provider:DEBUG - authenticated -
2015-08-11 10:25:57,086 oic.oic.provider:DEBUG AREQ keys: dict_keys(['upm_answer', 'client_id', 'state', 'response_type', 'scope', 'acr_values', 'redirect_uri'])
2015-08-11 10:25:57,087 oic.utils.sdb:DEBUG uid2sid: {'diana': ['74cda1a27353849de5f7dd6151c793b87cc0401b04b3e0bb888c46f7']}
2015-08-11 10:25:57,088 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 10:25:57,088 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 10:25:57,092 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=sMG%2BuCT2UkDJQ4J0HIR28IVNi57JlApyw4AKWyDcKgFQege1l%2F5N9nCE%2FYxQTqF5jP5x5RzRczw7uJbxwmdtYSSPeTPk7LIsYDBvKvwWKyU%3D&scope=openid+profile+email+address+phone&state=urn%3Auuid%3A29c2ef87-5ce3-4962-ab8e-47dc5d6becca' (<class 'str'>)
2015-08-11 10:26:22,296 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 10:26:22,332 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10559feb8>
2015-08-11 10:26:33,809 oic.oic.provider:DEBUG - token -
2015-08-11 10:26:33,810 oic.oic.provider:INFO token_request: redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&code=sMG%2BuCT2UkDJQ4J0HIR28IVNi57JlApyw4AKWyDcKgFQege1l%2F5N9nCE%2FYxQTqF5jP5x5RzRczw7uJbxwmdtYSSPeTPk7LIsYDBvKvwWKyU%3D&grant_type=authorization_code
2015-08-11 10:26:33,811 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'sMG+uCT2UkDJQ4J0HIR28IVNi57JlApyw4AKWyDcKgFQege1l/5N9nCE/YxQTqF5jP5x5RzRczw7uJbxwmdtYSSPeTPk7LIsYDBvKvwWKyU=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:26:33,811 oic.utils.authn.client:DEBUG REQ: {'code': 'sMG+uCT2UkDJQ4J0HIR28IVNi57JlApyw4AKWyDcKgFQege1l/5N9nCE/YxQTqF5jP5x5RzRczw7uJbxwmdtYSSPeTPk7LIsYDBvKvwWKyU=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:26:33,812 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 10:26:33,812 oic.oic.provider:ERROR Failed to verify client due to: Incorrect padding
2015-08-11 10:27:40,589 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105739bf8>
2015-08-11 10:27:42,329 oic.utils.authn.user:DEBUG verify(client_id=l9sS6pbPe9vO)
2015-08-11 10:27:42,330 oic.utils.authn.user:DEBUG dict: {'client_id': ['l9sS6pbPe9vO']}
2015-08-11 10:27:42,330 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-11 10:27:42,347 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10559fe10>
2015-08-11 10:27:42,931 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=l9sS6pbPe9vO'
2015-08-11 10:27:42,932 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f2400>, <jwkest.jwk.RSAKey object at 0x1057b7b70>, <jwkest.jwk.ECKey object at 0x1057b7eb8>]
2015-08-11 10:27:42,933 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'l9sS6pbPe9vO', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code'}
2015-08-11 10:27:42,936 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'l9sS6pbPe9vO', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code'}
2015-08-11 10:27:42,938 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10579e128>, 'PASSWORD')]
2015-08-11 10:27:42,939 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:27:42,940 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:27:42,940 oic.oic.provider:DEBUG - authenticated -
2015-08-11 10:27:42,940 oic.oic.provider:DEBUG AREQ keys: dict_keys(['client_id', 'scope', 'acr_values', 'redirect_uri', 'response_type'])
2015-08-11 10:27:42,941 oic.utils.sdb:DEBUG uid2sid: {'diana': ['74cda1a27353849de5f7dd6151c793b87cc0401b04b3e0bb888c46f7', '491fc2e97632b1fa14a650bd6ab42f259b9ba1c671274af035699bb9']}
2015-08-11 10:27:42,942 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 10:27:42,942 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 10:27:42,944 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=dKdHTrEMRDTK6xjxmBvN4TBufWqAPm8ptCmfAapNL3FJTaEjGiu5WpIWrvsnyJ73cPVYg%2BK5oigpt3mAIWGkqK6M9Hu6%2BPSpF%2BtUtscfMHQ%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 10:28:29,349 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}]}
2015-08-11 10:28:29,349 root:INFO OC3 server keys: {"keys": [{"x": "uuzHkb7iRw48JS3iRP5nqtxbFkhoqZYsWeb35lAGy6o", "y": "eGJmKrldij7_Ncjt2o0H-v3CKLbab_iKONuNTUJt790", "use": "sig", "crv": "P-256", "kid": "op2", "kty": "EC"}]}
2015-08-11 10:28:29,350 root:INFO OC3 server keys: {"keys": [{"x": "eyoGxaFcuAXLpirSbkzFgfvIs6i7Rjmh8T4ZWrG9NXs", "y": "VF588eexlDUHQWaXGuQ-VFOCtg1GvctxY03m85wwo1c", "use": "enc", "crv": "P-256", "kid": "op3", "kty": "EC"}]}
2015-08-11 10:28:29,350 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 10:28:39,936 oicServer:INFO callback: <function webfinger at 0x105645d08>
2015-08-11 10:29:05,751 oicServer:INFO callback: <function op_info at 0x105645950>
2015-08-11 10:29:07,321 root:INFO op_info
2015-08-11 10:29:07,322 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 10:29:07,323 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['none', 'RS512', 'HS256', 'HS384', 'ES384', 'ES512', 'PS384', 'ES256', 'PS521', 'RS384', 'PS256', 'HS512', 'RS256'], 'issuer': 'https://localhost:8092/', 'claims_supported': ['family_name', 'updated_at', 'zoneinfo', 'email', 'given_name', 'profile', 'name', 'gender', 'preferred_username', 'nickname', 'address', 'phone_number', 'locale', 'phone_number_verified', 'picture', 'email_verified', 'sub', 'middle_name', 'website', 'birthdate'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'scopes_supported': ['email', 'offline_access', 'openid', 'profile', 'address', 'phone', 'openid'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['none', 'RS512', 'HS256', 'HS384', 'ES384', 'ES512', 'PS384', 'ES256', 'PS521', 'RS384', 'PS256', 'HS512', 'RS256'], 'request_uri_parameter_supported': True, 'registration_endpoint': 'https://localhost:8092/registration', 'version': '3.0', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'claims_parameter_supported': True, 'request_object_signing_alg_values_supported': ['none', 'RS512', 'HS256', 'HS384', 'ES384', 'ES512', 'PS384', 'ES256', 'PS521', 'RS384', 'PS256', 'HS512', 'RS256'], 'acr_values_supported': ['PASSWORD'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'token_endpoint': 'https://localhost:8092/token', 'authorization_endpoint': 'https://localhost:8092/authorization', 'subject_types_supported': ['public', 'pairwise'], 'require_request_uri_registration': True, 'request_parameter_supported': True, 'token_endpoint_auth_signing_alg_values_supported': ['RS512', 'HS256', 'HS384', 'ES384', 'ES512', 'PS384', 'ES256', 'PS521', 'RS384', 'PS256', 'HS512', 'RS256']}
2015-08-11 10:29:07,394 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10563d400>
2015-08-11 10:29:09,272 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/"], "contacts": ["ops@example.com"]}>>
2015-08-11 10:29:09,273 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 10:29:09,280 oic.oic.provider:DEBUG _cinfo: {'client_id': 'axfBmlnIDr3f', 'client_secret': '7302357aa203608f03831b27ee61f17ca7d6eabd865b761bd607271a', 'registration_access_token': 'kZzCOc9sGqXxi2REvsAGgCoualXdvTGK', 'registration_client_uri': 'https://localhost:8092/registration?client_id=axfBmlnIDr3f', 'client_secret_expires_at': 1439364549, 'client_id_issued_at': 1439278149}
2015-08-11 10:29:09,282 oic.utils.keyio:DEBUG loading keys for issuer: axfBmlnIDr3f
2015-08-11 10:29:09,283 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 10:29:09,283 oic.oic.provider:DEBUG keys for axfBmlnIDr3f: []
2015-08-11 10:29:09,286 oic.oic.provider:INFO Client info: {'client_id': 'axfBmlnIDr3f', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'contacts': ['ops@example.com'], 'client_secret': '7302357aa203608f03831b27ee61f17ca7d6eabd865b761bd607271a', 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'application_type': 'web', 'registration_access_token': 'kZzCOc9sGqXxi2REvsAGgCoualXdvTGK', 'registration_client_uri': 'https://localhost:8092/registration?client_id=axfBmlnIDr3f', 'client_secret_expires_at': 1439364549, 'client_id_issued_at': 1439278149}
2015-08-11 10:29:09,286 oic.oic.provider:DEBUG registration_response: {'client_id': 'axfBmlnIDr3f', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'client_secret': '7302357aa203608f03831b27ee61f17ca7d6eabd865b761bd607271a', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'application_type': 'web', 'registration_access_token': 'kZzCOc9sGqXxi2REvsAGgCoualXdvTGK', 'registration_client_uri': 'https://localhost:8092/registration?client_id=axfBmlnIDr3f', 'client_secret_expires_at': 1439364549, 'client_id_issued_at': 1439278149}
2015-08-11 10:29:09,306 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10546fef0>
2015-08-11 10:29:12,166 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&response_type=code&client_id=axfBmlnIDr3f&state=urn%3Auuid%3A5f2747ea-f162-4ab2-8938-3446fbef95eb&scope=openid+profile+email+address+phone'
2015-08-11 10:29:12,168 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3550>, <jwkest.jwk.RSAKey object at 0x1057b6be0>, <jwkest.jwk.ECKey object at 0x1057b6f98>]
2015-08-11 10:29:12,169 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'client_id': 'axfBmlnIDr3f', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:5f2747ea-f162-4ab2-8938-3446fbef95eb'}
2015-08-11 10:29:12,171 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'client_id': 'axfBmlnIDr3f', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:5f2747ea-f162-4ab2-8938-3446fbef95eb'}
2015-08-11 10:29:12,173 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x1057a1198>, 'PASSWORD')]
2015-08-11 10:29:12,174 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:29:12,174 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:29:12,175 oic.utils.authn.user:INFO do_authentication argv: {'policy_uri': '', 'password': '', 'client_policy_title': 'Client Policy', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'logo_uri': '', 'query': 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&response_type=code&client_id=axfBmlnIDr3f&state=urn%3Auuid%3A5f2747ea-f162-4ab2-8938-3446fbef95eb&scope=openid+profile+email+address+phone', 'login': '', 'acr': ['PASSWORD'], 'submit_text': 'Submit', 'login_title': 'Username', 'passwd_title': 'Password', 'tos_uri': ''}
2015-08-11 10:29:12,196 oicServer:INFO callback: <function css at 0x10547ebf8>
2015-08-11 10:29:30,070 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10573bbf8>
2015-08-11 10:29:43,083 oic.utils.authn.user:DEBUG verify(query=redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26acr_values%3DPASSWORD%26response_type%3Dcode%26client_id%3DaxfBmlnIDr3f%26state%3Durn%253Auuid%253A5f2747ea-f162-4ab2-8938-3446fbef95eb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 10:29:56,624 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'query': ['redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&response_type=code&client_id=axfBmlnIDr3f&state=urn%3Auuid%3A5f2747ea-f162-4ab2-8938-3446fbef95eb&scope=openid+profile+email+address+phone'], 'acr_values': ["['PASSWORD']"], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-11 10:29:57,212 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 10:30:58,381 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'client_id': ['axfBmlnIDr3f'], 'upm_answer': 'true', 'scope': ['openid profile email address phone'], 'response_type': ['code'], 'acr_values': ['PASSWORD'], 'state': ['urn:uuid:5f2747ea-f162-4ab2-8938-3446fbef95eb']}
2015-08-11 10:31:32,351 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10546fef0>
2015-08-11 10:31:56,179 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&client_id=axfBmlnIDr3f&upm_answer=true&scope=openid+profile+email+address+phone&response_type=code&acr_values=PASSWORD&state=urn%3Auuid%3A5f2747ea-f162-4ab2-8938-3446fbef95eb'
2015-08-11 10:31:56,181 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3550>, <jwkest.jwk.RSAKey object at 0x1057b6be0>, <jwkest.jwk.ECKey object at 0x1057b6f98>]
2015-08-11 10:31:56,182 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'client_id': 'axfBmlnIDr3f', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:5f2747ea-f162-4ab2-8938-3446fbef95eb'}
2015-08-11 10:32:03,013 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'client_id': 'axfBmlnIDr3f', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:5f2747ea-f162-4ab2-8938-3446fbef95eb'}
2015-08-11 10:32:42,278 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x1057a1198>, 'PASSWORD')]
2015-08-11 10:33:13,127 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:33:58,978 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:36:13,624 oic.oic.provider:DEBUG - authenticated -
2015-08-11 10:36:14,298 oic.oic.provider:DEBUG AREQ keys: dict_keys(['redirect_uri', 'client_id', 'upm_answer', 'scope', 'response_type', 'acr_values', 'state'])
2015-08-11 10:36:29,242 oic.utils.sdb:DEBUG uid2sid: {'diana': ['83ce0953ab76506d35f4f7ab4945a42d5001e64d776a901130664124']}
2015-08-11 10:36:36,834 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 10:36:36,835 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 10:37:51,122 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?state=urn%3Auuid%3A5f2747ea-f162-4ab2-8938-3446fbef95eb&scope=openid+profile+email+address+phone&code=EOZ1fHA%2BvHcYPOI0y55xz%2FH8%2FrIEXNT96tGRkHytK1K6yXRZRTzSJanBGDEjjL28iaGN6xHuEDkgijClwg4bfGIE97LHO2v7u0DGkhcWHXM%3D' (<class 'str'>)
2015-08-11 10:39:28,591 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 10:40:34,830 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10546ff98>
2015-08-11 10:40:44,998 oic.oic.provider:DEBUG - token -
2015-08-11 10:40:44,999 oic.oic.provider:INFO token_request: code=EOZ1fHA%2BvHcYPOI0y55xz%2FH8%2FrIEXNT96tGRkHytK1K6yXRZRTzSJanBGDEjjL28iaGN6xHuEDkgijClwg4bfGIE97LHO2v7u0DGkhcWHXM%3D&grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 10:40:45,000 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code', 'code': 'EOZ1fHA+vHcYPOI0y55xz/H8/rIEXNT96tGRkHytK1K6yXRZRTzSJanBGDEjjL28iaGN6xHuEDkgijClwg4bfGIE97LHO2v7u0DGkhcWHXM='}
2015-08-11 10:40:45,000 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code', 'code': 'EOZ1fHA+vHcYPOI0y55xz/H8/rIEXNT96tGRkHytK1K6yXRZRTzSJanBGDEjjL28iaGN6xHuEDkgijClwg4bfGIE97LHO2v7u0DGkhcWHXM='}
2015-08-11 10:40:45,001 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 10:40:45,001 oic.oic.provider:ERROR Failed to verify client due to: Incorrect padding
2015-08-11 10:41:26,623 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "e": "AQAB", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "e": "AQAB", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-11 10:41:26,623 root:INFO OC3 server keys: {"keys": [{"x": "dDtNESyV-FGgyoDsXjZzqha-K_C4PdHsSVYmA74CRsk", "y": "lHXEE43uGbRKZY_aofXDZ7TfsgakRiTbraCwom7qoeQ", "use": "sig", "crv": "P-256", "kid": "op2", "kty": "EC"}]}
2015-08-11 10:41:26,624 root:INFO OC3 server keys: {"keys": [{"x": "qTPx5zh7xlfHe4KrnSkos7t8svWK9VIkhZVxHDdUL-o", "y": "F9qPn6kHtZi6zAP81d1Mc1sd02vr6_rQeAc1ZvzQBfI", "use": "enc", "crv": "P-256", "kid": "op3", "kty": "EC"}]}
2015-08-11 10:41:26,624 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 10:41:40,401 oicServer:INFO callback: <function webfinger at 0x105605d08>
2015-08-11 10:41:41,346 oicServer:INFO callback: <function op_info at 0x105605950>
2015-08-11 10:41:41,797 root:INFO op_info
2015-08-11 10:41:41,798 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 10:41:41,799 oic.oic.provider:INFO provider_info_response: {'request_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'userinfo_signing_alg_values_supported': ['none', 'ES512', 'RS384', 'ES256', 'PS384', 'PS256', 'PS521', 'RS512', 'RS256', 'HS256', 'HS512', 'ES384', 'HS384'], 'require_request_uri_registration': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_signing_alg_values_supported': ['none', 'ES512', 'RS384', 'ES256', 'PS384', 'PS256', 'PS521', 'RS512', 'RS256', 'HS256', 'HS512', 'ES384', 'HS384'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'version': '3.0', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS384', 'ES256', 'PS384', 'PS256', 'PS521', 'RS512', 'RS256', 'HS256', 'HS512', 'ES384', 'HS384'], 'claims_supported': ['address', 'phone_number', 'sub', 'updated_at', 'email', 'birthdate', 'zoneinfo', 'locale', 'website', 'given_name', 'email_verified', 'middle_name', 'nickname', 'phone_number_verified', 'family_name', 'name', 'profile', 'picture', 'gender', 'preferred_username'], 'id_token_signing_alg_values_supported': ['none', 'ES512', 'RS384', 'ES256', 'PS384', 'PS256', 'PS521', 'RS512', 'RS256', 'HS256', 'HS512', 'ES384', 'HS384'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_uri_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'scopes_supported': ['address', 'offline_access', 'phone', 'email', 'profile', 'openid', 'openid'], 'issuer': 'https://localhost:8092/', 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint': 'https://localhost:8092/token'}
2015-08-11 10:41:41,877 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1055fb470>
2015-08-11 10:41:42,228 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 10:41:42,229 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 10:41:42,237 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'bd7882fdfbb21676207597342f90400f76fe863a28005eb2dc303b04', 'client_id': 'gucS6nx7fHJz', 'registration_access_token': 'dbJhniH4XnwIQPQT9YLgBxlq2daxUUWQ', 'registration_client_uri': 'https://localhost:8092/registration?client_id=gucS6nx7fHJz', 'client_secret_expires_at': 1439365302, 'client_id_issued_at': 1439278902}
2015-08-11 10:41:42,239 oic.utils.keyio:DEBUG loading keys for issuer: gucS6nx7fHJz
2015-08-11 10:41:42,239 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 10:41:42,239 oic.oic.provider:DEBUG keys for gucS6nx7fHJz: []
2015-08-11 10:41:42,242 oic.oic.provider:INFO Client info: {'client_secret': 'bd7882fdfbb21676207597342f90400f76fe863a28005eb2dc303b04', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'client_id': 'gucS6nx7fHJz', 'application_type': 'web', 'registration_access_token': 'dbJhniH4XnwIQPQT9YLgBxlq2daxUUWQ', 'contacts': ['ops@example.com'], 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=gucS6nx7fHJz', 'client_secret_expires_at': 1439365302, 'client_id_issued_at': 1439278902}
2015-08-11 10:41:42,242 oic.oic.provider:DEBUG registration_response: {'client_secret': 'bd7882fdfbb21676207597342f90400f76fe863a28005eb2dc303b04', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'client_id': 'gucS6nx7fHJz', 'application_type': 'web', 'registration_access_token': 'dbJhniH4XnwIQPQT9YLgBxlq2daxUUWQ', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=gucS6nx7fHJz', 'client_secret_expires_at': 1439365302, 'client_id_issued_at': 1439278902}
2015-08-11 10:41:42,258 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105834f98>
2015-08-11 10:41:42,662 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&acr_values=PASSWORD&state=urn%3Auuid%3A1d066c7b-9523-43ea-b2cd-32c1ce38635c&response_type=code&client_id=gucS6nx7fHJz&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'
2015-08-11 10:41:42,663 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057af198>, <jwkest.jwk.RSAKey object at 0x105777c88>, <jwkest.jwk.ECKey object at 0x105777f98>]
2015-08-11 10:41:42,664 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'client_id': 'gucS6nx7fHJz', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:1d066c7b-9523-43ea-b2cd-32c1ce38635c'}
2015-08-11 10:41:42,666 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'client_id': 'gucS6nx7fHJz', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:1d066c7b-9523-43ea-b2cd-32c1ce38635c'}
2015-08-11 10:41:42,669 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x1057632b0>, 'PASSWORD')]
2015-08-11 10:41:42,670 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:41:42,670 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:41:42,670 oic.utils.authn.user:INFO do_authentication argv: {'password': '', 'query': 'scope=openid+profile+email+address+phone&acr_values=PASSWORD&state=urn%3Auuid%3A1d066c7b-9523-43ea-b2cd-32c1ce38635c&response_type=code&client_id=gucS6nx7fHJz&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7', 'login_title': 'Username', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'passwd_title': 'Password', 'submit_text': 'Submit', 'policy_uri': '', 'tos_uri': '', 'client_policy_title': 'Client Policy', 'login': '', 'acr': ['PASSWORD'], 'logo_uri': ''}
2015-08-11 10:41:42,686 oicServer:INFO callback: <function css at 0x105824bf8>
2015-08-11 10:41:51,653 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x1056fbbf8>
2015-08-11 10:43:57,826 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DPASSWORD%26state%3Durn%253Auuid%253A1d066c7b-9523-43ea-b2cd-32c1ce38635c%26response_type%3Dcode%26client_id%3DgucS6nx7fHJz%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 10:43:57,827 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['PASSWORD']"], 'form.commit': ['Submit'], 'password': ['krall'], 'login': ['diana'], 'query': ['scope=openid+profile+email+address+phone&acr_values=PASSWORD&state=urn%3Auuid%3A1d066c7b-9523-43ea-b2cd-32c1ce38635c&response_type=code&client_id=gucS6nx7fHJz&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 10:43:57,828 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-11 10:43:57,831 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['PASSWORD'], 'client_id': ['gucS6nx7fHJz'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'upm_answer': 'true', 'response_type': ['code'], 'scope': ['openid profile email address phone'], 'state': ['urn:uuid:1d066c7b-9523-43ea-b2cd-32c1ce38635c']}
2015-08-11 10:43:57,839 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105834f98>
2015-08-11 10:44:01,323 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&client_id=gucS6nx7fHJz&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&upm_answer=true&response_type=code&scope=openid+profile+email+address+phone&state=urn%3Auuid%3A1d066c7b-9523-43ea-b2cd-32c1ce38635c'
2015-08-11 10:44:01,325 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057af198>, <jwkest.jwk.RSAKey object at 0x105777c88>, <jwkest.jwk.ECKey object at 0x105777f98>]
2015-08-11 10:44:01,327 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'client_id': 'gucS6nx7fHJz', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:1d066c7b-9523-43ea-b2cd-32c1ce38635c'}
2015-08-11 10:44:01,329 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'client_id': 'gucS6nx7fHJz', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:1d066c7b-9523-43ea-b2cd-32c1ce38635c'}
2015-08-11 10:44:01,331 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x1057632b0>, 'PASSWORD')]
2015-08-11 10:44:01,331 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:44:01,338 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:44:01,339 oic.oic.provider:DEBUG - authenticated -
2015-08-11 10:44:01,340 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'client_id', 'redirect_uri', 'upm_answer', 'response_type', 'scope', 'state']
2015-08-11 10:44:01,341 oic.utils.sdb:DEBUG uid2sid: {'diana': ['a872f053c8d715d5bc62a23481996aa2c4660cc2bc8e6b3502b45b33']}
2015-08-11 10:44:01,341 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 10:44:01,342 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 10:44:01,346 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?scope=openid+profile+email+address+phone&code=FpmBu3NPoQWK%2FIodr3bJ1Y%2Fyk7KB767pyI%2Bl27zdlqfGAeshsqXMzVEb%2BUrko%2FbrxYbCIS9jDOqR2ecX417WfxrRdMjNpZAWFucgOGmebEw%3D&state=urn%3Auuid%3A1d066c7b-9523-43ea-b2cd-32c1ce38635c' (<class 'str'>)
2015-08-11 10:44:17,333 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 10:44:56,778 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10583d438>
2015-08-11 10:45:13,436 oic.oic.provider:DEBUG - token -
2015-08-11 10:45:13,883 oic.oic.provider:INFO token_request: grant_type=authorization_code&code=FpmBu3NPoQWK%2FIodr3bJ1Y%2Fyk7KB767pyI%2Bl27zdlqfGAeshsqXMzVEb%2BUrko%2FbrxYbCIS9jDOqR2ecX417WfxrRdMjNpZAWFucgOGmebEw%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 10:45:20,019 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'code': 'FpmBu3NPoQWK/Iodr3bJ1Y/yk7KB767pyI+l27zdlqfGAeshsqXMzVEb+Urko/brxYbCIS9jDOqR2ecX417WfxrRdMjNpZAWFucgOGmebEw=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:45:21,868 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'code': 'FpmBu3NPoQWK/Iodr3bJ1Y/yk7KB767pyI+l27zdlqfGAeshsqXMzVEb+Urko/brxYbCIS9jDOqR2ecX417WfxrRdMjNpZAWFucgOGmebEw=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 10:45:21,868 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 10:48:53,356 oic.oic.provider:ERROR Failed to verify client due to: Incorrect padding
2015-08-11 10:49:06,675 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-11 10:49:06,675 root:INFO OC3 server keys: {"keys": [{"x": "gM8w0f1WEkiTX552F0qz6uqJpz4djKBnKuCIyONI0ec", "kty": "EC", "kid": "op2", "crv": "P-256", "use": "sig", "y": "87pW2OmjCl_TAw5MY77dHvoOq-g73GjxEqaoXZyipFk"}]}
2015-08-11 10:49:06,676 root:INFO OC3 server keys: {"keys": [{"x": "eH8vezSvN4FR-WHT-xK-QUb9j6y7mcekMECDMQXcbdY", "kty": "EC", "kid": "op3", "crv": "P-256", "use": "enc", "y": "ixfepXNzHzNKCYYVJrS2c_kln_jwheV4ErTa7tLssck"}]}
2015-08-11 10:49:06,676 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 10:49:18,254 oicServer:INFO callback: <function webfinger at 0x105515d08>
2015-08-11 10:49:19,922 oicServer:INFO callback: <function op_info at 0x105515950>
2015-08-11 10:49:20,107 root:INFO op_info
2015-08-11 10:49:20,107 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 10:49:20,108 oic.oic.provider:INFO provider_info_response: {'request_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'PS521', 'HS512', 'ES256', 'PS256', 'RS256', 'ES512', 'HS384', 'RS512', 'PS384', 'ES384', 'RS384'], 'request_uri_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_signing_alg_values_supported': ['HS256', 'PS521', 'HS512', 'ES256', 'PS256', 'none', 'RS256', 'ES512', 'HS384', 'RS512', 'PS384', 'ES384', 'RS384'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_signing_alg_values_supported': ['HS256', 'PS521', 'HS512', 'ES256', 'PS256', 'none', 'RS256', 'ES512', 'HS384', 'RS512', 'PS384', 'ES384', 'RS384'], 'subject_types_supported': ['public', 'pairwise'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'claims_supported': ['gender', 'name', 'sub', 'family_name', 'phone_number', 'website', 'zoneinfo', 'locale', 'birthdate', 'phone_number_verified', 'email', 'email_verified', 'updated_at', 'preferred_username', 'middle_name', 'given_name', 'address', 'profile', 'picture', 'nickname'], 'request_object_signing_alg_values_supported': ['HS256', 'PS521', 'HS512', 'ES256', 'PS256', 'none', 'RS256', 'ES512', 'HS384', 'RS512', 'PS384', 'ES384', 'RS384'], 'claims_parameter_supported': True, 'scopes_supported': ['openid', 'offline_access', 'email', 'phone', 'address', 'profile', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'version': '3.0', 'end_session_endpoint': 'https://localhost:8092/end_session', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'require_request_uri_registration': True, 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'acr_values_supported': ['PASSWORD']}
2015-08-11 10:49:20,183 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10550e4a8>
2015-08-11 10:49:20,799 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/"], "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "application_type": "web"}>>
2015-08-11 10:49:20,800 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 10:49:20,808 oic.oic.provider:DEBUG _cinfo: {'client_secret_expires_at': 1439365760, 'registration_access_token': 'DqGpMOoXI4hGsvln5pKpdw7vAqbw17u6', 'registration_client_uri': 'https://localhost:8092/registration?client_id=lOMOgMAJeVIg', 'client_id': 'lOMOgMAJeVIg', 'client_id_issued_at': 1439279360, 'client_secret': 'e9d8292d4ef531b46f3bf8f06d6edaf54677fc13313760cc4c43f30d'}
2015-08-11 10:49:20,810 oic.utils.keyio:DEBUG loading keys for issuer: lOMOgMAJeVIg
2015-08-11 10:49:20,810 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 10:49:20,810 oic.oic.provider:DEBUG keys for lOMOgMAJeVIg: []
2015-08-11 10:49:20,812 oic.oic.provider:INFO Client info: {'client_secret_expires_at': 1439365760, 'contacts': ['ops@example.com'], 'registration_access_token': 'DqGpMOoXI4hGsvln5pKpdw7vAqbw17u6', 'registration_client_uri': 'https://localhost:8092/registration?client_id=lOMOgMAJeVIg', 'client_id': 'lOMOgMAJeVIg', 'client_id_issued_at': 1439279360, 'application_type': 'web', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'client_secret': 'e9d8292d4ef531b46f3bf8f06d6edaf54677fc13313760cc4c43f30d', 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)]}
2015-08-11 10:49:20,813 oic.oic.provider:DEBUG registration_response: {'client_secret_expires_at': 1439365760, 'contacts': ['ops@example.com'], 'registration_access_token': 'DqGpMOoXI4hGsvln5pKpdw7vAqbw17u6', 'registration_client_uri': 'https://localhost:8092/registration?client_id=lOMOgMAJeVIg', 'client_id': 'lOMOgMAJeVIg', 'client_id_issued_at': 1439279360, 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'client_secret': 'e9d8292d4ef531b46f3bf8f06d6edaf54677fc13313760cc4c43f30d', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 10:49:20,829 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105471f98>
2015-08-11 10:49:21,140 oic.oauth2.provider:DEBUG Request: 'client_id=lOMOgMAJeVIg&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&state=urn%3Auuid%3Af8b3bd69-c133-4240-95bd-a60ab083f26f&response_type=code'
2015-08-11 10:49:21,141 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1058f0160>, <jwkest.jwk.RSAKey object at 0x1058b5c88>, <jwkest.jwk.ECKey object at 0x1058b5f98>]
2015-08-11 10:49:21,142 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:f8b3bd69-c133-4240-95bd-a60ab083f26f', 'client_id': 'lOMOgMAJeVIg', 'acr_values': 'PASSWORD'}
2015-08-11 10:49:21,144 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:f8b3bd69-c133-4240-95bd-a60ab083f26f', 'client_id': 'lOMOgMAJeVIg', 'acr_values': 'PASSWORD'}
2015-08-11 10:49:21,146 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10586a2b0>, 'PASSWORD')]
2015-08-11 10:49:21,146 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 10:49:21,147 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:49:21,147 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'policy_uri': '', 'logo_uri': '', 'login': '', 'acr': ['PASSWORD'], 'query': 'client_id=lOMOgMAJeVIg&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&state=urn%3Auuid%3Af8b3bd69-c133-4240-95bd-a60ab083f26f&response_type=code', 'password': '', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'login_title': 'Username', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'tos_uri': ''}
2015-08-11 10:49:21,167 oicServer:INFO callback: <function css at 0x10547dbf8>
2015-08-11 10:49:27,137 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10583abf8>
2015-08-11 10:49:30,673 oic.utils.authn.user:DEBUG verify(query=client_id%3DlOMOgMAJeVIg%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26acr_values%3DPASSWORD%26state%3Durn%253Auuid%253Af8b3bd69-c133-4240-95bd-a60ab083f26f%26response_type%3Dcode&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 10:49:30,674 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'form.commit': ['Submit'], 'acr_values': ["['PASSWORD']"], 'query': ['client_id=lOMOgMAJeVIg&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&state=urn%3Auuid%3Af8b3bd69-c133-4240-95bd-a60ab083f26f&response_type=code'], 'password': ['krall']}
2015-08-11 10:49:30,674 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 10:49:30,677 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'state': ['urn:uuid:f8b3bd69-c133-4240-95bd-a60ab083f26f'], 'response_type': ['code'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true', 'client_id': ['lOMOgMAJeVIg'], 'acr_values': ['PASSWORD']}
2015-08-11 10:49:30,682 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105471f98>
2015-08-11 10:49:31,398 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Af8b3bd69-c133-4240-95bd-a60ab083f26f&response_type=code&scope=openid+profile+email+address+phone&upm_answer=true&client_id=lOMOgMAJeVIg&acr_values=PASSWORD'
2015-08-11 10:49:31,399 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1058f0160>, <jwkest.jwk.RSAKey object at 0x1058b5c88>, <jwkest.jwk.ECKey object at 0x1058b5f98>]
2015-08-11 10:49:31,400 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:f8b3bd69-c133-4240-95bd-a60ab083f26f', 'client_id': 'lOMOgMAJeVIg', 'acr_values': 'PASSWORD'}
2015-08-11 10:49:31,402 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:f8b3bd69-c133-4240-95bd-a60ab083f26f', 'client_id': 'lOMOgMAJeVIg', 'acr_values': 'PASSWORD'}
2015-08-11 10:49:31,404 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10586a2b0>, 'PASSWORD')]
2015-08-11 10:49:31,404 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 10:49:31,405 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:49:31,405 oic.oic.provider:DEBUG - authenticated -
2015-08-11 10:49:31,406 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'state', 'response_type', 'scope', 'upm_answer', 'client_id', 'acr_values']
2015-08-11 10:49:31,406 oic.utils.sdb:DEBUG uid2sid: {'diana': ['e36836e5d86c9ac653eef6d1ccf558a4db52045bf6314f9ddd1d1912']}
2015-08-11 10:49:31,407 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 10:49:31,407 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 10:49:31,410 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?state=urn%3Auuid%3Af8b3bd69-c133-4240-95bd-a60ab083f26f&code=OTlnrRZS9AawKvOiSlYnzArD7W%2FemJkBAoqsdcKcvgZ9azpdwlHhDICZGdRCIIVixUNzsgMZLAVIVLH68IrAmdsylwy9Nm5pL%2Bif4grMcEk%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 10:49:35,681 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 10:49:38,009 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10548d438>
2015-08-11 10:49:41,225 oic.oic.provider:DEBUG - token -
2015-08-11 10:49:41,226 oic.oic.provider:INFO token_request: code=OTlnrRZS9AawKvOiSlYnzArD7W%2FemJkBAoqsdcKcvgZ9azpdwlHhDICZGdRCIIVixUNzsgMZLAVIVLH68IrAmdsylwy9Nm5pL%2Bif4grMcEk%3D&grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 10:49:41,227 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'OTlnrRZS9AawKvOiSlYnzArD7W/emJkBAoqsdcKcvgZ9azpdwlHhDICZGdRCIIVixUNzsgMZLAVIVLH68IrAmdsylwy9Nm5pL+if4grMcEk=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code'}
2015-08-11 10:50:18,159 oic.utils.authn.client:DEBUG REQ: {'code': 'OTlnrRZS9AawKvOiSlYnzArD7W/emJkBAoqsdcKcvgZ9azpdwlHhDICZGdRCIIVixUNzsgMZLAVIVLH68IrAmdsylwy9Nm5pL+if4grMcEk=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code'}
2015-08-11 10:50:18,159 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 10:50:38,891 oic.utils.authn.client:DEBUG REQ: {'code': 'OTlnrRZS9AawKvOiSlYnzArD7W/emJkBAoqsdcKcvgZ9azpdwlHhDICZGdRCIIVixUNzsgMZLAVIVLH68IrAmdsylwy9Nm5pL+if4grMcEk=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code'}
2015-08-11 10:50:44,395 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 10:53:08,449 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-11 10:53:08,449 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "Js8LS3f4Yd-FS5dUJxYAJCVlVtgqVZfHI57EA6cmP0g", "x": "4iiFf_Fcf3cSqhr4d3RDWLyLCdqTLCUbP4UEGK4_N7M", "kid": "op2"}]}
2015-08-11 10:53:08,450 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "4pIyAi7EolUqZ382awKUGAL4_zp-X2MU70xq3iA9bXg", "x": "tLVCnEE3Fh_wUU3FjBRRatVkBYJ0zPbnM6alviFhNhE", "kid": "op3"}]}
2015-08-11 10:53:08,451 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 10:53:14,966 oicServer:INFO callback: <function webfinger at 0x106c3e758>
2015-08-11 10:53:17,289 oicServer:INFO callback: <function op_info at 0x106c3e410>
2015-08-11 10:53:17,737 root:INFO op_info
2015-08-11 10:53:17,738 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 10:53:17,739 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-11 10:53:17,787 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x106c3d490>
2015-08-11 10:53:18,171 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 10:53:18,172 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': [u'https://localhost:8666/'], 'contacts': [u'ops@example.com']}
2015-08-11 10:53:18,183 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439279598, 'registration_access_token': 't6DF2uUVJ2sp3sdfizAqI2F8vTFk91cO', 'client_id': 'l5WWFCnq8MTd', 'client_secret': 'c04753f1527a15ca8ee4ef4ec096796133b07b3a00e344f8771a0715', 'registration_client_uri': 'https://localhost:8092/registration?client_id=l5WWFCnq8MTd', 'client_secret_expires_at': 1439365998}
2015-08-11 10:53:18,184 oic.utils.keyio:DEBUG loading keys for issuer: l5WWFCnq8MTd
2015-08-11 10:53:18,185 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': [u'https://localhost:8666/'], 'contacts': [u'ops@example.com']}
2015-08-11 10:53:18,185 oic.oic.provider:DEBUG keys for l5WWFCnq8MTd: []
2015-08-11 10:53:18,187 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439279598, 'post_logout_redirect_uris': [(u'https://localhost:8666/', None)], 'registration_access_token': 't6DF2uUVJ2sp3sdfizAqI2F8vTFk91cO', 'redirect_uris': [(u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'client_id': 'l5WWFCnq8MTd', 'application_type': u'web', 'client_secret': 'c04753f1527a15ca8ee4ef4ec096796133b07b3a00e344f8771a0715', 'registration_client_uri': 'https://localhost:8092/registration?client_id=l5WWFCnq8MTd', 'contacts': [u'ops@example.com'], 'client_secret_expires_at': 1439365998}
2015-08-11 10:53:18,187 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439279598, 'redirect_uris': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=l5WWFCnq8MTd', 'post_logout_redirect_uris': [u'https://localhost:8666/'], 'registration_access_token': 't6DF2uUVJ2sp3sdfizAqI2F8vTFk91cO', 'client_id': 'l5WWFCnq8MTd', 'client_secret': 'c04753f1527a15ca8ee4ef4ec096796133b07b3a00e344f8771a0715', 'client_secret_expires_at': 1439365998}
2015-08-11 10:53:18,200 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x106c3d3d0>
2015-08-11 10:53:19,857 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&state=urn%3Auuid%3A1088d14c-bce9-4161-8f48-0e3b8f849707&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=l5WWFCnq8MTd&scope=openid+profile+email+address+phone'
2015-08-11 10:53:19,858 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x106e37f50>, <jwkest.jwk.RSAKey object at 0x106e0f390>, <jwkest.jwk.ECKey object at 0x106e0f650>]
2015-08-11 10:53:19,859 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:1088d14c-bce9-4161-8f48-0e3b8f849707', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'l5WWFCnq8MTd', 'scope': 'openid profile email address phone'}
2015-08-11 10:53:19,860 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:1088d14c-bce9-4161-8f48-0e3b8f849707', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'l5WWFCnq8MTd', 'scope': 'openid profile email address phone'}
2015-08-11 10:53:19,863 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x106e06890>, 'PASSWORD')]
2015-08-11 10:53:19,864 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 10:53:19,865 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:53:19,865 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['PASSWORD'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'acr_values=PASSWORD&state=urn%3Auuid%3A1088d14c-bce9-4161-8f48-0e3b8f849707&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=l5WWFCnq8MTd&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-11 10:53:19,879 oicServer:INFO callback: <function css at 0x106a332a8>
2015-08-11 10:53:34,637 oicServer:INFO callback: <function auth_verify at 0x106de62a8>
2015-08-11 10:53:52,726 oic.utils.authn.user:DEBUG verify(query=acr_values%3DPASSWORD%26state%3Durn%253Auuid%253A1088d14c-bce9-4161-8f48-0e3b8f849707%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26response_type%3Dcode%26client_id%3Dl5WWFCnq8MTd%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 10:53:52,727 oic.utils.authn.user:DEBUG dict: {u'query': [u'acr_values=PASSWORD&state=urn%3Auuid%3A1088d14c-bce9-4161-8f48-0e3b8f849707&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=l5WWFCnq8MTd&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['PASSWORD']"]}
2015-08-11 10:53:52,727 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 10:53:52,728 oic.utils.authn.user:DEBUG kwargs: {u'acr_values': [u'PASSWORD'], u'state': [u'urn:uuid:1088d14c-bce9-4161-8f48-0e3b8f849707'], u'redirect_uri': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], u'response_type': [u'code'], u'client_id': [u'l5WWFCnq8MTd'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-11 10:53:52,732 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x106c3d3d0>
2015-08-11 10:53:55,619 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&state=urn%3Auuid%3A1088d14c-bce9-4161-8f48-0e3b8f849707&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=l5WWFCnq8MTd&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-11 10:53:55,621 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x106e37f50>, <jwkest.jwk.RSAKey object at 0x106e0f390>, <jwkest.jwk.ECKey object at 0x106e0f650>]
2015-08-11 10:53:55,621 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:1088d14c-bce9-4161-8f48-0e3b8f849707', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'l5WWFCnq8MTd', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-11 10:53:55,623 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:1088d14c-bce9-4161-8f48-0e3b8f849707', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'l5WWFCnq8MTd', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-11 10:53:55,626 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x106e06890>, 'PASSWORD')]
2015-08-11 10:53:55,627 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 10:53:55,628 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:53:55,628 oic.oic.provider:DEBUG - authenticated -
2015-08-11 10:53:55,628 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-11 10:53:55,629 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['be25ec1c89744d281ba2914ce2e682644030d50d939f53d33e22f11a']}
2015-08-11 10:53:55,629 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 10:53:55,630 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 10:53:55,632 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?scope=openid+profile+email+address+phone&state=urn%3Auuid%3A1088d14c-bce9-4161-8f48-0e3b8f849707&code=BpwC6foX1oWow9jxqFbA527frixKgbh%2B8TUg4pZ0f4BWLHrnAUMQO32eqZEurLsvYBANl175yDjoiWkE4%2B%2FgJLdpq6hHfUdYSqaCy5cYmkk%3D' (<type 'str'>)
2015-08-11 10:53:58,264 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 10:54:01,251 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x106c3d410>
2015-08-11 10:54:02,743 oic.oic.provider:DEBUG - token -
2015-08-11 10:54:02,744 oic.oic.provider:INFO token_request: code=BpwC6foX1oWow9jxqFbA527frixKgbh%2B8TUg4pZ0f4BWLHrnAUMQO32eqZEurLsvYBANl175yDjoiWkE4%2B%2FgJLdpq6hHfUdYSqaCy5cYmkk%3D&grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 10:54:02,745 oic.oic.provider:DEBUG AccessTokenRequest: {u'redirect_uri': u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', u'code': u'BpwC6foX1oWow9jxqFbA527frixKgbh+8TUg4pZ0f4BWLHrnAUMQO32eqZEurLsvYBANl175yDjoiWkE4+/gJLdpq6hHfUdYSqaCy5cYmkk=', 'grant_type': u'authorization_code'}
2015-08-11 10:55:40,752 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-11 10:55:40,752 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "JTWX5PgRYvIWE1lF9ur-DfPLWxOhTxT-uj6beWJw1rQ", "x": "fqsf1i8QiTt9XtD6k145jgcYNVYtXQh5g9SWF1x7CgQ", "kid": "op2"}]}
2015-08-11 10:55:40,753 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "ZZ4HWPKacj5uzlrrRLTBEvCD7AD93huW6DuuE4lNmvI", "x": "54aY3BfdTrG1MsBfhqc0tKJquyJdAvhWmhNOpVYAr6Y", "kid": "op3"}]}
2015-08-11 10:55:40,753 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 10:55:58,552 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "use": "enc"}, {"kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "use": "sig"}]}
2015-08-11 10:55:58,553 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "xOgK5GLtA53C40iw3CHvCmvJQtQQuJd6NIs-1ppYKyY", "crv": "P-256", "kid": "op2", "x": "oqStCOvU4Oan4r7PzLurPJa_ce0jUf18sLWAo8i62Vo", "use": "sig"}]}
2015-08-11 10:55:58,553 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "3QmFVH2EWKdrRWyrPTHB-XuPxZIoohjV1lXJ5SToK74", "crv": "P-256", "kid": "op3", "x": "dN2GauRH7Z_Oze_gV-omUxE8HfmAPpUBFENyklD5FV8", "use": "enc"}]}
2015-08-11 10:55:58,554 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 10:56:05,486 oicServer:INFO callback: <function webfinger at 0x10553ad08>
2015-08-11 10:56:28,552 oicServer:INFO callback: <function op_info at 0x10553a950>
2015-08-11 10:56:38,829 root:INFO op_info
2015-08-11 10:56:38,830 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 10:56:38,831 oic.oic.provider:INFO provider_info_response: {'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'request_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_signing_alg_values_supported': ['HS256', 'RS512', 'PS384', 'HS512', 'ES384', 'HS384', 'ES256', 'none', 'RS384', 'PS256', 'RS256', 'ES512', 'PS521'], 'scopes_supported': ['address', 'email', 'phone', 'offline_access', 'profile', 'openid', 'openid'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'subject_types_supported': ['public', 'pairwise'], 'claims_supported': ['nickname', 'email_verified', 'email', 'phone_number', 'website', 'gender', 'updated_at', 'phone_number_verified', 'sub', 'locale', 'address', 'family_name', 'middle_name', 'preferred_username', 'zoneinfo', 'name', 'given_name', 'profile', 'birthdate', 'picture'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'acr_values_supported': ['PASSWORD'], 'userinfo_signing_alg_values_supported': ['HS256', 'RS512', 'PS384', 'HS512', 'ES384', 'HS384', 'ES256', 'none', 'RS384', 'PS256', 'RS256', 'ES512', 'PS521'], 'require_request_uri_registration': True, 'id_token_signing_alg_values_supported': ['HS256', 'RS512', 'PS384', 'HS512', 'ES384', 'HS384', 'ES256', 'none', 'RS384', 'PS256', 'RS256', 'ES512', 'PS521'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'claims_parameter_supported': True, 'version': '3.0', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'RS512', 'PS384', 'HS512', 'ES384', 'HS384', 'ES256', 'RS384', 'PS256', 'RS256', 'ES512', 'PS521'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True}
2015-08-11 10:56:38,902 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1055334e0>
2015-08-11 10:56:42,252 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "post_logout_redirect_uris": ["https://localhost:8666/"], "contacts": ["ops@example.com"]}>>
2015-08-11 10:56:42,253 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'application_type': 'web'}
2015-08-11 10:56:42,261 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'iYLs7Zf6uY0MpICAemN7N1mseOAa4RXr', 'client_id': 'iRKOn2K2OFlX', 'client_id_issued_at': 1439279802, 'registration_client_uri': 'https://localhost:8092/registration?client_id=iRKOn2K2OFlX', 'client_secret_expires_at': 1439366202, 'client_secret': 'af292442069b2ca71d9f9978680cd0e45bac19a02b934c818ead3f6c'}
2015-08-11 10:56:42,263 oic.utils.keyio:DEBUG loading keys for issuer: iRKOn2K2OFlX
2015-08-11 10:56:42,263 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'application_type': 'web'}
2015-08-11 10:56:42,264 oic.oic.provider:DEBUG keys for iRKOn2K2OFlX: []
2015-08-11 10:56:42,266 oic.oic.provider:INFO Client info: {'registration_access_token': 'iYLs7Zf6uY0MpICAemN7N1mseOAa4RXr', 'client_id': 'iRKOn2K2OFlX', 'client_id_issued_at': 1439279802, 'application_type': 'web', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=iRKOn2K2OFlX', 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'client_secret_expires_at': 1439366202, 'contacts': ['ops@example.com'], 'client_secret': 'af292442069b2ca71d9f9978680cd0e45bac19a02b934c818ead3f6c'}
2015-08-11 10:56:42,266 oic.oic.provider:DEBUG registration_response: {'registration_access_token': 'iYLs7Zf6uY0MpICAemN7N1mseOAa4RXr', 'client_id': 'iRKOn2K2OFlX', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=iRKOn2K2OFlX', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'client_secret_expires_at': 1439366202, 'contacts': ['ops@example.com'], 'client_secret': 'af292442069b2ca71d9f9978680cd0e45bac19a02b934c818ead3f6c', 'client_id_issued_at': 1439279802}
2015-08-11 10:56:42,284 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105496fd0>
2015-08-11 10:56:44,054 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&client_id=iRKOn2K2OFlX&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Af65ff830-7f4a-4321-a5f9-2e04abe93535&acr_values=PASSWORD'
2015-08-11 10:56:44,055 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10891a518>, <jwkest.jwk.RSAKey object at 0x1056abcc0>, <jwkest.jwk.ECKey object at 0x1056abfd0>]
2015-08-11 10:56:44,056 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'iRKOn2K2OFlX', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'state': 'urn:uuid:f65ff830-7f4a-4321-a5f9-2e04abe93535', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'response_type': 'code'}
2015-08-11 10:56:44,058 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'iRKOn2K2OFlX', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'state': 'urn:uuid:f65ff830-7f4a-4321-a5f9-2e04abe93535', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'response_type': 'code'}
2015-08-11 10:56:44,060 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10568f278>, 'PASSWORD')]
2015-08-11 10:56:44,061 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:56:44,061 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:56:44,062 oic.utils.authn.user:INFO do_authentication argv: {'passwd_title': 'Password', 'action': 'https://localhost:8092/verify', 'query': 'scope=openid+profile+email+address+phone&client_id=iRKOn2K2OFlX&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Af65ff830-7f4a-4321-a5f9-2e04abe93535&acr_values=PASSWORD', 'title': 'User log in', 'acr': ['PASSWORD'], 'submit_text': 'Submit', 'policy_uri': '', 'login_title': 'Username', 'logo_uri': '', 'tos_uri': '', 'password': '', 'login': '', 'client_policy_title': 'Client Policy'}
2015-08-11 10:56:44,078 oicServer:INFO callback: <function css at 0x1054a4bf8>
2015-08-11 10:56:54,931 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105630bf8>
2015-08-11 10:57:00,457 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DiRKOn2K2OFlX%26response_type%3Dcode%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26state%3Durn%253Auuid%253Af65ff830-7f4a-4321-a5f9-2e04abe93535%26acr_values%3DPASSWORD&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 10:57:00,458 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['PASSWORD']"], 'query': ['scope=openid+profile+email+address+phone&client_id=iRKOn2K2OFlX&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Af65ff830-7f4a-4321-a5f9-2e04abe93535&acr_values=PASSWORD'], 'password': ['krall'], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-11 10:57:00,459 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'babs': 'howes', 'diana': 'krall'}
2015-08-11 10:57:00,462 oic.utils.authn.user:DEBUG kwargs: {'client_id': ['iRKOn2K2OFlX'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'state': ['urn:uuid:f65ff830-7f4a-4321-a5f9-2e04abe93535'], 'acr_values': ['PASSWORD'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true', 'response_type': ['code']}
2015-08-11 10:57:00,468 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105496fd0>
2015-08-11 10:57:05,605 oic.oauth2.provider:DEBUG Request: 'client_id=iRKOn2K2OFlX&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Af65ff830-7f4a-4321-a5f9-2e04abe93535&acr_values=PASSWORD&scope=openid+profile+email+address+phone&upm_answer=true&response_type=code'
2015-08-11 10:57:05,606 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10891a518>, <jwkest.jwk.RSAKey object at 0x1056abcc0>, <jwkest.jwk.ECKey object at 0x1056abfd0>]
2015-08-11 10:57:05,606 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'client_id': 'iRKOn2K2OFlX', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'state': 'urn:uuid:f65ff830-7f4a-4321-a5f9-2e04abe93535', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'response_type': 'code'}
2015-08-11 10:57:05,608 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'client_id': 'iRKOn2K2OFlX', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'state': 'urn:uuid:f65ff830-7f4a-4321-a5f9-2e04abe93535', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'response_type': 'code'}
2015-08-11 10:57:05,610 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10568f278>, 'PASSWORD')]
2015-08-11 10:57:05,610 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 10:57:05,611 oic.oauth2.provider:INFO No active authentication
2015-08-11 10:57:05,611 oic.oic.provider:DEBUG - authenticated -
2015-08-11 10:57:05,612 oic.oic.provider:DEBUG AREQ keys: ['client_id', 'redirect_uri', 'state', 'acr_values', 'scope', 'upm_answer', 'response_type']
2015-08-11 10:57:05,613 oic.utils.sdb:DEBUG uid2sid: {'diana': ['4669bd6a3ab8da4e06a20e42d0e8ccf104cfd8a8f251905c89d1a521']}
2015-08-11 10:57:05,613 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 10:57:05,613 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 10:57:05,616 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?scope=openid+profile+email+address+phone&state=urn%3Auuid%3Af65ff830-7f4a-4321-a5f9-2e04abe93535&code=%2F8HjC8Y9qKMfgSmN6n3R8BBWJA3%2BUaWfU6PkorBG%2BJ6b2EBCOHYOU5WLX8NJItvwmUFy8OC1p6H2x5BiGOceRY4LREfJfx%2FO5gvxgvhARF4%3D' (<class 'str'>)
2015-08-11 10:57:17,682 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 10:57:25,206 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054b4978>
2015-08-11 11:05:58,863 root:INFO OC3 server keys: {"keys": [{"use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB"}, {"use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB"}]}
2015-08-11 11:05:58,864 root:INFO OC3 server keys: {"keys": [{"use": "sig", "y": "u8lhmlXNQmApBF-lNW-cm9Jzyqz80PRZk9Cy-SeAGFM", "x": "rpQTiqLSVuRjruCBGkv0Dj6L5LYf91oQOJzr5ODlCuQ", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-11 11:05:58,864 root:INFO OC3 server keys: {"keys": [{"use": "enc", "y": "hzhjUZCvKInK0wCZuNfAYvlEiLMm7wV9XsSrecuQgOM", "x": "zAddevLn_HuKBWHUOCDql13KukWSRbgAW4ksHsbsRP0", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-11 11:05:58,865 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:06:02,030 oicServer:INFO callback: <function webfinger at 0x105644d08>
2015-08-11 11:06:10,969 oicServer:INFO callback: <function op_info at 0x105644950>
2015-08-11 11:06:12,762 root:INFO op_info
2015-08-11 11:06:12,763 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:06:12,764 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['HS384', 'RS512', 'PS384', 'RS256', 'none', 'ES256', 'ES384', 'HS512', 'HS256', 'PS521', 'RS384', 'PS256', 'ES512'], 'issuer': 'https://localhost:8092/', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'claims_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'RS512', 'PS384', 'RS256', 'ES256', 'ES384', 'HS512', 'HS256', 'PS521', 'RS384', 'PS256', 'ES512'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'email', 'phone', 'address', 'offline_access', 'openid'], 'acr_values_supported': ['PASSWORD'], 'request_object_signing_alg_values_supported': ['HS384', 'RS512', 'PS384', 'RS256', 'none', 'ES256', 'ES384', 'HS512', 'HS256', 'PS521', 'RS384', 'PS256', 'ES512'], 'request_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'version': '3.0', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'registration_endpoint': 'https://localhost:8092/registration', 'claims_supported': ['nickname', 'given_name', 'website', 'name', 'zoneinfo', 'updated_at', 'family_name', 'address', 'locale', 'gender', 'profile', 'preferred_username', 'phone_number', 'birthdate', 'sub', 'email', 'email_verified', 'picture', 'middle_name', 'phone_number_verified'], 'require_request_uri_registration': True, 'id_token_signing_alg_values_supported': ['HS384', 'RS512', 'PS384', 'RS256', 'none', 'ES256', 'ES384', 'HS512', 'HS256', 'PS521', 'RS384', 'PS256', 'ES512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'authorization_endpoint': 'https://localhost:8092/authorization', 'token_endpoint': 'https://localhost:8092/token'}
2015-08-11 11:06:12,835 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10563c518>
2015-08-11 11:06:14,204 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 11:06:14,205 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'contacts': ['ops@example.com']}
2015-08-11 11:06:14,212 oic.oic.provider:DEBUG _cinfo: {'client_id': 'EKjbBaqVUyGZ', 'client_secret': 'c7a2384aed576bcdd5eb92d11cc0d2372bf32e983222786ec6e9b7e5', 'client_id_issued_at': 1439280374, 'client_secret_expires_at': 1439366774, 'registration_client_uri': 'https://localhost:8092/registration?client_id=EKjbBaqVUyGZ', 'registration_access_token': 'cT1aDC15PsuvoRzsbfTUcnUYL3jQt5Ok'}
2015-08-11 11:06:14,214 oic.utils.keyio:DEBUG loading keys for issuer: EKjbBaqVUyGZ
2015-08-11 11:06:14,214 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'contacts': ['ops@example.com']}
2015-08-11 11:06:14,215 oic.oic.provider:DEBUG keys for EKjbBaqVUyGZ: []
2015-08-11 11:06:14,217 oic.oic.provider:INFO Client info: {'client_id': 'EKjbBaqVUyGZ', 'client_secret': 'c7a2384aed576bcdd5eb92d11cc0d2372bf32e983222786ec6e9b7e5', 'client_id_issued_at': 1439280374, 'application_type': 'web', 'client_secret_expires_at': 1439366774, 'registration_client_uri': 'https://localhost:8092/registration?client_id=EKjbBaqVUyGZ', 'contacts': ['ops@example.com'], 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'registration_access_token': 'cT1aDC15PsuvoRzsbfTUcnUYL3jQt5Ok'}
2015-08-11 11:06:14,217 oic.oic.provider:DEBUG registration_response: {'client_id': 'EKjbBaqVUyGZ', 'client_secret': 'c7a2384aed576bcdd5eb92d11cc0d2372bf32e983222786ec6e9b7e5', 'client_id_issued_at': 1439280374, 'application_type': 'web', 'client_secret_expires_at': 1439366774, 'registration_client_uri': 'https://localhost:8092/registration?client_id=EKjbBaqVUyGZ', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'registration_access_token': 'cT1aDC15PsuvoRzsbfTUcnUYL3jQt5Ok'}
2015-08-11 11:06:14,234 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a39e8>
2015-08-11 11:06:15,501 oic.oauth2.provider:DEBUG Request: 'client_id=EKjbBaqVUyGZ&state=urn%3Auuid%3A9c32f564-0473-4153-a2c0-7969461f5fed&response_type=code&scope=openid+profile+email+address+phone&acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'
2015-08-11 11:06:15,504 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f1550>, <jwkest.jwk.RSAKey object at 0x1057b6d30>, <jwkest.jwk.ECKey object at 0x1057bb160>]
2015-08-11 11:06:15,505 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'EKjbBaqVUyGZ', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:9c32f564-0473-4153-a2c0-7969461f5fed', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone'}
2015-08-11 11:06:15,506 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'EKjbBaqVUyGZ', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:9c32f564-0473-4153-a2c0-7969461f5fed', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone'}
2015-08-11 11:06:15,509 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10576b358>, 'PASSWORD')]
2015-08-11 11:06:15,509 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:06:15,509 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:06:15,510 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'title': 'User log in', 'acr': ['PASSWORD'], 'login': '', 'query': 'client_id=EKjbBaqVUyGZ&state=urn%3Auuid%3A9c32f564-0473-4153-a2c0-7969461f5fed&response_type=code&scope=openid+profile+email+address+phone&acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7', 'logo_uri': '', 'password': '', 'passwd_title': 'Password', 'login_title': 'Username', 'client_policy_title': 'Client Policy', 'tos_uri': '', 'action': 'https://localhost:8092/verify', 'policy_uri': ''}
2015-08-11 11:06:15,530 oicServer:INFO callback: <function css at 0x105493bf8>
2015-08-11 11:06:23,051 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105739bf8>
2015-08-11 11:06:31,174 oic.utils.authn.user:DEBUG verify(query=client_id%3DEKjbBaqVUyGZ%26state%3Durn%253Auuid%253A9c32f564-0473-4153-a2c0-7969461f5fed%26response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DPASSWORD%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:06:31,175 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'form.commit': ['Submit'], 'query': ['client_id=EKjbBaqVUyGZ&state=urn%3Auuid%3A9c32f564-0473-4153-a2c0-7969461f5fed&response_type=code&scope=openid+profile+email+address+phone&acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'], 'password': ['krall'], 'acr_values': ["['PASSWORD']"]}
2015-08-11 11:06:31,175 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 11:06:31,177 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'client_id': ['EKjbBaqVUyGZ'], 'acr_values': ['PASSWORD'], 'state': ['urn:uuid:9c32f564-0473-4153-a2c0-7969461f5fed'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'response_type': ['code'], 'scope': ['openid profile email address phone']}
2015-08-11 11:06:31,181 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a39e8>
2015-08-11 11:06:34,522 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&client_id=EKjbBaqVUyGZ&acr_values=PASSWORD&state=urn%3Auuid%3A9c32f564-0473-4153-a2c0-7969461f5fed&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&scope=openid+profile+email+address+phone'
2015-08-11 11:06:34,523 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f1550>, <jwkest.jwk.RSAKey object at 0x1057b6d30>, <jwkest.jwk.ECKey object at 0x1057bb160>]
2015-08-11 11:06:34,523 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'client_id': 'EKjbBaqVUyGZ', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:9c32f564-0473-4153-a2c0-7969461f5fed', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone'}
2015-08-11 11:06:34,525 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'client_id': 'EKjbBaqVUyGZ', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:9c32f564-0473-4153-a2c0-7969461f5fed', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'scope': 'openid profile email address phone'}
2015-08-11 11:06:34,527 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10576b358>, 'PASSWORD')]
2015-08-11 11:06:34,527 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:06:34,528 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:06:34,528 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:06:34,529 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'client_id', 'acr_values', 'state', 'redirect_uri', 'response_type', 'scope']
2015-08-11 11:06:34,530 oic.utils.sdb:DEBUG uid2sid: {'diana': ['947b717402ff75ace1a4b8695f501a08f8ab6e4d57857edb1e3e5e3e']}
2015-08-11 11:06:34,530 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:06:34,530 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:06:34,533 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=XhNWD5snOiNxz47KIfBOTINF4%2BcwL%2FUv8WvpZAFEbfjvXziSLh%2BgQ8P8dxQkbeu%2BHtjppkGMZdY6OyDI457VLo7CDWSydGqY%2FJQ05RQSrRs%3D&state=urn%3Auuid%3A9c32f564-0473-4153-a2c0-7969461f5fed&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:06:47,013 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:07:08,605 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054a3c88>
2015-08-11 11:08:45,404 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kid": "op0"}, {"kty": "RSA", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kid": "op1"}]}
2015-08-11 11:08:45,405 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "crv": "P-256", "x": "iC5i8EetsskPzffn2hcnKv4zfHLmqT9cVZRiB4XPW8w", "kid": "op2", "y": "zMWodYI__eLieGCfij36avzj-PXkleke4XMVynlZhO0"}]}
2015-08-11 11:08:45,405 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "crv": "P-256", "x": "B18WbZuZPCJJetzzpQAij5FcU8tTEJcbDap_I6BYxyM", "kid": "op3", "y": "gVFLCuv4S-HV9VVU9kZeDdz7cCcQDDMr4TkyMsEKuDw"}]}
2015-08-11 11:08:45,406 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:08:48,447 oicServer:INFO callback: <function webfinger at 0x105644d08>
2015-08-11 11:08:50,429 oicServer:INFO callback: <function op_info at 0x105644950>
2015-08-11 11:08:51,696 root:INFO op_info
2015-08-11 11:08:51,697 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:08:51,697 oic.oic.provider:INFO provider_info_response: {'request_uri_parameter_supported': True, 'version': '3.0', 'request_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_signing_alg_values_supported': ['RS384', 'ES256', 'HS384', 'ES512', 'ES384', 'HS512', 'PS384', 'HS256', 'PS521', 'RS512', 'none', 'PS256', 'RS256'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'acr_values_supported': ['PASSWORD'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'scopes_supported': ['address', 'profile', 'openid', 'email', 'offline_access', 'phone', 'openid'], 'claims_parameter_supported': True, 'id_token_signing_alg_values_supported': ['RS384', 'ES256', 'HS384', 'ES512', 'ES384', 'HS512', 'PS384', 'HS256', 'PS521', 'RS512', 'none', 'PS256', 'RS256'], 'claims_supported': ['phone_number', 'address', 'given_name', 'profile', 'zoneinfo', 'sub', 'birthdate', 'updated_at', 'email_verified', 'phone_number_verified', 'name', 'family_name', 'website', 'gender', 'nickname', 'preferred_username', 'picture', 'middle_name', 'email', 'locale'], 'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'ES256', 'HS384', 'ES512', 'ES384', 'HS512', 'PS384', 'HS256', 'PS521', 'RS512', 'PS256', 'RS256'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'require_request_uri_registration': True, 'subject_types_supported': ['public', 'pairwise'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint': 'https://localhost:8092/token', 'authorization_endpoint': 'https://localhost:8092/authorization', 'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_signing_alg_values_supported': ['RS384', 'ES256', 'HS384', 'ES512', 'ES384', 'HS512', 'PS384', 'HS256', 'PS521', 'RS512', 'none', 'PS256', 'RS256']}
2015-08-11 11:08:51,769 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10563d588>
2015-08-11 11:08:52,336 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 11:08:52,337 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:08:52,344 oic.oic.provider:DEBUG _cinfo: {'client_secret_expires_at': 1439366932, 'client_id_issued_at': 1439280532, 'registration_client_uri': 'https://localhost:8092/registration?client_id=DIwTEV0wciJg', 'registration_access_token': 'Yufhp30MXxyQMJorzFhoN2Q1g4UzqGkm', 'client_secret': '8acae237c316affde7a1cc14874fb1c018d63bea84080975e84b0795', 'client_id': 'DIwTEV0wciJg'}
2015-08-11 11:08:52,346 oic.utils.keyio:DEBUG loading keys for issuer: DIwTEV0wciJg
2015-08-11 11:08:52,346 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:08:52,346 oic.oic.provider:DEBUG keys for DIwTEV0wciJg: []
2015-08-11 11:08:52,348 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'application_type': 'web', 'client_secret_expires_at': 1439366932, 'client_id_issued_at': 1439280532, 'registration_client_uri': 'https://localhost:8092/registration?client_id=DIwTEV0wciJg', 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'registration_access_token': 'Yufhp30MXxyQMJorzFhoN2Q1g4UzqGkm', 'client_secret': '8acae237c316affde7a1cc14874fb1c018d63bea84080975e84b0795', 'client_id': 'DIwTEV0wciJg', 'post_logout_redirect_uris': [('https://localhost:8666/', None)]}
2015-08-11 11:08:52,349 oic.oic.provider:DEBUG registration_response: {'contacts': ['ops@example.com'], 'application_type': 'web', 'client_secret_expires_at': 1439366932, 'client_id_issued_at': 1439280532, 'registration_client_uri': 'https://localhost:8092/registration?client_id=DIwTEV0wciJg', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'registration_access_token': 'Yufhp30MXxyQMJorzFhoN2Q1g4UzqGkm', 'client_secret': '8acae237c316affde7a1cc14874fb1c018d63bea84080975e84b0795', 'client_id': 'DIwTEV0wciJg', 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:08:52,367 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bea90>
2015-08-11 11:08:53,062 oic.oauth2.provider:DEBUG Request: 'response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Ab6ae1d18-8d10-469c-a30b-1a37bc0c77b9&client_id=DIwTEV0wciJg&acr_values=PASSWORD&scope=openid+profile+email+address+phone'
2015-08-11 11:08:53,063 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3a58>, <jwkest.jwk.RSAKey object at 0x1057b6d68>, <jwkest.jwk.ECKey object at 0x1057bb0f0>]
2015-08-11 11:08:53,064 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'state': 'urn:uuid:b6ae1d18-8d10-469c-a30b-1a37bc0c77b9', 'scope': 'openid profile email address phone', 'client_id': 'DIwTEV0wciJg'}
2015-08-11 11:08:53,065 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'state': 'urn:uuid:b6ae1d18-8d10-469c-a30b-1a37bc0c77b9', 'scope': 'openid profile email address phone', 'client_id': 'DIwTEV0wciJg'}
2015-08-11 11:08:53,067 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10576b390>, 'PASSWORD')]
2015-08-11 11:08:53,067 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:08:53,068 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:08:53,069 oic.utils.authn.user:INFO do_authentication argv: {'passwd_title': 'Password', 'password': '', 'client_policy_title': 'Client Policy', 'tos_uri': '', 'acr': ['PASSWORD'], 'login_title': 'Username', 'submit_text': 'Submit', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'query': 'response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Ab6ae1d18-8d10-469c-a30b-1a37bc0c77b9&client_id=DIwTEV0wciJg&acr_values=PASSWORD&scope=openid+profile+email+address+phone', 'logo_uri': '', 'policy_uri': '', 'login': ''}
2015-08-11 11:08:53,085 oicServer:INFO callback: <function css at 0x1055aebf8>
2015-08-11 11:09:00,771 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10573abf8>
2015-08-11 11:09:05,652 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26state%3Durn%253Auuid%253Ab6ae1d18-8d10-469c-a30b-1a37bc0c77b9%26client_id%3DDIwTEV0wciJg%26acr_values%3DPASSWORD%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:09:05,653 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'query': ['response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3Ab6ae1d18-8d10-469c-a30b-1a37bc0c77b9&client_id=DIwTEV0wciJg&acr_values=PASSWORD&scope=openid+profile+email+address+phone'], 'login': ['diana'], 'password': ['krall'], 'acr_values': ["['PASSWORD']"]}
2015-08-11 11:09:05,654 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-11 11:09:05,656 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['PASSWORD'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'client_id': ['DIwTEV0wciJg'], 'response_type': ['code'], 'state': ['urn:uuid:b6ae1d18-8d10-469c-a30b-1a37bc0c77b9'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true'}
2015-08-11 11:09:05,660 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bea90>
2015-08-11 11:09:06,220 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&client_id=DIwTEV0wciJg&response_type=code&state=urn%3Auuid%3Ab6ae1d18-8d10-469c-a30b-1a37bc0c77b9&scope=openid+profile+email+address+phone&upm_answer=true'
2015-08-11 11:09:06,221 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3a58>, <jwkest.jwk.RSAKey object at 0x1057b6d68>, <jwkest.jwk.ECKey object at 0x1057bb0f0>]
2015-08-11 11:09:06,222 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'response_type': 'code', 'state': 'urn:uuid:b6ae1d18-8d10-469c-a30b-1a37bc0c77b9', 'scope': 'openid profile email address phone', 'client_id': 'DIwTEV0wciJg'}
2015-08-11 11:09:06,224 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'response_type': 'code', 'state': 'urn:uuid:b6ae1d18-8d10-469c-a30b-1a37bc0c77b9', 'scope': 'openid profile email address phone', 'client_id': 'DIwTEV0wciJg'}
2015-08-11 11:09:06,226 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10576b390>, 'PASSWORD')]
2015-08-11 11:09:06,226 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:09:06,227 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:09:06,228 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:09:06,228 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'redirect_uri', 'client_id', 'response_type', 'state', 'scope', 'upm_answer']
2015-08-11 11:09:06,229 oic.utils.sdb:DEBUG uid2sid: {'diana': ['f2b8e116f34ec585eada8625d25faca1fc5d8c3ceaeef5a9022f2d68']}
2015-08-11 11:09:06,230 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:09:06,230 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:09:06,233 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=w1mP0kCaFwunCijIfRubheOUM2Dt7GmHZ3gdH4p09B0iru9xtC3sa4GkbLC49%2BLdNeK%2FosBcwgxHPFRQrMwpcXPZSG%2BYE96CawvE8UaMJzM%3D&state=urn%3Auuid%3Ab6ae1d18-8d10-469c-a30b-1a37bc0c77b9&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:09:15,739 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:11:20,135 root:INFO OC3 server keys: {"keys": [{"use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0"}, {"use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1"}]}
2015-08-11 11:11:20,136 root:INFO OC3 server keys: {"keys": [{"use": "sig", "y": "EiZMRr647bzKJCMLmp7ZUL7spVZ-RFzKkZbjgWrUsZI", "kty": "EC", "crv": "P-256", "x": "81xyCITuFvZr8EvcRHnCCFqSd7QHnu3iKD-aOPhSerY", "kid": "op2"}]}
2015-08-11 11:11:20,137 root:INFO OC3 server keys: {"keys": [{"use": "enc", "y": "BY6Hz6fk8sheFza5nU2jCM_PAALhWhNI8vo3Tal_FRc", "kty": "EC", "crv": "P-256", "x": "nZUYljqtIlfKL-QBvGhoNcBnyYpCIgDpRz63HIIy2oE", "kid": "op3"}]}
2015-08-11 11:11:20,137 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:11:23,804 oicServer:INFO callback: <function webfinger at 0x105644d90>
2015-08-11 11:11:26,404 oicServer:INFO callback: <function op_info at 0x1056449d8>
2015-08-11 11:11:27,040 root:INFO op_info
2015-08-11 11:11:27,041 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:11:27,042 oic.oic.provider:INFO provider_info_response: {'claims_supported': ['email', 'website', 'zoneinfo', 'middle_name', 'picture', 'gender', 'nickname', 'email_verified', 'sub', 'given_name', 'phone_number_verified', 'phone_number', 'preferred_username', 'address', 'updated_at', 'locale', 'name', 'family_name', 'profile', 'birthdate'], 'userinfo_signing_alg_values_supported': ['PS521', 'HS384', 'ES512', 'HS256', 'PS384', 'RS256', 'RS384', 'RS512', 'none', 'PS256', 'HS512', 'ES384', 'ES256'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_signing_alg_values_supported': ['PS521', 'HS384', 'ES512', 'HS256', 'PS384', 'RS256', 'RS384', 'RS512', 'none', 'PS256', 'HS512', 'ES384', 'ES256'], 'id_token_signing_alg_values_supported': ['PS521', 'HS384', 'ES512', 'HS256', 'PS384', 'RS256', 'RS384', 'RS512', 'none', 'PS256', 'HS512', 'ES384', 'ES256'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'scopes_supported': ['email', 'address', 'openid', 'profile', 'offline_access', 'phone', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'version': '3.0', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'issuer': 'https://localhost:8092/', 'subject_types_supported': ['public', 'pairwise'], 'token_endpoint_auth_signing_alg_values_supported': ['PS521', 'HS384', 'ES512', 'HS256', 'PS384', 'RS256', 'RS384', 'RS512', 'PS256', 'HS512', 'ES384', 'ES256'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_parameter_supported': True, 'require_request_uri_registration': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_parameter_supported': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json'}
2015-08-11 11:11:27,113 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10563c630>
2015-08-11 11:11:27,609 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/"], "contacts": ["ops@example.com"], "application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"]}>>
2015-08-11 11:11:27,610 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'contacts': ['ops@example.com']}
2015-08-11 11:11:27,618 oic.oic.provider:DEBUG _cinfo: {'client_secret': '3338458545e6847d66d642cc1b9d0b22c0f1092fc9fb9150c746f551', 'client_secret_expires_at': 1439367087, 'client_id_issued_at': 1439280687, 'registration_access_token': 'tILTAlybB2fBWZ7wdbJqn4oWcBBFoRku', 'client_id': 'FEK5HYAqcmV2', 'registration_client_uri': 'https://localhost:8092/registration?client_id=FEK5HYAqcmV2'}
2015-08-11 11:11:27,620 oic.utils.keyio:DEBUG loading keys for issuer: FEK5HYAqcmV2
2015-08-11 11:11:27,620 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'contacts': ['ops@example.com']}
2015-08-11 11:11:27,620 oic.oic.provider:DEBUG keys for FEK5HYAqcmV2: []
2015-08-11 11:11:27,624 oic.oic.provider:INFO Client info: {'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'client_secret': '3338458545e6847d66d642cc1b9d0b22c0f1092fc9fb9150c746f551', 'client_secret_expires_at': 1439367087, 'client_id_issued_at': 1439280687, 'registration_access_token': 'tILTAlybB2fBWZ7wdbJqn4oWcBBFoRku', 'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'client_id': 'FEK5HYAqcmV2', 'registration_client_uri': 'https://localhost:8092/registration?client_id=FEK5HYAqcmV2'}
2015-08-11 11:11:27,624 oic.oic.provider:DEBUG registration_response: {'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'client_secret': '3338458545e6847d66d642cc1b9d0b22c0f1092fc9fb9150c746f551', 'client_secret_expires_at': 1439367087, 'client_id_issued_at': 1439280687, 'registration_access_token': 'tILTAlybB2fBWZ7wdbJqn4oWcBBFoRku', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'client_id': 'FEK5HYAqcmV2', 'registration_client_uri': 'https://localhost:8092/registration?client_id=FEK5HYAqcmV2'}
2015-08-11 11:11:27,640 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054beb38>
2015-08-11 11:11:28,187 oic.oauth2.provider:DEBUG Request: 'client_id=FEK5HYAqcmV2&state=urn%3Auuid%3A481e88cc-8165-4548-ba3a-9f72902bab43&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&acr_values=PASSWORD'
2015-08-11 11:11:28,189 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e5c18>, <jwkest.jwk.RSAKey object at 0x1057b6e10>, <jwkest.jwk.ECKey object at 0x1057bb160>]
2015-08-11 11:11:28,189 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:481e88cc-8165-4548-ba3a-9f72902bab43', 'acr_values': 'PASSWORD', 'response_type': 'code', 'client_id': 'FEK5HYAqcmV2'}
2015-08-11 11:11:28,193 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:481e88cc-8165-4548-ba3a-9f72902bab43', 'acr_values': 'PASSWORD', 'response_type': 'code', 'client_id': 'FEK5HYAqcmV2'}
2015-08-11 11:11:28,195 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10579e3c8>, 'PASSWORD')]
2015-08-11 11:11:28,196 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:11:28,197 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:11:28,197 oic.utils.authn.user:INFO do_authentication argv: {'title': 'User log in', 'login_title': 'Username', 'policy_uri': '', 'client_policy_title': 'Client Policy', 'tos_uri': '', 'action': 'https://localhost:8092/verify', 'password': '', 'passwd_title': 'Password', 'login': '', 'acr': ['PASSWORD'], 'logo_uri': '', 'query': 'client_id=FEK5HYAqcmV2&state=urn%3Auuid%3A481e88cc-8165-4548-ba3a-9f72902bab43&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&acr_values=PASSWORD', 'submit_text': 'Submit'}
2015-08-11 11:11:28,216 oicServer:INFO callback: <function css at 0x1054aec80>
2015-08-11 11:11:36,033 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10573cc80>
2015-08-11 11:11:38,938 oic.utils.authn.user:DEBUG verify(query=client_id%3DFEK5HYAqcmV2%26state%3Durn%253Auuid%253A481e88cc-8165-4548-ba3a-9f72902bab43%26response_type%3Dcode%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DPASSWORD&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:11:38,939 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'acr_values': ["['PASSWORD']"], 'query': ['client_id=FEK5HYAqcmV2&state=urn%3Auuid%3A481e88cc-8165-4548-ba3a-9f72902bab43&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&acr_values=PASSWORD'], 'password': ['krall'], 'form.commit': ['Submit']}
2015-08-11 11:11:38,939 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 11:11:38,943 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'scope': ['openid profile email address phone'], 'response_type': ['code'], 'acr_values': ['PASSWORD'], 'state': ['urn:uuid:481e88cc-8165-4548-ba3a-9f72902bab43'], 'client_id': ['FEK5HYAqcmV2'], 'upm_answer': 'true'}
2015-08-11 11:11:38,948 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054beb38>
2015-08-11 11:11:39,551 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&response_type=code&acr_values=PASSWORD&state=urn%3Auuid%3A481e88cc-8165-4548-ba3a-9f72902bab43&client_id=FEK5HYAqcmV2&upm_answer=true'
2015-08-11 11:11:39,553 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e5c18>, <jwkest.jwk.RSAKey object at 0x1057b6e10>, <jwkest.jwk.ECKey object at 0x1057bb160>]
2015-08-11 11:11:39,554 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:481e88cc-8165-4548-ba3a-9f72902bab43', 'client_id': 'FEK5HYAqcmV2', 'upm_answer': 'true'}
2015-08-11 11:11:39,555 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:481e88cc-8165-4548-ba3a-9f72902bab43', 'client_id': 'FEK5HYAqcmV2', 'upm_answer': 'true'}
2015-08-11 11:11:39,558 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10579e3c8>, 'PASSWORD')]
2015-08-11 11:11:39,559 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:11:39,560 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:11:39,561 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:11:39,561 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'scope', 'response_type', 'acr_values', 'state', 'client_id', 'upm_answer']
2015-08-11 11:11:39,562 oic.utils.sdb:DEBUG uid2sid: {'diana': ['d84520b00e23aa82ba7311597946a5217d1f6d653751a4dba1c78354']}
2015-08-11 11:11:39,562 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:11:39,563 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:11:39,566 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=T%2BriCNqFW0Q2XrSipCQkqysKIBOBAT9GIBL%2BzE3hrvR4%2B85iCq%2FmQizFdJdIF%2BojN81lQ8aYBlXIzViYMeUMQmb2Bl7NY8NQF8UmzkWXYxg%3D&state=urn%3Auuid%3A481e88cc-8165-4548-ba3a-9f72902bab43&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:11:42,311 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:11:45,726 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054beda0>
2015-08-11 11:11:46,410 oic.oic.provider:DEBUG - token -
2015-08-11 11:11:46,410 oic.oic.provider:INFO token_request: redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&grant_type=authorization_code&code=T%2BriCNqFW0Q2XrSipCQkqysKIBOBAT9GIBL%2BzE3hrvR4%2B85iCq%2FmQizFdJdIF%2BojN81lQ8aYBlXIzViYMeUMQmb2Bl7NY8NQF8UmzkWXYxg%3D
2015-08-11 11:11:46,411 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'T+riCNqFW0Q2XrSipCQkqysKIBOBAT9GIBL+zE3hrvR4+85iCq/mQizFdJdIF+ojN81lQ8aYBlXIzViYMeUMQmb2Bl7NY8NQF8UmzkWXYxg=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:11:47,002 oic.utils.authn.client:DEBUG REQ: {'code': 'T+riCNqFW0Q2XrSipCQkqysKIBOBAT9GIBL+zE3hrvR4+85iCq/mQizFdJdIF+ojN81lQ8aYBlXIzViYMeUMQmb2Bl7NY8NQF8UmzkWXYxg=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:11:47,003 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:11:48,216 oic.oic.provider:ERROR Failed to verify client due to: 'str' does not support the buffer interface
2015-08-11 11:12:25,145 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10573cc80>
2015-08-11 11:12:31,821 oic.utils.authn.user:DEBUG verify(client_id=FEK5HYAqcmV2)
2015-08-11 11:12:31,822 oic.utils.authn.user:DEBUG dict: {'client_id': ['FEK5HYAqcmV2']}
2015-08-11 11:12:31,822 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 11:12:31,840 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054beb38>
2015-08-11 11:12:33,053 oic.oauth2.provider:DEBUG Request: 'client_id=FEK5HYAqcmV2&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&response_type=code&acr_values=PASSWORD'
2015-08-11 11:12:33,054 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e5c18>, <jwkest.jwk.RSAKey object at 0x1057b6e10>, <jwkest.jwk.ECKey object at 0x1057bb160>]
2015-08-11 11:12:33,055 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'FEK5HYAqcmV2', 'scope': 'openid profile email address phone'}
2015-08-11 11:12:33,057 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'FEK5HYAqcmV2', 'scope': 'openid profile email address phone'}
2015-08-11 11:12:33,059 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10579e3c8>, 'PASSWORD')]
2015-08-11 11:12:33,059 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:12:33,060 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:12:33,061 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:12:33,061 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'redirect_uri', 'response_type', 'client_id', 'scope']
2015-08-11 11:12:33,062 oic.utils.sdb:DEBUG uid2sid: {'diana': ['d84520b00e23aa82ba7311597946a5217d1f6d653751a4dba1c78354', '46f9d1e35f7f8bc164a6ec916056e83232f18b46bb9e10af935b5ff0']}
2015-08-11 11:12:33,062 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:12:33,063 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:12:33,065 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=g65d%2FaSrikn6oAUSW1nx%2BMfLenkrigpLcAB0auyhsqM7RQKLtzlrcUtWRY5iZ46fAkygZdG8G6l5pr4Hub0tGxAlmZ6KlJTh1N5gDMYobCc%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:12:56,606 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "use": "enc"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "use": "sig"}]}
2015-08-11 11:12:56,607 root:INFO OC3 server keys: {"keys": [{"x": "ZSpConyntYbqFwIx8NKmcrYpsYbIu96IEE-PZG9We3s", "kty": "EC", "crv": "P-256", "y": "6_LMJPRKrgu7d2ARFJzagRrpklcn75Wu70vEpS5KJfY", "kid": "op2", "use": "sig"}]}
2015-08-11 11:12:56,607 root:INFO OC3 server keys: {"keys": [{"x": "2VvZGlBFvWcux8s8zTJJ--gnALDZS_loVaPLJ60qC68", "kty": "EC", "crv": "P-256", "y": "i5pS9KsIzVmYTUy8En1zxDjGruIer5xLQUcwEKvkZl4", "kid": "op3", "use": "enc"}]}
2015-08-11 11:12:56,607 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:13:01,345 oicServer:INFO callback: <function webfinger at 0x10563ad90>
2015-08-11 11:13:03,618 oicServer:INFO callback: <function op_info at 0x10563a9d8>
2015-08-11 11:13:04,268 root:INFO op_info
2015-08-11 11:13:04,270 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:13:04,271 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'scopes_supported': ['phone', 'openid', 'profile', 'address', 'offline_access', 'email', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'request_object_signing_alg_values_supported': ['RS384', 'PS384', 'ES256', 'ES384', 'RS512', 'HS512', 'HS384', 'ES512', 'none', 'HS256', 'PS256', 'PS521', 'RS256'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_parameter_supported': True, 'request_uri_parameter_supported': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'userinfo_signing_alg_values_supported': ['RS384', 'PS384', 'ES256', 'ES384', 'RS512', 'HS512', 'HS384', 'ES512', 'none', 'HS256', 'PS256', 'PS521', 'RS256'], 'issuer': 'https://localhost:8092/', 'subject_types_supported': ['public', 'pairwise'], 'version': '3.0', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'end_session_endpoint': 'https://localhost:8092/end_session', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'claims_supported': ['sub', 'email_verified', 'preferred_username', 'gender', 'middle_name', 'picture', 'website', 'phone_number', 'family_name', 'birthdate', 'name', 'nickname', 'given_name', 'phone_number_verified', 'profile', 'address', 'zoneinfo', 'locale', 'email', 'updated_at'], 'id_token_signing_alg_values_supported': ['RS384', 'PS384', 'ES256', 'ES384', 'RS512', 'HS512', 'HS384', 'ES512', 'none', 'HS256', 'PS256', 'PS521', 'RS256'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'PS384', 'ES256', 'ES384', 'RS512', 'HS512', 'HS384', 'ES512', 'HS256', 'PS256', 'PS521', 'RS256'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'request_parameter_supported': True, 'registration_endpoint': 'https://localhost:8092/registration'}
2015-08-11 11:13:04,340 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105632588>
2015-08-11 11:13:05,021 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/"], "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "application_type": "web"}>>
2015-08-11 11:13:05,022 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:13:05,029 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439280785, 'registration_client_uri': 'https://localhost:8092/registration?client_id=g4RNs2LKYS1L', 'client_secret': 'aa048a69cf05298fa2340376240369c3d3ed4934bd7f6e1881949048', 'client_secret_expires_at': 1439367185, 'client_id': 'g4RNs2LKYS1L', 'registration_access_token': 'fdiuuaIqMhuyFm40BD40MkhBxgLV2KRH'}
2015-08-11 11:13:05,031 oic.utils.keyio:DEBUG loading keys for issuer: g4RNs2LKYS1L
2015-08-11 11:13:05,031 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:13:05,031 oic.oic.provider:DEBUG keys for g4RNs2LKYS1L: []
2015-08-11 11:13:05,033 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439280785, 'application_type': 'web', 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=g4RNs2LKYS1L', 'client_secret': 'aa048a69cf05298fa2340376240369c3d3ed4934bd7f6e1881949048', 'client_secret_expires_at': 1439367185, 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'contacts': ['ops@example.com'], 'client_id': 'g4RNs2LKYS1L', 'registration_access_token': 'fdiuuaIqMhuyFm40BD40MkhBxgLV2KRH'}
2015-08-11 11:13:05,034 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439280785, 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=g4RNs2LKYS1L', 'client_secret': 'aa048a69cf05298fa2340376240369c3d3ed4934bd7f6e1881949048', 'client_secret_expires_at': 1439367185, 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'client_id': 'g4RNs2LKYS1L', 'registration_access_token': 'fdiuuaIqMhuyFm40BD40MkhBxgLV2KRH'}
2015-08-11 11:13:05,068 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b3a90>
2015-08-11 11:13:05,792 oic.oauth2.provider:DEBUG Request: 'state=urn%3Auuid%3Aeb9901ca-9d0a-4893-a670-752f3c9353f4&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&response_type=code&acr_values=PASSWORD&client_id=g4RNs2LKYS1L'
2015-08-11 11:13:05,794 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e6b38>, <jwkest.jwk.RSAKey object at 0x1057acd68>, <jwkest.jwk.ECKey object at 0x1057b10b8>]
2015-08-11 11:13:05,794 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'state': 'urn:uuid:eb9901ca-9d0a-4893-a670-752f3c9353f4', 'client_id': 'g4RNs2LKYS1L', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD'}
2015-08-11 11:13:05,797 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'state': 'urn:uuid:eb9901ca-9d0a-4893-a670-752f3c9353f4', 'client_id': 'g4RNs2LKYS1L', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD'}
2015-08-11 11:13:05,799 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10578f390>, 'PASSWORD')]
2015-08-11 11:13:05,799 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:13:05,800 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:13:05,800 oic.utils.authn.user:INFO do_authentication argv: {'policy_uri': '', 'tos_uri': '', 'login': '', 'passwd_title': 'Password', 'query': 'state=urn%3Auuid%3Aeb9901ca-9d0a-4893-a670-752f3c9353f4&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&response_type=code&acr_values=PASSWORD&client_id=g4RNs2LKYS1L', 'client_policy_title': 'Client Policy', 'password': '', 'logo_uri': '', 'title': 'User log in', 'acr': ['PASSWORD'], 'submit_text': 'Submit', 'login_title': 'Username', 'action': 'https://localhost:8092/verify'}
2015-08-11 11:13:05,816 oicServer:INFO callback: <function css at 0x1055a3c80>
2015-08-11 11:13:13,557 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10572fc80>
2015-08-11 11:13:32,686 oic.utils.authn.user:DEBUG verify(query=state%3Durn%253Auuid%253Aeb9901ca-9d0a-4893-a670-752f3c9353f4%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26acr_values%3DPASSWORD%26client_id%3Dg4RNs2LKYS1L&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:13:32,687 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'query': ['state=urn%3Auuid%3Aeb9901ca-9d0a-4893-a670-752f3c9353f4&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&response_type=code&acr_values=PASSWORD&client_id=g4RNs2LKYS1L'], 'acr_values': ["['PASSWORD']"], 'password': ['krall'], 'form.commit': ['Submit']}
2015-08-11 11:13:32,688 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-11 11:13:32,691 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'upm_answer': 'true', 'state': ['urn:uuid:eb9901ca-9d0a-4893-a670-752f3c9353f4'], 'response_type': ['code'], 'client_id': ['g4RNs2LKYS1L'], 'scope': ['openid profile email address phone'], 'acr_values': ['PASSWORD']}
2015-08-11 11:13:32,695 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b3a90>
2015-08-11 11:13:34,813 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&upm_answer=true&state=urn%3Auuid%3Aeb9901ca-9d0a-4893-a670-752f3c9353f4&response_type=code&client_id=g4RNs2LKYS1L&scope=openid+profile+email+address+phone&acr_values=PASSWORD'
2015-08-11 11:13:34,813 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e6b38>, <jwkest.jwk.RSAKey object at 0x1057acd68>, <jwkest.jwk.ECKey object at 0x1057b10b8>]
2015-08-11 11:13:34,814 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'state': 'urn:uuid:eb9901ca-9d0a-4893-a670-752f3c9353f4', 'client_id': 'g4RNs2LKYS1L', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD'}
2015-08-11 11:13:34,815 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true', 'state': 'urn:uuid:eb9901ca-9d0a-4893-a670-752f3c9353f4', 'client_id': 'g4RNs2LKYS1L', 'response_type': 'code', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD'}
2015-08-11 11:13:34,818 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10578f390>, 'PASSWORD')]
2015-08-11 11:13:34,818 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:13:34,819 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:13:34,819 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:13:34,819 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'upm_answer', 'state', 'response_type', 'client_id', 'scope', 'acr_values']
2015-08-11 11:13:34,820 oic.utils.sdb:DEBUG uid2sid: {'diana': ['221e37c74a8a7d9d7b477e67b854b74094aae933569bc162c94f89b0']}
2015-08-11 11:13:34,821 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:13:34,821 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:13:34,824 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?state=urn%3Auuid%3Aeb9901ca-9d0a-4893-a670-752f3c9353f4&code=GyqXP8tujS%2Bo0ey0imzsNDx4NCzyfaIw1HhIaXvGJwIx1WGzu9UQsyhzg4pkWA4qgTm6tOnhD7K3djAWsUJESYNCz16DfAuEWtwPXUlKBe8%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:13:37,610 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:13:45,188 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055b3cf8>
2015-08-11 11:14:01,856 oic.oic.provider:DEBUG - token -
2015-08-11 11:14:02,265 oic.oic.provider:INFO token_request: code=GyqXP8tujS%2Bo0ey0imzsNDx4NCzyfaIw1HhIaXvGJwIx1WGzu9UQsyhzg4pkWA4qgTm6tOnhD7K3djAWsUJESYNCz16DfAuEWtwPXUlKBe8%3D&grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 11:14:04,353 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code', 'code': 'GyqXP8tujS+o0ey0imzsNDx4NCzyfaIw1HhIaXvGJwIx1WGzu9UQsyhzg4pkWA4qgTm6tOnhD7K3djAWsUJESYNCz16DfAuEWtwPXUlKBe8='}
2015-08-11 11:14:19,824 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code', 'code': 'GyqXP8tujS+o0ey0imzsNDx4NCzyfaIw1HhIaXvGJwIx1WGzu9UQsyhzg4pkWA4qgTm6tOnhD7K3djAWsUJESYNCz16DfAuEWtwPXUlKBe8='}
2015-08-11 11:14:22,329 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:17:52,648 root:INFO OC3 server keys: {"keys": [{"use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}, {"use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}]}
2015-08-11 11:17:52,649 root:INFO OC3 server keys: {"keys": [{"use": "sig", "y": "XCvqVfltmsYPOg-3y8l4jNPr7pYpYsqy2q1ORlAqM-M", "x": "4nrjTWP0XpTNoQGMpCDnbK2CyxmkYcYEoVROW3qR4hQ", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-11 11:17:52,649 root:INFO OC3 server keys: {"keys": [{"use": "enc", "y": "ToOi_4Rder_a2Ii5UwzskAuQX3XAkjumeY5nwvniYTI", "x": "50A_Z2IxQk9X9f5V3aFR88hTBBEpKFf77zkeXwXatdE", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-11 11:17:52,650 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:17:56,375 oicServer:INFO callback: <function webfinger at 0x105544d08>
2015-08-11 11:17:58,845 oicServer:INFO callback: <function op_info at 0x105544950>
2015-08-11 11:17:59,420 root:INFO op_info
2015-08-11 11:17:59,421 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:17:59,423 oic.oic.provider:INFO provider_info_response: {'request_uri_parameter_supported': True, 'claims_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_signing_alg_values_supported': ['PS384', 'ES512', 'HS384', 'ES384', 'RS256', 'RS384', 'PS521', 'none', 'HS512', 'RS512', 'PS256', 'ES256', 'HS256'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_parameter_supported': True, 'scopes_supported': ['profile', 'email', 'offline_access', 'phone', 'openid', 'address', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'registration_endpoint': 'https://localhost:8092/registration', 'claims_supported': ['name', 'profile', 'given_name', 'preferred_username', 'sub', 'family_name', 'locale', 'birthdate', 'phone_number', 'nickname', 'gender', 'email', 'phone_number_verified', 'middle_name', 'zoneinfo', 'email_verified', 'picture', 'website', 'updated_at', 'address'], 'request_object_signing_alg_values_supported': ['PS384', 'ES512', 'HS384', 'ES384', 'RS256', 'RS384', 'PS521', 'none', 'HS512', 'RS512', 'PS256', 'ES256', 'HS256'], 'id_token_signing_alg_values_supported': ['PS384', 'ES512', 'HS384', 'ES384', 'RS256', 'RS384', 'PS521', 'none', 'HS512', 'RS512', 'PS256', 'ES256', 'HS256'], 'acr_values_supported': ['PASSWORD'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'require_request_uri_registration': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_signing_alg_values_supported': ['PS384', 'ES512', 'HS384', 'ES384', 'RS256', 'RS384', 'PS521', 'HS512', 'RS512', 'PS256', 'ES256', 'HS256'], 'version': '3.0', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-11 11:17:59,497 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10553c668>
2015-08-11 11:18:00,848 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 11:18:00,848 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:18:00,855 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'ZZ3ZatKyDYqewIq4VVNedLTl48LsX1RK', 'client_secret_expires_at': 1439367480, 'client_id_issued_at': 1439281080, 'client_id': 'Xkl2YEtbiwqn', 'registration_client_uri': 'https://localhost:8092/registration?client_id=Xkl2YEtbiwqn', 'client_secret': 'fbee5a59fcbf4f4a754a0010294e251696fd5ad9a702e2b1d2b61220'}
2015-08-11 11:18:00,857 oic.utils.keyio:DEBUG loading keys for issuer: Xkl2YEtbiwqn
2015-08-11 11:18:00,857 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:18:00,857 oic.oic.provider:DEBUG keys for Xkl2YEtbiwqn: []
2015-08-11 11:18:00,861 oic.oic.provider:INFO Client info: {'registration_access_token': 'ZZ3ZatKyDYqewIq4VVNedLTl48LsX1RK', 'client_secret_expires_at': 1439367480, 'client_id_issued_at': 1439281080, 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'client_id': 'Xkl2YEtbiwqn', 'registration_client_uri': 'https://localhost:8092/registration?client_id=Xkl2YEtbiwqn', 'application_type': 'web', 'client_secret': 'fbee5a59fcbf4f4a754a0010294e251696fd5ad9a702e2b1d2b61220'}
2015-08-11 11:18:00,861 oic.oic.provider:DEBUG registration_response: {'registration_access_token': 'ZZ3ZatKyDYqewIq4VVNedLTl48LsX1RK', 'client_secret_expires_at': 1439367480, 'client_id': 'Xkl2YEtbiwqn', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439281080, 'registration_client_uri': 'https://localhost:8092/registration?client_id=Xkl2YEtbiwqn', 'application_type': 'web', 'client_secret': 'fbee5a59fcbf4f4a754a0010294e251696fd5ad9a702e2b1d2b61220'}
2015-08-11 11:18:00,880 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054beb70>
2015-08-11 11:18:01,712 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&client_id=Xkl2YEtbiwqn&response_type=code&state=urn%3Auuid%3A362306fc-9654-4e96-9b68-c7c314c3af72&acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'
2015-08-11 11:18:01,713 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056ec320>, <jwkest.jwk.RSAKey object at 0x1056b6e48>, <jwkest.jwk.ECKey object at 0x1056bb208>]
2015-08-11 11:18:01,714 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'acr_values': 'PASSWORD', 'client_id': 'Xkl2YEtbiwqn', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:18:01,716 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'acr_values': 'PASSWORD', 'client_id': 'Xkl2YEtbiwqn', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:18:01,718 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10566a470>, 'PASSWORD')]
2015-08-11 11:18:01,718 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:18:01,719 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:18:01,720 oic.utils.authn.user:INFO do_authentication argv: {'logo_uri': '', 'submit_text': 'Submit', 'login': '', 'password': '', 'query': 'scope=openid+profile+email+address+phone&client_id=Xkl2YEtbiwqn&response_type=code&state=urn%3Auuid%3A362306fc-9654-4e96-9b68-c7c314c3af72&acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7', 'passwd_title': 'Password', 'tos_uri': '', 'title': 'User log in', 'action': 'https://localhost:8092/verify', 'client_policy_title': 'Client Policy', 'login_title': 'Username', 'policy_uri': '', 'acr': ['PASSWORD']}
2015-08-11 11:18:01,750 oicServer:INFO callback: <function css at 0x1054aebf8>
2015-08-11 11:18:07,641 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10563cbf8>
2015-08-11 11:18:10,815 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DXkl2YEtbiwqn%26response_type%3Dcode%26state%3Durn%253Auuid%253A362306fc-9654-4e96-9b68-c7c314c3af72%26acr_values%3DPASSWORD%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:18:10,816 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'acr_values': ["['PASSWORD']"], 'query': ['scope=openid+profile+email+address+phone&client_id=Xkl2YEtbiwqn&response_type=code&state=urn%3Auuid%3A362306fc-9654-4e96-9b68-c7c314c3af72&acr_values=PASSWORD&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-11 11:18:10,816 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-11 11:18:10,818 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'scope': ['openid profile email address phone'], 'state': ['urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72'], 'acr_values': ['PASSWORD'], 'client_id': ['Xkl2YEtbiwqn'], 'upm_answer': 'true', 'response_type': ['code']}
2015-08-11 11:18:10,822 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054beb70>
2015-08-11 11:18:11,531 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&state=urn%3Auuid%3A362306fc-9654-4e96-9b68-c7c314c3af72&acr_values=PASSWORD&client_id=Xkl2YEtbiwqn&upm_answer=true&response_type=code'
2015-08-11 11:18:11,533 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056ec320>, <jwkest.jwk.RSAKey object at 0x1056b6e48>, <jwkest.jwk.ECKey object at 0x1056bb208>]
2015-08-11 11:18:11,533 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'acr_values': 'PASSWORD', 'upm_answer': 'true', 'client_id': 'Xkl2YEtbiwqn', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:18:11,535 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'acr_values': 'PASSWORD', 'upm_answer': 'true', 'client_id': 'Xkl2YEtbiwqn', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:18:11,537 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10566a470>, 'PASSWORD')]
2015-08-11 11:18:11,537 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:18:11,538 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:18:11,539 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:18:11,539 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'scope', 'state', 'acr_values', 'client_id', 'response_type', 'upm_answer']
2015-08-11 11:18:11,540 oic.utils.sdb:DEBUG uid2sid: {'diana': ['65c055ffdd5eceb15777c29044f563fcddece4cf4b9632ff7b6a4601']}
2015-08-11 11:18:11,540 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:18:11,541 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:18:11,544 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi%2BwI0cJ2CC7u%2FQCVyzG68PRES5r%2BbRdLRwrGBtxCbxHk7Ly7i%2FrucqOQ1sZP0fToUGS0%3D&scope=openid+profile+email+address+phone&state=urn%3Auuid%3A362306fc-9654-4e96-9b68-c7c314c3af72' (<class 'str'>)
2015-08-11 11:18:12,609 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:18:16,371 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054bedd8>
2015-08-11 11:18:18,322 oic.oic.provider:DEBUG - token -
2015-08-11 11:18:18,323 oic.oic.provider:INFO token_request: grant_type=authorization_code&code=OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi%2BwI0cJ2CC7u%2FQCVyzG68PRES5r%2BbRdLRwrGBtxCbxHk7Ly7i%2FrucqOQ1sZP0fToUGS0%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 11:18:18,324 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRES5r+bRdLRwrGBtxCbxHk7Ly7i/rucqOQ1sZP0fToUGS0=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:18:20,214 oic.utils.authn.client:DEBUG REQ: {'code': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRES5r+bRdLRwrGBtxCbxHk7Ly7i/rucqOQ1sZP0fToUGS0=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:18:20,215 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:18:27,053 oic.oic.provider:DEBUG All checks OK
2015-08-11 11:18:27,056 oic.oic:DEBUG authzreq: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'acr_values': 'PASSWORD', 'client_id': 'Xkl2YEtbiwqn', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 11:18:27,056 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 11:18:27,057 oic.oic:DEBUG authzreq: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'acr_values': 'PASSWORD', 'client_id': 'Xkl2YEtbiwqn', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 11:18:27,058 oic.oic.provider:DEBUG id_token: {'iss': 'https://localhost:8092/', 'exp': 1439363907, 'sub': '197ccf53a3ea9d23', 'iat': 1439284707, 'aud': ['Xkl2YEtbiwqn'], 'auth_time': 1439284690, 'acr': 'PASSWORD'}
2015-08-11 11:18:27,060 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}, {"use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}]}
2015-08-11 11:18:27,061 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "y": "XCvqVfltmsYPOg-3y8l4jNPr7pYpYsqy2q1ORlAqM-M", "x": "4nrjTWP0XpTNoQGMpCDnbK2CyxmkYcYEoVROW3qR4hQ", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-11 11:18:27,062 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "y": "ToOi_4Rder_a2Ii5UwzskAuQX3XAkjumeY5nwvniYTI", "x": "50A_Z2IxQk9X9f5V3aFR88hTBBEpKFf77zkeXwXatdE", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-11 11:18:27,062 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1056b6e48>]
2015-08-11 11:18:27,069 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 11:18:27,070 oic.oic.provider:DEBUG _tinfo: {'revoked': False, 'oauth_state': 'token', 'access_token_scope': '?', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'access_token': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRESSvS/0d/b74OFQfjT6MakhAL/2VwKDdtRLSxF49N1mwE=', 'sub': '197ccf53a3ea9d23', 'client_id': 'Xkl2YEtbiwqn', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1056ecfd0>, 'code': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRES5r+bRdLRwrGBtxCbxHk7Ly7i/rucqOQ1sZP0fToUGS0=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'expires_in': 3600, 'code_used': True, 'permission': '', 'authzreq': '{"scope": "openid profile email address phone", "state": "urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72", "acr_values": "PASSWORD", "upm_answer": "true", "client_id": "Xkl2YEtbiwqn", "response_type": "code", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"}', 'token_expires_at': 1439284707, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiZXhwIjogMTQzOTM2MzkwNywgInN1YiI6ICIxOTdjY2Y1M2EzZWE5ZDIzIiwgImlhdCI6IDE0MzkyODQ3MDcsICJhdWQiOiBbIlhrbDJZRXRiaXdxbiJdLCAiYXV0aF90aW1lIjogMTQzOTI4NDY5MCwgImFjciI6ICJQQVNTV09SRCJ9.S4uyB5oaUgduz5L7Hv1l3aogbyriSgXvm4ET_igpmgxM3hiJELy3k2LRd3tTksoBP1N2VJMduyRCY1XJRcmdJlLiSIFGz0F8BYRIB3yoBS6-KYl72jqxDRa2PW8m_OAspLFOtDXHrJ7MctTkZijtS_O6r0bNwZiHZq0PfxdCT9r5sLwW_TIPRHIo3RjFhuWPADY0eWFNKIBzJ_kJVL4RxcPwGFRg-BAGHFUwFMSZ5ewopHcmLYUrDEXRSu_knVwRhY3mbHbrVAt_8-PFyEQWh_s-1jW3vIWWg_lTSDx2UlJVJnQ6a1YWNBXlRg4qUfzwP4THhfWzg5489_b2gZQIQQ', 'token_type': 'Bearer', 'refresh_token': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRESYez99dbhcjyySSZig8BqVO+TfQZ2tJxp+Q1CIqvJP70='}
2015-08-11 11:18:27,071 oic.oic.provider:DEBUG access_token_response: {'scope': 'openid profile email address phone', 'expires_in': 3600, 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'access_token': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRESSvS/0d/b74OFQfjT6MakhAL/2VwKDdtRLSxF49N1mwE=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiZXhwIjogMTQzOTM2MzkwNywgInN1YiI6ICIxOTdjY2Y1M2EzZWE5ZDIzIiwgImlhdCI6IDE0MzkyODQ3MDcsICJhdWQiOiBbIlhrbDJZRXRiaXdxbiJdLCAiYXV0aF90aW1lIjogMTQzOTI4NDY5MCwgImFjciI6ICJQQVNTV09SRCJ9.S4uyB5oaUgduz5L7Hv1l3aogbyriSgXvm4ET_igpmgxM3hiJELy3k2LRd3tTksoBP1N2VJMduyRCY1XJRcmdJlLiSIFGz0F8BYRIB3yoBS6-KYl72jqxDRa2PW8m_OAspLFOtDXHrJ7MctTkZijtS_O6r0bNwZiHZq0PfxdCT9r5sLwW_TIPRHIo3RjFhuWPADY0eWFNKIBzJ_kJVL4RxcPwGFRg-BAGHFUwFMSZ5ewopHcmLYUrDEXRSu_knVwRhY3mbHbrVAt_8-PFyEQWh_s-1jW3vIWWg_lTSDx2UlJVJnQ6a1YWNBXlRg4qUfzwP4THhfWzg5489_b2gZQIQQ', 'token_type': 'Bearer', 'refresh_token': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRESYez99dbhcjyySSZig8BqVO+TfQZ2tJxp+Q1CIqvJP70='}
2015-08-11 11:18:27,095 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10553c5c0>
2015-08-11 11:18:29,226 oic.oic:DEBUG verify keys: None
2015-08-11 11:18:29,227 oic.oic.provider:DEBUG user_info_request: {'access_token': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRESSvS/0d/b74OFQfjT6MakhAL/2VwKDdtRLSxF49N1mwE='}
2015-08-11 11:18:29,228 oicServer:DEBUG access_token type: 'T'
2015-08-11 11:18:29,229 oic.oic:DEBUG authzreq: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'acr_values': 'PASSWORD', 'client_id': 'Xkl2YEtbiwqn', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 11:18:29,230 oic.oic.provider:DEBUG userinfo_claim: {'picture': None, 'name': None, 'given_name': None, 'preferred_username': None, 'profile': None, 'sub': None, 'family_name': None, 'locale': None, 'birthdate': None, 'phone_number': None, 'phone_number_verified': None, 'gender': None, 'email': None, 'nickname': None, 'middle_name': None, 'zoneinfo': None, 'email_verified': None, 'website': None, 'updated_at': None, 'address': None}
2015-08-11 11:18:29,230 oic.oic.provider:DEBUG Session info: {'revoked': False, 'oauth_state': 'token', 'access_token_scope': '?', 'state': 'urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72', 'access_token': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRESSvS/0d/b74OFQfjT6MakhAL/2VwKDdtRLSxF49N1mwE=', 'sub': '197ccf53a3ea9d23', 'client_id': 'Xkl2YEtbiwqn', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1056ecfd0>, 'code': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRES5r+bRdLRwrGBtxCbxHk7Ly7i/rucqOQ1sZP0fToUGS0=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'expires_in': 3600, 'code_used': True, 'permission': '', 'authzreq': '{"scope": "openid profile email address phone", "state": "urn:uuid:362306fc-9654-4e96-9b68-c7c314c3af72", "acr_values": "PASSWORD", "upm_answer": "true", "client_id": "Xkl2YEtbiwqn", "response_type": "code", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"}', 'token_expires_at': 1439284707, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiZXhwIjogMTQzOTM2MzkwNywgInN1YiI6ICIxOTdjY2Y1M2EzZWE5ZDIzIiwgImlhdCI6IDE0MzkyODQ3MDcsICJhdWQiOiBbIlhrbDJZRXRiaXdxbiJdLCAiYXV0aF90aW1lIjogMTQzOTI4NDY5MCwgImFjciI6ICJQQVNTV09SRCJ9.S4uyB5oaUgduz5L7Hv1l3aogbyriSgXvm4ET_igpmgxM3hiJELy3k2LRd3tTksoBP1N2VJMduyRCY1XJRcmdJlLiSIFGz0F8BYRIB3yoBS6-KYl72jqxDRa2PW8m_OAspLFOtDXHrJ7MctTkZijtS_O6r0bNwZiHZq0PfxdCT9r5sLwW_TIPRHIo3RjFhuWPADY0eWFNKIBzJ_kJVL4RxcPwGFRg-BAGHFUwFMSZ5ewopHcmLYUrDEXRSu_knVwRhY3mbHbrVAt_8-PFyEQWh_s-1jW3vIWWg_lTSDx2UlJVJnQ6a1YWNBXlRg4qUfzwP4THhfWzg5489_b2gZQIQQ', 'token_type': 'Bearer', 'refresh_token': 'OGxczfBHjPOISV7WblfbhMFd4jDn1MOwAonewJDi+wI0cJ2CC7u/QCVyzG68PRESYez99dbhcjyySSZig8BqVO+TfQZ2tJxp+Q1CIqvJP70='}
2015-08-11 11:18:29,231 oic.oic.provider:DEBUG user_info_response: {'nickname': 'Dina', 'name': 'Diana Krall', 'email': 'diana@example.org', 'given_name': 'Diana', 'address': {'country': 'Sweden', 'locality': 'Ume', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187'}, 'sub': '197ccf53a3ea9d23', 'family_name': 'Krall', 'email_verified': False, 'phone_number': '+46 90 7865000'}
2015-08-11 11:19:02,300 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-11 11:19:02,301 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "use": "sig", "crv": "P-256", "y": "3Todavks0XGot03v0QH67JpfyH4jVL_SXwl873nuGf4", "x": "WycXU5a_FmPtHXrPxT8LPoSK5f5fbbVSeWFjklGjVKo"}]}
2015-08-11 11:19:02,301 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "use": "enc", "crv": "P-256", "y": "YtY2_aRdWUdIpWxaNf6aixwgB9G78CEkgTdLhf7pRLs", "x": "ZFos63CvHxCRAHO5qGC-E4tWFMu8EohIoVvljobJWd4"}]}
2015-08-11 11:19:02,302 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:19:05,767 oicServer:INFO callback: <function webfinger at 0x105644d08>
2015-08-11 11:19:08,082 oicServer:INFO callback: <function op_info at 0x105644950>
2015-08-11 11:19:08,363 root:INFO op_info
2015-08-11 11:19:08,365 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:19:08,366 oic.oic.provider:INFO provider_info_response: {'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'token_endpoint_auth_signing_alg_values_supported': ['PS521', 'ES256', 'HS256', 'RS512', 'ES512', 'RS384', 'HS512', 'RS256', 'PS384', 'PS256', 'HS384', 'ES384'], 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_signing_alg_values_supported': ['PS521', 'none', 'ES256', 'HS256', 'RS512', 'ES512', 'RS384', 'HS512', 'RS256', 'PS384', 'PS256', 'HS384', 'ES384'], 'claims_supported': ['middle_name', 'phone_number_verified', 'locale', 'gender', 'email_verified', 'profile', 'updated_at', 'picture', 'email', 'name', 'sub', 'given_name', 'phone_number', 'zoneinfo', 'preferred_username', 'address', 'nickname', 'birthdate', 'website', 'family_name'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'token_endpoint': 'https://localhost:8092/token', 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_signing_alg_values_supported': ['PS521', 'none', 'ES256', 'HS256', 'RS512', 'ES512', 'RS384', 'HS512', 'RS256', 'PS384', 'PS256', 'HS384', 'ES384'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['PS521', 'none', 'ES256', 'HS256', 'RS512', 'ES512', 'RS384', 'HS512', 'RS256', 'PS384', 'PS256', 'HS384', 'ES384'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'version': '3.0', 'require_request_uri_registration': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'acr_values_supported': ['PASSWORD'], 'scopes_supported': ['email', 'phone', 'offline_access', 'openid', 'address', 'profile', 'openid'], 'registration_endpoint': 'https://localhost:8092/registration', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW']}
2015-08-11 11:19:08,441 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10563a588>
2015-08-11 11:19:09,149 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "contacts": ["ops@example.com"], "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 11:19:09,150 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:19:09,158 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'kd47PBtkgJJv3LFxGQiLW6T4zz2B4qaa', 'client_id_issued_at': 1439281149, 'client_secret_expires_at': 1439367549, 'client_secret': '007e348022b7c21edeb9d1562f03e028f41b482d26068953ba0fab38', 'registration_client_uri': 'https://localhost:8092/registration?client_id=10rOPDtg8rQP', 'client_id': '10rOPDtg8rQP'}
2015-08-11 11:19:09,160 oic.utils.keyio:DEBUG loading keys for issuer: 10rOPDtg8rQP
2015-08-11 11:19:09,161 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:19:09,162 oic.oic.provider:DEBUG keys for 10rOPDtg8rQP: []
2015-08-11 11:19:09,164 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'application_type': 'web', 'registration_access_token': 'kd47PBtkgJJv3LFxGQiLW6T4zz2B4qaa', 'client_id_issued_at': 1439281149, 'client_secret_expires_at': 1439367549, 'client_secret': '007e348022b7c21edeb9d1562f03e028f41b482d26068953ba0fab38', 'registration_client_uri': 'https://localhost:8092/registration?client_id=10rOPDtg8rQP', 'client_id': '10rOPDtg8rQP'}
2015-08-11 11:19:09,164 oic.oic.provider:DEBUG registration_response: {'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439281149, 'registration_access_token': 'kd47PBtkgJJv3LFxGQiLW6T4zz2B4qaa', 'client_secret': '007e348022b7c21edeb9d1562f03e028f41b482d26068953ba0fab38', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'client_id': '10rOPDtg8rQP', 'client_secret_expires_at': 1439367549, 'registration_client_uri': 'https://localhost:8092/registration?client_id=10rOPDtg8rQP'}
2015-08-11 11:19:09,182 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bdcf8>
2015-08-11 11:19:09,797 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=10rOPDtg8rQP&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A09fe0d25-6034-49eb-b55f-bcb532a6b5b6'
2015-08-11 11:19:09,798 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057ec2b0>, <jwkest.jwk.RSAKey object at 0x1057b6da0>, <jwkest.jwk.ECKey object at 0x1057bb160>]
2015-08-11 11:19:09,799 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'acr_values': 'PASSWORD', 'client_id': '10rOPDtg8rQP', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:09,802 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'acr_values': 'PASSWORD', 'client_id': '10rOPDtg8rQP', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:09,804 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10576b3c8>, 'PASSWORD')]
2015-08-11 11:19:09,804 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:19:09,805 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:19:09,805 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'passwd_title': 'Password', 'policy_uri': '', 'client_policy_title': 'Client Policy', 'logo_uri': '', 'login_title': 'Username', 'login': '', 'acr': ['PASSWORD'], 'tos_uri': '', 'title': 'User log in', 'password': '', 'action': 'https://localhost:8092/verify', 'query': 'acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=10rOPDtg8rQP&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A09fe0d25-6034-49eb-b55f-bcb532a6b5b6'}
2015-08-11 11:19:09,822 oicServer:INFO callback: <function css at 0x1055adbf8>
2015-08-11 11:19:17,187 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10573abf8>
2015-08-11 11:19:19,840 oic.utils.authn.user:DEBUG verify(query=acr_values%3DPASSWORD%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3D10rOPDtg8rQP%26response_type%3Dcode%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26state%3Durn%253Auuid%253A09fe0d25-6034-49eb-b55f-bcb532a6b5b6&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:19:19,841 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'password': ['krall'], 'query': ['acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=10rOPDtg8rQP&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A09fe0d25-6034-49eb-b55f-bcb532a6b5b6'], 'acr_values': ["['PASSWORD']"], 'form.commit': ['Submit']}
2015-08-11 11:19:19,841 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 11:19:19,843 oic.utils.authn.user:DEBUG kwargs: {'state': ['urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'upm_answer': 'true', 'response_type': ['code'], 'acr_values': ['PASSWORD'], 'client_id': ['10rOPDtg8rQP'], 'scope': ['openid profile email address phone']}
2015-08-11 11:19:19,848 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bdcf8>
2015-08-11 11:19:20,562 oic.oauth2.provider:DEBUG Request: 'state=urn%3Auuid%3A09fe0d25-6034-49eb-b55f-bcb532a6b5b6&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&upm_answer=true&response_type=code&acr_values=PASSWORD&client_id=10rOPDtg8rQP&scope=openid+profile+email+address+phone'
2015-08-11 11:19:20,564 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057ec2b0>, <jwkest.jwk.RSAKey object at 0x1057b6da0>, <jwkest.jwk.ECKey object at 0x1057bb160>]
2015-08-11 11:19:20,565 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'client_id': '10rOPDtg8rQP', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:20,567 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'client_id': '10rOPDtg8rQP', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:20,569 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x10576b3c8>, 'PASSWORD')]
2015-08-11 11:19:20,569 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:19:20,570 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:19:20,570 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:19:20,571 oic.oic.provider:DEBUG AREQ keys: ['state', 'redirect_uri', 'acr_values', 'response_type', 'upm_answer', 'client_id', 'scope']
2015-08-11 11:19:20,572 oic.utils.sdb:DEBUG uid2sid: {'diana': ['3352c8ee2157cf07d7568df36432c8b7848ad2c5bf2d144961aff1b7']}
2015-08-11 11:19:20,572 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:19:20,572 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:19:20,575 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?state=urn%3Auuid%3A09fe0d25-6034-49eb-b55f-bcb532a6b5b6&code=sf8tvZt1BaHSOBq%2B3bwrvThEeBO%2FZlx37vNJpMs7I2ZeCWgl1eE%2F0SPCp0aPCXDcuJVqGpiH9%2FB9oGuJqWRT1ObE7ob5mAe4mg7e6gud6u8%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:19:21,391 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:19:22,768 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055bdb00>
2015-08-11 11:19:23,622 oic.oic.provider:DEBUG - token -
2015-08-11 11:19:23,623 oic.oic.provider:INFO token_request: grant_type=authorization_code&code=sf8tvZt1BaHSOBq%2B3bwrvThEeBO%2FZlx37vNJpMs7I2ZeCWgl1eE%2F0SPCp0aPCXDcuJVqGpiH9%2FB9oGuJqWRT1ObE7ob5mAe4mg7e6gud6u8%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 11:19:23,623 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'code': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcuJVqGpiH9/B9oGuJqWRT1ObE7ob5mAe4mg7e6gud6u8=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:19:24,346 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'code': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcuJVqGpiH9/B9oGuJqWRT1ObE7ob5mAe4mg7e6gud6u8=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:19:24,346 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:19:25,133 oic.oic.provider:DEBUG All checks OK
2015-08-11 11:19:25,134 oic.oic:DEBUG authzreq: {'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'client_id': '10rOPDtg8rQP', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:25,135 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 11:19:25,135 oic.oic:DEBUG authzreq: {'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'client_id': '10rOPDtg8rQP', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:25,136 oic.oic.provider:DEBUG id_token: {'auth_time': 1439284759, 'sub': '-597c3e2895000438', 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/', 'aud': ['10rOPDtg8rQP'], 'iat': 1439284765, 'exp': 1439363965}
2015-08-11 11:19:25,139 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-11 11:19:25,142 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "use": "sig", "crv": "P-256", "y": "3Todavks0XGot03v0QH67JpfyH4jVL_SXwl873nuGf4", "x": "WycXU5a_FmPtHXrPxT8LPoSK5f5fbbVSeWFjklGjVKo"}]}
2015-08-11 11:19:25,144 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "use": "enc", "crv": "P-256", "y": "YtY2_aRdWUdIpWxaNf6aixwgB9G78CEkgTdLhf7pRLs", "x": "ZFos63CvHxCRAHO5qGC-E4tWFMu8EohIoVvljobJWd4"}]}
2015-08-11 11:19:25,144 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057b6da0>]
2015-08-11 11:19:25,157 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 11:19:25,158 oic.oic.provider:DEBUG _tinfo: {'expires_in': 3600, 'permission': '', 'revoked': False, 'access_token': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcHoayLL8vRpqMnwYA21X+eCJ6e86U/xSppQK7qhR4Nu4=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057ecfd0>, 'refresh_token': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDca15ivKbmTHjXu3Cq53pVA9wg7m5i0mx4T+KsEfjxOyY=', 'token_expires_at': 1439284765, 'code': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcuJVqGpiH9/B9oGuJqWRT1ObE7ob5mAe4mg7e6gud6u8=', 'authzreq': '{"state": "urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "acr_values": "PASSWORD", "response_type": "code", "upm_answer": "true", "client_id": "10rOPDtg8rQP", "scope": "openid profile email address phone"}', 'token_type': 'Bearer', 'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'sub': '-597c3e2895000438', 'access_token_scope': '?', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code_used': True, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5Mjg0NzU5LCAic3ViIjogIi01OTdjM2UyODk1MDAwNDM4IiwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyIxMHJPUER0ZzhyUVAiXSwgImlhdCI6IDE0MzkyODQ3NjUsICJleHAiOiAxNDM5MzYzOTY1fQ.b2UpXxzvXAbKe-OH6cTQNnVsfmJ3aZnElcU2YtUzB75m47sqqlWDor9wmWJgFCJjhaIfrPZrWDZPMzvn2_1XKhigMXlsBGvmNbsbuezSrFou84VRy8XadcAGcEsvM6JfPJbx-GT3H9rEOAeVccxO2gieZXUB0iDE_9SNA-Y6o2IlFXn9kZwnlv36JpDgK_h-ESL9u2xSmOXMvjsDj1mEkIQpuAofkKDxhlIBLkeOYVelLUlbMtV406Mgn0b5mMRHza7atfeRPdpZ3cRy3p1XUpouQcdFx8wXv1hFvaBBx-2WzUtsDujoT1IiLbyr_Gill2ssw1A2f3NeZctqJUsRPA', 'oauth_state': 'token', 'client_id': '10rOPDtg8rQP', 'scope': ['openid', 'profile', 'email', 'address', 'phone']}
2015-08-11 11:19:25,159 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'access_token': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcHoayLL8vRpqMnwYA21X+eCJ6e86U/xSppQK7qhR4Nu4=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5Mjg0NzU5LCAic3ViIjogIi01OTdjM2UyODk1MDAwNDM4IiwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyIxMHJPUER0ZzhyUVAiXSwgImlhdCI6IDE0MzkyODQ3NjUsICJleHAiOiAxNDM5MzYzOTY1fQ.b2UpXxzvXAbKe-OH6cTQNnVsfmJ3aZnElcU2YtUzB75m47sqqlWDor9wmWJgFCJjhaIfrPZrWDZPMzvn2_1XKhigMXlsBGvmNbsbuezSrFou84VRy8XadcAGcEsvM6JfPJbx-GT3H9rEOAeVccxO2gieZXUB0iDE_9SNA-Y6o2IlFXn9kZwnlv36JpDgK_h-ESL9u2xSmOXMvjsDj1mEkIQpuAofkKDxhlIBLkeOYVelLUlbMtV406Mgn0b5mMRHza7atfeRPdpZ3cRy3p1XUpouQcdFx8wXv1hFvaBBx-2WzUtsDujoT1IiLbyr_Gill2ssw1A2f3NeZctqJUsRPA', 'token_type': 'Bearer', 'refresh_token': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDca15ivKbmTHjXu3Cq53pVA9wg7m5i0mx4T+KsEfjxOyY=', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:25,190 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10563a518>
2015-08-11 11:19:25,772 oic.oic:DEBUG verify keys: None
2015-08-11 11:19:25,773 oic.oic.provider:DEBUG user_info_request: {'access_token': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcHoayLL8vRpqMnwYA21X+eCJ6e86U/xSppQK7qhR4Nu4='}
2015-08-11 11:19:25,774 oicServer:DEBUG access_token type: 'T'
2015-08-11 11:19:25,775 oic.oic:DEBUG authzreq: {'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'client_id': '10rOPDtg8rQP', 'scope': 'openid profile email address phone'}
2015-08-11 11:19:25,775 oic.oic.provider:DEBUG userinfo_claim: {'middle_name': None, 'locale': None, 'email': None, 'gender': None, 'phone_number_verified': None, 'profile': None, 'updated_at': None, 'family_name': None, 'picture': None, 'given_name': None, 'name': None, 'sub': None, 'phone_number': None, 'preferred_username': None, 'address': None, 'nickname': None, 'birthdate': None, 'email_verified': None, 'website': None, 'zoneinfo': None}
2015-08-11 11:19:25,776 oic.oic.provider:DEBUG Session info: {'expires_in': 3600, 'permission': '', 'revoked': False, 'access_token': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcHoayLL8vRpqMnwYA21X+eCJ6e86U/xSppQK7qhR4Nu4=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057ecfd0>, 'refresh_token': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDca15ivKbmTHjXu3Cq53pVA9wg7m5i0mx4T+KsEfjxOyY=', 'token_expires_at': 1439284765, 'code': 'sf8tvZt1BaHSOBq+3bwrvThEeBO/Zlx37vNJpMs7I2ZeCWgl1eE/0SPCp0aPCXDcuJVqGpiH9/B9oGuJqWRT1ObE7ob5mAe4mg7e6gud6u8=', 'authzreq': '{"state": "urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "acr_values": "PASSWORD", "response_type": "code", "upm_answer": "true", "client_id": "10rOPDtg8rQP", "scope": "openid profile email address phone"}', 'token_type': 'Bearer', 'state': 'urn:uuid:09fe0d25-6034-49eb-b55f-bcb532a6b5b6', 'sub': '-597c3e2895000438', 'access_token_scope': '?', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code_used': True, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5Mjg0NzU5LCAic3ViIjogIi01OTdjM2UyODk1MDAwNDM4IiwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyIxMHJPUER0ZzhyUVAiXSwgImlhdCI6IDE0MzkyODQ3NjUsICJleHAiOiAxNDM5MzYzOTY1fQ.b2UpXxzvXAbKe-OH6cTQNnVsfmJ3aZnElcU2YtUzB75m47sqqlWDor9wmWJgFCJjhaIfrPZrWDZPMzvn2_1XKhigMXlsBGvmNbsbuezSrFou84VRy8XadcAGcEsvM6JfPJbx-GT3H9rEOAeVccxO2gieZXUB0iDE_9SNA-Y6o2IlFXn9kZwnlv36JpDgK_h-ESL9u2xSmOXMvjsDj1mEkIQpuAofkKDxhlIBLkeOYVelLUlbMtV406Mgn0b5mMRHza7atfeRPdpZ3cRy3p1XUpouQcdFx8wXv1hFvaBBx-2WzUtsDujoT1IiLbyr_Gill2ssw1A2f3NeZctqJUsRPA', 'oauth_state': 'token', 'client_id': '10rOPDtg8rQP', 'scope': ['openid', 'profile', 'email', 'address', 'phone']}
2015-08-11 11:19:25,776 oic.oic.provider:DEBUG user_info_response: {'email': 'diana@example.org', 'given_name': 'Diana', 'sub': '-597c3e2895000438', 'phone_number': '+46 90 7865000', 'name': 'Diana Krall', 'address': {'locality': 'Ume', 'street_address': 'Ume Universitet', 'country': 'Sweden', 'postal_code': 'SE-90187'}, 'nickname': 'Dina', 'email_verified': False, 'family_name': 'Krall'}
2015-08-11 11:20:26,162 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-11 11:20:26,162 root:INFO OC3 server keys: {"keys": [{"y": "sPTyOXLYgGz1MEZbQY0-yAm0QtKgmD0EUxOsjaEpZLk", "use": "sig", "x": "mrkb7yM1zsbhGp60_sQDh0H_w9MXVHj5R43OgKEW4DM", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-11 11:20:26,163 root:INFO OC3 server keys: {"keys": [{"y": "Wn6e4n6k5JLrzaN_OII6TczfGgkPBrVSQBfrTqjxHU8", "use": "enc", "x": "qEoQ9muZee38vDS2dkZgOe_DGz-5rLcXAZi1gw0qhPw", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-11 11:20:26,163 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:20:34,560 oicServer:INFO callback: <function webfinger at 0x10447ad90>
2015-08-11 11:20:34,568 oicServer:INFO callback: <function op_info at 0x10447a9d8>
2015-08-11 11:20:34,568 root:INFO op_info
2015-08-11 11:20:34,569 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:20:34,569 oic.oic.provider:INFO provider_info_response: {'claims_supported': ['phone_number', 'zoneinfo', 'given_name', 'updated_at', 'email_verified', 'address', 'family_name', 'profile', 'picture', 'name', 'middle_name', 'website', 'nickname', 'preferred_username', 'sub', 'locale', 'phone_number_verified', 'email', 'gender', 'birthdate'], 'id_token_signing_alg_values_supported': ['PS384', 'HS512', 'ES512', 'none', 'HS256', 'PS521', 'RS384', 'RS256', 'PS256', 'RS512', 'HS384', 'ES256', 'ES384'], 'claims_parameter_supported': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'token_endpoint': 'https://localhost:8092/token', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_signing_alg_values_supported': ['PS384', 'HS512', 'ES512', 'HS256', 'PS521', 'RS384', 'RS256', 'PS256', 'RS512', 'HS384', 'ES256', 'ES384'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'issuer': 'https://localhost:8092/', 'version': '3.0', 'scopes_supported': ['offline_access', 'email', 'address', 'profile', 'openid', 'phone', 'openid'], 'request_object_signing_alg_values_supported': ['PS384', 'HS512', 'ES512', 'none', 'HS256', 'PS521', 'RS384', 'RS256', 'PS256', 'RS512', 'HS384', 'ES256', 'ES384'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_signing_alg_values_supported': ['PS384', 'HS512', 'ES512', 'none', 'HS256', 'PS521', 'RS384', 'RS256', 'PS256', 'RS512', 'HS384', 'ES256', 'ES384'], 'request_uri_parameter_supported': True, 'end_session_endpoint': 'https://localhost:8092/end_session', 'acr_values_supported': ['PASSWORD']}
2015-08-11 11:20:34,602 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10446ce48>
2015-08-11 11:20:34,602 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/"], "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"]}>>
2015-08-11 11:20:34,602 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:20:34,607 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439281234, 'client_id': 'BLGLFKW73Hnf', 'client_secret_expires_at': 1439367634, 'registration_client_uri': 'https://localhost:8092/registration?client_id=BLGLFKW73Hnf', 'client_secret': '8bdec6e4784cf8e887258023b8d1bb90bb5fb7defcf48307c1679882', 'registration_access_token': 'lKPL3FSuvGgAqn7lQs3GSItanrcXAkid'}
2015-08-11 11:20:34,609 oic.utils.keyio:DEBUG loading keys for issuer: BLGLFKW73Hnf
2015-08-11 11:20:34,609 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:20:34,609 oic.oic.provider:DEBUG keys for BLGLFKW73Hnf: []
2015-08-11 11:20:34,612 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'client_id_issued_at': 1439281234, 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'client_id': 'BLGLFKW73Hnf', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'client_secret_expires_at': 1439367634, 'registration_client_uri': 'https://localhost:8092/registration?client_id=BLGLFKW73Hnf', 'application_type': 'web', 'client_secret': '8bdec6e4784cf8e887258023b8d1bb90bb5fb7defcf48307c1679882', 'registration_access_token': 'lKPL3FSuvGgAqn7lQs3GSItanrcXAkid'}
2015-08-11 11:20:34,612 oic.oic.provider:DEBUG registration_response: {'contacts': ['ops@example.com'], 'client_id_issued_at': 1439281234, 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'client_secret_expires_at': 1439367634, 'registration_client_uri': 'https://localhost:8092/registration?client_id=BLGLFKW73Hnf', 'application_type': 'web', 'client_secret': '8bdec6e4784cf8e887258023b8d1bb90bb5fb7defcf48307c1679882', 'registration_access_token': 'lKPL3FSuvGgAqn7lQs3GSItanrcXAkid', 'client_id': 'BLGLFKW73Hnf'}
2015-08-11 11:20:34,627 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1043e58d0>
2015-08-11 11:20:34,627 oic.oauth2.provider:DEBUG Request: 'state=urn%3Auuid%3Ae453ef84-8eda-45a3-8941-0071d170e8f1&acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=BLGLFKW73Hnf&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'
2015-08-11 11:20:34,627 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1079aa4e0>, <jwkest.jwk.RSAKey object at 0x104692908>, <jwkest.jwk.ECKey object at 0x104692c18>]
2015-08-11 11:20:34,627 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'client_id': 'BLGLFKW73Hnf', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1'}
2015-08-11 11:20:34,629 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'client_id': 'BLGLFKW73Hnf', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1'}
2015-08-11 11:20:34,630 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104677f98>, 'PASSWORD')]
2015-08-11 11:20:34,630 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:20:34,631 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:20:34,631 oic.utils.authn.user:INFO do_authentication argv: {'tos_uri': '', 'acr': ['PASSWORD'], 'title': 'User log in', 'passwd_title': 'Password', 'password': '', 'query': 'state=urn%3Auuid%3Ae453ef84-8eda-45a3-8941-0071d170e8f1&acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=BLGLFKW73Hnf&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7', 'logo_uri': '', 'client_policy_title': 'Client Policy', 'submit_text': 'Submit', 'login_title': 'Username', 'login': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify'}
2015-08-11 11:20:34,639 oicServer:INFO callback: <function css at 0x1043ed1e0>
2015-08-11 11:20:39,150 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10461aea0>
2015-08-11 11:20:39,150 oic.utils.authn.user:DEBUG verify(query=state%3Durn%253Auuid%253Ae453ef84-8eda-45a3-8941-0071d170e8f1%26acr_values%3DPASSWORD%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DBLGLFKW73Hnf%26response_type%3Dcode%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:20:39,150 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['PASSWORD']"], 'login': ['diana'], 'form.commit': ['Submit'], 'password': ['krall'], 'query': ['state=urn%3Auuid%3Ae453ef84-8eda-45a3-8941-0071d170e8f1&acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=BLGLFKW73Hnf&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:20:39,150 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-11 11:20:39,151 oic.utils.authn.user:DEBUG kwargs: {'scope': ['openid profile email address phone'], 'client_id': ['BLGLFKW73Hnf'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'acr_values': ['PASSWORD'], 'response_type': ['code'], 'upm_answer': 'true', 'state': ['urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1']}
2015-08-11 11:20:39,175 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1043e58d0>
2015-08-11 11:20:39,175 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&client_id=BLGLFKW73Hnf&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&response_type=code&upm_answer=true&state=urn%3Auuid%3Ae453ef84-8eda-45a3-8941-0071d170e8f1'
2015-08-11 11:20:39,176 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1079aa4e0>, <jwkest.jwk.RSAKey object at 0x104692908>, <jwkest.jwk.ECKey object at 0x104692c18>]
2015-08-11 11:20:39,176 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'client_id': 'BLGLFKW73Hnf', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1'}
2015-08-11 11:20:39,177 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'client_id': 'BLGLFKW73Hnf', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1'}
2015-08-11 11:20:39,179 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104677f98>, 'PASSWORD')]
2015-08-11 11:20:39,179 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:20:39,179 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:20:39,179 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:20:39,180 oic.oic.provider:DEBUG AREQ keys: ['scope', 'client_id', 'redirect_uri', 'acr_values', 'response_type', 'upm_answer', 'state']
2015-08-11 11:20:39,180 oic.utils.sdb:DEBUG uid2sid: {'diana': ['9bc445ac9288ed4d64c6978e0937d55682e78cbc77f21d9e0d40a9a9']}
2015-08-11 11:20:39,180 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:20:39,180 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:20:39,182 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?scope=openid+profile+email+address+phone&state=urn%3Auuid%3Ae453ef84-8eda-45a3-8941-0071d170e8f1&code=AmP0l1Ucx%2B1ftNLgi9jQ48D%2B0U7IbeUCzJgnprdcl4%2BaV3QrcewA4876t0vUJqiy470Lf%2FV02NDpyuD7%2F3%2FX86fX4BNUIukA09sP05Qc5mE%3D' (<class 'str'>)
2015-08-11 11:20:39,190 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:20:39,203 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10446cda0>
2015-08-11 11:20:39,203 oic.oic.provider:DEBUG - token -
2015-08-11 11:20:39,203 oic.oic.provider:INFO token_request: grant_type=authorization_code&code=AmP0l1Ucx%2B1ftNLgi9jQ48D%2B0U7IbeUCzJgnprdcl4%2BaV3QrcewA4876t0vUJqiy470Lf%2FV02NDpyuD7%2F3%2FX86fX4BNUIukA09sP05Qc5mE%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 11:20:39,203 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiy470Lf/V02NDpyuD7/3/X86fX4BNUIukA09sP05Qc5mE=', 'grant_type': 'authorization_code'}
2015-08-11 11:20:39,204 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiy470Lf/V02NDpyuD7/3/X86fX4BNUIukA09sP05Qc5mE=', 'grant_type': 'authorization_code'}
2015-08-11 11:20:39,204 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:20:39,208 oic.oic.provider:DEBUG All checks OK
2015-08-11 11:20:39,209 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'BLGLFKW73Hnf', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1'}
2015-08-11 11:20:39,209 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 11:20:39,209 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'BLGLFKW73Hnf', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1'}
2015-08-11 11:20:39,209 oic.oic.provider:DEBUG id_token: {'iat': 1439284839, 'exp': 1439364039, 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/', 'auth_time': 1439284839, 'aud': ['BLGLFKW73Hnf'], 'sub': '-6a4ba805a1176172'}
2015-08-11 11:20:39,210 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-11 11:20:39,211 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "sPTyOXLYgGz1MEZbQY0-yAm0QtKgmD0EUxOsjaEpZLk", "use": "sig", "x": "mrkb7yM1zsbhGp60_sQDh0H_w9MXVHj5R43OgKEW4DM", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-11 11:20:39,211 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "Wn6e4n6k5JLrzaN_OII6TczfGgkPBrVSQBfrTqjxHU8", "use": "enc", "x": "qEoQ9muZee38vDS2dkZgOe_DGz-5rLcXAZi1gw0qhPw", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-11 11:20:39,211 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104692908>]
2015-08-11 11:20:39,218 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 11:20:39,218 oic.oic.provider:DEBUG _tinfo: {'permission': '', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5Mjg0ODM5LCAiZXhwIjogMTQzOTM2NDAzOSwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXV0aF90aW1lIjogMTQzOTI4NDgzOSwgImF1ZCI6IFsiQkxHTEZLVzczSG5mIl0sICJzdWIiOiAiLTZhNGJhODA1YTExNzYxNzIifQ.UDd67KrX06WXk0y3c9dhXfXmUdO1YeLevic9rU71ecftvPgCtwHqOMU4L9VHfayRIxfMdWQkaoWuoSML_QNDD-yo9KwZOvdB2xorwx13vPmQigwTYlLi8EPfPDnSqdqpLTivH2pCljQaXtAT34WLDse0-CaCsFGQIxDR7BmRP8Nn5WBRG9_1-THvk09Dg9Ndy6QRgE9H1Sbke8DZkw0davmV6OR5eJOzMIvupT9yAFKxMTfyYCuPgg-QId-iyAr016-dFv_tVFTHROeOYyK_UtEFVU_g7UAZzEwKI2LBM1GboyZG5PlRqUX7yHN2beLknaE_l-kAY9pDk8xmZuTD6w', 'client_id': 'BLGLFKW73Hnf', 'access_token_scope': '?', 'expires_in': 3600, 'oauth_state': 'token', 'refresh_token': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiyN66IFbhK1uEPL+404Z3jRzPcbUltbtXScAuOGqdc/M8=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd208>, 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1', 'token_type': 'Bearer', 'sub': '-6a4ba805a1176172', 'access_token': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiyT04xSv6M4o4cQjSm4gx6CtpErNVw8MOr8VaAZQEY2zc=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiy470Lf/V02NDpyuD7/3/X86fX4BNUIukA09sP05Qc5mE=', 'revoked': False, 'code_used': True, 'authzreq': '{"scope": "openid profile email address phone", "client_id": "BLGLFKW73Hnf", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "acr_values": "PASSWORD", "response_type": "code", "upm_answer": "true", "state": "urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1"}', 'token_expires_at': 1439284839}
2015-08-11 11:20:39,218 oic.oic.provider:DEBUG access_token_response: {'access_token': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiyT04xSv6M4o4cQjSm4gx6CtpErNVw8MOr8VaAZQEY2zc=', 'expires_in': 3600, 'refresh_token': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiyN66IFbhK1uEPL+404Z3jRzPcbUltbtXScAuOGqdc/M8=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5Mjg0ODM5LCAiZXhwIjogMTQzOTM2NDAzOSwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXV0aF90aW1lIjogMTQzOTI4NDgzOSwgImF1ZCI6IFsiQkxHTEZLVzczSG5mIl0sICJzdWIiOiAiLTZhNGJhODA1YTExNzYxNzIifQ.UDd67KrX06WXk0y3c9dhXfXmUdO1YeLevic9rU71ecftvPgCtwHqOMU4L9VHfayRIxfMdWQkaoWuoSML_QNDD-yo9KwZOvdB2xorwx13vPmQigwTYlLi8EPfPDnSqdqpLTivH2pCljQaXtAT34WLDse0-CaCsFGQIxDR7BmRP8Nn5WBRG9_1-THvk09Dg9Ndy6QRgE9H1Sbke8DZkw0davmV6OR5eJOzMIvupT9yAFKxMTfyYCuPgg-QId-iyAr016-dFv_tVFTHROeOYyK_UtEFVU_g7UAZzEwKI2LBM1GboyZG5PlRqUX7yHN2beLknaE_l-kAY9pDk8xmZuTD6w', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1', 'token_type': 'Bearer', 'scope': 'openid profile email address phone'}
2015-08-11 11:20:39,228 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10446ce10>
2015-08-11 11:20:39,228 oic.oic:DEBUG verify keys: None
2015-08-11 11:20:39,228 oic.oic.provider:DEBUG user_info_request: {'access_token': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiyT04xSv6M4o4cQjSm4gx6CtpErNVw8MOr8VaAZQEY2zc='}
2015-08-11 11:20:39,228 oicServer:DEBUG access_token type: 'T'
2015-08-11 11:20:39,229 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'BLGLFKW73Hnf', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'response_type': 'code', 'upm_answer': 'true', 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1'}
2015-08-11 11:20:39,229 oic.oic.provider:DEBUG userinfo_claim: {'address': None, 'phone_number': None, 'zoneinfo': None, 'gender': None, 'given_name': None, 'updated_at': None, 'picture': None, 'profile': None, 'family_name': None, 'sub': None, 'name': None, 'middle_name': None, 'nickname': None, 'phone_number_verified': None, 'locale': None, 'email': None, 'website': None, 'birthdate': None, 'email_verified': None, 'preferred_username': None}
2015-08-11 11:20:39,229 oic.oic.provider:DEBUG Session info: {'permission': '', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5Mjg0ODM5LCAiZXhwIjogMTQzOTM2NDAzOSwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXV0aF90aW1lIjogMTQzOTI4NDgzOSwgImF1ZCI6IFsiQkxHTEZLVzczSG5mIl0sICJzdWIiOiAiLTZhNGJhODA1YTExNzYxNzIifQ.UDd67KrX06WXk0y3c9dhXfXmUdO1YeLevic9rU71ecftvPgCtwHqOMU4L9VHfayRIxfMdWQkaoWuoSML_QNDD-yo9KwZOvdB2xorwx13vPmQigwTYlLi8EPfPDnSqdqpLTivH2pCljQaXtAT34WLDse0-CaCsFGQIxDR7BmRP8Nn5WBRG9_1-THvk09Dg9Ndy6QRgE9H1Sbke8DZkw0davmV6OR5eJOzMIvupT9yAFKxMTfyYCuPgg-QId-iyAr016-dFv_tVFTHROeOYyK_UtEFVU_g7UAZzEwKI2LBM1GboyZG5PlRqUX7yHN2beLknaE_l-kAY9pDk8xmZuTD6w', 'client_id': 'BLGLFKW73Hnf', 'access_token_scope': '?', 'expires_in': 3600, 'oauth_state': 'token', 'refresh_token': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiyN66IFbhK1uEPL+404Z3jRzPcbUltbtXScAuOGqdc/M8=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd208>, 'state': 'urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1', 'token_type': 'Bearer', 'sub': '-6a4ba805a1176172', 'access_token': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiyT04xSv6M4o4cQjSm4gx6CtpErNVw8MOr8VaAZQEY2zc=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code': 'AmP0l1Ucx+1ftNLgi9jQ48D+0U7IbeUCzJgnprdcl4+aV3QrcewA4876t0vUJqiy470Lf/V02NDpyuD7/3/X86fX4BNUIukA09sP05Qc5mE=', 'revoked': False, 'code_used': True, 'authzreq': '{"scope": "openid profile email address phone", "client_id": "BLGLFKW73Hnf", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "acr_values": "PASSWORD", "response_type": "code", "upm_answer": "true", "state": "urn:uuid:e453ef84-8eda-45a3-8941-0071d170e8f1"}', 'token_expires_at': 1439284839}
2015-08-11 11:20:39,229 oic.oic.provider:DEBUG user_info_response: {'name': 'Diana Krall', 'phone_number': '+46 90 7865000', 'nickname': 'Dina', 'address': {'country': 'Sweden', 'postal_code': 'SE-90187', 'street_address': 'Ume Universitet', 'locality': 'Ume'}, 'email': 'diana@example.org', 'given_name': 'Diana', 'email_verified': False, 'family_name': 'Krall', 'sub': '-6a4ba805a1176172'}
2015-08-11 11:21:08,189 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-11 11:21:08,189 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "use": "sig", "y": "2g3K57Wb2Vz4jSXUtFtS7DhlGcgHjxxdNJDE9-8rr68", "x": "gPcvJ9qXKHODBDgn1_LeMI-XpLzLDpSKUS3EjTzUVUQ", "crv": "P-256", "kty": "EC"}]}
2015-08-11 11:21:08,189 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "use": "enc", "y": "o6lUJPmlDZKTA_VS66SFDpVqooP8WW-4R2FE6fLm7AA", "x": "iUois8t7bjQa-qpa6o9MCJ527tOQYyO6SVxtXDrIPkQ", "crv": "P-256", "kty": "EC"}]}
2015-08-11 11:21:08,189 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:21:19,311 oicServer:INFO callback: <function webfinger at 0x10443ad90>
2015-08-11 11:21:19,322 oicServer:INFO callback: <function op_info at 0x10443a9d8>
2015-08-11 11:21:19,322 root:INFO op_info
2015-08-11 11:21:19,322 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:21:19,322 oic.oic.provider:INFO provider_info_response: {'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'claims_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'registration_endpoint': 'https://localhost:8092/registration', 'request_uri_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'claims_supported': ['phone_number', 'picture', 'gender', 'address', 'given_name', 'preferred_username', 'middle_name', 'phone_number_verified', 'name', 'nickname', 'email_verified', 'zoneinfo', 'family_name', 'updated_at', 'locale', 'sub', 'email', 'profile', 'birthdate', 'website'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_parameter_supported': True, 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_signing_alg_values_supported': ['ES384', 'RS512', 'ES256', 'RS256', 'HS512', 'PS521', 'RS384', 'HS256', 'PS384', 'HS384', 'ES512', 'none', 'PS256'], 'scopes_supported': ['openid', 'offline_access', 'phone', 'address', 'email', 'profile', 'openid'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['ES384', 'RS512', 'ES256', 'RS256', 'HS512', 'PS521', 'RS384', 'HS256', 'PS384', 'HS384', 'ES512', 'none', 'PS256'], 'token_endpoint_auth_signing_alg_values_supported': ['ES384', 'RS512', 'ES256', 'RS256', 'HS512', 'PS521', 'RS384', 'HS256', 'PS384', 'HS384', 'ES512', 'PS256'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_signing_alg_values_supported': ['ES384', 'RS512', 'ES256', 'RS256', 'HS512', 'PS521', 'RS384', 'HS256', 'PS384', 'HS384', 'ES512', 'none', 'PS256'], 'acr_values_supported': ['PASSWORD'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'token_endpoint': 'https://localhost:8092/token', 'require_request_uri_registration': True, 'end_session_endpoint': 'https://localhost:8092/end_session', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'issuer': 'https://localhost:8092/'}
2015-08-11 11:21:19,355 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10442ce48>
2015-08-11 11:21:19,355 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "post_logout_redirect_uris": ["https://localhost:8666/"], "contacts": ["ops@example.com"]}>>
2015-08-11 11:21:19,355 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:21:19,360 oic.oic.provider:DEBUG _cinfo: {'client_secret_expires_at': 1439367679, 'client_id': '5JKA18QauHsO', 'client_id_issued_at': 1439281279, 'registration_access_token': 'pbmwKHFf14SsXXjzT5W3qo0MaNzRaZjq', 'client_secret': 'cbec732a2c86c7cc742a466fcb90825c2449d4756efdda28f2a8f24f', 'registration_client_uri': 'https://localhost:8092/registration?client_id=5JKA18QauHsO'}
2015-08-11 11:21:19,360 oic.utils.keyio:DEBUG loading keys for issuer: 5JKA18QauHsO
2015-08-11 11:21:19,361 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:21:19,361 oic.oic.provider:DEBUG keys for 5JKA18QauHsO: []
2015-08-11 11:21:19,363 oic.oic.provider:INFO Client info: {'client_secret_expires_at': 1439367679, 'client_id': '5JKA18QauHsO', 'application_type': 'web', 'client_id_issued_at': 1439281279, 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'registration_access_token': 'pbmwKHFf14SsXXjzT5W3qo0MaNzRaZjq', 'client_secret': 'cbec732a2c86c7cc742a466fcb90825c2449d4756efdda28f2a8f24f', 'contacts': ['ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=5JKA18QauHsO', 'post_logout_redirect_uris': [('https://localhost:8666/', None)]}
2015-08-11 11:21:19,363 oic.oic.provider:DEBUG registration_response: {'client_secret_expires_at': 1439367679, 'client_id': '5JKA18QauHsO', 'application_type': 'web', 'client_id_issued_at': 1439281279, 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'registration_access_token': 'pbmwKHFf14SsXXjzT5W3qo0MaNzRaZjq', 'client_secret': 'cbec732a2c86c7cc742a466fcb90825c2449d4756efdda28f2a8f24f', 'contacts': ['ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=5JKA18QauHsO', 'post_logout_redirect_uris': ['https://localhost:8666/']}
2015-08-11 11:21:19,375 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1043a58d0>
2015-08-11 11:21:19,375 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&client_id=5JKA18QauHsO&state=urn%3Auuid%3Ad75cdad7-bddc-4d1a-b4ad-b6233e921fd8&scope=openid+profile+email+address+phone&response_type=code'
2015-08-11 11:21:19,375 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10796a4e0>, <jwkest.jwk.RSAKey object at 0x104652908>, <jwkest.jwk.ECKey object at 0x104652c88>]
2015-08-11 11:21:19,375 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': '5JKA18QauHsO', 'acr_values': 'PASSWORD', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:21:19,377 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': '5JKA18QauHsO', 'acr_values': 'PASSWORD', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:21:19,379 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104637e48>, 'PASSWORD')]
2015-08-11 11:21:19,379 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:21:19,380 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:21:19,380 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'acr': ['PASSWORD'], 'password': '', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'logo_uri': '', 'login': '', 'tos_uri': '', 'policy_uri': '', 'login_title': 'Username', 'query': 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&client_id=5JKA18QauHsO&state=urn%3Auuid%3Ad75cdad7-bddc-4d1a-b4ad-b6233e921fd8&scope=openid+profile+email+address+phone&response_type=code', 'action': 'https://localhost:8092/verify'}
2015-08-11 11:21:19,401 oicServer:INFO callback: <function css at 0x1043ad1e0>
2015-08-11 11:21:23,392 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x1045daea0>
2015-08-11 11:21:23,392 oic.utils.authn.user:DEBUG verify(query=redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26acr_values%3DPASSWORD%26client_id%3D5JKA18QauHsO%26state%3Durn%253Auuid%253Ad75cdad7-bddc-4d1a-b4ad-b6233e921fd8%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:21:23,392 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'login': ['diana'], 'query': ['redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&acr_values=PASSWORD&client_id=5JKA18QauHsO&state=urn%3Auuid%3Ad75cdad7-bddc-4d1a-b4ad-b6233e921fd8&scope=openid+profile+email+address+phone&response_type=code'], 'password': ['krall'], 'acr_values': ["['PASSWORD']"]}
2015-08-11 11:21:23,392 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-11 11:21:23,393 oic.utils.authn.user:DEBUG kwargs: {'client_id': ['5JKA18QauHsO'], 'acr_values': ['PASSWORD'], 'scope': ['openid profile email address phone'], 'state': ['urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8'], 'response_type': ['code'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'upm_answer': 'true'}
2015-08-11 11:21:23,439 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1043a58d0>
2015-08-11 11:21:23,439 oic.oauth2.provider:DEBUG Request: 'client_id=5JKA18QauHsO&acr_values=PASSWORD&scope=openid+profile+email+address+phone&state=urn%3Auuid%3Ad75cdad7-bddc-4d1a-b4ad-b6233e921fd8&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&upm_answer=true'
2015-08-11 11:21:23,439 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10796a4e0>, <jwkest.jwk.RSAKey object at 0x104652908>, <jwkest.jwk.ECKey object at 0x104652c88>]
2015-08-11 11:21:23,439 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': '5JKA18QauHsO', 'acr_values': 'PASSWORD', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true'}
2015-08-11 11:21:23,440 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': '5JKA18QauHsO', 'acr_values': 'PASSWORD', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true'}
2015-08-11 11:21:23,442 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104637e48>, 'PASSWORD')]
2015-08-11 11:21:23,442 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:21:23,442 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:21:23,442 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:21:23,442 oic.oic.provider:DEBUG AREQ keys: ['client_id', 'acr_values', 'scope', 'state', 'response_type', 'redirect_uri', 'upm_answer']
2015-08-11 11:21:23,442 oic.utils.sdb:DEBUG uid2sid: {'diana': ['3a308940147b14a082ff83626dc8af70fbe287acb4b1c3820ca39a83']}
2015-08-11 11:21:23,443 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:21:23,443 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:21:23,444 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?state=urn%3Auuid%3Ad75cdad7-bddc-4d1a-b4ad-b6233e921fd8&code=zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub%2F9O675aS%2B9AZoaX%2B7ug2e29fOvuTV6czNGqjwLQWn8n4Az6%2Bc%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:21:23,454 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:21:23,467 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10442cda0>
2015-08-11 11:21:23,468 oic.oic.provider:DEBUG - token -
2015-08-11 11:21:23,468 oic.oic.provider:INFO token_request: grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&code=zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub%2F9O675aS%2B9AZoaX%2B7ug2e29fOvuTV6czNGqjwLQWn8n4Az6%2Bc%3D
2015-08-11 11:21:23,468 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675aS+9AZoaX+7ug2e29fOvuTV6czNGqjwLQWn8n4Az6+c=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code'}
2015-08-11 11:21:23,468 oic.utils.authn.client:DEBUG REQ: {'code': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675aS+9AZoaX+7ug2e29fOvuTV6czNGqjwLQWn8n4Az6+c=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'grant_type': 'authorization_code'}
2015-08-11 11:21:23,468 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:21:23,474 oic.oic.provider:DEBUG All checks OK
2015-08-11 11:21:23,474 oic.oic:DEBUG authzreq: {'client_id': '5JKA18QauHsO', 'acr_values': 'PASSWORD', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true'}
2015-08-11 11:21:23,474 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 11:21:23,475 oic.oic:DEBUG authzreq: {'client_id': '5JKA18QauHsO', 'acr_values': 'PASSWORD', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true'}
2015-08-11 11:21:23,475 oic.oic.provider:DEBUG id_token: {'iat': 1439284883, 'auth_time': 1439284883, 'acr': 'PASSWORD', 'exp': 1439364083, 'iss': 'https://localhost:8092/', 'sub': '-3475c76a8947935a', 'aud': ['5JKA18QauHsO']}
2015-08-11 11:21:23,476 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-11 11:21:23,476 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op2", "use": "sig", "y": "2g3K57Wb2Vz4jSXUtFtS7DhlGcgHjxxdNJDE9-8rr68", "x": "gPcvJ9qXKHODBDgn1_LeMI-XpLzLDpSKUS3EjTzUVUQ", "crv": "P-256", "kty": "EC"}]}
2015-08-11 11:21:23,476 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op3", "use": "enc", "y": "o6lUJPmlDZKTA_VS66SFDpVqooP8WW-4R2FE6fLm7AA", "x": "iUois8t7bjQa-qpa6o9MCJ527tOQYyO6SVxtXDrIPkQ", "crv": "P-256", "kty": "EC"}]}
2015-08-11 11:21:23,476 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104652908>]
2015-08-11 11:21:23,483 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 11:21:23,483 oic.oic.provider:DEBUG _tinfo: {'permission': '', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675SgN3foQLam2w0qj7O0FPD+OLZVQVnfQKPAUN721bzHU=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5Mjg0ODgzLCAiYXV0aF90aW1lIjogMTQzOTI4NDg4MywgImFjciI6ICJQQVNTV09SRCIsICJleHAiOiAxNDM5MzY0MDgzLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICItMzQ3NWM3NmE4OTQ3OTM1YSIsICJhdWQiOiBbIjVKS0ExOFFhdUhzTyJdfQ.RMwSScqoBKbc9yRUdAA7EHNtuklEPF6BdmwJtNF2DpeVHhxn61b4Qke-nwZmSXRY7VTc6HZA_IVPfiIGQ6PHxua92wFsWnnrJ4QOZDZaYGWc3tlbcNiIXJntYhwFPSpDSl8FddHR-xIVdQ5GcRop2vDuRna9duBFaWapn8tRe77IAa2kyjL5rGqh0DfkIKY1OOvWI-KkUpvtp2H7Xmu4nwpWq4EPkI1e70AKTN6NcV72uoCnCtm99vOBT1J_quFAjZNlBVspSALFVil4GKJLtCPHUG85fI2Ot30NPR-USgPROye6Ys8TF2L7J4iajjjmzLRKOYk7ssyGNG3nnxfqTw', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10797d208>, 'access_token_scope': '?', 'token_type': 'Bearer', 'expires_in': 3600, 'refresh_token': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675jX2PBg0G09OiPeENjyAMBI521gIjHK277kqXDpCjK1E=', 'code_used': True, 'client_id': '5JKA18QauHsO', 'code': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675aS+9AZoaX+7ug2e29fOvuTV6czNGqjwLQWn8n4Az6+c=', 'token_expires_at': 1439284883, 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'oauth_state': 'token', 'authzreq': '{"client_id": "5JKA18QauHsO", "acr_values": "PASSWORD", "scope": "openid profile email address phone", "state": "urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8", "response_type": "code", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "upm_answer": "true"}', 'sub': '-3475c76a8947935a', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'revoked': False}
2015-08-11 11:21:23,484 oic.oic.provider:DEBUG access_token_response: {'refresh_token': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675jX2PBg0G09OiPeENjyAMBI521gIjHK277kqXDpCjK1E=', 'token_type': 'Bearer', 'access_token': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675SgN3foQLam2w0qj7O0FPD+OLZVQVnfQKPAUN721bzHU=', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5Mjg0ODgzLCAiYXV0aF90aW1lIjogMTQzOTI4NDg4MywgImFjciI6ICJQQVNTV09SRCIsICJleHAiOiAxNDM5MzY0MDgzLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICItMzQ3NWM3NmE4OTQ3OTM1YSIsICJhdWQiOiBbIjVKS0ExOFFhdUhzTyJdfQ.RMwSScqoBKbc9yRUdAA7EHNtuklEPF6BdmwJtNF2DpeVHhxn61b4Qke-nwZmSXRY7VTc6HZA_IVPfiIGQ6PHxua92wFsWnnrJ4QOZDZaYGWc3tlbcNiIXJntYhwFPSpDSl8FddHR-xIVdQ5GcRop2vDuRna9duBFaWapn8tRe77IAa2kyjL5rGqh0DfkIKY1OOvWI-KkUpvtp2H7Xmu4nwpWq4EPkI1e70AKTN6NcV72uoCnCtm99vOBT1J_quFAjZNlBVspSALFVil4GKJLtCPHUG85fI2Ot30NPR-USgPROye6Ys8TF2L7J4iajjjmzLRKOYk7ssyGNG3nnxfqTw', 'expires_in': 3600}
2015-08-11 11:21:23,495 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10442ce10>
2015-08-11 11:21:23,495 oic.oic:DEBUG verify keys: None
2015-08-11 11:21:23,495 oic.oic.provider:DEBUG user_info_request: {'access_token': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675SgN3foQLam2w0qj7O0FPD+OLZVQVnfQKPAUN721bzHU='}
2015-08-11 11:21:23,495 oicServer:DEBUG access_token type: 'T'
2015-08-11 11:21:23,495 oic.oic:DEBUG authzreq: {'client_id': '5JKA18QauHsO', 'acr_values': 'PASSWORD', 'scope': 'openid profile email address phone', 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'upm_answer': 'true'}
2015-08-11 11:21:23,496 oic.oic.provider:DEBUG userinfo_claim: {'phone_number_verified': None, 'nickname': None, 'website': None, 'picture': None, 'address': None, 'given_name': None, 'middle_name': None, 'name': None, 'email_verified': None, 'zoneinfo': None, 'family_name': None, 'preferred_username': None, 'updated_at': None, 'locale': None, 'gender': None, 'sub': None, 'email': None, 'profile': None, 'birthdate': None, 'phone_number': None}
2015-08-11 11:21:23,496 oic.oic.provider:DEBUG Session info: {'permission': '', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675SgN3foQLam2w0qj7O0FPD+OLZVQVnfQKPAUN721bzHU=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5Mjg0ODgzLCAiYXV0aF90aW1lIjogMTQzOTI4NDg4MywgImFjciI6ICJQQVNTV09SRCIsICJleHAiOiAxNDM5MzY0MDgzLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICItMzQ3NWM3NmE4OTQ3OTM1YSIsICJhdWQiOiBbIjVKS0ExOFFhdUhzTyJdfQ.RMwSScqoBKbc9yRUdAA7EHNtuklEPF6BdmwJtNF2DpeVHhxn61b4Qke-nwZmSXRY7VTc6HZA_IVPfiIGQ6PHxua92wFsWnnrJ4QOZDZaYGWc3tlbcNiIXJntYhwFPSpDSl8FddHR-xIVdQ5GcRop2vDuRna9duBFaWapn8tRe77IAa2kyjL5rGqh0DfkIKY1OOvWI-KkUpvtp2H7Xmu4nwpWq4EPkI1e70AKTN6NcV72uoCnCtm99vOBT1J_quFAjZNlBVspSALFVil4GKJLtCPHUG85fI2Ot30NPR-USgPROye6Ys8TF2L7J4iajjjmzLRKOYk7ssyGNG3nnxfqTw', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10797d208>, 'access_token_scope': '?', 'token_type': 'Bearer', 'expires_in': 3600, 'refresh_token': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675jX2PBg0G09OiPeENjyAMBI521gIjHK277kqXDpCjK1E=', 'code_used': True, 'client_id': '5JKA18QauHsO', 'code': 'zgYnRrRfuOjrjwHxCkai4jsYUP7cqieZJc3vTHyWJ62yAdE1XY5aSOf6ub/9O675aS+9AZoaX+7ug2e29fOvuTV6czNGqjwLQWn8n4Az6+c=', 'token_expires_at': 1439284883, 'state': 'urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8', 'oauth_state': 'token', 'authzreq': '{"client_id": "5JKA18QauHsO", "acr_values": "PASSWORD", "scope": "openid profile email address phone", "state": "urn:uuid:d75cdad7-bddc-4d1a-b4ad-b6233e921fd8", "response_type": "code", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "upm_answer": "true"}', 'sub': '-3475c76a8947935a', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'revoked': False}
2015-08-11 11:21:23,496 oic.oic.provider:DEBUG user_info_response: {'family_name': 'Krall', 'sub': '-3475c76a8947935a', 'phone_number': '+46 90 7865000', 'address': {'postal_code': 'SE-90187', 'street_address': 'Ume Universitet', 'locality': 'Ume', 'country': 'Sweden'}, 'given_name': 'Diana', 'nickname': 'Dina', 'name': 'Diana Krall', 'email': 'diana@example.org', 'email_verified': False}
2015-08-11 11:23:50,842 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kid": "op0", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kid": "op1", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-11 11:23:50,843 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "y": "zAdPp2c19TYkoeSTRRQ4E1U-s13t-fJpNwPJnDLsulQ", "x": "yIpZKKpgw6M3BscUe--R26ASTXJs1yyrfgF8oTH27YM", "use": "sig", "kid": "op2", "kty": "EC"}]}
2015-08-11 11:23:50,843 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "y": "wePcC7rpNhjkZJLoMfwsMYaLddAjVxppdzqF90MF5xg", "x": "VEmT8_XiKnBUj-eg7MIDKETKl46NJ3rcjdwz0PvIoGQ", "use": "enc", "kid": "op3", "kty": "EC"}]}
2015-08-11 11:23:50,843 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:23:58,181 oicServer:INFO callback: <function webfinger at 0x104479d90>
2015-08-11 11:23:58,191 oicServer:INFO callback: <function op_info at 0x1044799d8>
2015-08-11 11:23:58,191 root:INFO op_info
2015-08-11 11:23:58,191 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:23:58,192 oic.oic.provider:INFO provider_info_response: {'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['PS521', 'none', 'HS256', 'PS384', 'PS256', 'HS512', 'ES256', 'RS256', 'RS384', 'HS384', 'ES512', 'RS512', 'ES384'], 'request_object_signing_alg_values_supported': ['PS521', 'none', 'HS256', 'PS384', 'PS256', 'HS512', 'ES256', 'RS256', 'RS384', 'HS384', 'ES512', 'RS512', 'ES384'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['email', 'zoneinfo', 'phone_number', 'family_name', 'birthdate', 'locale', 'website', 'sub', 'gender', 'address', 'profile', 'picture', 'email_verified', 'name', 'middle_name', 'updated_at', 'preferred_username', 'nickname', 'phone_number_verified', 'given_name'], 'request_parameter_supported': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_signing_alg_values_supported': ['PS521', 'none', 'HS256', 'PS384', 'PS256', 'HS512', 'ES256', 'RS256', 'RS384', 'HS384', 'ES512', 'RS512', 'ES384'], 'version': '3.0', 'token_endpoint': 'https://localhost:8092/token', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8092/registration', 'require_request_uri_registration': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'scopes_supported': ['openid', 'phone', 'profile', 'address', 'offline_access', 'email', 'openid'], 'token_endpoint_auth_signing_alg_values_supported': ['PS521', 'HS256', 'PS384', 'PS256', 'HS512', 'ES256', 'RS256', 'RS384', 'HS384', 'ES512', 'RS512', 'ES384'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'authorization_endpoint': 'https://localhost:8092/authorization', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'claims_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True}
2015-08-11 11:23:58,223 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10446be48>
2015-08-11 11:23:58,223 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/"], "application_type": "web", "contacts": ["ops@example.com"], "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"]}>>
2015-08-11 11:23:58,224 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': ['ops@example.com']}
2015-08-11 11:23:58,229 oic.oic.provider:DEBUG _cinfo: {'client_secret': '07b562e214b68011b7070c4ba9c53462c07feb8f08482c68b857ea2d', 'client_id_issued_at': 1439281438, 'registration_access_token': '2UOH69pWMY6dJNCCiV7KbCamZrMsLl7n', 'client_secret_expires_at': 1439367838, 'client_id': 'gpYjo6qtf4en', 'registration_client_uri': 'https://localhost:8092/registration?client_id=gpYjo6qtf4en'}
2015-08-11 11:23:58,230 oic.utils.keyio:DEBUG loading keys for issuer: gpYjo6qtf4en
2015-08-11 11:23:58,230 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': ['ops@example.com']}
2015-08-11 11:23:58,230 oic.oic.provider:DEBUG keys for gpYjo6qtf4en: []
2015-08-11 11:23:58,231 oic.oic.provider:INFO Client info: {'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'application_type': 'web', 'client_secret': '07b562e214b68011b7070c4ba9c53462c07feb8f08482c68b857ea2d', 'client_id_issued_at': 1439281438, 'registration_access_token': '2UOH69pWMY6dJNCCiV7KbCamZrMsLl7n', 'client_secret_expires_at': 1439367838, 'client_id': 'gpYjo6qtf4en', 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=gpYjo6qtf4en', 'contacts': ['ops@example.com']}
2015-08-11 11:23:58,232 oic.oic.provider:DEBUG registration_response: {'post_logout_redirect_uris': ['https://localhost:8666/'], 'application_type': 'web', 'client_secret': '07b562e214b68011b7070c4ba9c53462c07feb8f08482c68b857ea2d', 'client_id_issued_at': 1439281438, 'registration_access_token': '2UOH69pWMY6dJNCCiV7KbCamZrMsLl7n', 'client_secret_expires_at': 1439367838, 'client_id': 'gpYjo6qtf4en', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=gpYjo6qtf4en', 'contacts': ['ops@example.com']}
2015-08-11 11:23:58,245 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042af8d0>
2015-08-11 11:23:58,245 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&acr_values=PASSWORD&response_type=code&client_id=gpYjo6qtf4en&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A6971956b-164c-49a0-840f-2089f8088a87'
2015-08-11 11:23:58,245 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1079a94e0>, <jwkest.jwk.RSAKey object at 0x104691908>, <jwkest.jwk.ECKey object at 0x104691cc0>]
2015-08-11 11:23:58,245 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'client_id': 'gpYjo6qtf4en'}
2015-08-11 11:23:58,247 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'client_id': 'gpYjo6qtf4en'}
2015-08-11 11:23:58,248 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104676e48>, 'PASSWORD')]
2015-08-11 11:23:58,248 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:23:58,249 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:23:58,249 oic.utils.authn.user:INFO do_authentication argv: {'tos_uri': '', 'password': '', 'passwd_title': 'Password', 'query': 'scope=openid+profile+email+address+phone&acr_values=PASSWORD&response_type=code&client_id=gpYjo6qtf4en&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A6971956b-164c-49a0-840f-2089f8088a87', 'title': 'User log in', 'login': '', 'action': 'https://localhost:8092/verify', 'policy_uri': '', 'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'login_title': 'Username', 'logo_uri': '', 'acr': ['PASSWORD']}
2015-08-11 11:23:58,265 oicServer:INFO callback: <function css at 0x1042b71e0>
2015-08-11 11:24:02,951 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x104619ea0>
2015-08-11 11:24:02,951 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DPASSWORD%26response_type%3Dcode%26client_id%3DgpYjo6qtf4en%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26state%3Durn%253Auuid%253A6971956b-164c-49a0-840f-2089f8088a87&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:24:02,951 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['PASSWORD']"], 'form.commit': ['Submit'], 'query': ['scope=openid+profile+email+address+phone&acr_values=PASSWORD&response_type=code&client_id=gpYjo6qtf4en&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&state=urn%3Auuid%3A6971956b-164c-49a0-840f-2089f8088a87'], 'password': ['krall'], 'login': ['diana']}
2015-08-11 11:24:02,951 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-11 11:24:02,952 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'scope': ['openid profile email address phone'], 'acr_values': ['PASSWORD'], 'upm_answer': 'true', 'state': ['urn:uuid:6971956b-164c-49a0-840f-2089f8088a87'], 'client_id': ['gpYjo6qtf4en']}
2015-08-11 11:24:02,976 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042af8d0>
2015-08-11 11:24:02,976 oic.oauth2.provider:DEBUG Request: 'response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&acr_values=PASSWORD&upm_answer=true&state=urn%3Auuid%3A6971956b-164c-49a0-840f-2089f8088a87&client_id=gpYjo6qtf4en'
2015-08-11 11:24:02,976 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1079a94e0>, <jwkest.jwk.RSAKey object at 0x104691908>, <jwkest.jwk.ECKey object at 0x104691cc0>]
2015-08-11 11:24:02,976 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'upm_answer': 'true', 'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'client_id': 'gpYjo6qtf4en'}
2015-08-11 11:24:02,977 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'upm_answer': 'true', 'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'client_id': 'gpYjo6qtf4en'}
2015-08-11 11:24:02,979 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104676e48>, 'PASSWORD')]
2015-08-11 11:24:02,979 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 11:24:02,980 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:24:02,980 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:24:02,980 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'redirect_uri', 'scope', 'acr_values', 'upm_answer', 'state', 'client_id']
2015-08-11 11:24:02,980 oic.utils.sdb:DEBUG uid2sid: {'diana': ['eb3e5d7bf85bdc07613d0e62c70179b2dfa6e7f370c145beb49e1033']}
2015-08-11 11:24:02,980 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:24:02,980 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:24:02,982 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?state=urn%3Auuid%3A6971956b-164c-49a0-840f-2089f8088a87&scope=openid+profile+email+address+phone&code=MzdSNKiQmBtj%2F3D%2FIr3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKiSCtppbPSI%2FPg3in5Rmq4ZaHpryQAjmVUq24%2BhC3e90%3D' (<class 'str'>)
2015-08-11 11:24:02,993 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:24:03,005 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10446bda0>
2015-08-11 11:24:03,005 oic.oic.provider:DEBUG - token -
2015-08-11 11:24:03,005 oic.oic.provider:INFO token_request: code=MzdSNKiQmBtj%2F3D%2FIr3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKiSCtppbPSI%2FPg3in5Rmq4ZaHpryQAjmVUq24%2BhC3e90%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&grant_type=authorization_code
2015-08-11 11:24:03,005 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKiSCtppbPSI/Pg3in5Rmq4ZaHpryQAjmVUq24+hC3e90=', 'grant_type': 'authorization_code'}
2015-08-11 11:24:03,005 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKiSCtppbPSI/Pg3in5Rmq4ZaHpryQAjmVUq24+hC3e90=', 'grant_type': 'authorization_code'}
2015-08-11 11:24:03,005 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:24:03,012 oic.oic.provider:DEBUG All checks OK
2015-08-11 11:24:03,012 oic.oic:DEBUG authzreq: {'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'upm_answer': 'true', 'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'client_id': 'gpYjo6qtf4en'}
2015-08-11 11:24:03,013 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 11:24:03,013 oic.oic:DEBUG authzreq: {'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'upm_answer': 'true', 'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'client_id': 'gpYjo6qtf4en'}
2015-08-11 11:24:03,013 oic.oic.provider:DEBUG id_token: {'sub': '-1ed7c7a1858695e1', 'auth_time': 1439285042, 'aud': ['gpYjo6qtf4en'], 'exp': 1439364243, 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'iat': 1439285043}
2015-08-11 11:24:03,014 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kid": "op0", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kid": "op1", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-11 11:24:03,015 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "y": "zAdPp2c19TYkoeSTRRQ4E1U-s13t-fJpNwPJnDLsulQ", "x": "yIpZKKpgw6M3BscUe--R26ASTXJs1yyrfgF8oTH27YM", "use": "sig", "kid": "op2", "kty": "EC"}]}
2015-08-11 11:24:03,015 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "y": "wePcC7rpNhjkZJLoMfwsMYaLddAjVxppdzqF90MF5xg", "x": "VEmT8_XiKnBUj-eg7MIDKETKl46NJ3rcjdwz0PvIoGQ", "use": "enc", "kid": "op3", "kty": "EC"}]}
2015-08-11 11:24:03,015 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104691908>]
2015-08-11 11:24:03,020 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 11:24:03,021 oic.oic.provider:DEBUG _tinfo: {'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'sub': '-1ed7c7a1858695e1', 'oauth_state': 'token', 'expires_in': 3600, 'revoked': False, 'token_type': 'Bearer', 'refresh_token': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKlh7Q+WmF6oi8+IWRg4g2LKvw6jAmPYXtOCJTzvxaPkw=', 'client_id': 'gpYjo6qtf4en', 'permission': '', 'access_token_scope': '?', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKiSCtppbPSI/Pg3in5Rmq4ZaHpryQAjmVUq24+hC3e90=', 'token_expires_at': 1439285043, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bc208>, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiLTFlZDdjN2ExODU4Njk1ZTEiLCAiYXV0aF90aW1lIjogMTQzOTI4NTA0MiwgImF1ZCI6IFsiZ3BZam82cXRmNGVuIl0sICJleHAiOiAxNDM5MzY0MjQzLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImFjciI6ICJQQVNTV09SRCIsICJpYXQiOiAxNDM5Mjg1MDQzfQ.VBO02ICK7-D2ufgQ_5bXA441luLAC6KVbMVTbHJ5NJ1JHluuYmY0R4W4Cz0MQsz_cBbbq0gsDi1lNgSFkIcVoyM02VQ1NJDFb0Be2F-5-8TeAv3LMBjgCjfysnUVAqhmaUvt_XG4QRf2D9LmzxkWiiE4kzCwJoPprvYJqOVcVTY5gm15uSxPUua5K5H7GhvP_WCshXGABtKECHza9B5GSlr2tlyWfm6rl4maDifDET3thE7xycrpRzxsdx14iyKE_g3O1461XagKHopfgqjMoA58UjFdHl2bp0CRXZTJQnAgJKOBLR-zcgeEsGcQvpZLKcqVyxdxDv2kzNtEgkFLmw', 'authzreq': '{"response_type": "code", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "scope": "openid profile email address phone", "acr_values": "PASSWORD", "upm_answer": "true", "state": "urn:uuid:6971956b-164c-49a0-840f-2089f8088a87", "client_id": "gpYjo6qtf4en"}', 'code_used': True, 'access_token': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKLRnc+UiBiCj4pLtfbIp6wY8gsflTVDBohLo+GeeJlnc='}
2015-08-11 11:24:03,021 oic.oic.provider:DEBUG access_token_response: {'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'refresh_token': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKlh7Q+WmF6oi8+IWRg4g2LKvw6jAmPYXtOCJTzvxaPkw=', 'scope': 'openid profile email address phone', 'expires_in': 3600, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiLTFlZDdjN2ExODU4Njk1ZTEiLCAiYXV0aF90aW1lIjogMTQzOTI4NTA0MiwgImF1ZCI6IFsiZ3BZam82cXRmNGVuIl0sICJleHAiOiAxNDM5MzY0MjQzLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImFjciI6ICJQQVNTV09SRCIsICJpYXQiOiAxNDM5Mjg1MDQzfQ.VBO02ICK7-D2ufgQ_5bXA441luLAC6KVbMVTbHJ5NJ1JHluuYmY0R4W4Cz0MQsz_cBbbq0gsDi1lNgSFkIcVoyM02VQ1NJDFb0Be2F-5-8TeAv3LMBjgCjfysnUVAqhmaUvt_XG4QRf2D9LmzxkWiiE4kzCwJoPprvYJqOVcVTY5gm15uSxPUua5K5H7GhvP_WCshXGABtKECHza9B5GSlr2tlyWfm6rl4maDifDET3thE7xycrpRzxsdx14iyKE_g3O1461XagKHopfgqjMoA58UjFdHl2bp0CRXZTJQnAgJKOBLR-zcgeEsGcQvpZLKcqVyxdxDv2kzNtEgkFLmw', 'token_type': 'Bearer', 'access_token': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKLRnc+UiBiCj4pLtfbIp6wY8gsflTVDBohLo+GeeJlnc='}
2015-08-11 11:24:03,032 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10446be10>
2015-08-11 11:24:03,033 oic.oic:DEBUG verify keys: None
2015-08-11 11:24:03,033 oic.oic.provider:DEBUG user_info_request: {'access_token': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKLRnc+UiBiCj4pLtfbIp6wY8gsflTVDBohLo+GeeJlnc='}
2015-08-11 11:24:03,033 oicServer:DEBUG access_token type: 'T'
2015-08-11 11:24:03,033 oic.oic:DEBUG authzreq: {'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'acr_values': 'PASSWORD', 'upm_answer': 'true', 'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'client_id': 'gpYjo6qtf4en'}
2015-08-11 11:24:03,033 oic.oic.provider:DEBUG userinfo_claim: {'birthdate': None, 'nickname': None, 'zoneinfo': None, 'gender': None, 'phone_number': None, 'family_name': None, 'email_verified': None, 'locale': None, 'website': None, 'sub': None, 'address': None, 'profile': None, 'picture': None, 'preferred_username': None, 'middle_name': None, 'updated_at': None, 'email': None, 'name': None, 'phone_number_verified': None, 'given_name': None}
2015-08-11 11:24:03,033 oic.oic.provider:DEBUG Session info: {'state': 'urn:uuid:6971956b-164c-49a0-840f-2089f8088a87', 'sub': '-1ed7c7a1858695e1', 'oauth_state': 'token', 'expires_in': 3600, 'revoked': False, 'token_type': 'Bearer', 'refresh_token': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKlh7Q+WmF6oi8+IWRg4g2LKvw6jAmPYXtOCJTzvxaPkw=', 'client_id': 'gpYjo6qtf4en', 'permission': '', 'access_token_scope': '?', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKiSCtppbPSI/Pg3in5Rmq4ZaHpryQAjmVUq24+hC3e90=', 'token_expires_at': 1439285043, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bc208>, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiLTFlZDdjN2ExODU4Njk1ZTEiLCAiYXV0aF90aW1lIjogMTQzOTI4NTA0MiwgImF1ZCI6IFsiZ3BZam82cXRmNGVuIl0sICJleHAiOiAxNDM5MzY0MjQzLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImFjciI6ICJQQVNTV09SRCIsICJpYXQiOiAxNDM5Mjg1MDQzfQ.VBO02ICK7-D2ufgQ_5bXA441luLAC6KVbMVTbHJ5NJ1JHluuYmY0R4W4Cz0MQsz_cBbbq0gsDi1lNgSFkIcVoyM02VQ1NJDFb0Be2F-5-8TeAv3LMBjgCjfysnUVAqhmaUvt_XG4QRf2D9LmzxkWiiE4kzCwJoPprvYJqOVcVTY5gm15uSxPUua5K5H7GhvP_WCshXGABtKECHza9B5GSlr2tlyWfm6rl4maDifDET3thE7xycrpRzxsdx14iyKE_g3O1461XagKHopfgqjMoA58UjFdHl2bp0CRXZTJQnAgJKOBLR-zcgeEsGcQvpZLKcqVyxdxDv2kzNtEgkFLmw', 'authzreq': '{"response_type": "code", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "scope": "openid profile email address phone", "acr_values": "PASSWORD", "upm_answer": "true", "state": "urn:uuid:6971956b-164c-49a0-840f-2089f8088a87", "client_id": "gpYjo6qtf4en"}', 'code_used': True, 'access_token': 'MzdSNKiQmBtj/3D/Ir3j7dICidv8EF4TZfbBxehxAAJs35PguUpSnMnwJwCyThkKLRnc+UiBiCj4pLtfbIp6wY8gsflTVDBohLo+GeeJlnc='}
2015-08-11 11:24:03,033 oic.oic.provider:DEBUG user_info_response: {'sub': '-1ed7c7a1858695e1', 'address': {'country': 'Sweden', 'locality': 'Ume', 'postal_code': 'SE-90187', 'street_address': 'Ume Universitet'}, 'given_name': 'Diana', 'name': 'Diana Krall', 'phone_number': '+46 90 7865000', 'family_name': 'Krall', 'email': 'diana@example.org', 'email_verified': False, 'nickname': 'Dina'}
2015-08-11 11:26:25,767 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-11 11:26:25,767 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "sig", "y": "3S_QLGWWYsRcJ9wPCpogRFFpyN3iZNMruJv9DDnTntk", "kty": "EC", "x": "tjSnUP9ln8OIBVheQH-c02V1GnXNvOEa8JYa3v9xKn0", "kid": "op2"}]}
2015-08-11 11:26:25,767 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "enc", "y": "PKjBx9cdwCzKrYqeqpfkipv23lsqUMApsaEHEWa9Cdw", "kty": "EC", "x": "NwgvjrzQk6NcvMx0Jxd4WMe7OJJaAV_0uiD4Vs4kbT4", "kid": "op3"}]}
2015-08-11 11:26:25,767 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:26:32,777 oicServer:INFO callback: <function webfinger at 0x104344d90>
2015-08-11 11:26:32,786 oicServer:INFO callback: <function op_info at 0x1043449d8>
2015-08-11 11:26:32,787 root:INFO op_info
2015-08-11 11:26:32,787 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:26:32,787 oic.oic.provider:INFO provider_info_response: {'claims_supported': ['profile', 'name', 'picture', 'zoneinfo', 'email', 'given_name', 'locale', 'nickname', 'website', 'email_verified', 'phone_number_verified', 'birthdate', 'middle_name', 'updated_at', 'sub', 'family_name', 'gender', 'preferred_username', 'address', 'phone_number'], 'request_parameter_supported': True, 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_signing_alg_values_supported': ['RS384', 'PS256', 'PS384', 'ES384', 'HS384', 'ES512', 'PS521', 'RS256', 'HS256', 'RS512', 'none', 'ES256', 'HS512'], 'subject_types_supported': ['public', 'pairwise'], 'issuer': 'https://localhost:8092/', 'acr_values_supported': ['PASSWORD'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'scopes_supported': ['profile', 'openid', 'offline_access', 'email', 'phone', 'address', 'openid'], 'id_token_signing_alg_values_supported': ['RS384', 'PS256', 'PS384', 'ES384', 'HS384', 'ES512', 'PS521', 'RS256', 'HS256', 'RS512', 'none', 'ES256', 'HS512'], 'require_request_uri_registration': True, 'version': '3.0', 'end_session_endpoint': 'https://localhost:8092/end_session', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint': 'https://localhost:8092/token', 'claims_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'PS256', 'PS384', 'ES384', 'HS384', 'ES512', 'PS521', 'RS256', 'HS256', 'RS512', 'ES256', 'HS512'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['RS384', 'PS256', 'PS384', 'ES384', 'HS384', 'ES512', 'PS521', 'RS256', 'HS256', 'RS512', 'none', 'ES256', 'HS512']}
2015-08-11 11:26:32,818 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x104336e48>
2015-08-11 11:26:32,818 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 11:26:32,818 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:26:32,826 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'd9acb0ef0ce9c50bca1bdeffbc0f8b08c639312f058f721aefe024f1', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xm2XwFZm1Io4', 'client_secret_expires_at': 1439367992, 'client_id_issued_at': 1439281592, 'client_id': 'xm2XwFZm1Io4', 'registration_access_token': 'ee5dIw8a1sW6C1uXmvObA39FMvfLtMWG'}
2015-08-11 11:26:32,827 oic.utils.keyio:DEBUG loading keys for issuer: xm2XwFZm1Io4
2015-08-11 11:26:32,827 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:26:32,827 oic.oic.provider:DEBUG keys for xm2XwFZm1Io4: []
2015-08-11 11:26:32,828 oic.oic.provider:INFO Client info: {'client_secret': 'd9acb0ef0ce9c50bca1bdeffbc0f8b08c639312f058f721aefe024f1', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=xm2XwFZm1Io4', 'application_type': 'web', 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439367992, 'client_id_issued_at': 1439281592, 'client_id': 'xm2XwFZm1Io4', 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'registration_access_token': 'ee5dIw8a1sW6C1uXmvObA39FMvfLtMWG'}
2015-08-11 11:26:32,829 oic.oic.provider:DEBUG registration_response: {'client_secret': 'd9acb0ef0ce9c50bca1bdeffbc0f8b08c639312f058f721aefe024f1', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=xm2XwFZm1Io4', 'application_type': 'web', 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439367992, 'client_id_issued_at': 1439281592, 'client_id': 'xm2XwFZm1Io4', 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'registration_access_token': 'ee5dIw8a1sW6C1uXmvObA39FMvfLtMWG'}
2015-08-11 11:26:32,839 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042af8d0>
2015-08-11 11:26:32,839 oic.oauth2.provider:DEBUG Request: 'state=urn%3Auuid%3A76f6ed26-4898-43f7-8497-c84186aa0161&acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=xm2XwFZm1Io4&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'
2015-08-11 11:26:32,839 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1079a94e0>, <jwkest.jwk.RSAKey object at 0x104691908>, <jwkest.jwk.ECKey object at 0x104691d30>]
2015-08-11 11:26:32,840 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'xm2XwFZm1Io4', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'scope': 'openid profile email address phone'}
2015-08-11 11:26:32,842 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'xm2XwFZm1Io4', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'scope': 'openid profile email address phone'}
2015-08-11 11:26:32,843 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104676e48>, 'PASSWORD')]
2015-08-11 11:26:32,843 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:26:32,844 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:26:32,844 oic.utils.authn.user:INFO do_authentication argv: {'password': '', 'query': 'state=urn%3Auuid%3A76f6ed26-4898-43f7-8497-c84186aa0161&acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=xm2XwFZm1Io4&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7', 'action': 'https://localhost:8092/verify', 'policy_uri': '', 'passwd_title': 'Password', 'submit_text': 'Submit', 'tos_uri': '', 'login': '', 'logo_uri': '', 'login_title': 'Username', 'title': 'User log in', 'acr': ['PASSWORD'], 'client_policy_title': 'Client Policy'}
2015-08-11 11:26:32,858 oicServer:INFO callback: <function css at 0x1042b71e0>
2015-08-11 11:26:36,501 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x104619ea0>
2015-08-11 11:26:36,501 oic.utils.authn.user:DEBUG verify(query=state%3Durn%253Auuid%253A76f6ed26-4898-43f7-8497-c84186aa0161%26acr_values%3DPASSWORD%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3Dxm2XwFZm1Io4%26response_type%3Dcode%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:26:36,501 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'query': ['state=urn%3Auuid%3A76f6ed26-4898-43f7-8497-c84186aa0161&acr_values=PASSWORD&scope=openid+profile+email+address+phone&client_id=xm2XwFZm1Io4&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7'], 'login': ['diana'], 'form.commit': ['Submit'], 'acr_values': ["['PASSWORD']"]}
2015-08-11 11:26:36,501 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-11 11:26:36,501 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'redirect_uri': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'scope': ['openid profile email address phone'], 'response_type': ['code'], 'client_id': ['xm2XwFZm1Io4'], 'state': ['urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161'], 'acr_values': ['PASSWORD']}
2015-08-11 11:26:36,525 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042af8d0>
2015-08-11 11:26:36,525 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&scope=openid+profile+email+address+phone&response_type=code&client_id=xm2XwFZm1Io4&state=urn%3Auuid%3A76f6ed26-4898-43f7-8497-c84186aa0161&acr_values=PASSWORD'
2015-08-11 11:26:36,526 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1079a94e0>, <jwkest.jwk.RSAKey object at 0x104691908>, <jwkest.jwk.ECKey object at 0x104691d30>]
2015-08-11 11:26:36,526 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'xm2XwFZm1Io4', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'scope': 'openid profile email address phone'}
2015-08-11 11:26:36,528 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'acr_values': 'PASSWORD', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'xm2XwFZm1Io4', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'scope': 'openid profile email address phone'}
2015-08-11 11:26:36,530 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104676e48>, 'PASSWORD')]
2015-08-11 11:26:36,530 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:26:36,530 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:26:36,530 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:26:36,530 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'redirect_uri', 'scope', 'response_type', 'client_id', 'state', 'acr_values']
2015-08-11 11:26:36,531 oic.utils.sdb:DEBUG uid2sid: {'diana': ['ca14c4caf960ae2e1cd4696beacf61763af5cf1c3f83380495425980']}
2015-08-11 11:26:36,531 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:26:36,531 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:26:36,533 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?code=cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfgnVjqbksZQCEOJwiw1jWNX4V0ELbAtNJVlwjpdBUNkg%3D&state=urn%3Auuid%3A76f6ed26-4898-43f7-8497-c84186aa0161&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 11:26:36,545 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:26:36,556 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x104336da0>
2015-08-11 11:26:36,556 oic.oic.provider:DEBUG - token -
2015-08-11 11:26:36,556 oic.oic.provider:INFO token_request: grant_type=authorization_code&code=cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfgnVjqbksZQCEOJwiw1jWNX4V0ELbAtNJVlwjpdBUNkg%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 11:26:36,556 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'code': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfgnVjqbksZQCEOJwiw1jWNX4V0ELbAtNJVlwjpdBUNkg=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:26:36,556 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'code': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfgnVjqbksZQCEOJwiw1jWNX4V0ELbAtNJVlwjpdBUNkg=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'}
2015-08-11 11:26:36,556 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:26:36,563 oic.oic.provider:DEBUG All checks OK
2015-08-11 11:26:36,564 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xm2XwFZm1Io4', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'acr_values': 'PASSWORD'}
2015-08-11 11:26:36,564 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 11:26:36,564 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xm2XwFZm1Io4', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'acr_values': 'PASSWORD'}
2015-08-11 11:26:36,564 oic.oic.provider:DEBUG id_token: {'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'sub': '-4e48bff4e157c8a5', 'aud': ['xm2XwFZm1Io4'], 'iat': 1439285196, 'auth_time': 1439285196, 'exp': 1439364396}
2015-08-11 11:26:36,566 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-11 11:26:36,566 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "use": "sig", "y": "3S_QLGWWYsRcJ9wPCpogRFFpyN3iZNMruJv9DDnTntk", "kty": "EC", "x": "tjSnUP9ln8OIBVheQH-c02V1GnXNvOEa8JYa3v9xKn0", "kid": "op2"}]}
2015-08-11 11:26:36,566 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "use": "enc", "y": "PKjBx9cdwCzKrYqeqpfkipv23lsqUMApsaEHEWa9Cdw", "kty": "EC", "x": "NwgvjrzQk6NcvMx0Jxd4WMe7OJJaAV_0uiD4Vs4kbT4", "kid": "op3"}]}
2015-08-11 11:26:36,566 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104691908>]
2015-08-11 11:26:36,572 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 11:26:36,572 oic.oic.provider:DEBUG _tinfo: {'permission': '', 'access_token_scope': '?', 'client_id': 'xm2XwFZm1Io4', 'access_token': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfr0t8k47oCSxjPcVKGMPRMsCcdTkIKttg0YNiJGZbARA=', 'code': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfgnVjqbksZQCEOJwiw1jWNX4V0ELbAtNJVlwjpdBUNkg=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'refresh_token': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfo6PnspWWsE8+xVid5BAIlWTOc1B0JVeY0apvlO6XLY8=', 'token_expires_at': 1439285196, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICItNGU0OGJmZjRlMTU3YzhhNSIsICJhdWQiOiBbInhtMlh3RlptMUlvNCJdLCAiaWF0IjogMTQzOTI4NTE5NiwgImF1dGhfdGltZSI6IDE0MzkyODUxOTYsICJleHAiOiAxNDM5MzY0Mzk2fQ.Yfrauohi4efesAMIVLXezGkffYnsHa04107Yo1SV5DMhpcigOrMXK9B4xhU67wdzbyF0JvXfCCb6xOudhHPTrwDIHyVYZFij0K_jFEm2ZD3DJomoDBp3AEUoT61S028R_sabVCyKnQH0irm2UQt2t-eXNcqV_Ul8tW6XALkq2LY7TAFvYYLM5tk6ZCzgawch3ztjUeWmEiBi3j-HwIc_Oc-6l3ATG436MpxbuLxaBafBivVihD3dvkaKZhL2WkHVpvsFNMAOAVPSJxwkvX5kWlA1PTZ83WbJBnMixjDkzEGiVxjkxkw_KpiJqljzAzT7q2HpN9G0sMGLqVKhiE_Jqw', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'revoked': False, 'sub': '-4e48bff4e157c8a5', 'expires_in': 3600, 'oauth_state': 'token', 'code_used': True, 'token_type': 'Bearer', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bc208>, 'authzreq': '{"upm_answer": "true", "acr_values": "PASSWORD", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "response_type": "code", "client_id": "xm2XwFZm1Io4", "state": "urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161", "scope": "openid profile email address phone"}'}
2015-08-11 11:26:36,572 oic.oic.provider:DEBUG access_token_response: {'refresh_token': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfo6PnspWWsE8+xVid5BAIlWTOc1B0JVeY0apvlO6XLY8=', 'expires_in': 3600, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICItNGU0OGJmZjRlMTU3YzhhNSIsICJhdWQiOiBbInhtMlh3RlptMUlvNCJdLCAiaWF0IjogMTQzOTI4NTE5NiwgImF1dGhfdGltZSI6IDE0MzkyODUxOTYsICJleHAiOiAxNDM5MzY0Mzk2fQ.Yfrauohi4efesAMIVLXezGkffYnsHa04107Yo1SV5DMhpcigOrMXK9B4xhU67wdzbyF0JvXfCCb6xOudhHPTrwDIHyVYZFij0K_jFEm2ZD3DJomoDBp3AEUoT61S028R_sabVCyKnQH0irm2UQt2t-eXNcqV_Ul8tW6XALkq2LY7TAFvYYLM5tk6ZCzgawch3ztjUeWmEiBi3j-HwIc_Oc-6l3ATG436MpxbuLxaBafBivVihD3dvkaKZhL2WkHVpvsFNMAOAVPSJxwkvX5kWlA1PTZ83WbJBnMixjDkzEGiVxjkxkw_KpiJqljzAzT7q2HpN9G0sMGLqVKhiE_Jqw', 'token_type': 'Bearer', 'access_token': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfr0t8k47oCSxjPcVKGMPRMsCcdTkIKttg0YNiJGZbARA=', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'scope': 'openid profile email address phone'}
2015-08-11 11:26:36,584 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x104336e10>
2015-08-11 11:26:36,584 oic.oic:DEBUG verify keys: None
2015-08-11 11:26:36,584 oic.oic.provider:DEBUG user_info_request: {'access_token': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfr0t8k47oCSxjPcVKGMPRMsCcdTkIKttg0YNiJGZbARA='}
2015-08-11 11:26:36,584 oicServer:DEBUG access_token type: 'T'
2015-08-11 11:26:36,585 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xm2XwFZm1Io4', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'acr_values': 'PASSWORD'}
2015-08-11 11:26:36,585 oic.oic.provider:DEBUG userinfo_claim: {'preferred_username': None, 'profile': None, 'website': None, 'name': None, 'zoneinfo': None, 'email': None, 'given_name': None, 'locale': None, 'nickname': None, 'email_verified': None, 'phone_number_verified': None, 'birthdate': None, 'middle_name': None, 'updated_at': None, 'sub': None, 'family_name': None, 'gender': None, 'picture': None, 'phone_number': None, 'address': None}
2015-08-11 11:26:36,585 oic.oic.provider:DEBUG Session info: {'permission': '', 'access_token_scope': '?', 'client_id': 'xm2XwFZm1Io4', 'access_token': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfr0t8k47oCSxjPcVKGMPRMsCcdTkIKttg0YNiJGZbARA=', 'code': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfgnVjqbksZQCEOJwiw1jWNX4V0ELbAtNJVlwjpdBUNkg=', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'refresh_token': 'cVlgY1z58ILOjh1u5o8fJAjMYfzf9oFuNlv19mJeT23PtL3QT44abHkkocO6pEkfo6PnspWWsE8+xVid5BAIlWTOc1B0JVeY0apvlO6XLY8=', 'token_expires_at': 1439285196, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICItNGU0OGJmZjRlMTU3YzhhNSIsICJhdWQiOiBbInhtMlh3RlptMUlvNCJdLCAiaWF0IjogMTQzOTI4NTE5NiwgImF1dGhfdGltZSI6IDE0MzkyODUxOTYsICJleHAiOiAxNDM5MzY0Mzk2fQ.Yfrauohi4efesAMIVLXezGkffYnsHa04107Yo1SV5DMhpcigOrMXK9B4xhU67wdzbyF0JvXfCCb6xOudhHPTrwDIHyVYZFij0K_jFEm2ZD3DJomoDBp3AEUoT61S028R_sabVCyKnQH0irm2UQt2t-eXNcqV_Ul8tW6XALkq2LY7TAFvYYLM5tk6ZCzgawch3ztjUeWmEiBi3j-HwIc_Oc-6l3ATG436MpxbuLxaBafBivVihD3dvkaKZhL2WkHVpvsFNMAOAVPSJxwkvX5kWlA1PTZ83WbJBnMixjDkzEGiVxjkxkw_KpiJqljzAzT7q2HpN9G0sMGLqVKhiE_Jqw', 'state': 'urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'revoked': False, 'sub': '-4e48bff4e157c8a5', 'expires_in': 3600, 'oauth_state': 'token', 'code_used': True, 'token_type': 'Bearer', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bc208>, 'authzreq': '{"upm_answer": "true", "acr_values": "PASSWORD", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "response_type": "code", "client_id": "xm2XwFZm1Io4", "state": "urn:uuid:76f6ed26-4898-43f7-8497-c84186aa0161", "scope": "openid profile email address phone"}'}
2015-08-11 11:26:36,585 oic.oic.provider:DEBUG user_info_response: {'email_verified': False, 'name': 'Diana Krall', 'address': {'country': 'Sweden', 'locality': 'Ume', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187'}, 'sub': '-4e48bff4e157c8a5', 'email': 'diana@example.org', 'given_name': 'Diana', 'phone_number': '+46 90 7865000', 'nickname': 'Dina', 'family_name': 'Krall'}
2015-08-11 11:27:16,018 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-11 11:27:16,018 root:INFO OC3 server keys: {"keys": [{"x": "vQvM0kl4KDvsBaWmVJzMLhGgmBkRKBTZWNnC_oeJZRs", "kid": "op2", "kty": "EC", "crv": "P-256", "use": "sig", "y": "v-laHLWpY4JxCUJ_IqILzim4YGlhEcj8jmIQ6yG4IOU"}]}
2015-08-11 11:27:16,018 root:INFO OC3 server keys: {"keys": [{"x": "OgPhoXf6N-8n7k6ecZjbCBPVy8cwFFJkZewuyPjyidQ", "kid": "op3", "kty": "EC", "crv": "P-256", "use": "enc", "y": "UBdLxwesEv133x6laFvF7zbsvCZd5BE-cUqTEQ9jLto"}]}
2015-08-11 11:27:16,018 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:27:25,391 oicServer:INFO callback: <function webfinger at 0x104439d90>
2015-08-11 11:27:25,401 oicServer:INFO callback: <function op_info at 0x1044399d8>
2015-08-11 11:27:25,401 root:INFO op_info
2015-08-11 11:27:25,402 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:27:25,402 oic.oic.provider:INFO provider_info_response: {'request_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'issuer': 'https://localhost:8092/', 'claims_supported': ['website', 'birthdate', 'profile', 'preferred_username', 'picture', 'nickname', 'address', 'sub', 'locale', 'name', 'zoneinfo', 'phone_number_verified', 'email', 'given_name', 'middle_name', 'gender', 'updated_at', 'family_name', 'email_verified', 'phone_number'], 'id_token_signing_alg_values_supported': ['RS384', 'RS256', 'PS256', 'HS512', 'HS384', 'HS256', 'ES256', 'PS521', 'none', 'PS384', 'RS512', 'ES384', 'ES512'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_signing_alg_values_supported': ['RS384', 'RS256', 'PS256', 'HS512', 'HS384', 'HS256', 'ES256', 'PS521', 'none', 'PS384', 'RS512', 'ES384', 'ES512'], 'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'RS256', 'PS256', 'HS512', 'HS384', 'HS256', 'ES256', 'PS521', 'PS384', 'RS512', 'ES384', 'ES512'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'require_request_uri_registration': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'email', 'offline_access', 'address', 'openid', 'phone', 'openid'], 'request_object_signing_alg_values_supported': ['RS384', 'RS256', 'PS256', 'HS512', 'HS384', 'HS256', 'ES256', 'PS521', 'none', 'PS384', 'RS512', 'ES384', 'ES512'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'version': '3.0', 'token_endpoint': 'https://localhost:8092/token', 'registration_endpoint': 'https://localhost:8092/registration', 'acr_values_supported': ['PASSWORD'], 'claims_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-11 11:27:25,434 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10442be48>
2015-08-11 11:27:25,434 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/"], "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"]}>>
2015-08-11 11:27:25,434 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:27:25,439 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439281645, 'client_id': 'pYEa836fYkrN', 'client_secret': 'df84f589297f89f207a3f185c4ee0f2b05ff53ea1a520f1fc288548f', 'registration_access_token': 'TRkqjmXnpfZpkizFCKNRP93p8T5v6seC', 'registration_client_uri': 'https://localhost:8092/registration?client_id=pYEa836fYkrN', 'client_secret_expires_at': 1439368045}
2015-08-11 11:27:25,440 oic.utils.keyio:DEBUG loading keys for issuer: pYEa836fYkrN
2015-08-11 11:27:25,440 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/'], 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:27:25,440 oic.oic.provider:DEBUG keys for pYEa836fYkrN: []
2015-08-11 11:27:25,441 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439281645, 'client_id': 'pYEa836fYkrN', 'application_type': 'web', 'client_secret': 'df84f589297f89f207a3f185c4ee0f2b05ff53ea1a520f1fc288548f', 'post_logout_redirect_uris': [('https://localhost:8666/', None)], 'contacts': ['ops@example.com'], 'registration_access_token': 'TRkqjmXnpfZpkizFCKNRP93p8T5v6seC', 'registration_client_uri': 'https://localhost:8092/registration?client_id=pYEa836fYkrN', 'client_secret_expires_at': 1439368045, 'redirect_uris': [('https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)]}
2015-08-11 11:27:25,441 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439281645, 'client_id': 'pYEa836fYkrN', 'application_type': 'web', 'client_secret': 'df84f589297f89f207a3f185c4ee0f2b05ff53ea1a520f1fc288548f', 'post_logout_redirect_uris': ['https://localhost:8666/'], 'contacts': ['ops@example.com'], 'registration_access_token': 'TRkqjmXnpfZpkizFCKNRP93p8T5v6seC', 'registration_client_uri': 'https://localhost:8092/registration?client_id=pYEa836fYkrN', 'client_secret_expires_at': 1439368045, 'redirect_uris': ['https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7']}
2015-08-11 11:27:25,452 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1041a28d0>
2015-08-11 11:27:25,452 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&client_id=pYEa836fYkrN&state=urn%3Auuid%3A6986a41f-8d3b-4518-97b3-53fd6ecd8d2b&response_type=code'
2015-08-11 11:27:25,452 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1079694e0>, <jwkest.jwk.RSAKey object at 0x104651908>, <jwkest.jwk.ECKey object at 0x104651c50>]
2015-08-11 11:27:25,452 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'pYEa836fYkrN', 'scope': 'openid profile email address phone', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:6986a41f-8d3b-4518-97b3-53fd6ecd8d2b'}
2015-08-11 11:27:25,454 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'pYEa836fYkrN', 'scope': 'openid profile email address phone', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'acr_values': 'PASSWORD', 'state': 'urn:uuid:6986a41f-8d3b-4518-97b3-53fd6ecd8d2b'}
2015-08-11 11:27:25,455 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x104636f98>, 'PASSWORD')]
2015-08-11 11:27:25,456 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:27:25,456 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:27:25,456 oic.utils.authn.user:INFO do_authentication argv: {'action': 'https://localhost:8092/verify', 'policy_uri': '', 'logo_uri': '', 'acr': ['PASSWORD'], 'tos_uri': '', 'title': 'User log in', 'passwd_title': 'Password', 'query': 'acr_values=PASSWORD&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&client_id=pYEa836fYkrN&state=urn%3Auuid%3A6986a41f-8d3b-4518-97b3-53fd6ecd8d2b&response_type=code', 'submit_text': 'Submit', 'login': '', 'password': '', 'client_policy_title': 'Client Policy', 'login_title': 'Username'}
2015-08-11 11:27:25,474 oicServer:INFO callback: <function css at 0x1041aa1e0>
2015-08-11 11:27:40,274 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-11 11:27:40,274 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "urMWvspwZgkndedyiQNAcFy30y57rF1XLh0QBl1Q9BY", "x": "hG36ZAYr9-A76oo3PoVNZqLUYHb1rbBF4PhmXmNNe1M", "kid": "op2"}]}
2015-08-11 11:27:40,274 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "fLx-yFrFYYpt53TyBatlHnASJDQViwUKmcucTY7-QBA", "x": "PrN2td_rDmDgyup4kHBVYqdSSExwTaDRXCMUDv9I5y4", "kid": "op3"}]}
2015-08-11 11:27:40,274 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 11:27:50,607 oicServer:INFO callback: <function webfinger at 0x102968230>
2015-08-11 11:27:50,614 oicServer:INFO callback: <function op_info at 0x102967e60>
2015-08-11 11:27:50,614 root:INFO op_info
2015-08-11 11:27:50,614 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 11:27:50,615 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-11 11:27:50,646 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x102966610>
2015-08-11 11:27:50,646 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/"]}>>
2015-08-11 11:27:50,646 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': [u'https://localhost:8666/'], 'contacts': [u'ops@example.com']}
2015-08-11 11:27:50,655 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439281670, 'registration_access_token': 'vnSmVrKxUZ0xgMRLxL8Yt67iy2DGdpdv', 'client_id': 'k4CCP0VE4sfd', 'client_secret': '7682d719d4fd03c6ba97b4c6f765ef072e643f2aaa4e80280423040c', 'registration_client_uri': 'https://localhost:8092/registration?client_id=k4CCP0VE4sfd', 'client_secret_expires_at': 1439368070}
2015-08-11 11:27:50,656 oic.utils.keyio:DEBUG loading keys for issuer: k4CCP0VE4sfd
2015-08-11 11:27:50,656 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'post_logout_redirect_uris': [u'https://localhost:8666/'], 'contacts': [u'ops@example.com']}
2015-08-11 11:27:50,656 oic.oic.provider:DEBUG keys for k4CCP0VE4sfd: []
2015-08-11 11:27:50,659 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439281670, 'post_logout_redirect_uris': [(u'https://localhost:8666/', None)], 'registration_access_token': 'vnSmVrKxUZ0xgMRLxL8Yt67iy2DGdpdv', 'redirect_uris': [(u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', None)], 'client_id': 'k4CCP0VE4sfd', 'application_type': u'web', 'client_secret': '7682d719d4fd03c6ba97b4c6f765ef072e643f2aaa4e80280423040c', 'registration_client_uri': 'https://localhost:8092/registration?client_id=k4CCP0VE4sfd', 'contacts': [u'ops@example.com'], 'client_secret_expires_at': 1439368070}
2015-08-11 11:27:50,659 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439281670, 'redirect_uris': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=k4CCP0VE4sfd', 'post_logout_redirect_uris': [u'https://localhost:8666/'], 'registration_access_token': 'vnSmVrKxUZ0xgMRLxL8Yt67iy2DGdpdv', 'client_id': 'k4CCP0VE4sfd', 'client_secret': '7682d719d4fd03c6ba97b4c6f765ef072e643f2aaa4e80280423040c', 'client_secret_expires_at': 1439368070}
2015-08-11 11:27:50,666 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x102966550>
2015-08-11 11:27:50,667 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&state=urn%3Auuid%3A83fd32f7-7d34-4a9d-9336-0e2c82e31184&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=k4CCP0VE4sfd&scope=openid+profile+email+address+phone'
2015-08-11 11:27:50,667 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x102b10610>, <jwkest.jwk.RSAKey object at 0x102ae16d0>, <jwkest.jwk.ECKey object at 0x102b05ed0>]
2015-08-11 11:27:50,667 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'k4CCP0VE4sfd', 'scope': 'openid profile email address phone'}
2015-08-11 11:27:50,669 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'k4CCP0VE4sfd', 'scope': 'openid profile email address phone'}
2015-08-11 11:27:50,670 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x102afaf90>, 'PASSWORD')]
2015-08-11 11:27:50,670 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:27:50,671 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:27:50,671 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['PASSWORD'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'acr_values=PASSWORD&state=urn%3Auuid%3A83fd32f7-7d34-4a9d-9336-0e2c82e31184&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=k4CCP0VE4sfd&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-11 11:27:50,683 oicServer:INFO callback: <function css at 0x1024260c8>
2015-08-11 11:27:55,041 oicServer:INFO callback: <function auth_verify at 0x102ad4d70>
2015-08-11 11:27:55,041 oic.utils.authn.user:DEBUG verify(query=acr_values%3DPASSWORD%26state%3Durn%253Auuid%253A83fd32f7-7d34-4a9d-9336-0e2c82e31184%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252F919D3F697FDAAF138124B83E09ECB0B7%26response_type%3Dcode%26client_id%3Dk4CCP0VE4sfd%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27PASSWORD%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 11:27:55,041 oic.utils.authn.user:DEBUG dict: {u'query': [u'acr_values=PASSWORD&state=urn%3Auuid%3A83fd32f7-7d34-4a9d-9336-0e2c82e31184&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=k4CCP0VE4sfd&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['PASSWORD']"]}
2015-08-11 11:27:55,041 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 11:27:55,042 oic.utils.authn.user:DEBUG kwargs: {u'acr_values': [u'PASSWORD'], u'state': [u'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184'], u'redirect_uri': [u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7'], u'response_type': [u'code'], u'client_id': [u'k4CCP0VE4sfd'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-11 11:27:55,065 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x102966550>
2015-08-11 11:27:55,065 oic.oauth2.provider:DEBUG Request: 'acr_values=PASSWORD&state=urn%3Auuid%3A83fd32f7-7d34-4a9d-9336-0e2c82e31184&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7&response_type=code&client_id=k4CCP0VE4sfd&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-11 11:27:55,065 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x102b10610>, <jwkest.jwk.RSAKey object at 0x102ae16d0>, <jwkest.jwk.ECKey object at 0x102b05ed0>]
2015-08-11 11:27:55,065 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'k4CCP0VE4sfd', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-11 11:27:55,066 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'PASSWORD', 'state': 'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': 'code', 'client_id': 'k4CCP0VE4sfd', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-11 11:27:55,068 oic.oic.provider:DEBUG Picked AuthN broker for ACR PASSWORD: [(<oic.utils.authn.multi_auth.AuthnIndexedEndpointWrapper object at 0x102afaf90>, 'PASSWORD')]
2015-08-11 11:27:55,068 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 11:27:55,068 oic.oauth2.provider:INFO No active authentication
2015-08-11 11:27:55,068 oic.oic.provider:DEBUG - authenticated -
2015-08-11 11:27:55,068 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-11 11:27:55,068 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['60b3f70a64b35bb541991e63e91f2e77d0da4f7cc68e7b56549581de']}
2015-08-11 11:27:55,068 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 11:27:55,068 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 11:27:55,070 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7?scope=openid+profile+email+address+phone&state=urn%3Auuid%3A83fd32f7-7d34-4a9d-9336-0e2c82e31184&code=RcPOC%2FxegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw%2BFiEy1y6MO1XOoBqvneuoHRIl0pyJ0sGpK5t6K9kMFrD1xp3YvYX8d2mNoH5k%3D' (<type 'str'>)
2015-08-11 11:27:55,078 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 11:27:55,090 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x102966590>
2015-08-11 11:27:55,090 oic.oic.provider:DEBUG - token -
2015-08-11 11:27:55,090 oic.oic.provider:INFO token_request: code=RcPOC%2FxegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw%2BFiEy1y6MO1XOoBqvneuoHRIl0pyJ0sGpK5t6K9kMFrD1xp3YvYX8d2mNoH5k%3D&grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2F919D3F697FDAAF138124B83E09ECB0B7
2015-08-11 11:27:55,090 oic.oic.provider:DEBUG AccessTokenRequest: {u'redirect_uri': u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', u'code': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvneuoHRIl0pyJ0sGpK5t6K9kMFrD1xp3YvYX8d2mNoH5k=', 'grant_type': u'authorization_code'}
2015-08-11 11:27:55,090 oic.utils.authn.client:DEBUG REQ: {u'redirect_uri': u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', u'code': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvneuoHRIl0pyJ0sGpK5t6K9kMFrD1xp3YvYX8d2mNoH5k=', 'grant_type': u'authorization_code'}
2015-08-11 11:27:55,090 oic.utils.authn.client:DEBUG Basic auth
2015-08-11 11:27:55,097 oic.oic.provider:DEBUG All checks OK
2015-08-11 11:27:55,098 oic.oic:DEBUG authzreq: {'acr_values': u'PASSWORD', 'state': u'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': u'code', 'client_id': u'k4CCP0VE4sfd', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-11 11:27:55,098 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 11:27:55,098 oic.oic:DEBUG authzreq: {'acr_values': u'PASSWORD', 'state': u'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': u'code', 'client_id': u'k4CCP0VE4sfd', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-11 11:27:55,098 oic.oic.provider:DEBUG id_token: {'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439364475, 'auth_time': 1439285275, 'iat': 1439285275, 'aud': ['k4CCP0VE4sfd']}
2015-08-11 11:27:55,100 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-11 11:27:55,100 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "urMWvspwZgkndedyiQNAcFy30y57rF1XLh0QBl1Q9BY", "x": "hG36ZAYr9-A76oo3PoVNZqLUYHb1rbBF4PhmXmNNe1M", "kid": "op2"}]}
2015-08-11 11:27:55,100 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "fLx-yFrFYYpt53TyBatlHnASJDQViwUKmcucTY7-QBA", "x": "PrN2td_rDmDgyup4kHBVYqdSSExwTaDRXCMUDv9I5y4", "kid": "op3"}]}
2015-08-11 11:27:55,100 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x102ae16d0>]
2015-08-11 11:27:55,106 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 11:27:55,106 oic.oic.provider:DEBUG _tinfo: {'authn_event': <oic.utils.sdb.AuthnEvent object at 0x102b10fd0>, 'code': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvneuoHRIl0pyJ0sGpK5t6K9kMFrD1xp3YvYX8d2mNoH5k=', 'authzreq': '{"acr_values": "PASSWORD", "state": "urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "response_type": "code", "client_id": "k4CCP0VE4sfd", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvnhudzI4N2Qz+8kRgQ79ti3Dl4EEmpSCmaL9DmLHX3fWY=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiLWZkZmI0YTg0MWRjZTE2NyIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0MzkzNjQ0NzUsICJhdXRoX3RpbWUiOiAxNDM5Mjg1Mjc1LCAiaWF0IjogMTQzOTI4NTI3NSwgImF1ZCI6IFsiazRDQ1AwVkU0c2ZkIl19.vgvWUFOfoN6DBM2QANte0JPsuKgsPx5T0hlOzlhBcEzJaK_naSe8TXHygLo8Q5gIKNNNBv9lezEzg0XMFEJJvWhcDO79WI6LBnuDi1MNXWC6t-dJerk7ybmDpV6VV7KkoEztMeILs5mMMiF2g1YXvaJ5fiD5PZBdLY7SyovkPtvsXbxkkTUy98Md3V9yaKgsSLPchBL0Lyk-bJn4ZA7rCvbnRjUecXrJ0aPiUqysZr26Rfzp3uL770r_WhApLvZMw1hSXn_uDtoy6XfgT1gj05MGpSFk8tNQPFqX9ltrY0zorFY2k2zfl6ghQQ2H4lbHmOiX6ieIjrBaBEfN1WVHIA', 'token_expires_at': 1439285275, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code_used': True, 'client_id': 'k4CCP0VE4sfd', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvntX+evFcZxNEOMpm/AEZiwxs9SLkevkCao/spwdABboY=', 'sub': '-fdfb4a841dce167'}
2015-08-11 11:27:55,106 oic.oic.provider:DEBUG access_token_response: {'access_token': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvnhudzI4N2Qz+8kRgQ79ti3Dl4EEmpSCmaL9DmLHX3fWY=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiLWZkZmI0YTg0MWRjZTE2NyIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0MzkzNjQ0NzUsICJhdXRoX3RpbWUiOiAxNDM5Mjg1Mjc1LCAiaWF0IjogMTQzOTI4NTI3NSwgImF1ZCI6IFsiazRDQ1AwVkU0c2ZkIl19.vgvWUFOfoN6DBM2QANte0JPsuKgsPx5T0hlOzlhBcEzJaK_naSe8TXHygLo8Q5gIKNNNBv9lezEzg0XMFEJJvWhcDO79WI6LBnuDi1MNXWC6t-dJerk7ybmDpV6VV7KkoEztMeILs5mMMiF2g1YXvaJ5fiD5PZBdLY7SyovkPtvsXbxkkTUy98Md3V9yaKgsSLPchBL0Lyk-bJn4ZA7rCvbnRjUecXrJ0aPiUqysZr26Rfzp3uL770r_WhApLvZMw1hSXn_uDtoy6XfgT1gj05MGpSFk8tNQPFqX9ltrY0zorFY2k2zfl6ghQQ2H4lbHmOiX6ieIjrBaBEfN1WVHIA', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'scope': 'openid profile email address phone', 'refresh_token': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvntX+evFcZxNEOMpm/AEZiwxs9SLkevkCao/spwdABboY='}
2015-08-11 11:27:55,116 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1029665d0>
2015-08-11 11:27:55,116 oic.oic:DEBUG verify keys: None
2015-08-11 11:27:55,116 oic.oic.provider:DEBUG user_info_request: {u'access_token': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvnhudzI4N2Qz+8kRgQ79ti3Dl4EEmpSCmaL9DmLHX3fWY='}
2015-08-11 11:27:55,117 oicServer:DEBUG access_token type: 'T'
2015-08-11 11:27:55,117 oic.oic:DEBUG authzreq: {'acr_values': u'PASSWORD', 'state': u'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': u'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'response_type': u'code', 'client_id': u'k4CCP0VE4sfd', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-11 11:27:55,117 oic.oic.provider:DEBUG userinfo_claim: {'profile': None, 'family_name': None, 'gender': None, 'middle_name': None, 'sub': None, 'phone_number_verified': None, 'picture': None, 'locale': None, 'email_verified': None, 'zoneinfo': None, 'preferred_username': None, 'updated_at': None, 'birthdate': None, 'website': None, 'nickname': None, 'given_name': None, 'address': None, 'phone_number': None, 'email': None, 'name': None}
2015-08-11 11:27:55,117 oic.oic.provider:DEBUG Session info: {'authn_event': <oic.utils.sdb.AuthnEvent object at 0x102b10fd0>, 'code': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvneuoHRIl0pyJ0sGpK5t6K9kMFrD1xp3YvYX8d2mNoH5k=', 'authzreq': '{"acr_values": "PASSWORD", "state": "urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184", "redirect_uri": "https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7", "response_type": "code", "client_id": "k4CCP0VE4sfd", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvnhudzI4N2Qz+8kRgQ79ti3Dl4EEmpSCmaL9DmLHX3fWY=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiLWZkZmI0YTg0MWRjZTE2NyIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0MzkzNjQ0NzUsICJhdXRoX3RpbWUiOiAxNDM5Mjg1Mjc1LCAiaWF0IjogMTQzOTI4NTI3NSwgImF1ZCI6IFsiazRDQ1AwVkU0c2ZkIl19.vgvWUFOfoN6DBM2QANte0JPsuKgsPx5T0hlOzlhBcEzJaK_naSe8TXHygLo8Q5gIKNNNBv9lezEzg0XMFEJJvWhcDO79WI6LBnuDi1MNXWC6t-dJerk7ybmDpV6VV7KkoEztMeILs5mMMiF2g1YXvaJ5fiD5PZBdLY7SyovkPtvsXbxkkTUy98Md3V9yaKgsSLPchBL0Lyk-bJn4ZA7rCvbnRjUecXrJ0aPiUqysZr26Rfzp3uL770r_WhApLvZMw1hSXn_uDtoy6XfgT1gj05MGpSFk8tNQPFqX9ltrY0zorFY2k2zfl6ghQQ2H4lbHmOiX6ieIjrBaBEfN1WVHIA', 'token_expires_at': 1439285275, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'urn:uuid:83fd32f7-7d34-4a9d-9336-0e2c82e31184', 'redirect_uri': 'https://localhost:8666/919D3F697FDAAF138124B83E09ECB0B7', 'code_used': True, 'client_id': 'k4CCP0VE4sfd', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'RcPOC/xegeNkw9naOB7AcklpRtPFxGnpFPzUfLbD51CcUw+FiEy1y6MO1XOoBqvntX+evFcZxNEOMpm/AEZiwxs9SLkevkCao/spwdABboY=', 'sub': '-fdfb4a841dce167'}
2015-08-11 11:27:55,117 oic.oic.provider:DEBUG user_info_response: {'phone_number': '+46 90 7865000', 'family_name': 'Krall', 'sub': '-fdfb4a841dce167', 'email_verified': False, 'given_name': 'Diana', 'address': {'country': 'Sweden', 'postal_code': 'SE-90187', 'street_address': 'Ume\xc3\xa5 Universitet', 'locality': 'Ume\xc3\xa5'}, 'nickname': 'Dina', 'email': 'diana@example.org', 'name': 'Diana Krall'}
2015-08-11 15:35:38,318 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-11 15:35:38,318 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "ClSQvnywgScZ517q8tdaDVsSUCTHymFAMiC8BVbE6yM", "x": "h8nut83art5VX7pAxEnJ5CDFeoKG0bQQMQ5x3W1iYwA", "kid": "op2"}]}
2015-08-11 15:35:38,318 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "9ZDQ2Kbr5wpM5nCpINN3LgRAs-aHS3wKqv-rwaFELgM", "x": "ZSJbLw62ovZYF6auOUDJfcZuCB4eqP40fMfM8SqR4yo", "kid": "op3"}]}
2015-08-11 15:35:38,318 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 15:35:48,003 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-11 15:35:48,003 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "XnG08dmE2zrJam5B578i_9g8j2hBMnuuZy2Ph5CxlUI", "x": "JX-x3jmoHO_c8igKmhooeglK4ZMeAwovv8bvfnCsqmY", "kid": "op2"}]}
2015-08-11 15:35:48,003 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "O_3XvwfSQWIpS3EEv7MxZKE4tqfR49UiNbjTYrdt5vA", "x": "ypIX68Lkb_z90ijho0kaw1qR9zoFEzZhNqAgxFaZu8c", "kid": "op3"}]}
2015-08-11 15:35:48,003 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 15:37:01,476 oicServer:INFO callback: <function webfinger at 0x10ebee2a8>
2015-08-11 15:37:01,483 oicServer:INFO callback: <function op_info at 0x10ebeded8>
2015-08-11 15:37:01,483 root:INFO op_info
2015-08-11 15:37:01,483 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 15:37:01,483 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'PS521', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-11 15:37:01,510 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10ebec710>
2015-08-11 15:37:01,510 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-11 15:37:01,510 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-11 15:37:01,518 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439296621, 'registration_access_token': 'hx0XUEcdK8tqUy1S5p24ptzZQZ3QzrYZ', 'client_id': '5Q3jVyeWrVIb', 'client_secret': '09110a4fc165e0af876cfbf9c01360ea7b2ac2c31a950c6187b293c8', 'registration_client_uri': 'https://localhost:8092/registration?client_id=5Q3jVyeWrVIb', 'client_secret_expires_at': 1439383021}
2015-08-11 15:37:01,518 oic.utils.keyio:DEBUG loading keys for issuer: 5Q3jVyeWrVIb
2015-08-11 15:37:01,519 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-11 15:37:01,519 oic.oic.provider:DEBUG keys for 5Q3jVyeWrVIb: []
2015-08-11 15:37:01,521 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439296621, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'hx0XUEcdK8tqUy1S5p24ptzZQZ3QzrYZ', 'client_id': '5Q3jVyeWrVIb', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=5Q3jVyeWrVIb', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '09110a4fc165e0af876cfbf9c01360ea7b2ac2c31a950c6187b293c8', 'client_secret_expires_at': 1439383021}
2015-08-11 15:37:01,521 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439296621, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=5Q3jVyeWrVIb', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'hx0XUEcdK8tqUy1S5p24ptzZQZ3QzrYZ', 'response_types': [u'code'], 'client_id': '5Q3jVyeWrVIb', 'client_secret': '09110a4fc165e0af876cfbf9c01360ea7b2ac2c31a950c6187b293c8', 'client_secret_expires_at': 1439383021}
2015-08-11 15:37:05,138 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ebec650>
2015-08-11 15:37:05,139 oic.oauth2.provider:DEBUG Request: 'nonce=ASMQbXsLntXU7QOh&acr_values=SAML&state=hztSRpk0eWi1vIA5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=5Q3jVyeWrVIb&scope=openid+profile+email+address+phone'
2015-08-11 15:37:05,139 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10ed95710>, <jwkest.jwk.RSAKey object at 0x10ed667d0>, <jwkest.jwk.ECKey object at 0x10ed89110>]
2015-08-11 15:37:05,139 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'ASMQbXsLntXU7QOh', 'acr_values': 'SAML', 'state': 'hztSRpk0eWi1vIA5', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '5Q3jVyeWrVIb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:05,140 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'ASMQbXsLntXU7QOh', 'acr_values': 'SAML', 'state': 'hztSRpk0eWi1vIA5', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '5Q3jVyeWrVIb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:05,142 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:05,142 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:05,142 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 15:37:05,142 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:37:05,142 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=ASMQbXsLntXU7QOh&acr_values=SAML&state=hztSRpk0eWi1vIA5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=5Q3jVyeWrVIb&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-11 15:37:05,159 oicServer:INFO callback: <function css at 0x10e6ab140>
2015-08-11 15:37:10,096 oicServer:INFO callback: <function auth_verify at 0x10ed5cde8>
2015-08-11 15:37:10,096 oic.utils.authn.user:DEBUG verify(query=nonce%3DASMQbXsLntXU7QOh%26acr_values%3DSAML%26state%3DhztSRpk0eWi1vIA5%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26client_id%3D5Q3jVyeWrVIb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 15:37:10,097 oic.utils.authn.user:DEBUG dict: {u'query': [u'nonce=ASMQbXsLntXU7QOh&acr_values=SAML&state=hztSRpk0eWi1vIA5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=5Q3jVyeWrVIb&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-11 15:37:10,097 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-11 15:37:10,097 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'ASMQbXsLntXU7QOh'], u'acr_values': [u'SAML'], u'state': [u'hztSRpk0eWi1vIA5'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'5Q3jVyeWrVIb'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-11 15:37:10,126 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ebec650>
2015-08-11 15:37:10,127 oic.oauth2.provider:DEBUG Request: 'nonce=ASMQbXsLntXU7QOh&acr_values=SAML&state=hztSRpk0eWi1vIA5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=5Q3jVyeWrVIb&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-11 15:37:10,127 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10ed95710>, <jwkest.jwk.RSAKey object at 0x10ed667d0>, <jwkest.jwk.ECKey object at 0x10ed89110>]
2015-08-11 15:37:10,127 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'ASMQbXsLntXU7QOh', 'acr_values': 'SAML', 'state': 'hztSRpk0eWi1vIA5', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '5Q3jVyeWrVIb', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:10,128 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'ASMQbXsLntXU7QOh', 'acr_values': 'SAML', 'state': 'hztSRpk0eWi1vIA5', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '5Q3jVyeWrVIb', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:10,129 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:10,129 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:10,129 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 15:37:10,130 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:37:10,130 oic.oic.provider:DEBUG - authenticated -
2015-08-11 15:37:10,130 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-11 15:37:10,130 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['9782d6ddedfb582a0015827af60e5a0bb9852cf2d3b7df35e6c4b1cc']}
2015-08-11 15:37:10,130 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 15:37:10,130 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 15:37:10,132 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=hztSRpk0eWi1vIA5&code=c8CQ7C9rpSo9%2BmZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S%2BypwJoWXD1CeE7HsDI0UD0LR78Di2WQqy1YdQoUC%2F5tozuATH0%3D' (<type 'str'>)
2015-08-11 15:37:10,141 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10ebec690>
2015-08-11 15:37:10,141 oic.oic.provider:DEBUG - token -
2015-08-11 15:37:10,142 oic.oic.provider:INFO token_request: code=c8CQ7C9rpSo9%2BmZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S%2BypwJoWXD1CeE7HsDI0UD0LR78Di2WQqy1YdQoUC%2F5tozuATH0%3D&client_secret=09110a4fc165e0af876cfbf9c01360ea7b2ac2c31a950c6187b293c8&grant_type=authorization_code&client_id=5Q3jVyeWrVIb&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-11 15:37:10,142 oic.oic.provider:DEBUG AccessTokenRequest: {u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_secret': u'09110a4fc165e0af876cfbf9c01360ea7b2ac2c31a950c6187b293c8', u'code': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWXD1CeE7HsDI0UD0LR78Di2WQqy1YdQoUC/5tozuATH0=', u'client_id': u'5Q3jVyeWrVIb', 'grant_type': u'authorization_code'}
2015-08-11 15:37:10,142 oic.utils.authn.client:DEBUG REQ: {u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_secret': u'09110a4fc165e0af876cfbf9c01360ea7b2ac2c31a950c6187b293c8', u'code': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWXD1CeE7HsDI0UD0LR78Di2WQqy1YdQoUC/5tozuATH0=', u'client_id': u'5Q3jVyeWrVIb', 'grant_type': u'authorization_code'}
2015-08-11 15:37:10,143 oic.utils.authn.client:DEBUG Verified Client ID: 5Q3jVyeWrVIb
2015-08-11 15:37:10,146 oic.oic.provider:DEBUG All checks OK
2015-08-11 15:37:10,147 oic.oic:DEBUG authzreq: {'nonce': u'ASMQbXsLntXU7QOh', 'acr_values': u'SAML', 'state': u'hztSRpk0eWi1vIA5', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'5Q3jVyeWrVIb', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-11 15:37:10,147 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 15:37:10,147 oic.oic:DEBUG authzreq: {'nonce': u'ASMQbXsLntXU7QOh', 'acr_values': u'SAML', 'state': u'hztSRpk0eWi1vIA5', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'5Q3jVyeWrVIb', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-11 15:37:10,147 oic.oic.provider:DEBUG id_token: {'nonce': 'ASMQbXsLntXU7QOh', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439379430, 'auth_time': 1439300230, 'iat': 1439300230, 'aud': ['5Q3jVyeWrVIb']}
2015-08-11 15:37:10,149 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-11 15:37:10,149 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "XnG08dmE2zrJam5B578i_9g8j2hBMnuuZy2Ph5CxlUI", "x": "JX-x3jmoHO_c8igKmhooeglK4ZMeAwovv8bvfnCsqmY", "kid": "op2"}]}
2015-08-11 15:37:10,149 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "O_3XvwfSQWIpS3EEv7MxZKE4tqfR49UiNbjTYrdt5vA", "x": "ypIX68Lkb_z90ijho0kaw1qR9zoFEzZhNqAgxFaZu8c", "kid": "op3"}]}
2015-08-11 15:37:10,149 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ed667d0>]
2015-08-11 15:37:10,156 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 15:37:10,156 oic.oic.provider:DEBUG _tinfo: {'nonce': 'ASMQbXsLntXU7QOh', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1115ed450>, 'code': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWXD1CeE7HsDI0UD0LR78Di2WQqy1YdQoUC/5tozuATH0=', 'authzreq': '{"nonce": "ASMQbXsLntXU7QOh", "acr_values": "SAML", "state": "hztSRpk0eWi1vIA5", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "5Q3jVyeWrVIb", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWHx1HU9nRLeg37acKJ8c8/EaoFb0BaxeQlLw8Ou31cZk=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJBU01RYlhzTG50WFU3UU9oIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTM3OTQzMCwgImF1dGhfdGltZSI6IDE0MzkzMDAyMzAsICJpYXQiOiAxNDM5MzAwMjMwLCAiYXVkIjogWyI1UTNqVnllV3JWSWIiXX0.LK1z1dduVLncNfHWDVJHv9SpBxkmnaC1gGsFEj5LmJhcQc0jo6sbbsSb1PPrMbF0s_HuA9lhjcMM-wPRjVvuRuC5e-vY_m_P7zAVvS8fupdEl6aZOkVZGdxPvfEYfPtzR0jPueBAclQojOWG-ptFge-oxf-Vd1in7tOBxmsKgIvww6gFPbBEikBaSW2bTP2bzmIEI6Hd0SaFf05SSL4y16JYPl2lm-2IoDJE3Mcw0-shave1q0VpDV9_nh_TyIHttf1Ac4GTVoH_JfPKSo41XF2E7Lv6gj1TtJwGH_CkxKh5vw6AamTjJ9OYkD4pC25_N9zwmaSgpz9l2EouSC096A', 'token_expires_at': 1439300230, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'hztSRpk0eWi1vIA5', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': '5Q3jVyeWrVIb', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWqR1tVsfOSpbz+Mlmbb2DYxKjIiixGFgNd9mgsHOrIf4=', 'sub': '-fdfb4a841dce167'}
2015-08-11 15:37:10,157 oic.oic.provider:DEBUG access_token_response: {'access_token': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWHx1HU9nRLeg37acKJ8c8/EaoFb0BaxeQlLw8Ou31cZk=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJBU01RYlhzTG50WFU3UU9oIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTM3OTQzMCwgImF1dGhfdGltZSI6IDE0MzkzMDAyMzAsICJpYXQiOiAxNDM5MzAwMjMwLCAiYXVkIjogWyI1UTNqVnllV3JWSWIiXX0.LK1z1dduVLncNfHWDVJHv9SpBxkmnaC1gGsFEj5LmJhcQc0jo6sbbsSb1PPrMbF0s_HuA9lhjcMM-wPRjVvuRuC5e-vY_m_P7zAVvS8fupdEl6aZOkVZGdxPvfEYfPtzR0jPueBAclQojOWG-ptFge-oxf-Vd1in7tOBxmsKgIvww6gFPbBEikBaSW2bTP2bzmIEI6Hd0SaFf05SSL4y16JYPl2lm-2IoDJE3Mcw0-shave1q0VpDV9_nh_TyIHttf1Ac4GTVoH_JfPKSo41XF2E7Lv6gj1TtJwGH_CkxKh5vw6AamTjJ9OYkD4pC25_N9zwmaSgpz9l2EouSC096A', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'hztSRpk0eWi1vIA5', 'scope': 'openid profile email address phone', 'refresh_token': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWqR1tVsfOSpbz+Mlmbb2DYxKjIiixGFgNd9mgsHOrIf4='}
2015-08-11 15:37:10,163 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 15:37:10,176 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10ebec6d0>
2015-08-11 15:37:10,176 oic.oic:DEBUG verify keys: None
2015-08-11 15:37:10,176 oic.oic.provider:DEBUG user_info_request: {u'access_token': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWHx1HU9nRLeg37acKJ8c8/EaoFb0BaxeQlLw8Ou31cZk='}
2015-08-11 15:37:10,176 oicServer:DEBUG access_token type: 'T'
2015-08-11 15:37:10,177 oic.oic:DEBUG authzreq: {'nonce': u'ASMQbXsLntXU7QOh', 'acr_values': u'SAML', 'state': u'hztSRpk0eWi1vIA5', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'5Q3jVyeWrVIb', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-11 15:37:10,177 oic.oic.provider:DEBUG userinfo_claim: {'profile': None, 'family_name': None, 'gender': None, 'middle_name': None, 'sub': None, 'phone_number_verified': None, 'picture': None, 'locale': None, 'email_verified': None, 'zoneinfo': None, 'preferred_username': None, 'updated_at': None, 'birthdate': None, 'website': None, 'nickname': None, 'given_name': None, 'address': None, 'phone_number': None, 'email': None, 'name': None}
2015-08-11 15:37:10,177 oic.oic.provider:DEBUG Session info: {'nonce': 'ASMQbXsLntXU7QOh', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1115ed450>, 'code': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWXD1CeE7HsDI0UD0LR78Di2WQqy1YdQoUC/5tozuATH0=', 'authzreq': '{"nonce": "ASMQbXsLntXU7QOh", "acr_values": "SAML", "state": "hztSRpk0eWi1vIA5", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "5Q3jVyeWrVIb", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWHx1HU9nRLeg37acKJ8c8/EaoFb0BaxeQlLw8Ou31cZk=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJBU01RYlhzTG50WFU3UU9oIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTM3OTQzMCwgImF1dGhfdGltZSI6IDE0MzkzMDAyMzAsICJpYXQiOiAxNDM5MzAwMjMwLCAiYXVkIjogWyI1UTNqVnllV3JWSWIiXX0.LK1z1dduVLncNfHWDVJHv9SpBxkmnaC1gGsFEj5LmJhcQc0jo6sbbsSb1PPrMbF0s_HuA9lhjcMM-wPRjVvuRuC5e-vY_m_P7zAVvS8fupdEl6aZOkVZGdxPvfEYfPtzR0jPueBAclQojOWG-ptFge-oxf-Vd1in7tOBxmsKgIvww6gFPbBEikBaSW2bTP2bzmIEI6Hd0SaFf05SSL4y16JYPl2lm-2IoDJE3Mcw0-shave1q0VpDV9_nh_TyIHttf1Ac4GTVoH_JfPKSo41XF2E7Lv6gj1TtJwGH_CkxKh5vw6AamTjJ9OYkD4pC25_N9zwmaSgpz9l2EouSC096A', 'token_expires_at': 1439300230, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'hztSRpk0eWi1vIA5', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': '5Q3jVyeWrVIb', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'c8CQ7C9rpSo9+mZcCXM8VgHC60CMwja7pNaZafgGvmObQJMganEHOUK0S+ypwJoWqR1tVsfOSpbz+Mlmbb2DYxKjIiixGFgNd9mgsHOrIf4=', 'sub': '-fdfb4a841dce167'}
2015-08-11 15:37:10,177 oic.oic.provider:DEBUG user_info_response: {'phone_number': '+46 90 7865000', 'family_name': 'Krall', 'sub': '-fdfb4a841dce167', 'email_verified': False, 'given_name': 'Diana', 'address': {'country': 'Sweden', 'postal_code': 'SE-90187', 'street_address': 'Ume\xc3\xa5 Universitet', 'locality': 'Ume\xc3\xa5'}, 'nickname': 'Dina', 'email': 'diana@example.org', 'name': 'Diana Krall'}
2015-08-11 15:37:30,766 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc"}, {"kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig"}]}
2015-08-11 15:37:30,766 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op2", "x": "6WDuwfqxqYqazMWLkktfpScX8klMXvRjwl1bOsIEnjw", "y": "iQ3wdEo1r-UsFQftyFxV42g9aSR5l-JwPM5EHTEl8Q8", "use": "sig"}]}
2015-08-11 15:37:30,766 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op3", "x": "cxz8-EQtUEcn3364Y1Wzk6Mu7Au48zEaDnrrGCghYvQ", "y": "GHV-nbxvAQ_GOnbTNtm02VUKcddiAhiITSLxIhombtk", "use": "enc"}]}
2015-08-11 15:37:30,766 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 15:37:37,374 oicServer:INFO callback: <function webfinger at 0x104231e18>
2015-08-11 15:37:37,384 oicServer:INFO callback: <function op_info at 0x104231a60>
2015-08-11 15:37:37,385 root:INFO op_info
2015-08-11 15:37:37,385 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 15:37:37,385 oic.oic.provider:INFO provider_info_response: {'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_uri_parameter_supported': True, 'version': '3.0', 'acr_values_supported': ['PASSWORD'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'id_token_signing_alg_values_supported': ['HS256', 'RS512', 'PS521', 'ES512', 'PS256', 'HS512', 'none', 'ES256', 'ES384', 'RS256', 'HS384', 'RS384', 'PS384'], 'userinfo_signing_alg_values_supported': ['HS256', 'RS512', 'PS521', 'ES512', 'PS256', 'HS512', 'none', 'ES256', 'ES384', 'RS256', 'HS384', 'RS384', 'PS384'], 'require_request_uri_registration': True, 'end_session_endpoint': 'https://localhost:8092/end_session', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_parameter_supported': True, 'scopes_supported': ['openid', 'profile', 'offline_access', 'email', 'address', 'phone', 'openid'], 'subject_types_supported': ['public', 'pairwise'], 'issuer': 'https://localhost:8092/', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'claims_supported': ['address', 'phone_number', 'website', 'zoneinfo', 'name', 'profile', 'locale', 'phone_number_verified', 'picture', 'gender', 'given_name', 'nickname', 'birthdate', 'family_name', 'email', 'preferred_username', 'sub', 'middle_name', 'updated_at', 'email_verified'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'RS512', 'PS521', 'ES512', 'PS256', 'HS512', 'ES256', 'ES384', 'RS256', 'HS384', 'RS384', 'PS384'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'token_endpoint': 'https://localhost:8092/token', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_signing_alg_values_supported': ['HS256', 'RS512', 'PS521', 'ES512', 'PS256', 'HS512', 'none', 'ES256', 'ES384', 'RS256', 'HS384', 'RS384', 'PS384'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-11 15:37:37,431 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10422d320>
2015-08-11 15:37:37,431 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"]}>>
2015-08-11 15:37:37,432 oic.oic.provider:INFO registration_request:{'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-11 15:37:37,437 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439296657, 'client_secret': 'fe75eec1dd826e2f9b3db52bcf318e0bfd71aab1f29c94f3d6c4567c', 'client_id': 'uF0tnErWXH4w', 'registration_access_token': '33SMeQR7vZ0AQ94aCkke1Njbj6ayiWZH', 'registration_client_uri': 'https://localhost:8092/registration?client_id=uF0tnErWXH4w', 'client_secret_expires_at': 1439383057}
2015-08-11 15:37:37,437 oic.utils.keyio:DEBUG loading keys for issuer: uF0tnErWXH4w
2015-08-11 15:37:37,438 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-11 15:37:37,438 oic.oic.provider:DEBUG keys for uF0tnErWXH4w: []
2015-08-11 15:37:37,439 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439296657, 'client_secret': 'fe75eec1dd826e2f9b3db52bcf318e0bfd71aab1f29c94f3d6c4567c', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'contacts': ['ops@example.com'], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'application_type': 'web', 'client_id': 'uF0tnErWXH4w', 'response_types': ['code'], 'registration_access_token': '33SMeQR7vZ0AQ94aCkke1Njbj6ayiWZH', 'registration_client_uri': 'https://localhost:8092/registration?client_id=uF0tnErWXH4w', 'client_secret_expires_at': 1439383057}
2015-08-11 15:37:37,439 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439296657, 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_secret': 'fe75eec1dd826e2f9b3db52bcf318e0bfd71aab1f29c94f3d6c4567c', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'client_id': 'uF0tnErWXH4w', 'response_types': ['code'], 'registration_access_token': '33SMeQR7vZ0AQ94aCkke1Njbj6ayiWZH', 'registration_client_uri': 'https://localhost:8092/registration?client_id=uF0tnErWXH4w', 'client_secret_expires_at': 1439383057}
2015-08-11 15:37:37,450 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x104198da0>
2015-08-11 15:37:37,450 oic.oauth2.provider:DEBUG Request: 'state=tt6uQLsxb7aSI3lH&nonce=oF9x8ZBIUV7smTb9&scope=openid+profile+email+address+phone&client_id=uF0tnErWXH4w&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code'
2015-08-11 15:37:37,450 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1045799e8>, <jwkest.jwk.RSAKey object at 0x104553dd8>, <jwkest.jwk.ECKey object at 0x104556198>]
2015-08-11 15:37:37,450 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'nonce': 'oF9x8ZBIUV7smTb9', 'acr_values': 'SAML', 'state': 'tt6uQLsxb7aSI3lH', 'client_id': 'uF0tnErWXH4w', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:37,452 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'nonce': 'oF9x8ZBIUV7smTb9', 'acr_values': 'SAML', 'state': 'tt6uQLsxb7aSI3lH', 'client_id': 'uF0tnErWXH4w', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:37,454 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:37,454 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:37,454 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 15:37:37,454 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:37:37,454 oic.utils.authn.user:INFO do_authentication argv: {'title': 'User log in', 'login': '', 'passwd_title': 'Password', 'acr': ['SAML'], 'client_policy_title': 'Client Policy', 'password': '', 'tos_uri': '', 'submit_text': 'Submit', 'policy_uri': '', 'login_title': 'Username', 'query': 'state=tt6uQLsxb7aSI3lH&nonce=oF9x8ZBIUV7smTb9&scope=openid+profile+email+address+phone&client_id=uF0tnErWXH4w&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code', 'action': 'https://localhost:8092/verify', 'logo_uri': ''}
2015-08-11 15:37:37,472 oicServer:INFO callback: <function css at 0x1041a4268>
2015-08-11 15:37:43,017 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x1043d0f28>
2015-08-11 15:37:43,017 oic.utils.authn.user:DEBUG verify(query=state%3Dtt6uQLsxb7aSI3lH%26nonce%3DoF9x8ZBIUV7smTb9%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DuF0tnErWXH4w%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26acr_values%3DSAML%26response_type%3Dcode&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 15:37:43,017 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'login': ['diana'], 'password': ['krall'], 'acr_values': ["['SAML']"], 'query': ['state=tt6uQLsxb7aSI3lH&nonce=oF9x8ZBIUV7smTb9&scope=openid+profile+email+address+phone&client_id=uF0tnErWXH4w&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code']}
2015-08-11 15:37:43,017 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'babs': 'howes', 'diana': 'krall'}
2015-08-11 15:37:43,017 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'nonce': ['oF9x8ZBIUV7smTb9'], 'acr_values': ['SAML'], 'state': ['tt6uQLsxb7aSI3lH'], 'upm_answer': 'true', 'client_id': ['uF0tnErWXH4w'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone']}
2015-08-11 15:37:43,042 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x104198da0>
2015-08-11 15:37:43,042 oic.oauth2.provider:DEBUG Request: 'response_type=code&nonce=oF9x8ZBIUV7smTb9&acr_values=SAML&state=tt6uQLsxb7aSI3lH&upm_answer=true&client_id=uF0tnErWXH4w&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone'
2015-08-11 15:37:43,042 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1045799e8>, <jwkest.jwk.RSAKey object at 0x104553dd8>, <jwkest.jwk.ECKey object at 0x104556198>]
2015-08-11 15:37:43,042 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'nonce': 'oF9x8ZBIUV7smTb9', 'acr_values': 'SAML', 'state': 'tt6uQLsxb7aSI3lH', 'upm_answer': 'true', 'client_id': 'uF0tnErWXH4w', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:43,043 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'nonce': 'oF9x8ZBIUV7smTb9', 'acr_values': 'SAML', 'state': 'tt6uQLsxb7aSI3lH', 'upm_answer': 'true', 'client_id': 'uF0tnErWXH4w', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:43,045 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:43,045 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:37:43,046 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 15:37:43,046 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:37:43,046 oic.oic.provider:DEBUG - authenticated -
2015-08-11 15:37:43,047 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'nonce', 'acr_values', 'state', 'upm_answer', 'client_id', 'redirect_uri', 'scope']
2015-08-11 15:37:43,047 oic.utils.sdb:DEBUG uid2sid: {'diana': ['4c6416db7a9cb0c97e455559910576be0418bcd247546bc53ef5312d']}
2015-08-11 15:37:43,047 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 15:37:43,047 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 15:37:43,049 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=IFI%2FnZdG%2FVnBLJRd%2Bq6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HQQl88j0H5vd220B8H4%2BZELfEteAiVFw2fXARvPA7ocg%3D&state=tt6uQLsxb7aSI3lH&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 15:37:43,059 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10422d2b0>
2015-08-11 15:37:43,060 oic.oic.provider:DEBUG - token -
2015-08-11 15:37:43,060 oic.oic.provider:INFO token_request: client_secret=fe75eec1dd826e2f9b3db52bcf318e0bfd71aab1f29c94f3d6c4567c&code=IFI%2FnZdG%2FVnBLJRd%2Bq6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HQQl88j0H5vd220B8H4%2BZELfEteAiVFw2fXARvPA7ocg%3D&client_id=uF0tnErWXH4w&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&grant_type=authorization_code
2015-08-11 15:37:43,060 oic.oic.provider:DEBUG AccessTokenRequest: {'client_id': 'uF0tnErWXH4w', 'grant_type': 'authorization_code', 'code': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HQQl88j0H5vd220B8H4+ZELfEteAiVFw2fXARvPA7ocg=', 'client_secret': 'fe75eec1dd826e2f9b3db52bcf318e0bfd71aab1f29c94f3d6c4567c', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-11 15:37:43,060 oic.utils.authn.client:DEBUG REQ: {'client_id': 'uF0tnErWXH4w', 'grant_type': 'authorization_code', 'code': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HQQl88j0H5vd220B8H4+ZELfEteAiVFw2fXARvPA7ocg=', 'client_secret': 'fe75eec1dd826e2f9b3db52bcf318e0bfd71aab1f29c94f3d6c4567c', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-11 15:37:43,061 oic.utils.authn.client:DEBUG Verified Client ID: uF0tnErWXH4w
2015-08-11 15:37:43,066 oic.oic.provider:DEBUG All checks OK
2015-08-11 15:37:43,067 oic.oic:DEBUG authzreq: {'response_type': 'code', 'nonce': 'oF9x8ZBIUV7smTb9', 'acr_values': 'SAML', 'state': 'tt6uQLsxb7aSI3lH', 'upm_answer': 'true', 'client_id': 'uF0tnErWXH4w', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:43,067 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 15:37:43,067 oic.oic:DEBUG authzreq: {'response_type': 'code', 'nonce': 'oF9x8ZBIUV7smTb9', 'acr_values': 'SAML', 'state': 'tt6uQLsxb7aSI3lH', 'upm_answer': 'true', 'client_id': 'uF0tnErWXH4w', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:43,067 oic.oic.provider:DEBUG id_token: {'iat': 1439300263, 'auth_time': 1439300263, 'nonce': 'oF9x8ZBIUV7smTb9', 'exp': 1439379463, 'aud': ['uF0tnErWXH4w'], 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'sub': '-5d59b8a144f87169'}
2015-08-11 15:37:43,068 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc"}, {"kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig"}]}
2015-08-11 15:37:43,069 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op2", "x": "6WDuwfqxqYqazMWLkktfpScX8klMXvRjwl1bOsIEnjw", "y": "iQ3wdEo1r-UsFQftyFxV42g9aSR5l-JwPM5EHTEl8Q8", "use": "sig"}]}
2015-08-11 15:37:43,069 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op3", "x": "cxz8-EQtUEcn3364Y1Wzk6Mu7Au48zEaDnrrGCghYvQ", "y": "GHV-nbxvAQ_GOnbTNtm02VUKcddiAhiITSLxIhombtk", "use": "enc"}]}
2015-08-11 15:37:43,069 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104553dd8>]
2015-08-11 15:37:43,074 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 15:37:43,075 oic.oic.provider:DEBUG _tinfo: {'nonce': 'oF9x8ZBIUV7smTb9', 'oauth_state': 'token', 'state': 'tt6uQLsxb7aSI3lH', 'token_type': 'Bearer', 'code_used': True, 'client_id': 'uF0tnErWXH4w', 'expires_in': 3600, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5MzAwMjYzLCAiYXV0aF90aW1lIjogMTQzOTMwMDI2MywgIm5vbmNlIjogIm9GOXg4WkJJVVY3c21UYjkiLCAiZXhwIjogMTQzOTM3OTQ2MywgImF1ZCI6IFsidUYwdG5FcldYSDR3Il0sICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICItNWQ1OWI4YTE0NGY4NzE2OSJ9.qa2wF6SdGUSNUyGY0QBDhgQnljUYSt9_jo1nApGaZc_jy_-LHzvtswEBYFJVZVzq5bV3Bmg2JcvTJUr_1dThkUaLj1MZ2Sn14nBwT-sdpfnp2Qn4sYZP4SzzCOz_Etf-x7p0hrdV0pc4NtNzEI7ua2YckIn0AUjas-6W7SHuQHODSyaZB_SyFcLhwD1QFN6gmTIaK3KKedcPpK5VpU8G-1hvmUIfvSwMGG6yYnXFcji5o9F2kEItQiW5iT1xps67NR3juNiIkw-u08qJbgc4HRVx4W0FrpZmahcZyCaz0lMvmcg1u-y1Zx7rInkDKSg7qr41UIFWYn1DRPaf6iXCwA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'permission': '', 'token_expires_at': 1439300263, 'code': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HQQl88j0H5vd220B8H4+ZELfEteAiVFw2fXARvPA7ocg=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1064717f0>, 'access_token': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HcpxVzYLasMZb3hyU0fB3b4dFhUQbh9ZnLy1BWzb4xAQ=', 'refresh_token': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HdZFmimkg2mIIMeX7+jq1iH+WvF9+0TX4T0WKZ825Zdo=', 'authzreq': '{"response_type": "code", "nonce": "oF9x8ZBIUV7smTb9", "acr_values": "SAML", "state": "tt6uQLsxb7aSI3lH", "upm_answer": "true", "client_id": "uF0tnErWXH4w", "redirect_uri": "http://localhost:8666/authz_cb", "scope": "openid profile email address phone"}', 'revoked': False, 'access_token_scope': '?', 'sub': '-5d59b8a144f87169', 'scope': ['openid', 'profile', 'email', 'address', 'phone']}
2015-08-11 15:37:43,075 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'state': 'tt6uQLsxb7aSI3lH', 'access_token': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HcpxVzYLasMZb3hyU0fB3b4dFhUQbh9ZnLy1BWzb4xAQ=', 'token_type': 'Bearer', 'refresh_token': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HdZFmimkg2mIIMeX7+jq1iH+WvF9+0TX4T0WKZ825Zdo=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5MzAwMjYzLCAiYXV0aF90aW1lIjogMTQzOTMwMDI2MywgIm5vbmNlIjogIm9GOXg4WkJJVVY3c21UYjkiLCAiZXhwIjogMTQzOTM3OTQ2MywgImF1ZCI6IFsidUYwdG5FcldYSDR3Il0sICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICItNWQ1OWI4YTE0NGY4NzE2OSJ9.qa2wF6SdGUSNUyGY0QBDhgQnljUYSt9_jo1nApGaZc_jy_-LHzvtswEBYFJVZVzq5bV3Bmg2JcvTJUr_1dThkUaLj1MZ2Sn14nBwT-sdpfnp2Qn4sYZP4SzzCOz_Etf-x7p0hrdV0pc4NtNzEI7ua2YckIn0AUjas-6W7SHuQHODSyaZB_SyFcLhwD1QFN6gmTIaK3KKedcPpK5VpU8G-1hvmUIfvSwMGG6yYnXFcji5o9F2kEItQiW5iT1xps67NR3juNiIkw-u08qJbgc4HRVx4W0FrpZmahcZyCaz0lMvmcg1u-y1Zx7rInkDKSg7qr41UIFWYn1DRPaf6iXCwA', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:43,085 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 15:37:43,096 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10422d2e8>
2015-08-11 15:37:43,096 oic.oic:DEBUG verify keys: None
2015-08-11 15:37:43,096 oic.oic.provider:DEBUG user_info_request: {'access_token': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HcpxVzYLasMZb3hyU0fB3b4dFhUQbh9ZnLy1BWzb4xAQ='}
2015-08-11 15:37:43,096 oicServer:DEBUG access_token type: 'T'
2015-08-11 15:37:43,097 oic.oic:DEBUG authzreq: {'response_type': 'code', 'nonce': 'oF9x8ZBIUV7smTb9', 'acr_values': 'SAML', 'state': 'tt6uQLsxb7aSI3lH', 'upm_answer': 'true', 'client_id': 'uF0tnErWXH4w', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:37:43,097 oic.oic.provider:DEBUG userinfo_claim: {'website': None, 'zoneinfo': None, 'name': None, 'locale': None, 'middle_name': None, 'phone_number_verified': None, 'picture': None, 'gender': None, 'given_name': None, 'nickname': None, 'sub': None, 'profile': None, 'birthdate': None, 'family_name': None, 'email': None, 'preferred_username': None, 'address': None, 'email_verified': None, 'updated_at': None, 'phone_number': None}
2015-08-11 15:37:43,097 oic.oic.provider:DEBUG Session info: {'nonce': 'oF9x8ZBIUV7smTb9', 'oauth_state': 'token', 'state': 'tt6uQLsxb7aSI3lH', 'token_type': 'Bearer', 'code_used': True, 'client_id': 'uF0tnErWXH4w', 'expires_in': 3600, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5MzAwMjYzLCAiYXV0aF90aW1lIjogMTQzOTMwMDI2MywgIm5vbmNlIjogIm9GOXg4WkJJVVY3c21UYjkiLCAiZXhwIjogMTQzOTM3OTQ2MywgImF1ZCI6IFsidUYwdG5FcldYSDR3Il0sICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICItNWQ1OWI4YTE0NGY4NzE2OSJ9.qa2wF6SdGUSNUyGY0QBDhgQnljUYSt9_jo1nApGaZc_jy_-LHzvtswEBYFJVZVzq5bV3Bmg2JcvTJUr_1dThkUaLj1MZ2Sn14nBwT-sdpfnp2Qn4sYZP4SzzCOz_Etf-x7p0hrdV0pc4NtNzEI7ua2YckIn0AUjas-6W7SHuQHODSyaZB_SyFcLhwD1QFN6gmTIaK3KKedcPpK5VpU8G-1hvmUIfvSwMGG6yYnXFcji5o9F2kEItQiW5iT1xps67NR3juNiIkw-u08qJbgc4HRVx4W0FrpZmahcZyCaz0lMvmcg1u-y1Zx7rInkDKSg7qr41UIFWYn1DRPaf6iXCwA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'permission': '', 'token_expires_at': 1439300263, 'code': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HQQl88j0H5vd220B8H4+ZELfEteAiVFw2fXARvPA7ocg=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1064717f0>, 'access_token': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HcpxVzYLasMZb3hyU0fB3b4dFhUQbh9ZnLy1BWzb4xAQ=', 'refresh_token': 'IFI/nZdG/VnBLJRd+q6qunmBZM95wskEUBMBVJAX86oCjOapTR1kFi7ljVrENX8HdZFmimkg2mIIMeX7+jq1iH+WvF9+0TX4T0WKZ825Zdo=', 'authzreq': '{"response_type": "code", "nonce": "oF9x8ZBIUV7smTb9", "acr_values": "SAML", "state": "tt6uQLsxb7aSI3lH", "upm_answer": "true", "client_id": "uF0tnErWXH4w", "redirect_uri": "http://localhost:8666/authz_cb", "scope": "openid profile email address phone"}', 'revoked': False, 'access_token_scope': '?', 'sub': '-5d59b8a144f87169', 'scope': ['openid', 'profile', 'email', 'address', 'phone']}
2015-08-11 15:37:43,097 oic.oic.provider:DEBUG user_info_response: {'given_name': 'Diana', 'nickname': 'Dina', 'name': 'Diana Krall', 'family_name': 'Krall', 'sub': '-5d59b8a144f87169', 'email': 'diana@example.org', 'address': {'street_address': 'Ume Universitet', 'locality': 'Ume', 'country': 'Sweden', 'postal_code': 'SE-90187'}, 'email_verified': False, 'phone_number': '+46 90 7865000'}
2015-08-11 15:38:17,973 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-11 15:38:17,973 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "crv": "P-256", "y": "FOLT1as-YZh4Kn75wZq2ABjiiKM13PwWgIJKIWgwXpw", "x": "_Nm0joy8ojc86ZCGu3DI2M4yN-5Mv0OpADsY1VsQsf4", "kid": "op2"}]}
2015-08-11 15:38:17,974 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "crv": "P-256", "y": "rnkr9vkMvknvsz7oySB2u4oL1v_fM3Gx8OAtUSMCoDA", "x": "DV0gzGK_c6qXa7eBdQUF9Ade8zdsTHmhRqUdw7VYu7w", "kid": "op3"}]}
2015-08-11 15:38:17,974 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 15:38:25,345 oicServer:INFO callback: <function webfinger at 0x10443ae18>
2015-08-11 15:38:25,357 oicServer:INFO callback: <function op_info at 0x10443aa60>
2015-08-11 15:38:25,357 root:INFO op_info
2015-08-11 15:38:25,357 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 15:38:25,357 oic.oic.provider:INFO provider_info_response: {'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_uri_parameter_supported': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint_auth_signing_alg_values_supported': ['ES384', 'ES256', 'PS384', 'PS521', 'RS512', 'HS512', 'HS384', 'RS384', 'HS256', 'PS256', 'RS256', 'ES512'], 'userinfo_signing_alg_values_supported': ['none', 'ES384', 'ES256', 'PS384', 'PS521', 'RS512', 'HS512', 'HS384', 'RS384', 'HS256', 'PS256', 'RS256', 'ES512'], 'acr_values_supported': ['PASSWORD'], 'claims_supported': ['gender', 'phone_number', 'email', 'website', 'address', 'profile', 'updated_at', 'phone_number_verified', 'given_name', 'picture', 'preferred_username', 'family_name', 'nickname', 'birthdate', 'zoneinfo', 'sub', 'name', 'middle_name', 'locale', 'email_verified'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['none', 'ES384', 'ES256', 'PS384', 'PS521', 'RS512', 'HS512', 'HS384', 'RS384', 'HS256', 'PS256', 'RS256', 'ES512'], 'version': '3.0', 'claims_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'registration_endpoint': 'https://localhost:8092/registration', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'scopes_supported': ['address', 'email', 'openid', 'profile', 'offline_access', 'phone', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'issuer': 'https://localhost:8092/', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_object_signing_alg_values_supported': ['none', 'ES384', 'ES256', 'PS384', 'PS521', 'RS512', 'HS512', 'HS384', 'RS384', 'HS256', 'PS256', 'RS256', 'ES512'], 'subject_types_supported': ['public', 'pairwise']}
2015-08-11 15:38:25,391 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1044362b0>
2015-08-11 15:38:25,391 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "application_type": "web", "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-11 15:38:25,392 oic.oic.provider:INFO registration_request:{'response_types': ['code'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com']}
2015-08-11 15:38:25,397 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439296705, 'registration_access_token': 'CnBTY9XFWeel59MMPNE9sLxDTXbiLWFJ', 'client_secret': 'c0a7171693afb2d1cf3910bed81282304433758bda813e0de2155640', 'registration_client_uri': 'https://localhost:8092/registration?client_id=AYWO4CaJwTTi', 'client_secret_expires_at': 1439383105, 'client_id': 'AYWO4CaJwTTi'}
2015-08-11 15:38:25,398 oic.utils.keyio:DEBUG loading keys for issuer: AYWO4CaJwTTi
2015-08-11 15:38:25,398 oic.utils.keyio:DEBUG pcr: {'response_types': ['code'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com']}
2015-08-11 15:38:25,399 oic.oic.provider:DEBUG keys for AYWO4CaJwTTi: []
2015-08-11 15:38:25,401 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'client_id_issued_at': 1439296705, 'registration_access_token': 'CnBTY9XFWeel59MMPNE9sLxDTXbiLWFJ', 'client_secret': 'c0a7171693afb2d1cf3910bed81282304433758bda813e0de2155640', 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=AYWO4CaJwTTi', 'response_types': ['code'], 'client_secret_expires_at': 1439383105, 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id': 'AYWO4CaJwTTi', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)]}
2015-08-11 15:38:25,402 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439296705, 'registration_client_uri': 'https://localhost:8092/registration?client_id=AYWO4CaJwTTi', 'client_secret_expires_at': 1439383105, 'client_secret': 'c0a7171693afb2d1cf3910bed81282304433758bda813e0de2155640', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'registration_access_token': 'CnBTY9XFWeel59MMPNE9sLxDTXbiLWFJ', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'client_id': 'AYWO4CaJwTTi', 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-11 15:38:25,409 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10419fd30>
2015-08-11 15:38:25,410 oic.oauth2.provider:DEBUG Request: 'nonce=A6aPZuIY7pbV5z6b&scope=openid+profile+email+address+phone&response_type=code&acr_values=SAML&client_id=AYWO4CaJwTTi&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=9FFONnygZEpXKZS6'
2015-08-11 15:38:25,410 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10467a908>, <jwkest.jwk.RSAKey object at 0x104653cf8>, <jwkest.jwk.ECKey object at 0x104658198>]
2015-08-11 15:38:25,410 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'nonce': 'A6aPZuIY7pbV5z6b', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'state': '9FFONnygZEpXKZS6', 'response_type': 'code'}
2015-08-11 15:38:25,412 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'nonce': 'A6aPZuIY7pbV5z6b', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'state': '9FFONnygZEpXKZS6', 'response_type': 'code'}
2015-08-11 15:38:25,413 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:38:25,413 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:38:25,413 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 15:38:25,414 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:38:25,414 oic.utils.authn.user:INFO do_authentication argv: {'client_policy_title': 'Client Policy', 'password': '', 'title': 'User log in', 'logo_uri': '', 'acr': ['SAML'], 'passwd_title': 'Password', 'submit_text': 'Submit', 'action': 'https://localhost:8092/verify', 'query': 'nonce=A6aPZuIY7pbV5z6b&scope=openid+profile+email+address+phone&response_type=code&acr_values=SAML&client_id=AYWO4CaJwTTi&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=9FFONnygZEpXKZS6', 'login_title': 'Username', 'tos_uri': '', 'login': '', 'policy_uri': ''}
2015-08-11 15:38:25,449 oicServer:INFO callback: <function css at 0x1041ab268>
2015-08-11 15:38:31,627 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x1045d9f28>
2015-08-11 15:38:31,627 oic.utils.authn.user:DEBUG verify(query=nonce%3DA6aPZuIY7pbV5z6b%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26acr_values%3DSAML%26client_id%3DAYWO4CaJwTTi%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26state%3D9FFONnygZEpXKZS6&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 15:38:31,628 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['SAML']"], 'password': ['krall'], 'form.commit': ['Submit'], 'query': ['nonce=A6aPZuIY7pbV5z6b&scope=openid+profile+email+address+phone&response_type=code&acr_values=SAML&client_id=AYWO4CaJwTTi&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=9FFONnygZEpXKZS6'], 'login': ['diana']}
2015-08-11 15:38:31,628 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-11 15:38:31,628 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'nonce': ['A6aPZuIY7pbV5z6b'], 'scope': ['openid profile email address phone'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'client_id': ['AYWO4CaJwTTi'], 'response_type': ['code'], 'state': ['9FFONnygZEpXKZS6'], 'upm_answer': 'true'}
2015-08-11 15:38:31,650 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10419fd30>
2015-08-11 15:38:31,651 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&nonce=A6aPZuIY7pbV5z6b&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=AYWO4CaJwTTi&response_type=code&state=9FFONnygZEpXKZS6&upm_answer=true'
2015-08-11 15:38:31,651 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10467a908>, <jwkest.jwk.RSAKey object at 0x104653cf8>, <jwkest.jwk.ECKey object at 0x104658198>]
2015-08-11 15:38:31,651 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'A6aPZuIY7pbV5z6b', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'state': '9FFONnygZEpXKZS6', 'response_type': 'code'}
2015-08-11 15:38:31,652 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'A6aPZuIY7pbV5z6b', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'state': '9FFONnygZEpXKZS6', 'response_type': 'code'}
2015-08-11 15:38:31,653 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:38:31,653 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:38:31,654 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 15:38:31,654 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:38:31,654 oic.oic.provider:DEBUG - authenticated -
2015-08-11 15:38:31,654 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'nonce', 'scope', 'redirect_uri', 'client_id', 'response_type', 'state', 'upm_answer']
2015-08-11 15:38:31,654 oic.utils.sdb:DEBUG uid2sid: {'diana': ['f7bcbbc817e1af5b692f5acae951228579b53d5ce9da0481831dd422']}
2015-08-11 15:38:31,654 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 15:38:31,654 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 15:38:31,658 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=9FFONnygZEpXKZS6&code=qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9%2FBqGPnvLIzMDzVbMvyoAbTYWlZBa1AXQph0%2FZEXj3har%2BEVNYWRVZZIB1cXycVHXMapAUgsmo%3D' (<class 'str'>)
2015-08-11 15:38:31,673 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x104436240>
2015-08-11 15:38:31,673 oic.oic.provider:DEBUG - token -
2015-08-11 15:38:31,673 oic.oic.provider:INFO token_request: client_secret=c0a7171693afb2d1cf3910bed81282304433758bda813e0de2155640&code=qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9%2FBqGPnvLIzMDzVbMvyoAbTYWlZBa1AXQph0%2FZEXj3har%2BEVNYWRVZZIB1cXycVHXMapAUgsmo%3D&client_id=AYWO4CaJwTTi&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&grant_type=authorization_code
2015-08-11 15:38:31,673 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'client_secret': 'c0a7171693afb2d1cf3910bed81282304433758bda813e0de2155640', 'grant_type': 'authorization_code', 'code': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AXQph0/ZEXj3har+EVNYWRVZZIB1cXycVHXMapAUgsmo='}
2015-08-11 15:38:31,673 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'client_secret': 'c0a7171693afb2d1cf3910bed81282304433758bda813e0de2155640', 'grant_type': 'authorization_code', 'code': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AXQph0/ZEXj3har+EVNYWRVZZIB1cXycVHXMapAUgsmo='}
2015-08-11 15:38:31,677 oic.utils.authn.client:DEBUG Verified Client ID: AYWO4CaJwTTi
2015-08-11 15:38:31,680 oic.oic.provider:DEBUG All checks OK
2015-08-11 15:38:31,681 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'nonce': 'A6aPZuIY7pbV5z6b', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'response_type': 'code', 'state': '9FFONnygZEpXKZS6', 'upm_answer': 'true'}
2015-08-11 15:38:31,681 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 15:38:31,681 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'nonce': 'A6aPZuIY7pbV5z6b', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'response_type': 'code', 'state': '9FFONnygZEpXKZS6', 'upm_answer': 'true'}
2015-08-11 15:38:31,681 oic.oic.provider:DEBUG id_token: {'aud': ['AYWO4CaJwTTi'], 'iss': 'https://localhost:8092/', 'iat': 1439300311, 'acr': 'PASSWORD', 'exp': 1439379511, 'sub': '1dd5e9713a69892d', 'auth_time': 1439300311, 'nonce': 'A6aPZuIY7pbV5z6b'}
2015-08-11 15:38:31,683 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-11 15:38:31,683 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "crv": "P-256", "y": "FOLT1as-YZh4Kn75wZq2ABjiiKM13PwWgIJKIWgwXpw", "x": "_Nm0joy8ojc86ZCGu3DI2M4yN-5Mv0OpADsY1VsQsf4", "kid": "op2"}]}
2015-08-11 15:38:31,683 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "crv": "P-256", "y": "rnkr9vkMvknvsz7oySB2u4oL1v_fM3Gx8OAtUSMCoDA", "x": "DV0gzGK_c6qXa7eBdQUF9Ade8zdsTHmhRqUdw7VYu7w", "kid": "op3"}]}
2015-08-11 15:38:31,683 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104653cf8>]
2015-08-11 15:38:31,690 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 15:38:31,690 oic.oic.provider:DEBUG _tinfo: {'code_used': True, 'permission': '', 'access_token_scope': '?', 'token_type': 'Bearer', 'redirect_uri': 'http://localhost:8666/authz_cb', 'expires_in': 3600, 'state': '9FFONnygZEpXKZS6', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10799dbe0>, 'token_expires_at': 1439300311, 'refresh_token': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1ABIVHN8EgKgXRnynJPJDpBphn9bldu/kKYLVVYWYFehA=', 'sub': '1dd5e9713a69892d', 'access_token': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AVwHGi7TNvvO2HV7hlLr8+KIL1BontbLVUMQuXXVhCro=', 'nonce': 'A6aPZuIY7pbV5z6b', 'authzreq': '{"acr_values": "SAML", "upm_answer": "true", "nonce": "A6aPZuIY7pbV5z6b", "scope": "openid profile email address phone", "redirect_uri": "http://localhost:8666/authz_cb", "client_id": "AYWO4CaJwTTi", "state": "9FFONnygZEpXKZS6", "response_type": "code"}', 'revoked': False, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'client_id': 'AYWO4CaJwTTi', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiBbIkFZV080Q2FKd1RUaSJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0MzkzMDAzMTEsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTM3OTUxMSwgInN1YiI6ICIxZGQ1ZTk3MTNhNjk4OTJkIiwgImF1dGhfdGltZSI6IDE0MzkzMDAzMTEsICJub25jZSI6ICJBNmFQWnVJWTdwYlY1ejZiIn0.DRLjPM0edR7TNcUfFzaWwDzrl_VXkY2eOatqX0E0kmd_leTqYPfBK0Ut2TJ1EORErkq_Pn0Itnry-pA7CGqDx2Fk7iZ9rx8J3T_I-Af_IsNholYExmdrKIhiW_zlt2Wj-Kf8EMKPvzxITdbR3WYVtRQfF5cRGbgWrP3NIrXxmRP1ZMb6fTC5FiBoYHaLP20jrNMp7Y7naAyFA1_PW2v4WtlfCVTfTJtoRkRoIlm6gP2ib3-b46hvHOYJaO_z_XWuDW-NVpNwbAdeltezPCfltdIkENT3OZ8Ic6QDxkc7CpgESNUPkEFYUsMvYgKuTljnd9UmBZTYrixre8APv5TdAw', 'code': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AXQph0/ZEXj3har+EVNYWRVZZIB1cXycVHXMapAUgsmo='}
2015-08-11 15:38:31,691 oic.oic.provider:DEBUG access_token_response: {'refresh_token': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1ABIVHN8EgKgXRnynJPJDpBphn9bldu/kKYLVVYWYFehA=', 'access_token': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AVwHGi7TNvvO2HV7hlLr8+KIL1BontbLVUMQuXXVhCro=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiBbIkFZV080Q2FKd1RUaSJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0MzkzMDAzMTEsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTM3OTUxMSwgInN1YiI6ICIxZGQ1ZTk3MTNhNjk4OTJkIiwgImF1dGhfdGltZSI6IDE0MzkzMDAzMTEsICJub25jZSI6ICJBNmFQWnVJWTdwYlY1ejZiIn0.DRLjPM0edR7TNcUfFzaWwDzrl_VXkY2eOatqX0E0kmd_leTqYPfBK0Ut2TJ1EORErkq_Pn0Itnry-pA7CGqDx2Fk7iZ9rx8J3T_I-Af_IsNholYExmdrKIhiW_zlt2Wj-Kf8EMKPvzxITdbR3WYVtRQfF5cRGbgWrP3NIrXxmRP1ZMb6fTC5FiBoYHaLP20jrNMp7Y7naAyFA1_PW2v4WtlfCVTfTJtoRkRoIlm6gP2ib3-b46hvHOYJaO_z_XWuDW-NVpNwbAdeltezPCfltdIkENT3OZ8Ic6QDxkc7CpgESNUPkEFYUsMvYgKuTljnd9UmBZTYrixre8APv5TdAw', 'scope': 'openid profile email address phone', 'expires_in': 3600, 'token_type': 'Bearer', 'state': '9FFONnygZEpXKZS6'}
2015-08-11 15:38:31,700 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 15:38:31,715 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x104436278>
2015-08-11 15:38:31,715 oic.oic:DEBUG verify keys: None
2015-08-11 15:38:31,715 oic.oic.provider:DEBUG user_info_request: {'access_token': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AVwHGi7TNvvO2HV7hlLr8+KIL1BontbLVUMQuXXVhCro='}
2015-08-11 15:38:31,715 oicServer:DEBUG access_token type: 'T'
2015-08-11 15:38:31,715 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'nonce': 'A6aPZuIY7pbV5z6b', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'AYWO4CaJwTTi', 'response_type': 'code', 'state': '9FFONnygZEpXKZS6', 'upm_answer': 'true'}
2015-08-11 15:38:31,716 oic.oic.provider:DEBUG userinfo_claim: {'gender': None, 'phone_number': None, 'email': None, 'website': None, 'profile': None, 'phone_number_verified': None, 'updated_at': None, 'birthdate': None, 'given_name': None, 'picture': None, 'preferred_username': None, 'family_name': None, 'address': None, 'nickname': None, 'sub': None, 'zoneinfo': None, 'name': None, 'locale': None, 'middle_name': None, 'email_verified': None}
2015-08-11 15:38:31,716 oic.oic.provider:DEBUG Session info: {'code_used': True, 'permission': '', 'access_token_scope': '?', 'token_type': 'Bearer', 'redirect_uri': 'http://localhost:8666/authz_cb', 'expires_in': 3600, 'state': '9FFONnygZEpXKZS6', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10799dbe0>, 'token_expires_at': 1439300311, 'refresh_token': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1ABIVHN8EgKgXRnynJPJDpBphn9bldu/kKYLVVYWYFehA=', 'sub': '1dd5e9713a69892d', 'access_token': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AVwHGi7TNvvO2HV7hlLr8+KIL1BontbLVUMQuXXVhCro=', 'nonce': 'A6aPZuIY7pbV5z6b', 'authzreq': '{"acr_values": "SAML", "upm_answer": "true", "nonce": "A6aPZuIY7pbV5z6b", "scope": "openid profile email address phone", "redirect_uri": "http://localhost:8666/authz_cb", "client_id": "AYWO4CaJwTTi", "state": "9FFONnygZEpXKZS6", "response_type": "code"}', 'revoked': False, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'client_id': 'AYWO4CaJwTTi', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiBbIkFZV080Q2FKd1RUaSJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0MzkzMDAzMTEsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTM3OTUxMSwgInN1YiI6ICIxZGQ1ZTk3MTNhNjk4OTJkIiwgImF1dGhfdGltZSI6IDE0MzkzMDAzMTEsICJub25jZSI6ICJBNmFQWnVJWTdwYlY1ejZiIn0.DRLjPM0edR7TNcUfFzaWwDzrl_VXkY2eOatqX0E0kmd_leTqYPfBK0Ut2TJ1EORErkq_Pn0Itnry-pA7CGqDx2Fk7iZ9rx8J3T_I-Af_IsNholYExmdrKIhiW_zlt2Wj-Kf8EMKPvzxITdbR3WYVtRQfF5cRGbgWrP3NIrXxmRP1ZMb6fTC5FiBoYHaLP20jrNMp7Y7naAyFA1_PW2v4WtlfCVTfTJtoRkRoIlm6gP2ib3-b46hvHOYJaO_z_XWuDW-NVpNwbAdeltezPCfltdIkENT3OZ8Ic6QDxkc7CpgESNUPkEFYUsMvYgKuTljnd9UmBZTYrixre8APv5TdAw', 'code': 'qKArL1xhvMmIXKuPhV45GnW6o2hqwePxU9/BqGPnvLIzMDzVbMvyoAbTYWlZBa1AXQph0/ZEXj3har+EVNYWRVZZIB1cXycVHXMapAUgsmo='}
2015-08-11 15:38:31,716 oic.oic.provider:DEBUG user_info_response: {'family_name': 'Krall', 'nickname': 'Dina', 'email': 'diana@example.org', 'sub': '1dd5e9713a69892d', 'phone_number': '+46 90 7865000', 'address': {'country': 'Sweden', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187', 'locality': 'Ume'}, 'name': 'Diana Krall', 'given_name': 'Diana', 'email_verified': False}
2015-08-11 15:40:03,938 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kid": "op1", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-11 15:40:03,938 root:INFO OC3 server keys: {"keys": [{"x": "D1H7-gax2MXykUgufbRnuCrF0M7OKFC5W8gSA8fHhJ4", "y": "UFwvmxAFlVLYvFXfJsmuYSSI6kCRaeTEZtIrDJIINSI", "kid": "op2", "use": "sig", "crv": "P-256", "kty": "EC"}]}
2015-08-11 15:40:03,938 root:INFO OC3 server keys: {"keys": [{"x": "oEY9JGC6js2blLh1lNszJZ--5XKL1kGc5jJflIl1oQk", "y": "4RT-eQ2nm90-_G2uBw_j4rifUYANh9r9_iRaHpGJoaU", "kid": "op3", "use": "enc", "crv": "P-256", "kty": "EC"}]}
2015-08-11 15:40:03,938 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 15:40:11,121 oicServer:INFO callback: <function webfinger at 0x10447ae18>
2015-08-11 15:40:11,132 oicServer:INFO callback: <function op_info at 0x10447aa60>
2015-08-11 15:40:11,132 root:INFO op_info
2015-08-11 15:40:11,132 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 15:40:11,132 oic.oic.provider:INFO provider_info_response: {'request_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_signing_alg_values_supported': ['PS256', 'ES256', 'PS521', 'ES512', 'ES384', 'none', 'HS256', 'RS384', 'PS384', 'RS256', 'HS512', 'RS512', 'HS384'], 'request_object_signing_alg_values_supported': ['PS256', 'ES256', 'PS521', 'ES512', 'ES384', 'none', 'HS256', 'RS384', 'PS384', 'RS256', 'HS512', 'RS512', 'HS384'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'id_token_signing_alg_values_supported': ['PS256', 'ES256', 'PS521', 'ES512', 'ES384', 'none', 'HS256', 'RS384', 'PS384', 'RS256', 'HS512', 'RS512', 'HS384'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint': 'https://localhost:8092/token', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['phone', 'address', 'profile', 'email', 'openid', 'offline_access', 'openid'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'claims_supported': ['sub', 'phone_number_verified', 'name', 'profile', 'preferred_username', 'updated_at', 'email_verified', 'given_name', 'phone_number', 'birthdate', 'address', 'gender', 'locale', 'middle_name', 'picture', 'nickname', 'email', 'website', 'family_name', 'zoneinfo'], 'request_uri_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'subject_types_supported': ['public', 'pairwise'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'issuer': 'https://localhost:8092/', 'claims_parameter_supported': True, 'version': '3.0', 'require_request_uri_registration': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'token_endpoint_auth_signing_alg_values_supported': ['PS256', 'ES256', 'PS521', 'ES512', 'ES384', 'HS256', 'RS384', 'PS384', 'RS256', 'HS512', 'RS512', 'HS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'end_session_endpoint': 'https://localhost:8092/end_session', 'acr_values_supported': ['PASSWORD']}
2015-08-11 15:40:11,165 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x104476320>
2015-08-11 15:40:11,166 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-11 15:40:11,166 oic.oic.provider:INFO registration_request:{'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-11 15:40:11,172 oic.oic.provider:DEBUG _cinfo: {'client_id': '8OvkdX0NN8Jd', 'registration_client_uri': 'https://localhost:8092/registration?client_id=8OvkdX0NN8Jd', 'client_secret_expires_at': 1439383211, 'client_id_issued_at': 1439296811, 'client_secret': '056bdbe6c0cc42f19247f136221e3e8841bcc288a0b5f16632659020', 'registration_access_token': '4oILY7Dg6h3Nq3hMo7yR1zIieIpMcN2j'}
2015-08-11 15:40:11,172 oic.utils.keyio:DEBUG loading keys for issuer: 8OvkdX0NN8Jd
2015-08-11 15:40:11,172 oic.utils.keyio:DEBUG pcr: {'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-11 15:40:11,172 oic.oic.provider:DEBUG keys for 8OvkdX0NN8Jd: []
2015-08-11 15:40:11,174 oic.oic.provider:INFO Client info: {'client_id': '8OvkdX0NN8Jd', 'registration_client_uri': 'https://localhost:8092/registration?client_id=8OvkdX0NN8Jd', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_secret_expires_at': 1439383211, 'response_types': ['code'], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1439296811, 'client_secret': '056bdbe6c0cc42f19247f136221e3e8841bcc288a0b5f16632659020', 'application_type': 'web', 'contacts': ['ops@example.com'], 'registration_access_token': '4oILY7Dg6h3Nq3hMo7yR1zIieIpMcN2j'}
2015-08-11 15:40:11,174 oic.oic.provider:DEBUG registration_response: {'client_id': '8OvkdX0NN8Jd', 'registration_client_uri': 'https://localhost:8092/registration?client_id=8OvkdX0NN8Jd', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439383211, 'response_types': ['code'], 'client_id_issued_at': 1439296811, 'client_secret': '056bdbe6c0cc42f19247f136221e3e8841bcc288a0b5f16632659020', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'registration_access_token': '4oILY7Dg6h3Nq3hMo7yR1zIieIpMcN2j'}
2015-08-11 15:40:11,186 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042acda0>
2015-08-11 15:40:11,187 oic.oauth2.provider:DEBUG Request: 'client_id=8OvkdX0NN8Jd&nonce=7UDH8HZYpoToNzfG&response_type=code&scope=openid+profile+email+address+phone&state=UMxgAl9UqInmTYdT&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-11 15:40:11,187 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1046b99e8>, <jwkest.jwk.RSAKey object at 0x104693dd8>, <jwkest.jwk.ECKey object at 0x104697240>]
2015-08-11 15:40:11,187 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': '8OvkdX0NN8Jd', 'scope': 'openid profile email address phone', 'response_type': 'code', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-11 15:40:11,189 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': '8OvkdX0NN8Jd', 'scope': 'openid profile email address phone', 'response_type': 'code', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-11 15:40:11,190 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:40:11,190 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:40:11,190 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 15:40:11,191 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:40:11,191 oic.utils.authn.user:INFO do_authentication argv: {'query': 'client_id=8OvkdX0NN8Jd&nonce=7UDH8HZYpoToNzfG&response_type=code&scope=openid+profile+email+address+phone&state=UMxgAl9UqInmTYdT&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'tos_uri': '', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'logo_uri': '', 'login_title': 'Username', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'submit_text': 'Submit', 'policy_uri': '', 'acr': ['SAML'], 'password': '', 'login': ''}
2015-08-11 15:40:11,203 oicServer:INFO callback: <function css at 0x1042b8268>
2015-08-11 15:40:15,415 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x104619f28>
2015-08-11 15:40:15,415 oic.utils.authn.user:DEBUG verify(query=client_id%3D8OvkdX0NN8Jd%26nonce%3D7UDH8HZYpoToNzfG%26response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3DUMxgAl9UqInmTYdT%26acr_values%3DSAML%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 15:40:15,416 oic.utils.authn.user:DEBUG dict: {'query': ['client_id=8OvkdX0NN8Jd&nonce=7UDH8HZYpoToNzfG&response_type=code&scope=openid+profile+email+address+phone&state=UMxgAl9UqInmTYdT&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'], 'form.commit': ['Submit'], 'password': ['krall'], 'acr_values': ["['SAML']"], 'login': ['diana']}
2015-08-11 15:40:15,416 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'babs': 'howes', 'diana': 'krall'}
2015-08-11 15:40:15,416 oic.utils.authn.user:DEBUG kwargs: {'client_id': ['8OvkdX0NN8Jd'], 'acr_values': ['SAML'], 'upm_answer': 'true', 'scope': ['openid profile email address phone'], 'state': ['UMxgAl9UqInmTYdT'], 'nonce': ['7UDH8HZYpoToNzfG'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'response_type': ['code']}
2015-08-11 15:40:15,441 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042acda0>
2015-08-11 15:40:15,441 oic.oauth2.provider:DEBUG Request: 'client_id=8OvkdX0NN8Jd&acr_values=SAML&upm_answer=true&scope=openid+profile+email+address+phone&state=UMxgAl9UqInmTYdT&nonce=7UDH8HZYpoToNzfG&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'
2015-08-11 15:40:15,441 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1046b99e8>, <jwkest.jwk.RSAKey object at 0x104693dd8>, <jwkest.jwk.ECKey object at 0x104697240>]
2015-08-11 15:40:15,441 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': '8OvkdX0NN8Jd', 'acr_values': 'SAML', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-11 15:40:15,442 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': '8OvkdX0NN8Jd', 'acr_values': 'SAML', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-11 15:40:15,444 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:40:15,444 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:40:15,444 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 15:40:15,444 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:40:15,444 oic.oic.provider:DEBUG - authenticated -
2015-08-11 15:40:15,444 oic.oic.provider:DEBUG AREQ keys: ['client_id', 'upm_answer', 'scope', 'redirect_uri', 'state', 'nonce', 'response_type', 'acr_values']
2015-08-11 15:40:15,444 oic.utils.sdb:DEBUG uid2sid: {'diana': ['edfc77a3adaec68856d26baf20335ad094df9dfea664ae2154322763']}
2015-08-11 15:40:15,444 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 15:40:15,444 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 15:40:15,447 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=0jnOFflcql7Osd%2BCtz0Zk4AXaOpN%2FLU9HSHjDjLJVIak2cTjx%2FGWp6IsyeM%2BWYd9GoCsl8f0QO5qBDcVIH99eUCwrkldCZVza0%2FGd8RbokA%3D&state=UMxgAl9UqInmTYdT&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 15:40:15,475 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1044762b0>
2015-08-11 15:40:15,475 oic.oic.provider:DEBUG - token -
2015-08-11 15:40:15,475 oic.oic.provider:INFO token_request: redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=0jnOFflcql7Osd%2BCtz0Zk4AXaOpN%2FLU9HSHjDjLJVIak2cTjx%2FGWp6IsyeM%2BWYd9GoCsl8f0QO5qBDcVIH99eUCwrkldCZVza0%2FGd8RbokA%3D&grant_type=authorization_code&client_id=8OvkdX0NN8Jd&client_secret=056bdbe6c0cc42f19247f136221e3e8841bcc288a0b5f16632659020
2015-08-11 15:40:15,475 oic.oic.provider:DEBUG AccessTokenRequest: {'code': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9GoCsl8f0QO5qBDcVIH99eUCwrkldCZVza0/Gd8RbokA=', 'client_id': '8OvkdX0NN8Jd', 'grant_type': 'authorization_code', 'client_secret': '056bdbe6c0cc42f19247f136221e3e8841bcc288a0b5f16632659020', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-11 15:40:15,475 oic.utils.authn.client:DEBUG REQ: {'code': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9GoCsl8f0QO5qBDcVIH99eUCwrkldCZVza0/Gd8RbokA=', 'client_id': '8OvkdX0NN8Jd', 'grant_type': 'authorization_code', 'client_secret': '056bdbe6c0cc42f19247f136221e3e8841bcc288a0b5f16632659020', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-11 15:40:15,477 oic.utils.authn.client:DEBUG Verified Client ID: 8OvkdX0NN8Jd
2015-08-11 15:40:15,481 oic.oic.provider:DEBUG All checks OK
2015-08-11 15:40:15,482 oic.oic:DEBUG authzreq: {'client_id': '8OvkdX0NN8Jd', 'acr_values': 'SAML', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-11 15:40:15,482 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 15:40:15,483 oic.oic:DEBUG authzreq: {'client_id': '8OvkdX0NN8Jd', 'acr_values': 'SAML', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-11 15:40:15,483 oic.oic.provider:DEBUG id_token: {'iss': 'https://localhost:8092/', 'aud': ['8OvkdX0NN8Jd'], 'iat': 1439300415, 'auth_time': 1439300415, 'nonce': '7UDH8HZYpoToNzfG', 'exp': 1439379615, 'sub': '4fb184124b9cc6d3', 'acr': 'PASSWORD'}
2015-08-11 15:40:15,485 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kid": "op1", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-11 15:40:15,486 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "D1H7-gax2MXykUgufbRnuCrF0M7OKFC5W8gSA8fHhJ4", "y": "UFwvmxAFlVLYvFXfJsmuYSSI6kCRaeTEZtIrDJIINSI", "kid": "op2", "use": "sig", "crv": "P-256", "kty": "EC"}]}
2015-08-11 15:40:15,486 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "oEY9JGC6js2blLh1lNszJZ--5XKL1kGc5jJflIl1oQk", "y": "4RT-eQ2nm90-_G2uBw_j4rifUYANh9r9_iRaHpGJoaU", "kid": "op3", "use": "enc", "crv": "P-256", "kty": "EC"}]}
2015-08-11 15:40:15,486 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104693dd8>]
2015-08-11 15:40:15,492 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 15:40:15,492 oic.oic.provider:DEBUG _tinfo: {'code': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9GoCsl8f0QO5qBDcVIH99eUCwrkldCZVza0/Gd8RbokA=', 'token_expires_at': 1439300415, 'authzreq': '{"client_id": "8OvkdX0NN8Jd", "acr_values": "SAML", "upm_answer": "true", "scope": "openid profile email address phone", "state": "UMxgAl9UqInmTYdT", "nonce": "7UDH8HZYpoToNzfG", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code"}', 'oauth_state': 'token', 'code_used': True, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyI4T3ZrZFgwTk44SmQiXSwgImlhdCI6IDE0MzkzMDA0MTUsICJhdXRoX3RpbWUiOiAxNDM5MzAwNDE1LCAibm9uY2UiOiAiN1VESDhIWllwb1RvTnpmRyIsICJleHAiOiAxNDM5Mzc5NjE1LCAic3ViIjogIjRmYjE4NDEyNGI5Y2M2ZDMiLCAiYWNyIjogIlBBU1NXT1JEIn0.mTsk2G6ITCH3XnxQ1NsMMZdDnLSZHvvNRp2PzTA3zFlFbCgu51JCuhzMkpnEeGvGnefi9wviRS8yUH8YSJaXt061J3Fm_RhlAF2RpSn0V-swLQUPbXVmcxx2-V7hST6wxrINBvfPo1OUCeI_zNLU7CUs_tC6sS5i57TP5ULGd9RaMEsv_BJQRIwPhd49zB0QebweGf6VA0Mmx4wWDi7DcQOys61EPf0ACJfDHuKQzqpW6QgubcITjvUBdgvsfOasdRF_OmhyxzgiaorPVqJ5oA5OzC9bPuonKO8AixG9zbAxJW0aPclXwVVTfQt1XWyT0SeXMDXXYstFZ2dcuhaJNQ', 'revoked': False, 'access_token': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9xRgf+6casekmvhe922zQJrPeSbIOnKa/3Y+A7aeCHfw=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': '8OvkdX0NN8Jd', 'refresh_token': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9RchAaowTlxKSCwjbxqPbtB9/F1GsdWbDU1IbMkuf2gA=', 'token_type': 'Bearer', 'expires_in': 3600, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd7f0>, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token_scope': '?', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'sub': '4fb184124b9cc6d3', 'permission': ''}
2015-08-11 15:40:15,492 oic.oic.provider:DEBUG access_token_response: {'refresh_token': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9RchAaowTlxKSCwjbxqPbtB9/F1GsdWbDU1IbMkuf2gA=', 'token_type': 'Bearer', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyI4T3ZrZFgwTk44SmQiXSwgImlhdCI6IDE0MzkzMDA0MTUsICJhdXRoX3RpbWUiOiAxNDM5MzAwNDE1LCAibm9uY2UiOiAiN1VESDhIWllwb1RvTnpmRyIsICJleHAiOiAxNDM5Mzc5NjE1LCAic3ViIjogIjRmYjE4NDEyNGI5Y2M2ZDMiLCAiYWNyIjogIlBBU1NXT1JEIn0.mTsk2G6ITCH3XnxQ1NsMMZdDnLSZHvvNRp2PzTA3zFlFbCgu51JCuhzMkpnEeGvGnefi9wviRS8yUH8YSJaXt061J3Fm_RhlAF2RpSn0V-swLQUPbXVmcxx2-V7hST6wxrINBvfPo1OUCeI_zNLU7CUs_tC6sS5i57TP5ULGd9RaMEsv_BJQRIwPhd49zB0QebweGf6VA0Mmx4wWDi7DcQOys61EPf0ACJfDHuKQzqpW6QgubcITjvUBdgvsfOasdRF_OmhyxzgiaorPVqJ5oA5OzC9bPuonKO8AixG9zbAxJW0aPclXwVVTfQt1XWyT0SeXMDXXYstFZ2dcuhaJNQ', 'access_token': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9xRgf+6casekmvhe922zQJrPeSbIOnKa/3Y+A7aeCHfw=', 'state': 'UMxgAl9UqInmTYdT'}
2015-08-11 15:40:15,502 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 15:40:15,515 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1044762e8>
2015-08-11 15:40:15,516 oic.oic:DEBUG verify keys: None
2015-08-11 15:40:15,516 oic.oic.provider:DEBUG user_info_request: {'access_token': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9xRgf+6casekmvhe922zQJrPeSbIOnKa/3Y+A7aeCHfw='}
2015-08-11 15:40:15,516 oicServer:DEBUG access_token type: 'T'
2015-08-11 15:40:15,516 oic.oic:DEBUG authzreq: {'client_id': '8OvkdX0NN8Jd', 'acr_values': 'SAML', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-11 15:40:15,517 oic.oic.provider:DEBUG userinfo_claim: {'phone_number_verified': None, 'middle_name': None, 'name': None, 'email_verified': None, 'preferred_username': None, 'updated_at': None, 'given_name': None, 'phone_number': None, 'sub': None, 'profile': None, 'birthdate': None, 'address': None, 'gender': None, 'picture': None, 'locale': None, 'nickname': None, 'email': None, 'website': None, 'family_name': None, 'zoneinfo': None}
2015-08-11 15:40:15,517 oic.oic.provider:DEBUG Session info: {'code': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9GoCsl8f0QO5qBDcVIH99eUCwrkldCZVza0/Gd8RbokA=', 'token_expires_at': 1439300415, 'authzreq': '{"client_id": "8OvkdX0NN8Jd", "acr_values": "SAML", "upm_answer": "true", "scope": "openid profile email address phone", "state": "UMxgAl9UqInmTYdT", "nonce": "7UDH8HZYpoToNzfG", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code"}', 'oauth_state': 'token', 'code_used': True, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyI4T3ZrZFgwTk44SmQiXSwgImlhdCI6IDE0MzkzMDA0MTUsICJhdXRoX3RpbWUiOiAxNDM5MzAwNDE1LCAibm9uY2UiOiAiN1VESDhIWllwb1RvTnpmRyIsICJleHAiOiAxNDM5Mzc5NjE1LCAic3ViIjogIjRmYjE4NDEyNGI5Y2M2ZDMiLCAiYWNyIjogIlBBU1NXT1JEIn0.mTsk2G6ITCH3XnxQ1NsMMZdDnLSZHvvNRp2PzTA3zFlFbCgu51JCuhzMkpnEeGvGnefi9wviRS8yUH8YSJaXt061J3Fm_RhlAF2RpSn0V-swLQUPbXVmcxx2-V7hST6wxrINBvfPo1OUCeI_zNLU7CUs_tC6sS5i57TP5ULGd9RaMEsv_BJQRIwPhd49zB0QebweGf6VA0Mmx4wWDi7DcQOys61EPf0ACJfDHuKQzqpW6QgubcITjvUBdgvsfOasdRF_OmhyxzgiaorPVqJ5oA5OzC9bPuonKO8AixG9zbAxJW0aPclXwVVTfQt1XWyT0SeXMDXXYstFZ2dcuhaJNQ', 'revoked': False, 'access_token': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9xRgf+6casekmvhe922zQJrPeSbIOnKa/3Y+A7aeCHfw=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': '8OvkdX0NN8Jd', 'refresh_token': '0jnOFflcql7Osd+Ctz0Zk4AXaOpN/LU9HSHjDjLJVIak2cTjx/GWp6IsyeM+WYd9RchAaowTlxKSCwjbxqPbtB9/F1GsdWbDU1IbMkuf2gA=', 'token_type': 'Bearer', 'expires_in': 3600, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd7f0>, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token_scope': '?', 'state': 'UMxgAl9UqInmTYdT', 'nonce': '7UDH8HZYpoToNzfG', 'sub': '4fb184124b9cc6d3', 'permission': ''}
2015-08-11 15:40:15,517 oic.oic.provider:DEBUG user_info_response: {'address': {'locality': 'Ume', 'postal_code': 'SE-90187', 'street_address': 'Ume Universitet', 'country': 'Sweden'}, 'family_name': 'Krall', 'name': 'Diana Krall', 'email_verified': False, 'nickname': 'Dina', 'email': 'diana@example.org', 'given_name': 'Diana', 'phone_number': '+46 90 7865000', 'sub': '4fb184124b9cc6d3'}
2015-08-11 15:41:36,334 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-11 15:41:36,334 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "x": "wn3Q9kZEdut9pt8Xw57PUd3X0e25CbM_h8ymdLkY2xw", "crv": "P-256", "kty": "EC", "y": "ccHcdhmbdFGdGCygneNvNcBhYLMs3iIcvwYFLAliV_g", "use": "sig"}]}
2015-08-11 15:41:36,334 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "x": "uPqrbiwYXA0LprAnlKxVMS7RQiddZyajjY60XnWUjxE", "crv": "P-256", "kty": "EC", "y": "0B7yZJFzXcMrAA8_6ekDS33ulguM75wadVmuvFI1TIQ", "use": "enc"}]}
2015-08-11 15:41:36,334 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 15:41:46,421 oicServer:INFO callback: <function webfinger at 0x10447ae18>
2015-08-11 15:41:46,432 oicServer:INFO callback: <function op_info at 0x10447aa60>
2015-08-11 15:41:46,432 root:INFO op_info
2015-08-11 15:41:46,432 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 15:41:46,432 oic.oic.provider:INFO provider_info_response: {'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['website', 'phone_number', 'email', 'sub', 'phone_number_verified', 'zoneinfo', 'nickname', 'gender', 'profile', 'birthdate', 'updated_at', 'family_name', 'middle_name', 'locale', 'preferred_username', 'address', 'given_name', 'picture', 'email_verified', 'name'], 'token_endpoint': 'https://localhost:8092/token', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'request_uri_parameter_supported': True, 'issuer': 'https://localhost:8092/', 'scopes_supported': ['phone', 'openid', 'address', 'email', 'profile', 'offline_access', 'openid'], 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'end_session_endpoint': 'https://localhost:8092/end_session', 'version': '3.0', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'require_request_uri_registration': True, 'request_object_signing_alg_values_supported': ['ES512', 'PS521', 'ES256', 'PS256', 'none', 'HS384', 'RS256', 'PS384', 'ES384', 'HS512', 'RS384', 'HS256', 'RS512'], 'id_token_signing_alg_values_supported': ['ES512', 'PS521', 'ES256', 'PS256', 'none', 'HS384', 'RS256', 'PS384', 'ES384', 'HS512', 'RS384', 'HS256', 'RS512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_signing_alg_values_supported': ['ES512', 'PS521', 'ES256', 'PS256', 'none', 'HS384', 'RS256', 'PS384', 'ES384', 'HS512', 'RS384', 'HS256', 'RS512'], 'request_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'PS521', 'ES256', 'PS256', 'HS384', 'RS256', 'PS384', 'ES384', 'HS512', 'RS384', 'HS256', 'RS512']}
2015-08-11 15:41:46,465 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x104476320>
2015-08-11 15:41:46,465 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "response_types": ["code"]}>>
2015-08-11 15:41:46,465 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-11 15:41:46,470 oic.oic.provider:DEBUG _cinfo: {'client_id': 'xRf9SzDgk21X', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xRf9SzDgk21X', 'client_id_issued_at': 1439296906, 'registration_access_token': 'sL5HcSeSWGbnW61CkMtXOhQDIR7MT2Sj', 'client_secret_expires_at': 1439383306, 'client_secret': '79fa27b532ed28f0b952818d019ac996172c30a155215bca4d8c17bd'}
2015-08-11 15:41:46,470 oic.utils.keyio:DEBUG loading keys for issuer: xRf9SzDgk21X
2015-08-11 15:41:46,470 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-11 15:41:46,470 oic.oic.provider:DEBUG keys for xRf9SzDgk21X: []
2015-08-11 15:41:46,472 oic.oic.provider:INFO Client info: {'application_type': 'web', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_id': 'xRf9SzDgk21X', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xRf9SzDgk21X', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1439296906, 'response_types': ['code'], 'registration_access_token': 'sL5HcSeSWGbnW61CkMtXOhQDIR7MT2Sj', 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439383306, 'client_secret': '79fa27b532ed28f0b952818d019ac996172c30a155215bca4d8c17bd'}
2015-08-11 15:41:46,472 oic.oic.provider:DEBUG registration_response: {'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret_expires_at': 1439383306, 'client_id': 'xRf9SzDgk21X', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xRf9SzDgk21X', 'client_id_issued_at': 1439296906, 'response_types': ['code'], 'registration_access_token': 'sL5HcSeSWGbnW61CkMtXOhQDIR7MT2Sj', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'client_secret': '79fa27b532ed28f0b952818d019ac996172c30a155215bca4d8c17bd'}
2015-08-11 15:41:46,483 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1041acda0>
2015-08-11 15:41:46,484 oic.oauth2.provider:DEBUG Request: 'response_type=code&state=C4bXL5NsrD6RBvHX&acr_values=SAML&client_id=xRf9SzDgk21X&nonce=oV1oUk2nyXALyi4r&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-11 15:41:46,484 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1046b99e8>, <jwkest.jwk.RSAKey object at 0x104693dd8>, <jwkest.jwk.ECKey object at 0x104696198>]
2015-08-11 15:41:46,484 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'state': 'C4bXL5NsrD6RBvHX', 'response_type': 'code', 'client_id': 'xRf9SzDgk21X', 'nonce': 'oV1oUk2nyXALyi4r', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:41:46,486 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'state': 'C4bXL5NsrD6RBvHX', 'response_type': 'code', 'client_id': 'xRf9SzDgk21X', 'nonce': 'oV1oUk2nyXALyi4r', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone'}
2015-08-11 15:41:46,487 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:41:46,487 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:41:46,487 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 15:41:46,487 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:41:46,487 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'acr': ['SAML'], 'login': '', 'password': '', 'query': 'response_type=code&state=C4bXL5NsrD6RBvHX&acr_values=SAML&client_id=xRf9SzDgk21X&nonce=oV1oUk2nyXALyi4r&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'logo_uri': '', 'tos_uri': '', 'action': 'https://localhost:8092/verify', 'client_policy_title': 'Client Policy', 'login_title': 'Username', 'title': 'User log in', 'policy_uri': '', 'passwd_title': 'Password'}
2015-08-11 15:41:46,500 oicServer:INFO callback: <function css at 0x1041b8268>
2015-08-11 15:41:50,483 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x104619f28>
2015-08-11 15:41:50,483 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26state%3DC4bXL5NsrD6RBvHX%26acr_values%3DSAML%26client_id%3DxRf9SzDgk21X%26nonce%3DoV1oUk2nyXALyi4r%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 15:41:50,483 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['SAML']"], 'login': ['diana'], 'password': ['krall'], 'form.commit': ['Submit'], 'query': ['response_type=code&state=C4bXL5NsrD6RBvHX&acr_values=SAML&client_id=xRf9SzDgk21X&nonce=oV1oUk2nyXALyi4r&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb']}
2015-08-11 15:41:50,483 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'babs': 'howes', 'diana': 'krall'}
2015-08-11 15:41:50,484 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'state': ['C4bXL5NsrD6RBvHX'], 'response_type': ['code'], 'client_id': ['xRf9SzDgk21X'], 'nonce': ['oV1oUk2nyXALyi4r'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true'}
2015-08-11 15:41:50,505 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1041acda0>
2015-08-11 15:41:50,505 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&state=C4bXL5NsrD6RBvHX&response_type=code&client_id=xRf9SzDgk21X&nonce=oV1oUk2nyXALyi4r&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&upm_answer=true'
2015-08-11 15:41:50,505 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1046b99e8>, <jwkest.jwk.RSAKey object at 0x104693dd8>, <jwkest.jwk.ECKey object at 0x104696198>]
2015-08-11 15:41:50,505 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'state': 'C4bXL5NsrD6RBvHX', 'response_type': 'code', 'client_id': 'xRf9SzDgk21X', 'nonce': 'oV1oUk2nyXALyi4r', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-11 15:41:50,506 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'state': 'C4bXL5NsrD6RBvHX', 'response_type': 'code', 'client_id': 'xRf9SzDgk21X', 'nonce': 'oV1oUk2nyXALyi4r', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-11 15:41:50,508 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:41:50,508 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:41:50,508 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-11 15:41:50,508 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:41:50,508 oic.oic.provider:DEBUG - authenticated -
2015-08-11 15:41:50,508 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'state', 'response_type', 'client_id', 'nonce', 'redirect_uri', 'scope', 'upm_answer']
2015-08-11 15:41:50,508 oic.utils.sdb:DEBUG uid2sid: {'diana': ['999e34b3c85fb1d14b4206ddae15c2fbf3218b68838da3939ad569fc']}
2015-08-11 15:41:50,509 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 15:41:50,509 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 15:41:50,511 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=C4bXL5NsrD6RBvHX&code=EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwRsna4ficfgQYF1EZ3z4R%2F1g5l%2Bwxmgl8B3fBLtgQNNA%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-11 15:41:50,526 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1044762b0>
2015-08-11 15:41:50,526 oic.oic.provider:DEBUG - token -
2015-08-11 15:41:50,526 oic.oic.provider:INFO token_request: client_id=xRf9SzDgk21X&client_secret=79fa27b532ed28f0b952818d019ac996172c30a155215bca4d8c17bd&code=EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwRsna4ficfgQYF1EZ3z4R%2F1g5l%2Bwxmgl8B3fBLtgQNNA%3D&grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-11 15:41:50,526 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'code': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwRsna4ficfgQYF1EZ3z4R/1g5l+wxmgl8B3fBLtgQNNA=', 'client_id': 'xRf9SzDgk21X', 'client_secret': '79fa27b532ed28f0b952818d019ac996172c30a155215bca4d8c17bd'}
2015-08-11 15:41:50,527 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'code': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwRsna4ficfgQYF1EZ3z4R/1g5l+wxmgl8B3fBLtgQNNA=', 'client_id': 'xRf9SzDgk21X', 'client_secret': '79fa27b532ed28f0b952818d019ac996172c30a155215bca4d8c17bd'}
2015-08-11 15:41:50,528 oic.utils.authn.client:DEBUG Verified Client ID: xRf9SzDgk21X
2015-08-11 15:41:50,533 oic.oic.provider:DEBUG All checks OK
2015-08-11 15:41:50,533 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'state': 'C4bXL5NsrD6RBvHX', 'response_type': 'code', 'client_id': 'xRf9SzDgk21X', 'nonce': 'oV1oUk2nyXALyi4r', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-11 15:41:50,534 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 15:41:50,534 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'state': 'C4bXL5NsrD6RBvHX', 'response_type': 'code', 'client_id': 'xRf9SzDgk21X', 'nonce': 'oV1oUk2nyXALyi4r', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-11 15:41:50,534 oic.oic.provider:DEBUG id_token: {'nonce': 'oV1oUk2nyXALyi4r', 'exp': 1439379710, 'sub': '288a35678b6f53eb', 'aud': ['xRf9SzDgk21X'], 'acr': 'PASSWORD', 'iat': 1439300510, 'auth_time': 1439300510, 'iss': 'https://localhost:8092/'}
2015-08-11 15:41:50,536 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-11 15:41:50,536 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op2", "x": "wn3Q9kZEdut9pt8Xw57PUd3X0e25CbM_h8ymdLkY2xw", "crv": "P-256", "kty": "EC", "y": "ccHcdhmbdFGdGCygneNvNcBhYLMs3iIcvwYFLAliV_g", "use": "sig"}]}
2015-08-11 15:41:50,536 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op3", "x": "uPqrbiwYXA0LprAnlKxVMS7RQiddZyajjY60XnWUjxE", "crv": "P-256", "kty": "EC", "y": "0B7yZJFzXcMrAA8_6ekDS33ulguM75wadVmuvFI1TIQ", "use": "enc"}]}
2015-08-11 15:41:50,536 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104693dd8>]
2015-08-11 15:41:50,541 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 15:41:50,542 oic.oic.provider:DEBUG _tinfo: {'expires_in': 3600, 'sub': '288a35678b6f53eb', 'client_id': 'xRf9SzDgk21X', 'permission': '', 'refresh_token': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwaRoQ/k6AZTmCAVdXVX3m3zJ69ojFEyyxcEqtc0/nov8=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_type': 'Bearer', 'code': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwRsna4ficfgQYF1EZ3z4R/1g5l+wxmgl8B3fBLtgQNNA=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'nonce': 'oV1oUk2nyXALyi4r', 'state': 'C4bXL5NsrD6RBvHX', 'authzreq': '{"acr_values": "SAML", "state": "C4bXL5NsrD6RBvHX", "response_type": "code", "client_id": "xRf9SzDgk21X", "nonce": "oV1oUk2nyXALyi4r", "redirect_uri": "http://localhost:8666/authz_cb", "scope": "openid profile email address phone", "upm_answer": "true"}', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd7f0>, 'code_used': True, 'access_token_scope': '?', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJvVjFvVWsybnlYQUx5aTRyIiwgImV4cCI6IDE0MzkzNzk3MTAsICJzdWIiOiAiMjg4YTM1Njc4YjZmNTNlYiIsICJhdWQiOiBbInhSZjlTekRnazIxWCJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0MzkzMDA1MTAsICJhdXRoX3RpbWUiOiAxNDM5MzAwNTEwLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIn0.wWHJbgBF-TLpTWz5YD46RfVrOzHTOz4hFw0mTew7x3eEpZLRfqJU4YD0VInEMDM17b0N_gP3o9WmRJ_TABUnf6-TpcwRwUeAt_02gXcbE3VCv1N0igvAKZyysNP6zHvdEhOJQWFBPF10DT1oLw0A5NxdziN9ePj1GUiopxU9vEJ6v-spftwjfUIKVGXnMyP7dDHd1F3YPwlWgmYORXEPCU4ZcX2v0tIajfd2WINzqGLufa2cWD2196pjxKWX6EfrwLYEwGM6hKwm-hE-1rlFlf9hOkqQ0hTQLwGNjG23MT6X-WBcJ_ZW3CpfkpEgyB2nTGu_Vy3or1EoQmm3dtCutA', 'access_token': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtw9+qLyMnVi58LmEpNoV8PxqHsQ5+n3UhJE4UBAP1qRuY=', 'token_expires_at': 1439300510, 'oauth_state': 'token', 'revoked': False}
2015-08-11 15:41:50,542 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'state': 'C4bXL5NsrD6RBvHX', 'token_type': 'Bearer', 'refresh_token': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwaRoQ/k6AZTmCAVdXVX3m3zJ69ojFEyyxcEqtc0/nov8=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJvVjFvVWsybnlYQUx5aTRyIiwgImV4cCI6IDE0MzkzNzk3MTAsICJzdWIiOiAiMjg4YTM1Njc4YjZmNTNlYiIsICJhdWQiOiBbInhSZjlTekRnazIxWCJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0MzkzMDA1MTAsICJhdXRoX3RpbWUiOiAxNDM5MzAwNTEwLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIn0.wWHJbgBF-TLpTWz5YD46RfVrOzHTOz4hFw0mTew7x3eEpZLRfqJU4YD0VInEMDM17b0N_gP3o9WmRJ_TABUnf6-TpcwRwUeAt_02gXcbE3VCv1N0igvAKZyysNP6zHvdEhOJQWFBPF10DT1oLw0A5NxdziN9ePj1GUiopxU9vEJ6v-spftwjfUIKVGXnMyP7dDHd1F3YPwlWgmYORXEPCU4ZcX2v0tIajfd2WINzqGLufa2cWD2196pjxKWX6EfrwLYEwGM6hKwm-hE-1rlFlf9hOkqQ0hTQLwGNjG23MT6X-WBcJ_ZW3CpfkpEgyB2nTGu_Vy3or1EoQmm3dtCutA', 'access_token': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtw9+qLyMnVi58LmEpNoV8PxqHsQ5+n3UhJE4UBAP1qRuY=', 'scope': 'openid profile email address phone'}
2015-08-11 15:41:50,552 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 15:41:50,567 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1044762e8>
2015-08-11 15:41:50,567 oic.oic:DEBUG verify keys: None
2015-08-11 15:41:50,568 oic.oic.provider:DEBUG user_info_request: {'access_token': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtw9+qLyMnVi58LmEpNoV8PxqHsQ5+n3UhJE4UBAP1qRuY='}
2015-08-11 15:41:50,568 oicServer:DEBUG access_token type: 'T'
2015-08-11 15:41:50,568 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'state': 'C4bXL5NsrD6RBvHX', 'response_type': 'code', 'client_id': 'xRf9SzDgk21X', 'nonce': 'oV1oUk2nyXALyi4r', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-11 15:41:50,568 oic.oic.provider:DEBUG userinfo_claim: {'website': None, 'email': None, 'sub': None, 'phone_number_verified': None, 'nickname': None, 'birthdate': None, 'profile': None, 'preferred_username': None, 'middle_name': None, 'locale': None, 'family_name': None, 'gender': None, 'zoneinfo': None, 'address': None, 'given_name': None, 'phone_number': None, 'picture': None, 'email_verified': None, 'name': None, 'updated_at': None}
2015-08-11 15:41:50,568 oic.oic.provider:DEBUG Session info: {'expires_in': 3600, 'sub': '288a35678b6f53eb', 'client_id': 'xRf9SzDgk21X', 'permission': '', 'refresh_token': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwaRoQ/k6AZTmCAVdXVX3m3zJ69ojFEyyxcEqtc0/nov8=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_type': 'Bearer', 'code': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtwRsna4ficfgQYF1EZ3z4R/1g5l+wxmgl8B3fBLtgQNNA=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'nonce': 'oV1oUk2nyXALyi4r', 'state': 'C4bXL5NsrD6RBvHX', 'authzreq': '{"acr_values": "SAML", "state": "C4bXL5NsrD6RBvHX", "response_type": "code", "client_id": "xRf9SzDgk21X", "nonce": "oV1oUk2nyXALyi4r", "redirect_uri": "http://localhost:8666/authz_cb", "scope": "openid profile email address phone", "upm_answer": "true"}', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd7f0>, 'code_used': True, 'access_token_scope': '?', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJvVjFvVWsybnlYQUx5aTRyIiwgImV4cCI6IDE0MzkzNzk3MTAsICJzdWIiOiAiMjg4YTM1Njc4YjZmNTNlYiIsICJhdWQiOiBbInhSZjlTekRnazIxWCJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0MzkzMDA1MTAsICJhdXRoX3RpbWUiOiAxNDM5MzAwNTEwLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIn0.wWHJbgBF-TLpTWz5YD46RfVrOzHTOz4hFw0mTew7x3eEpZLRfqJU4YD0VInEMDM17b0N_gP3o9WmRJ_TABUnf6-TpcwRwUeAt_02gXcbE3VCv1N0igvAKZyysNP6zHvdEhOJQWFBPF10DT1oLw0A5NxdziN9ePj1GUiopxU9vEJ6v-spftwjfUIKVGXnMyP7dDHd1F3YPwlWgmYORXEPCU4ZcX2v0tIajfd2WINzqGLufa2cWD2196pjxKWX6EfrwLYEwGM6hKwm-hE-1rlFlf9hOkqQ0hTQLwGNjG23MT6X-WBcJ_ZW3CpfkpEgyB2nTGu_Vy3or1EoQmm3dtCutA', 'access_token': 'EzUM8FzMhSJ39svF4NxgV4Mikw7sOwTPwG3aPOnEgDij29rplbByXDdffHYCSHtw9+qLyMnVi58LmEpNoV8PxqHsQ5+n3UhJE4UBAP1qRuY=', 'token_expires_at': 1439300510, 'oauth_state': 'token', 'revoked': False}
2015-08-11 15:41:50,568 oic.oic.provider:DEBUG user_info_response: {'email': 'diana@example.org', 'sub': '288a35678b6f53eb', 'given_name': 'Diana', 'address': {'country': 'Sweden', 'locality': 'Ume', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187'}, 'phone_number': '+46 90 7865000', 'email_verified': False, 'nickname': 'Dina', 'family_name': 'Krall', 'name': 'Diana Krall'}
2015-08-11 15:42:35,957 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "kty": "RSA"}, {"e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "kty": "RSA"}]}
2015-08-11 15:42:35,957 root:INFO OC3 server keys: {"keys": [{"x": "zMV6eMX0zNnEW70Q3eDshyVTn0dryk9JzNtnomJBdbc", "use": "sig", "y": "zM3xyN8gEHXcZC5XBvBkbHffV7W7oa9b5PNDwCiUZd0", "crv": "P-256", "kid": "op2", "kty": "EC"}]}
2015-08-11 15:42:35,957 root:INFO OC3 server keys: {"keys": [{"x": "H7lYWJAb7vz4oShCDDX7zO4Q6BqK3JI6KRtcQzrYrbQ", "use": "enc", "y": "iNkZQjyBAKlss6x9UkQ5kQ1w_kzIcJIeBBNjlLbHW6Y", "crv": "P-256", "kid": "op3", "kty": "EC"}]}
2015-08-11 15:42:35,957 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-11 15:42:42,782 oicServer:INFO callback: <function webfinger at 0x104345e18>
2015-08-11 15:42:42,791 oicServer:INFO callback: <function op_info at 0x104345a60>
2015-08-11 15:42:42,792 root:INFO op_info
2015-08-11 15:42:42,792 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-11 15:42:42,792 oic.oic.provider:INFO provider_info_response: {'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'issuer': 'https://localhost:8092/', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_signing_alg_values_supported': ['RS512', 'ES512', 'PS384', 'PS256', 'HS256', 'HS384', 'none', 'RS384', 'HS512', 'RS256', 'PS521', 'ES256', 'ES384'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'request_uri_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD'], 'token_endpoint': 'https://localhost:8092/token', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['RS512', 'ES512', 'PS384', 'PS256', 'HS256', 'HS384', 'RS384', 'HS512', 'RS256', 'PS521', 'ES256', 'ES384'], 'registration_endpoint': 'https://localhost:8092/registration', 'id_token_signing_alg_values_supported': ['RS512', 'ES512', 'PS384', 'PS256', 'HS256', 'HS384', 'none', 'RS384', 'HS512', 'RS256', 'PS521', 'ES256', 'ES384'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'version': '3.0', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'userinfo_signing_alg_values_supported': ['RS512', 'ES512', 'PS384', 'PS256', 'HS256', 'HS384', 'none', 'RS384', 'HS512', 'RS256', 'PS521', 'ES256', 'ES384'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'claims_supported': ['birthdate', 'locale', 'zoneinfo', 'phone_number', 'family_name', 'picture', 'updated_at', 'address', 'gender', 'website', 'preferred_username', 'name', 'profile', 'phone_number_verified', 'email', 'sub', 'nickname', 'email_verified', 'middle_name', 'given_name'], 'require_request_uri_registration': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-11 15:42:42,823 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x104341320>
2015-08-11 15:42:42,823 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "application_type": "web", "response_types": ["code"]}>>
2015-08-11 15:42:42,824 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com']}
2015-08-11 15:42:42,830 oic.oic.provider:DEBUG _cinfo: {'registration_client_uri': 'https://localhost:8092/registration?client_id=gmQwZcE8OBW4', 'registration_access_token': 'HzB3n04zYFZtrTX6zcYVFrFghGEix9QC', 'client_secret': 'd623a1d3e82ee326692bbe104fc15b2c30a1629cb6eeb42e8a778662', 'client_id': 'gmQwZcE8OBW4', 'client_id_issued_at': 1439296962, 'client_secret_expires_at': 1439383362}
2015-08-11 15:42:42,831 oic.utils.keyio:DEBUG loading keys for issuer: gmQwZcE8OBW4
2015-08-11 15:42:42,831 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com']}
2015-08-11 15:42:42,831 oic.oic.provider:DEBUG keys for gmQwZcE8OBW4: []
2015-08-11 15:42:42,832 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=gmQwZcE8OBW4', 'registration_access_token': 'HzB3n04zYFZtrTX6zcYVFrFghGEix9QC', 'client_secret': 'd623a1d3e82ee326692bbe104fc15b2c30a1629cb6eeb42e8a778662', 'client_id': 'gmQwZcE8OBW4', 'application_type': 'web', 'response_types': ['code'], 'client_id_issued_at': 1439296962, 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_secret_expires_at': 1439383362}
2015-08-11 15:42:42,833 oic.oic.provider:DEBUG registration_response: {'registration_client_uri': 'https://localhost:8092/registration?client_id=gmQwZcE8OBW4', 'registration_access_token': 'HzB3n04zYFZtrTX6zcYVFrFghGEix9QC', 'contacts': ['ops@example.com'], 'client_id': 'gmQwZcE8OBW4', 'application_type': 'web', 'response_types': ['code'], 'client_secret': 'd623a1d3e82ee326692bbe104fc15b2c30a1629cb6eeb42e8a778662', 'client_id_issued_at': 1439296962, 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret_expires_at': 1439383362}
2015-08-11 15:42:42,845 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042acda0>
2015-08-11 15:42:42,846 oic.oauth2.provider:DEBUG Request: 'response_type=code&scope=openid+profile+email+address+phone&state=y2ofRsykWRNBmwiC&acr_values=SAML&nonce=71o1TNoxCIfaVZ9S&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=gmQwZcE8OBW4'
2015-08-11 15:42:42,846 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1046b99e8>, <jwkest.jwk.RSAKey object at 0x104693dd8>, <jwkest.jwk.ECKey object at 0x104696198>]
2015-08-11 15:42:42,846 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gmQwZcE8OBW4', 'nonce': '71o1TNoxCIfaVZ9S', 'state': 'y2ofRsykWRNBmwiC', 'response_type': 'code'}
2015-08-11 15:42:42,848 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gmQwZcE8OBW4', 'nonce': '71o1TNoxCIfaVZ9S', 'state': 'y2ofRsykWRNBmwiC', 'response_type': 'code'}
2015-08-11 15:42:42,849 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:42:42,849 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:42:42,849 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 15:42:42,850 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:42:42,850 oic.utils.authn.user:INFO do_authentication argv: {'logo_uri': '', 'action': 'https://localhost:8092/verify', 'login_title': 'Username', 'policy_uri': '', 'password': '', 'passwd_title': 'Password', 'tos_uri': '', 'title': 'User log in', 'submit_text': 'Submit', 'acr': ['SAML'], 'login': '', 'client_policy_title': 'Client Policy', 'query': 'response_type=code&scope=openid+profile+email+address+phone&state=y2ofRsykWRNBmwiC&acr_values=SAML&nonce=71o1TNoxCIfaVZ9S&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=gmQwZcE8OBW4'}
2015-08-11 15:42:42,862 oicServer:INFO callback: <function css at 0x1042b8268>
2015-08-11 15:42:47,030 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x104619f28>
2015-08-11 15:42:47,030 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3Dy2ofRsykWRNBmwiC%26acr_values%3DSAML%26nonce%3D71o1TNoxCIfaVZ9S%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26client_id%3DgmQwZcE8OBW4&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-11 15:42:47,030 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['SAML']"], 'password': ['krall'], 'login': ['diana'], 'form.commit': ['Submit'], 'query': ['response_type=code&scope=openid+profile+email+address+phone&state=y2ofRsykWRNBmwiC&acr_values=SAML&nonce=71o1TNoxCIfaVZ9S&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=gmQwZcE8OBW4']}
2015-08-11 15:42:47,030 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-11 15:42:47,031 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'scope': ['openid profile email address phone'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'client_id': ['gmQwZcE8OBW4'], 'nonce': ['71o1TNoxCIfaVZ9S'], 'state': ['y2ofRsykWRNBmwiC'], 'response_type': ['code'], 'upm_answer': 'true'}
2015-08-11 15:42:47,053 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1042acda0>
2015-08-11 15:42:47,053 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=gmQwZcE8OBW4&nonce=71o1TNoxCIfaVZ9S&state=y2ofRsykWRNBmwiC&response_type=code&upm_answer=true'
2015-08-11 15:42:47,053 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1046b99e8>, <jwkest.jwk.RSAKey object at 0x104693dd8>, <jwkest.jwk.ECKey object at 0x104696198>]
2015-08-11 15:42:47,053 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gmQwZcE8OBW4', 'nonce': '71o1TNoxCIfaVZ9S', 'state': 'y2ofRsykWRNBmwiC', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 15:42:47,054 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gmQwZcE8OBW4', 'nonce': '71o1TNoxCIfaVZ9S', 'state': 'y2ofRsykWRNBmwiC', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 15:42:47,056 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:42:47,056 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-11 15:42:47,056 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-11 15:42:47,056 oic.oauth2.provider:INFO No active authentication
2015-08-11 15:42:47,056 oic.oic.provider:DEBUG - authenticated -
2015-08-11 15:42:47,056 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'scope', 'redirect_uri', 'client_id', 'nonce', 'state', 'response_type', 'upm_answer']
2015-08-11 15:42:47,056 oic.utils.sdb:DEBUG uid2sid: {'diana': ['cb88e5896dbf233fcbde5186a314de790ed3eb62657594070cfbe801']}
2015-08-11 15:42:47,056 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-11 15:42:47,057 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-11 15:42:47,058 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=y2ofRsykWRNBmwiC&scope=openid+profile+email+address+phone&code=5%2BDKK1q1mI5KkPbK6O48wDpQeF%2BOh6xdxDklN5n%2FOyWwd%2BQHfUsb1gV3BGmsY2WoOwH4TCk4ZLd1MCsFvoINk4XOUqG5yAYZ9X17juDR0WE%3D' (<class 'str'>)
2015-08-11 15:42:47,072 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1043412b0>
2015-08-11 15:42:47,073 oic.oic.provider:DEBUG - token -
2015-08-11 15:42:47,073 oic.oic.provider:INFO token_request: grant_type=authorization_code&code=5%2BDKK1q1mI5KkPbK6O48wDpQeF%2BOh6xdxDklN5n%2FOyWwd%2BQHfUsb1gV3BGmsY2WoOwH4TCk4ZLd1MCsFvoINk4XOUqG5yAYZ9X17juDR0WE%3D&client_secret=d623a1d3e82ee326692bbe104fc15b2c30a1629cb6eeb42e8a778662&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=gmQwZcE8OBW4
2015-08-11 15:42:47,073 oic.oic.provider:DEBUG AccessTokenRequest: {'client_id': 'gmQwZcE8OBW4', 'grant_type': 'authorization_code', 'code': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2WoOwH4TCk4ZLd1MCsFvoINk4XOUqG5yAYZ9X17juDR0WE=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': 'd623a1d3e82ee326692bbe104fc15b2c30a1629cb6eeb42e8a778662'}
2015-08-11 15:42:47,073 oic.utils.authn.client:DEBUG REQ: {'client_id': 'gmQwZcE8OBW4', 'grant_type': 'authorization_code', 'code': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2WoOwH4TCk4ZLd1MCsFvoINk4XOUqG5yAYZ9X17juDR0WE=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': 'd623a1d3e82ee326692bbe104fc15b2c30a1629cb6eeb42e8a778662'}
2015-08-11 15:42:47,075 oic.utils.authn.client:DEBUG Verified Client ID: gmQwZcE8OBW4
2015-08-11 15:42:47,078 oic.oic.provider:DEBUG All checks OK
2015-08-11 15:42:47,079 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gmQwZcE8OBW4', 'nonce': '71o1TNoxCIfaVZ9S', 'state': 'y2ofRsykWRNBmwiC', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 15:42:47,079 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-11 15:42:47,079 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gmQwZcE8OBW4', 'nonce': '71o1TNoxCIfaVZ9S', 'state': 'y2ofRsykWRNBmwiC', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 15:42:47,079 oic.oic.provider:DEBUG id_token: {'aud': ['gmQwZcE8OBW4'], 'exp': 1439379767, 'nonce': '71o1TNoxCIfaVZ9S', 'iss': 'https://localhost:8092/', 'sub': '-7b89e30549c348b2', 'acr': 'PASSWORD', 'auth_time': 1439300567, 'iat': 1439300567}
2015-08-11 15:42:47,081 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "kty": "RSA"}, {"e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "kty": "RSA"}]}
2015-08-11 15:42:47,082 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "zMV6eMX0zNnEW70Q3eDshyVTn0dryk9JzNtnomJBdbc", "use": "sig", "y": "zM3xyN8gEHXcZC5XBvBkbHffV7W7oa9b5PNDwCiUZd0", "crv": "P-256", "kid": "op2", "kty": "EC"}]}
2015-08-11 15:42:47,082 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "H7lYWJAb7vz4oShCDDX7zO4Q6BqK3JI6KRtcQzrYrbQ", "use": "enc", "y": "iNkZQjyBAKlss6x9UkQ5kQ1w_kzIcJIeBBNjlLbHW6Y", "crv": "P-256", "kid": "op3", "kty": "EC"}]}
2015-08-11 15:42:47,082 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x104693dd8>]
2015-08-11 15:42:47,088 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-11 15:42:47,088 oic.oic.provider:DEBUG _tinfo: {'access_token': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2Wohqz+8C8MkTF3QlyHgA60sZMeC/bCybGs35UPfZw9Xow=', 'sub': '-7b89e30549c348b2', 'nonce': '71o1TNoxCIfaVZ9S', 'code': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2WoOwH4TCk4ZLd1MCsFvoINk4XOUqG5yAYZ9X17juDR0WE=', 'revoked': False, 'client_id': 'gmQwZcE8OBW4', 'state': 'y2ofRsykWRNBmwiC', 'access_token_scope': '?', 'oauth_state': 'token', 'refresh_token': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2WoXKV6k10Py2bZx0/rp6OH6KjGMwnMy/KLaXlrrjlX438=', 'permission': '', 'redirect_uri': 'http://localhost:8666/authz_cb', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhdWQiOiBbImdtUXdaY0U4T0JXNCJdLCAiZXhwIjogMTQzOTM3OTc2NywgIm5vbmNlIjogIjcxbzFUTm94Q0lmYVZaOVMiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICItN2I4OWUzMDU0OWMzNDhiMiIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQzOTMwMDU2NywgImlhdCI6IDE0MzkzMDA1Njd9.bdJWAr2vnoQ6DLalQeFLvmoH9JBcR1KAzEwoEt42lI5jIHargh3CMgqBy6eNmIhRTtL1fcg_gpdxtO56SFJ3MZ6rtJREmsPs_iLAQE9zdswpIbGbiSV9JlOI7yuquEwXKwMSdqrFx5BN9g6QrohdmdukQ4mwH3XYyesnLbVJ4nVojQWkosvEGPuPLn_W-GGXuFghPPsKQDCg1dY6qBr__zW-SLWt8tIAG1vyrEVt6WoxAS09He7JQBqx7rBUR3WyeZOqXqpvcgFJ4XL_9KlhgSLAsJWT791dccU8bNVCGOvcgeRuZbQH95nWa9mZoeQbdDXD_CNQyGZvXdoEKAsISA', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd7f0>, 'token_type': 'Bearer', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_expires_at': 1439300567, 'expires_in': 3600, 'code_used': True, 'authzreq': '{"acr_values": "SAML", "scope": "openid profile email address phone", "redirect_uri": "http://localhost:8666/authz_cb", "client_id": "gmQwZcE8OBW4", "nonce": "71o1TNoxCIfaVZ9S", "state": "y2ofRsykWRNBmwiC", "response_type": "code", "upm_answer": "true"}'}
2015-08-11 15:42:47,089 oic.oic.provider:DEBUG access_token_response: {'access_token': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2Wohqz+8C8MkTF3QlyHgA60sZMeC/bCybGs35UPfZw9Xow=', 'scope': 'openid profile email address phone', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'y2ofRsykWRNBmwiC', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhdWQiOiBbImdtUXdaY0U4T0JXNCJdLCAiZXhwIjogMTQzOTM3OTc2NywgIm5vbmNlIjogIjcxbzFUTm94Q0lmYVZaOVMiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICItN2I4OWUzMDU0OWMzNDhiMiIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQzOTMwMDU2NywgImlhdCI6IDE0MzkzMDA1Njd9.bdJWAr2vnoQ6DLalQeFLvmoH9JBcR1KAzEwoEt42lI5jIHargh3CMgqBy6eNmIhRTtL1fcg_gpdxtO56SFJ3MZ6rtJREmsPs_iLAQE9zdswpIbGbiSV9JlOI7yuquEwXKwMSdqrFx5BN9g6QrohdmdukQ4mwH3XYyesnLbVJ4nVojQWkosvEGPuPLn_W-GGXuFghPPsKQDCg1dY6qBr__zW-SLWt8tIAG1vyrEVt6WoxAS09He7JQBqx7rBUR3WyeZOqXqpvcgFJ4XL_9KlhgSLAsJWT791dccU8bNVCGOvcgeRuZbQH95nWa9mZoeQbdDXD_CNQyGZvXdoEKAsISA', 'refresh_token': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2WoXKV6k10Py2bZx0/rp6OH6KjGMwnMy/KLaXlrrjlX438='}
2015-08-11 15:42:47,098 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-11 15:42:47,111 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1043412e8>
2015-08-11 15:42:47,111 oic.oic:DEBUG verify keys: None
2015-08-11 15:42:47,111 oic.oic.provider:DEBUG user_info_request: {'access_token': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2Wohqz+8C8MkTF3QlyHgA60sZMeC/bCybGs35UPfZw9Xow='}
2015-08-11 15:42:47,111 oicServer:DEBUG access_token type: 'T'
2015-08-11 15:42:47,111 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gmQwZcE8OBW4', 'nonce': '71o1TNoxCIfaVZ9S', 'state': 'y2ofRsykWRNBmwiC', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-11 15:42:47,112 oic.oic.provider:DEBUG userinfo_claim: {'picture': None, 'birthdate': None, 'locale': None, 'zoneinfo': None, 'given_name': None, 'updated_at': None, 'address': None, 'phone_number': None, 'gender': None, 'website': None, 'preferred_username': None, 'family_name': None, 'profile': None, 'email': None, 'sub': None, 'name': None, 'nickname': None, 'email_verified': None, 'middle_name': None, 'phone_number_verified': None}
2015-08-11 15:42:47,112 oic.oic.provider:DEBUG Session info: {'access_token': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2Wohqz+8C8MkTF3QlyHgA60sZMeC/bCybGs35UPfZw9Xow=', 'sub': '-7b89e30549c348b2', 'nonce': '71o1TNoxCIfaVZ9S', 'code': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2WoOwH4TCk4ZLd1MCsFvoINk4XOUqG5yAYZ9X17juDR0WE=', 'revoked': False, 'client_id': 'gmQwZcE8OBW4', 'state': 'y2ofRsykWRNBmwiC', 'access_token_scope': '?', 'oauth_state': 'token', 'refresh_token': '5+DKK1q1mI5KkPbK6O48wDpQeF+Oh6xdxDklN5n/OyWwd+QHfUsb1gV3BGmsY2WoXKV6k10Py2bZx0/rp6OH6KjGMwnMy/KLaXlrrjlX438=', 'permission': '', 'redirect_uri': 'http://localhost:8666/authz_cb', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhdWQiOiBbImdtUXdaY0U4T0JXNCJdLCAiZXhwIjogMTQzOTM3OTc2NywgIm5vbmNlIjogIjcxbzFUTm94Q0lmYVZaOVMiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICItN2I4OWUzMDU0OWMzNDhiMiIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQzOTMwMDU2NywgImlhdCI6IDE0MzkzMDA1Njd9.bdJWAr2vnoQ6DLalQeFLvmoH9JBcR1KAzEwoEt42lI5jIHargh3CMgqBy6eNmIhRTtL1fcg_gpdxtO56SFJ3MZ6rtJREmsPs_iLAQE9zdswpIbGbiSV9JlOI7yuquEwXKwMSdqrFx5BN9g6QrohdmdukQ4mwH3XYyesnLbVJ4nVojQWkosvEGPuPLn_W-GGXuFghPPsKQDCg1dY6qBr__zW-SLWt8tIAG1vyrEVt6WoxAS09He7JQBqx7rBUR3WyeZOqXqpvcgFJ4XL_9KlhgSLAsJWT791dccU8bNVCGOvcgeRuZbQH95nWa9mZoeQbdDXD_CNQyGZvXdoEKAsISA', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1079bd7f0>, 'token_type': 'Bearer', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_expires_at': 1439300567, 'expires_in': 3600, 'code_used': True, 'authzreq': '{"acr_values": "SAML", "scope": "openid profile email address phone", "redirect_uri": "http://localhost:8666/authz_cb", "client_id": "gmQwZcE8OBW4", "nonce": "71o1TNoxCIfaVZ9S", "state": "y2ofRsykWRNBmwiC", "response_type": "code", "upm_answer": "true"}'}
2015-08-11 15:42:47,112 oic.oic.provider:DEBUG user_info_response: {'nickname': 'Dina', 'name': 'Diana Krall', 'email': 'diana@example.org', 'phone_number': '+46 90 7865000', 'sub': '-7b89e30549c348b2', 'family_name': 'Krall', 'email_verified': False, 'address': {'postal_code': 'SE-90187', 'locality': 'Ume', 'country': 'Sweden', 'street_address': 'Ume Universitet'}, 'given_name': 'Diana'}
2015-08-14 08:36:41,698 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-14 08:36:41,698 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "faUkpn2DP3Oqdao9GkDT773P3E85mJ78-BXSbR38wP0", "x": "lOjMn4fjS5x2oIbelo-aOa7xQupwG6jRDqEC1nb77C8", "kid": "op2"}]}
2015-08-14 08:36:41,698 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "bPRo_OM78CNs8rGDC2lOF5ga0TIJXycQqw2u6Ch4Ftg", "x": "k1E1X74Ia4WyU_Sw2PxI2yKPJXC7KP5o6flQB_FFxWI", "kid": "op3"}]}
2015-08-14 08:36:41,699 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-14 08:36:57,064 oicServer:INFO callback: <function webfinger at 0x10cb0b488>
2015-08-14 08:36:57,093 oicServer:INFO callback: <function op_info at 0x10cb0b140>
2015-08-14 08:36:57,093 root:INFO op_info
2015-08-14 08:36:57,093 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-14 08:36:57,094 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-14 08:36:57,442 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10cb0c1d0>
2015-08-14 08:36:57,442 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-14 08:36:57,443 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-14 08:36:57,450 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439530617, 'registration_access_token': 'og27THZ2f23WI95cR4qYaSIxhnfOYdyn', 'client_id': 'xO1IOeVrr5FC', 'client_secret': 'd81ca16a12948b9db7c85c5e521b581614d0b41a29cdc6b72fae93df', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xO1IOeVrr5FC', 'client_secret_expires_at': 1439617017}
2015-08-14 08:36:57,450 oic.utils.keyio:DEBUG loading keys for issuer: xO1IOeVrr5FC
2015-08-14 08:36:57,450 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-14 08:36:57,450 oic.oic.provider:DEBUG keys for xO1IOeVrr5FC: []
2015-08-14 08:36:57,452 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439530617, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'og27THZ2f23WI95cR4qYaSIxhnfOYdyn', 'client_id': 'xO1IOeVrr5FC', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=xO1IOeVrr5FC', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': 'd81ca16a12948b9db7c85c5e521b581614d0b41a29cdc6b72fae93df', 'client_secret_expires_at': 1439617017}
2015-08-14 08:36:57,452 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439530617, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xO1IOeVrr5FC', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'og27THZ2f23WI95cR4qYaSIxhnfOYdyn', 'response_types': [u'code'], 'client_id': 'xO1IOeVrr5FC', 'client_secret': 'd81ca16a12948b9db7c85c5e521b581614d0b41a29cdc6b72fae93df', 'client_secret_expires_at': 1439617017}
2015-08-14 08:36:57,480 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10cb0c110>
2015-08-14 08:36:57,480 oic.oauth2.provider:DEBUG Request: 'nonce=tib2TGGGLsZjekq2&acr_values=SAML&state=bVIfDr5H40z6NVk4&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=xO1IOeVrr5FC&scope=openid+profile+email+address+phone'
2015-08-14 08:36:57,481 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10c2e7d50>, <jwkest.jwk.RSAKey object at 0x10d006d10>, <jwkest.jwk.ECKey object at 0x10d006fd0>]
2015-08-14 08:36:57,481 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'tib2TGGGLsZjekq2', 'acr_values': 'SAML', 'state': 'bVIfDr5H40z6NVk4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'xO1IOeVrr5FC', 'scope': 'openid profile email address phone'}
2015-08-14 08:36:57,483 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'tib2TGGGLsZjekq2', 'acr_values': 'SAML', 'state': 'bVIfDr5H40z6NVk4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'xO1IOeVrr5FC', 'scope': 'openid profile email address phone'}
2015-08-14 08:36:57,484 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:36:57,485 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:36:57,485 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-14 08:36:57,485 oic.oauth2.provider:INFO No active authentication
2015-08-14 08:36:57,485 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=tib2TGGGLsZjekq2&acr_values=SAML&state=bVIfDr5H40z6NVk4&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=xO1IOeVrr5FC&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-14 08:36:57,528 oicServer:INFO callback: <function css at 0x10cb84320>
2015-08-14 08:36:57,540 root:DEBUG unknown side: favicon.ico
2015-08-14 08:37:01,366 oicServer:INFO callback: <function auth_verify at 0x10cfff6e0>
2015-08-14 08:37:01,367 oic.utils.authn.user:DEBUG verify(query=nonce%3Dtib2TGGGLsZjekq2%26acr_values%3DSAML%26state%3DbVIfDr5H40z6NVk4%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26client_id%3DxO1IOeVrr5FC%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-14 08:37:01,367 oic.utils.authn.user:DEBUG dict: {'query': ['nonce=tib2TGGGLsZjekq2&acr_values=SAML&state=bVIfDr5H40z6NVk4&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=xO1IOeVrr5FC&scope=openid+profile+email+address+phone'], 'login': ['diana'], 'password': ['krall'], 'form.commit': ['Submit'], 'acr_values': ["['SAML']"]}
2015-08-14 08:37:01,367 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-14 08:37:01,367 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['tib2TGGGLsZjekq2'], 'acr_values': ['SAML'], 'state': ['bVIfDr5H40z6NVk4'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'response_type': ['code'], 'client_id': ['xO1IOeVrr5FC'], 'upm_answer': 'true', 'scope': ['openid profile email address phone']}
2015-08-14 08:37:01,402 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10cb0c110>
2015-08-14 08:37:01,402 oic.oauth2.provider:DEBUG Request: 'nonce=tib2TGGGLsZjekq2&acr_values=SAML&state=bVIfDr5H40z6NVk4&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=xO1IOeVrr5FC&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-14 08:37:01,403 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10c2e7d50>, <jwkest.jwk.RSAKey object at 0x10d006d10>, <jwkest.jwk.ECKey object at 0x10d006fd0>]
2015-08-14 08:37:01,403 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'tib2TGGGLsZjekq2', 'acr_values': 'SAML', 'state': 'bVIfDr5H40z6NVk4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'xO1IOeVrr5FC', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-14 08:37:01,404 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'tib2TGGGLsZjekq2', 'acr_values': 'SAML', 'state': 'bVIfDr5H40z6NVk4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'xO1IOeVrr5FC', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-14 08:37:01,406 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:37:01,406 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:37:01,406 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-14 08:37:01,406 oic.oauth2.provider:INFO No active authentication
2015-08-14 08:37:01,406 oic.oic.provider:DEBUG - authenticated -
2015-08-14 08:37:01,406 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-14 08:37:01,406 oic.utils.sdb:DEBUG uid2sid: {'diana': ['060ae06ce5c25d1907090668650a363f80699b1d0b4dc6ef6f56301c']}
2015-08-14 08:37:01,406 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-14 08:37:01,407 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-14 08:37:01,409 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=bVIfDr5H40z6NVk4&code=7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL%2BtXD%2FdfSJRUv%2FzcwL2QCS%2B26nANObF1nSTezQxxjr6ceorDDA3H5Cs9aE2YELv4xJU4mp0bBzwoDg%3D' (<type 'str'>)
2015-08-14 08:37:01,459 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10cb0c150>
2015-08-14 08:37:01,460 oic.oic.provider:DEBUG - token -
2015-08-14 08:37:01,460 oic.oic.provider:INFO token_request: code=7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL%2BtXD%2FdfSJRUv%2FzcwL2QCS%2B26nANObF1nSTezQxxjr6ceorDDA3H5Cs9aE2YELv4xJU4mp0bBzwoDg%3D&client_secret=d81ca16a12948b9db7c85c5e521b581614d0b41a29cdc6b72fae93df&grant_type=authorization_code&client_id=xO1IOeVrr5FC&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-14 08:37:01,460 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': 'd81ca16a12948b9db7c85c5e521b581614d0b41a29cdc6b72fae93df', 'code': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nSTezQxxjr6ceorDDA3H5Cs9aE2YELv4xJU4mp0bBzwoDg=', 'client_id': 'xO1IOeVrr5FC', 'grant_type': 'authorization_code'}
2015-08-14 08:37:01,460 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': 'd81ca16a12948b9db7c85c5e521b581614d0b41a29cdc6b72fae93df', 'code': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nSTezQxxjr6ceorDDA3H5Cs9aE2YELv4xJU4mp0bBzwoDg=', 'client_id': 'xO1IOeVrr5FC', 'grant_type': 'authorization_code'}
2015-08-14 08:37:01,463 oic.utils.authn.client:DEBUG Verified Client ID: xO1IOeVrr5FC
2015-08-14 08:37:01,466 oic.oic.provider:DEBUG All checks OK
2015-08-14 08:37:01,466 oic.oic:DEBUG authzreq: {'nonce': u'tib2TGGGLsZjekq2', 'acr_values': u'SAML', 'state': u'bVIfDr5H40z6NVk4', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'xO1IOeVrr5FC', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-14 08:37:01,466 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-14 08:37:01,467 oic.oic:DEBUG authzreq: {'nonce': u'tib2TGGGLsZjekq2', 'acr_values': u'SAML', 'state': u'bVIfDr5H40z6NVk4', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'xO1IOeVrr5FC', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-14 08:37:01,467 oic.oic.provider:DEBUG id_token: {'nonce': 'tib2TGGGLsZjekq2', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439613421, 'auth_time': 1439534221, 'iat': 1439534221, 'aud': ['xO1IOeVrr5FC']}
2015-08-14 08:37:01,468 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-14 08:37:01,469 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "faUkpn2DP3Oqdao9GkDT773P3E85mJ78-BXSbR38wP0", "x": "lOjMn4fjS5x2oIbelo-aOa7xQupwG6jRDqEC1nb77C8", "kid": "op2"}]}
2015-08-14 08:37:01,469 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "bPRo_OM78CNs8rGDC2lOF5ga0TIJXycQqw2u6Ch4Ftg", "x": "k1E1X74Ia4WyU_Sw2PxI2yKPJXC7KP5o6flQB_FFxWI", "kid": "op3"}]}
2015-08-14 08:37:01,469 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10d006d10>]
2015-08-14 08:37:01,475 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-14 08:37:01,475 oic.oic.provider:DEBUG _tinfo: {'nonce': 'tib2TGGGLsZjekq2', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10d01b590>, 'code': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nSTezQxxjr6ceorDDA3H5Cs9aE2YELv4xJU4mp0bBzwoDg=', 'authzreq': '{"nonce": "tib2TGGGLsZjekq2", "acr_values": "SAML", "state": "bVIfDr5H40z6NVk4", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "xO1IOeVrr5FC", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nST6a72Q5HvSV7CS+gaLSh0WfEnerbel6g5yGPy6VNYcf8=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJ0aWIyVEdHR0xzWmpla3EyIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTYxMzQyMSwgImF1dGhfdGltZSI6IDE0Mzk1MzQyMjEsICJpYXQiOiAxNDM5NTM0MjIxLCAiYXVkIjogWyJ4TzFJT2VWcnI1RkMiXX0.af4dK6M15F4A_hWoeftl2sXAVG7EBF-fSB3g30IRgVLRnbKCVAN_6PAmweGBe4XYNE4FFLKkdv8Dvjul-XLFOEZ_W_UtLqF_y_EREN7ZxcFDXl7lBiMd5oQOYflO1F9NVb_c-xeMgzoCrmXXLFkjIsy9b4hu030uGKpnktNYl1sDGDZ9QnTsTmH1OQCWF8LXC3VupHPBiYhhIE349Uoba3RZZig1OJLxKPtizJocwtcWkwONDMW58TBVAOYD5PYnzbCuOjKq-O_18xz3pbYZUF-rMfKJnBVV3UeIOTELSp3_hEJWnRpBMZiA0u2eNpaJKl-rBmoAUvIdcK0ORPhPMQ', 'token_expires_at': 1439534221, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'bVIfDr5H40z6NVk4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'xO1IOeVrr5FC', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nST9cLiCVJTZfqrTgq92DVFiDiCkdu2PFbFS5bdkbenJOA=', 'sub': '-fdfb4a841dce167'}
2015-08-14 08:37:01,475 oic.oic.provider:DEBUG access_token_response: {'access_token': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nST6a72Q5HvSV7CS+gaLSh0WfEnerbel6g5yGPy6VNYcf8=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJ0aWIyVEdHR0xzWmpla3EyIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTYxMzQyMSwgImF1dGhfdGltZSI6IDE0Mzk1MzQyMjEsICJpYXQiOiAxNDM5NTM0MjIxLCAiYXVkIjogWyJ4TzFJT2VWcnI1RkMiXX0.af4dK6M15F4A_hWoeftl2sXAVG7EBF-fSB3g30IRgVLRnbKCVAN_6PAmweGBe4XYNE4FFLKkdv8Dvjul-XLFOEZ_W_UtLqF_y_EREN7ZxcFDXl7lBiMd5oQOYflO1F9NVb_c-xeMgzoCrmXXLFkjIsy9b4hu030uGKpnktNYl1sDGDZ9QnTsTmH1OQCWF8LXC3VupHPBiYhhIE349Uoba3RZZig1OJLxKPtizJocwtcWkwONDMW58TBVAOYD5PYnzbCuOjKq-O_18xz3pbYZUF-rMfKJnBVV3UeIOTELSp3_hEJWnRpBMZiA0u2eNpaJKl-rBmoAUvIdcK0ORPhPMQ', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'bVIfDr5H40z6NVk4', 'scope': 'openid profile email address phone', 'refresh_token': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nST9cLiCVJTZfqrTgq92DVFiDiCkdu2PFbFS5bdkbenJOA='}
2015-08-14 08:37:01,505 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-14 08:37:01,542 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10cb0c190>
2015-08-14 08:37:01,542 oic.oic:DEBUG verify keys: None
2015-08-14 08:37:01,543 oic.oic.provider:DEBUG user_info_request: {'access_token': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nST6a72Q5HvSV7CS+gaLSh0WfEnerbel6g5yGPy6VNYcf8='}
2015-08-14 08:37:01,543 oicServer:DEBUG access_token type: 'T'
2015-08-14 08:37:01,543 oic.oic:DEBUG authzreq: {'nonce': u'tib2TGGGLsZjekq2', 'acr_values': u'SAML', 'state': u'bVIfDr5H40z6NVk4', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'xO1IOeVrr5FC', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-14 08:37:01,543 oic.oic.provider:DEBUG userinfo_claim: {'profile': None, 'family_name': None, 'gender': None, 'middle_name': None, 'sub': None, 'phone_number_verified': None, 'picture': None, 'locale': None, 'email_verified': None, 'zoneinfo': None, 'preferred_username': None, 'updated_at': None, 'birthdate': None, 'website': None, 'nickname': None, 'given_name': None, 'address': None, 'phone_number': None, 'email': None, 'name': None}
2015-08-14 08:37:01,543 oic.oic.provider:DEBUG Session info: {'nonce': 'tib2TGGGLsZjekq2', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10d01b590>, 'code': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nSTezQxxjr6ceorDDA3H5Cs9aE2YELv4xJU4mp0bBzwoDg=', 'authzreq': '{"nonce": "tib2TGGGLsZjekq2", "acr_values": "SAML", "state": "bVIfDr5H40z6NVk4", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "xO1IOeVrr5FC", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nST6a72Q5HvSV7CS+gaLSh0WfEnerbel6g5yGPy6VNYcf8=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJ0aWIyVEdHR0xzWmpla3EyIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTYxMzQyMSwgImF1dGhfdGltZSI6IDE0Mzk1MzQyMjEsICJpYXQiOiAxNDM5NTM0MjIxLCAiYXVkIjogWyJ4TzFJT2VWcnI1RkMiXX0.af4dK6M15F4A_hWoeftl2sXAVG7EBF-fSB3g30IRgVLRnbKCVAN_6PAmweGBe4XYNE4FFLKkdv8Dvjul-XLFOEZ_W_UtLqF_y_EREN7ZxcFDXl7lBiMd5oQOYflO1F9NVb_c-xeMgzoCrmXXLFkjIsy9b4hu030uGKpnktNYl1sDGDZ9QnTsTmH1OQCWF8LXC3VupHPBiYhhIE349Uoba3RZZig1OJLxKPtizJocwtcWkwONDMW58TBVAOYD5PYnzbCuOjKq-O_18xz3pbYZUF-rMfKJnBVV3UeIOTELSp3_hEJWnRpBMZiA0u2eNpaJKl-rBmoAUvIdcK0ORPhPMQ', 'token_expires_at': 1439534221, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'bVIfDr5H40z6NVk4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'xO1IOeVrr5FC', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': '7uPpKl6psG9Q0oGx6vcmhVYcMN8BsL+tXD/dfSJRUv/zcwL2QCS+26nANObF1nST9cLiCVJTZfqrTgq92DVFiDiCkdu2PFbFS5bdkbenJOA=', 'sub': '-fdfb4a841dce167'}
2015-08-14 08:37:01,543 oic.oic.provider:DEBUG user_info_response: {'phone_number': '+46 90 7865000', 'family_name': 'Krall', 'sub': '-fdfb4a841dce167', 'email_verified': False, 'given_name': 'Diana', 'address': {'country': 'Sweden', 'postal_code': 'SE-90187', 'street_address': 'Ume\xc3\xa5 Universitet', 'locality': 'Ume\xc3\xa5'}, 'nickname': 'Dina', 'email': 'diana@example.org', 'name': 'Diana Krall'}
2015-08-14 08:37:26,363 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-14 08:37:26,363 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "4bkubJBUkTGoTBhg-_pdhWC7MdYr67h5unxRvSPGQJk", "x": "39ksK6fgzei8KK9_ZCiP36XurOrY_1X13cLpiovFBmQ", "kid": "op2"}]}
2015-08-14 08:37:26,363 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "NX7cnTg874RfszqKToOEc_HfyIDUS_34RTn1VF-xX28", "x": "py61LKeuJ7JgQG8pDq7_3-BTqip4edOiAJDanewOA3U", "kid": "op3"}]}
2015-08-14 08:37:26,364 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-14 08:37:36,086 oicServer:INFO callback: <function webfinger at 0x1057b3320>
2015-08-14 08:37:36,117 oicServer:INFO callback: <function op_info at 0x1057b1f50>
2015-08-14 08:37:36,117 root:INFO op_info
2015-08-14 08:37:36,118 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-14 08:37:36,118 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-14 08:37:36,166 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1057b2290>
2015-08-14 08:37:36,166 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-14 08:37:36,166 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-14 08:37:36,172 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439530656, 'registration_access_token': 'rAwPWnaKF7ccy9QM7e09r0GdVMxaRAnR', 'client_id': '74b7PTWaDgml', 'client_secret': '5e34478a9274204fa767252d90b9acbc88867ffeba12044a18ae3e4d', 'registration_client_uri': 'https://localhost:8092/registration?client_id=74b7PTWaDgml', 'client_secret_expires_at': 1439617056}
2015-08-14 08:37:36,173 oic.utils.keyio:DEBUG loading keys for issuer: 74b7PTWaDgml
2015-08-14 08:37:36,173 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-14 08:37:36,173 oic.oic.provider:DEBUG keys for 74b7PTWaDgml: []
2015-08-14 08:37:36,174 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439530656, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'rAwPWnaKF7ccy9QM7e09r0GdVMxaRAnR', 'client_id': '74b7PTWaDgml', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=74b7PTWaDgml', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '5e34478a9274204fa767252d90b9acbc88867ffeba12044a18ae3e4d', 'client_secret_expires_at': 1439617056}
2015-08-14 08:37:36,175 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439530656, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=74b7PTWaDgml', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'rAwPWnaKF7ccy9QM7e09r0GdVMxaRAnR', 'response_types': [u'code'], 'client_id': '74b7PTWaDgml', 'client_secret': '5e34478a9274204fa767252d90b9acbc88867ffeba12044a18ae3e4d', 'client_secret_expires_at': 1439617056}
2015-08-14 08:37:36,203 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1057b21d0>
2015-08-14 08:37:36,203 oic.oauth2.provider:DEBUG Request: 'nonce=FZonRZD6VkkSfk5c&acr_values=SAML&state=chA1QztgH1OXLVqR&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=74b7PTWaDgml&scope=openid+profile+email+address+phone'
2015-08-14 08:37:36,204 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x104c0fd90>, <jwkest.jwk.RSAKey object at 0x10592cd90>, <jwkest.jwk.ECKey object at 0x10592cf50>]
2015-08-14 08:37:36,204 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'FZonRZD6VkkSfk5c', 'acr_values': 'SAML', 'state': 'chA1QztgH1OXLVqR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '74b7PTWaDgml', 'scope': 'openid profile email address phone'}
2015-08-14 08:37:36,208 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'FZonRZD6VkkSfk5c', 'acr_values': 'SAML', 'state': 'chA1QztgH1OXLVqR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '74b7PTWaDgml', 'scope': 'openid profile email address phone'}
2015-08-14 08:37:36,209 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:37:36,210 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:37:36,210 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-14 08:37:36,210 oic.oauth2.provider:INFO No active authentication
2015-08-14 08:37:36,210 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=FZonRZD6VkkSfk5c&acr_values=SAML&state=chA1QztgH1OXLVqR&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=74b7PTWaDgml&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-14 08:37:36,224 oicServer:INFO callback: <function css at 0x1052741b8>
2015-08-14 08:37:40,073 oicServer:INFO callback: <function auth_verify at 0x105925578>
2015-08-14 08:37:40,073 oic.utils.authn.user:DEBUG verify(query=nonce%3DFZonRZD6VkkSfk5c%26acr_values%3DSAML%26state%3DchA1QztgH1OXLVqR%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26client_id%3D74b7PTWaDgml%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-14 08:37:40,073 oic.utils.authn.user:DEBUG dict: {'query': ['nonce=FZonRZD6VkkSfk5c&acr_values=SAML&state=chA1QztgH1OXLVqR&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=74b7PTWaDgml&scope=openid+profile+email+address+phone'], 'login': ['diana'], 'password': ['krall'], 'form.commit': ['Submit'], 'acr_values': ["['SAML']"]}
2015-08-14 08:37:40,073 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-14 08:37:40,073 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['FZonRZD6VkkSfk5c'], 'acr_values': ['SAML'], 'state': ['chA1QztgH1OXLVqR'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'response_type': ['code'], 'client_id': ['74b7PTWaDgml'], 'upm_answer': 'true', 'scope': ['openid profile email address phone']}
2015-08-14 08:37:40,098 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1057b21d0>
2015-08-14 08:37:40,098 oic.oauth2.provider:DEBUG Request: 'nonce=FZonRZD6VkkSfk5c&acr_values=SAML&state=chA1QztgH1OXLVqR&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=74b7PTWaDgml&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-14 08:37:40,098 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x104c0fd90>, <jwkest.jwk.RSAKey object at 0x10592cd90>, <jwkest.jwk.ECKey object at 0x10592cf50>]
2015-08-14 08:37:40,098 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'FZonRZD6VkkSfk5c', 'acr_values': 'SAML', 'state': 'chA1QztgH1OXLVqR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '74b7PTWaDgml', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-14 08:37:40,099 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'FZonRZD6VkkSfk5c', 'acr_values': 'SAML', 'state': 'chA1QztgH1OXLVqR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '74b7PTWaDgml', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-14 08:37:40,101 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:37:40,101 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-14 08:37:40,101 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-14 08:37:40,101 oic.oauth2.provider:INFO No active authentication
2015-08-14 08:37:40,101 oic.oic.provider:DEBUG - authenticated -
2015-08-14 08:37:40,101 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-14 08:37:40,101 oic.utils.sdb:DEBUG uid2sid: {'diana': ['553e6adf9e708621d7da7e05e71b3f3e17839f0d904b195612e7d362']}
2015-08-14 08:37:40,102 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-14 08:37:40,102 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-14 08:37:40,103 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=chA1QztgH1OXLVqR&code=vb2c%2B%2FDP0sQp7VNLOjGtqDYx%2FhroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhYzchCyKkYA9p05MvKZtnEhHUn%2Bpv%2BHKbtw%2FQKmXoPVU%3D' (<type 'str'>)
2015-08-14 08:37:40,135 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1057b2210>
2015-08-14 08:37:40,135 oic.oic.provider:DEBUG - token -
2015-08-14 08:37:40,135 oic.oic.provider:INFO token_request: code=vb2c%2B%2FDP0sQp7VNLOjGtqDYx%2FhroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhYzchCyKkYA9p05MvKZtnEhHUn%2Bpv%2BHKbtw%2FQKmXoPVU%3D&client_secret=5e34478a9274204fa767252d90b9acbc88867ffeba12044a18ae3e4d&grant_type=authorization_code&client_id=74b7PTWaDgml&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-14 08:37:40,135 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '5e34478a9274204fa767252d90b9acbc88867ffeba12044a18ae3e4d', 'code': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhYzchCyKkYA9p05MvKZtnEhHUn+pv+HKbtw/QKmXoPVU=', 'client_id': '74b7PTWaDgml', 'grant_type': 'authorization_code'}
2015-08-14 08:37:40,135 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '5e34478a9274204fa767252d90b9acbc88867ffeba12044a18ae3e4d', 'code': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhYzchCyKkYA9p05MvKZtnEhHUn+pv+HKbtw/QKmXoPVU=', 'client_id': '74b7PTWaDgml', 'grant_type': 'authorization_code'}
2015-08-14 08:37:40,137 oic.utils.authn.client:DEBUG Verified Client ID: 74b7PTWaDgml
2015-08-14 08:37:40,140 oic.oic.provider:DEBUG All checks OK
2015-08-14 08:37:40,140 oic.oic:DEBUG authzreq: {'nonce': u'FZonRZD6VkkSfk5c', 'acr_values': u'SAML', 'state': u'chA1QztgH1OXLVqR', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'74b7PTWaDgml', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-14 08:37:40,141 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-14 08:37:40,141 oic.oic:DEBUG authzreq: {'nonce': u'FZonRZD6VkkSfk5c', 'acr_values': u'SAML', 'state': u'chA1QztgH1OXLVqR', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'74b7PTWaDgml', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-14 08:37:40,141 oic.oic.provider:DEBUG id_token: {'nonce': 'FZonRZD6VkkSfk5c', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439613460, 'auth_time': 1439534260, 'iat': 1439534260, 'aud': ['74b7PTWaDgml']}
2015-08-14 08:37:40,143 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-14 08:37:40,143 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "4bkubJBUkTGoTBhg-_pdhWC7MdYr67h5unxRvSPGQJk", "x": "39ksK6fgzei8KK9_ZCiP36XurOrY_1X13cLpiovFBmQ", "kid": "op2"}]}
2015-08-14 08:37:40,143 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "NX7cnTg874RfszqKToOEc_HfyIDUS_34RTn1VF-xX28", "x": "py61LKeuJ7JgQG8pDq7_3-BTqip4edOiAJDanewOA3U", "kid": "op3"}]}
2015-08-14 08:37:40,143 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10592cd90>]
2015-08-14 08:37:40,149 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-14 08:37:40,149 oic.oic.provider:DEBUG _tinfo: {'nonce': 'FZonRZD6VkkSfk5c', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x104c105d0>, 'code': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhYzchCyKkYA9p05MvKZtnEhHUn+pv+HKbtw/QKmXoPVU=', 'authzreq': '{"nonce": "FZonRZD6VkkSfk5c", "acr_values": "SAML", "state": "chA1QztgH1OXLVqR", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "74b7PTWaDgml", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4Dwh92LjRMkL1qxmnQWAV82WWPIF0Pldz/O+sq4+l4r78qg=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJGWm9uUlpENlZra1NmazVjIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTYxMzQ2MCwgImF1dGhfdGltZSI6IDE0Mzk1MzQyNjAsICJpYXQiOiAxNDM5NTM0MjYwLCAiYXVkIjogWyI3NGI3UFRXYURnbWwiXX0.xn6jhdBND_Tt-AIk-ZNMuVdpIvOu3NLZLMy4Om2M1rZ0Mda8FtMLLrACKNFGWOGF8aZ8-Cy9QGYLpGVxX8aoJBKYs5HoDAfUcQNHXcDZM53DFFBjKVekMbtqFbm51qu7tFM0p51viaIm_hJq6nbt7-bXJid8FLMST54EI2FYJf2YP2OaYHPePiJG6KUuKxxj6i43GCM26ETw-Zt9TtJmOn8m1dT8C2B_Q_nLRblQ8oLR7YdhTYLgBdJLD1Gsq1PQ8hybepFo8KEPCSe22mvq5sy0TQ8PLjWDP9tN3hjfQp3ZC-PdG6UsHvEa2q5piH-JGuf2ZpCKiDqwHndCleGHhA', 'token_expires_at': 1439534260, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'chA1QztgH1OXLVqR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': '74b7PTWaDgml', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhgowYyN++TFWQHw0qu1D3t6XV2WyB9COE7Vwp/CMjZgo=', 'sub': '-fdfb4a841dce167'}
2015-08-14 08:37:40,150 oic.oic.provider:DEBUG access_token_response: {'access_token': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4Dwh92LjRMkL1qxmnQWAV82WWPIF0Pldz/O+sq4+l4r78qg=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJGWm9uUlpENlZra1NmazVjIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTYxMzQ2MCwgImF1dGhfdGltZSI6IDE0Mzk1MzQyNjAsICJpYXQiOiAxNDM5NTM0MjYwLCAiYXVkIjogWyI3NGI3UFRXYURnbWwiXX0.xn6jhdBND_Tt-AIk-ZNMuVdpIvOu3NLZLMy4Om2M1rZ0Mda8FtMLLrACKNFGWOGF8aZ8-Cy9QGYLpGVxX8aoJBKYs5HoDAfUcQNHXcDZM53DFFBjKVekMbtqFbm51qu7tFM0p51viaIm_hJq6nbt7-bXJid8FLMST54EI2FYJf2YP2OaYHPePiJG6KUuKxxj6i43GCM26ETw-Zt9TtJmOn8m1dT8C2B_Q_nLRblQ8oLR7YdhTYLgBdJLD1Gsq1PQ8hybepFo8KEPCSe22mvq5sy0TQ8PLjWDP9tN3hjfQp3ZC-PdG6UsHvEa2q5piH-JGuf2ZpCKiDqwHndCleGHhA', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'chA1QztgH1OXLVqR', 'scope': 'openid profile email address phone', 'refresh_token': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhgowYyN++TFWQHw0qu1D3t6XV2WyB9COE7Vwp/CMjZgo='}
2015-08-14 08:37:40,177 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-14 08:37:40,211 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1057b2250>
2015-08-14 08:37:40,212 oic.oic:DEBUG verify keys: None
2015-08-14 08:37:40,212 oic.oic.provider:DEBUG user_info_request: {'access_token': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4Dwh92LjRMkL1qxmnQWAV82WWPIF0Pldz/O+sq4+l4r78qg='}
2015-08-14 08:37:40,212 oicServer:DEBUG access_token type: 'T'
2015-08-14 08:37:40,212 oic.oic:DEBUG authzreq: {'nonce': u'FZonRZD6VkkSfk5c', 'acr_values': u'SAML', 'state': u'chA1QztgH1OXLVqR', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'74b7PTWaDgml', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-14 08:37:40,212 oic.oic.provider:DEBUG userinfo_claim: {'profile': None, 'family_name': None, 'gender': None, 'middle_name': None, 'sub': None, 'phone_number_verified': None, 'picture': None, 'locale': None, 'email_verified': None, 'zoneinfo': None, 'preferred_username': None, 'updated_at': None, 'birthdate': None, 'website': None, 'nickname': None, 'given_name': None, 'address': None, 'phone_number': None, 'email': None, 'name': None}
2015-08-14 08:37:40,212 oic.oic.provider:DEBUG Session info: {'nonce': 'FZonRZD6VkkSfk5c', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x104c105d0>, 'code': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhYzchCyKkYA9p05MvKZtnEhHUn+pv+HKbtw/QKmXoPVU=', 'authzreq': '{"nonce": "FZonRZD6VkkSfk5c", "acr_values": "SAML", "state": "chA1QztgH1OXLVqR", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "74b7PTWaDgml", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4Dwh92LjRMkL1qxmnQWAV82WWPIF0Pldz/O+sq4+l4r78qg=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJGWm9uUlpENlZra1NmazVjIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTYxMzQ2MCwgImF1dGhfdGltZSI6IDE0Mzk1MzQyNjAsICJpYXQiOiAxNDM5NTM0MjYwLCAiYXVkIjogWyI3NGI3UFRXYURnbWwiXX0.xn6jhdBND_Tt-AIk-ZNMuVdpIvOu3NLZLMy4Om2M1rZ0Mda8FtMLLrACKNFGWOGF8aZ8-Cy9QGYLpGVxX8aoJBKYs5HoDAfUcQNHXcDZM53DFFBjKVekMbtqFbm51qu7tFM0p51viaIm_hJq6nbt7-bXJid8FLMST54EI2FYJf2YP2OaYHPePiJG6KUuKxxj6i43GCM26ETw-Zt9TtJmOn8m1dT8C2B_Q_nLRblQ8oLR7YdhTYLgBdJLD1Gsq1PQ8hybepFo8KEPCSe22mvq5sy0TQ8PLjWDP9tN3hjfQp3ZC-PdG6UsHvEa2q5piH-JGuf2ZpCKiDqwHndCleGHhA', 'token_expires_at': 1439534260, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'chA1QztgH1OXLVqR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': '74b7PTWaDgml', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': 'vb2c+/DP0sQp7VNLOjGtqDYx/hroO8391pHAZ2iSHt52ZwDcH1hMZqd1dwyQ4DwhgowYyN++TFWQHw0qu1D3t6XV2WyB9COE7Vwp/CMjZgo=', 'sub': '-fdfb4a841dce167'}
2015-08-14 08:37:40,213 oic.oic.provider:DEBUG user_info_response: {'phone_number': '+46 90 7865000', 'family_name': 'Krall', 'sub': '-fdfb4a841dce167', 'email_verified': False, 'given_name': 'Diana', 'address': {'country': 'Sweden', 'postal_code': 'SE-90187', 'street_address': 'Ume\xc3\xa5 Universitet', 'locality': 'Ume\xc3\xa5'}, 'nickname': 'Dina', 'email': 'diana@example.org', 'name': 'Diana Krall'}
2015-08-17 12:39:45,367 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-17 12:39:45,368 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "rkCuE0ZH42j8xvT3l0LM4-x57EGq1G9qenHyeBHkW-w", "x": "7IN9Gy6t8UPFhEfDKenD_jXR0Q6bH8UdnDLMCoAkbAk", "kid": "op2"}]}
2015-08-17 12:39:45,368 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "BR4oS8YfTt8oDnKV0Wjax9s2wF2ak0VbEtRbvMWC-aI", "x": "tsNxJTPj-PiFctng_EPwY2uzcGifCgFEy6mgzYtIHvE", "kid": "op3"}]}
2015-08-17 12:39:45,368 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 09:20:19,054 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 09:20:19,054 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "CHuUMgWOS__P5iW0PSZCpiMVsM4m7us3kC8S26qG2ok", "x": "cgd1QrQ5AbxXiuotn7cvHJk-wd20_qdbxNaYCeCdXk8", "kid": "op2"}]}
2015-08-18 09:20:19,054 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "nFpeycCMfvLtws3SiKUyg6dHRGJKK22iJdk74dGHN9E", "x": "ok5vFJHwwvVhLO6fxJIbsKJ1TCTYTCiyOVeVAXfRBkA", "kid": "op3"}]}
2015-08-18 09:20:19,055 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 09:21:07,600 oicServer:INFO callback: <function webfinger at 0x10ee85320>
2015-08-18 09:21:07,611 oicServer:INFO callback: <function op_info at 0x10ee84f50>
2015-08-18 09:21:07,612 root:INFO op_info
2015-08-18 09:21:07,612 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 09:21:07,612 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 09:21:07,977 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10ee83610>
2015-08-18 09:21:07,977 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-18 09:21:07,978 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:21:07,992 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439878867, 'registration_access_token': 'PnvmlGQCE039wrt4VeYBLqbFgwd8MYge', 'client_id': 'kC1BOWtkxaTi', 'client_secret': 'b628c8eaa898ed9ad7fecb37d22d4f19a4ed84742491bb1b63a90931', 'registration_client_uri': 'https://localhost:8092/registration?client_id=kC1BOWtkxaTi', 'client_secret_expires_at': 1439965267}
2015-08-18 09:21:07,993 oic.utils.keyio:DEBUG loading keys for issuer: kC1BOWtkxaTi
2015-08-18 09:21:07,993 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:21:07,993 oic.oic.provider:DEBUG keys for kC1BOWtkxaTi: []
2015-08-18 09:21:07,995 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439878867, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'PnvmlGQCE039wrt4VeYBLqbFgwd8MYge', 'client_id': 'kC1BOWtkxaTi', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=kC1BOWtkxaTi', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': 'b628c8eaa898ed9ad7fecb37d22d4f19a4ed84742491bb1b63a90931', 'client_secret_expires_at': 1439965267}
2015-08-18 09:21:07,996 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439878867, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=kC1BOWtkxaTi', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'PnvmlGQCE039wrt4VeYBLqbFgwd8MYge', 'response_types': [u'code'], 'client_id': 'kC1BOWtkxaTi', 'client_secret': 'b628c8eaa898ed9ad7fecb37d22d4f19a4ed84742491bb1b63a90931', 'client_secret_expires_at': 1439965267}
2015-08-18 09:21:08,015 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:21:08,016 oic.oauth2.provider:DEBUG Request: 'nonce=y7urVukC95MkPpYN&acr_values=SAML&state=NTxBlDG0qThQ7NlS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=kC1BOWtkxaTi&scope=openid+profile+email+address+phone'
2015-08-18 09:21:08,016 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f36f610>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:21:08,016 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'y7urVukC95MkPpYN', 'acr_values': 'SAML', 'state': 'NTxBlDG0qThQ7NlS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'kC1BOWtkxaTi', 'scope': 'openid profile email address phone'}
2015-08-18 09:21:08,017 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'y7urVukC95MkPpYN', 'acr_values': 'SAML', 'state': 'NTxBlDG0qThQ7NlS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'kC1BOWtkxaTi', 'scope': 'openid profile email address phone'}
2015-08-18 09:21:08,019 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:21:08,019 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:21:08,019 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:21:08,019 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:21:08,019 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=y7urVukC95MkPpYN&acr_values=SAML&state=NTxBlDG0qThQ7NlS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=kC1BOWtkxaTi&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-18 09:21:08,065 oicServer:INFO callback: <function css at 0x10ec811b8>
2015-08-18 09:21:08,124 root:DEBUG unknown side: favicon.ico
2015-08-18 09:21:15,808 oicServer:INFO callback: <function auth_verify at 0x10f336e60>
2015-08-18 09:21:15,808 oic.utils.authn.user:DEBUG verify(query=nonce%3Dy7urVukC95MkPpYN%26acr_values%3DSAML%26state%3DNTxBlDG0qThQ7NlS%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26client_id%3DkC1BOWtkxaTi%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 09:21:15,808 oic.utils.authn.user:DEBUG dict: {u'query': [u'nonce=y7urVukC95MkPpYN&acr_values=SAML&state=NTxBlDG0qThQ7NlS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=kC1BOWtkxaTi&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-18 09:21:15,808 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 09:21:15,809 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'y7urVukC95MkPpYN'], u'acr_values': [u'SAML'], u'state': [u'NTxBlDG0qThQ7NlS'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'kC1BOWtkxaTi'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-18 09:21:15,841 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:21:15,841 oic.oauth2.provider:DEBUG Request: 'nonce=y7urVukC95MkPpYN&acr_values=SAML&state=NTxBlDG0qThQ7NlS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=kC1BOWtkxaTi&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-18 09:21:15,842 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f36f610>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:21:15,842 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'y7urVukC95MkPpYN', 'acr_values': 'SAML', 'state': 'NTxBlDG0qThQ7NlS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'kC1BOWtkxaTi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:21:15,843 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'y7urVukC95MkPpYN', 'acr_values': 'SAML', 'state': 'NTxBlDG0qThQ7NlS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'kC1BOWtkxaTi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:21:15,844 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:21:15,844 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:21:15,844 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:21:15,845 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:21:15,845 oic.oic.provider:DEBUG - authenticated -
2015-08-18 09:21:15,845 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-18 09:21:15,845 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['3f04bbc62c670d96579409666d91f98f72d06873bba39fafd59173e8']}
2015-08-18 09:21:15,845 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 09:21:15,845 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 09:21:15,847 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=NTxBlDG0qThQ7NlS&code=pvev72dIEKfRXJ8RbY1KKL37zxR8McC%2FyzgBlUt0z5dEKwm5F66h%2FcUMlIxRmEw1StDCIHkS0ntD%2FQHynrTC525tj8iIW%2BvDHNUTyJZnL8Y%3D' (<type 'str'>)
2015-08-18 09:22:30,098 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 09:24:18,805 oicServer:INFO callback: <function webfinger at 0x10ee85320>
2015-08-18 09:24:18,818 oicServer:INFO callback: <function op_info at 0x10ee84f50>
2015-08-18 09:24:18,818 root:INFO op_info
2015-08-18 09:24:18,819 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 09:24:18,819 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 09:24:18,862 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10ee83610>
2015-08-18 09:24:18,862 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-18 09:24:18,863 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:24:18,868 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439879058, 'registration_access_token': 'tzlSHLRh9ipMhRtW7Y3GKbzMAyT3xTn8', 'client_id': 'xPIdy35cIDUt', 'client_secret': '09f3c8834856fa1879957d3d7d48b4fb112a65f2e0dc792c5cba3bb9', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xPIdy35cIDUt', 'client_secret_expires_at': 1439965458}
2015-08-18 09:24:18,868 oic.utils.keyio:DEBUG loading keys for issuer: xPIdy35cIDUt
2015-08-18 09:24:18,868 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:24:18,868 oic.oic.provider:DEBUG keys for xPIdy35cIDUt: []
2015-08-18 09:24:18,869 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439879058, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'tzlSHLRh9ipMhRtW7Y3GKbzMAyT3xTn8', 'client_id': 'xPIdy35cIDUt', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=xPIdy35cIDUt', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '09f3c8834856fa1879957d3d7d48b4fb112a65f2e0dc792c5cba3bb9', 'client_secret_expires_at': 1439965458}
2015-08-18 09:24:18,869 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439879058, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=xPIdy35cIDUt', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'tzlSHLRh9ipMhRtW7Y3GKbzMAyT3xTn8', 'response_types': [u'code'], 'client_id': 'xPIdy35cIDUt', 'client_secret': '09f3c8834856fa1879957d3d7d48b4fb112a65f2e0dc792c5cba3bb9', 'client_secret_expires_at': 1439965458}
2015-08-18 09:24:18,881 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:24:18,881 oic.oauth2.provider:DEBUG Request: 'nonce=FGCZcOeCWHFe3hym&acr_values=SAML&state=dMI54AhBYN2PbrUD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=xPIdy35cIDUt&scope=openid+profile+email+address+phone'
2015-08-18 09:24:18,881 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f37b110>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:24:18,881 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'FGCZcOeCWHFe3hym', 'acr_values': 'SAML', 'state': 'dMI54AhBYN2PbrUD', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'xPIdy35cIDUt', 'scope': 'openid profile email address phone'}
2015-08-18 09:24:18,883 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'FGCZcOeCWHFe3hym', 'acr_values': 'SAML', 'state': 'dMI54AhBYN2PbrUD', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'xPIdy35cIDUt', 'scope': 'openid profile email address phone'}
2015-08-18 09:24:18,884 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:24:18,884 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:24:18,884 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:24:18,885 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:24:18,885 oic.oic.provider:DEBUG - authenticated -
2015-08-18 09:24:18,885 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'scope']
2015-08-18 09:24:18,885 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['3f04bbc62c670d96579409666d91f98f72d06873bba39fafd59173e8', '614a709cf95584444a3634ca20f4e4c440cdc39629ea114e0a33dc5d']}
2015-08-18 09:24:18,885 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 09:24:18,885 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 09:24:18,887 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=dMI54AhBYN2PbrUD&code=QGkVrlL9fwrRJnABGSPLvSgoX%2BwLD2qVQkuVMztVwxB9Kzxs6fBCkd69PhaZTzh3CA9NG0x16mAEow0PIK5rpD%2Fcl5HhfGFQ2PqiYkObB50%3D' (<type 'str'>)
2015-08-18 09:29:42,499 oicServer:INFO callback: <function webfinger at 0x10ee85320>
2015-08-18 09:29:42,511 oicServer:INFO callback: <function op_info at 0x10ee84f50>
2015-08-18 09:29:42,511 root:INFO op_info
2015-08-18 09:29:42,511 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 09:29:42,512 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 09:29:42,551 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10ee83610>
2015-08-18 09:29:42,551 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-18 09:29:42,551 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:29:42,556 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439879382, 'registration_access_token': 'PWK2RWkdHYqRx9wHfoKTX65kJ5S5cptG', 'client_id': 'dNOR1D99YqKi', 'client_secret': '45f67d0e1442eae7faafff54674190cf648e2075758c3dd0038ef3f4', 'registration_client_uri': 'https://localhost:8092/registration?client_id=dNOR1D99YqKi', 'client_secret_expires_at': 1439965782}
2015-08-18 09:29:42,556 oic.utils.keyio:DEBUG loading keys for issuer: dNOR1D99YqKi
2015-08-18 09:29:42,556 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:29:42,556 oic.oic.provider:DEBUG keys for dNOR1D99YqKi: []
2015-08-18 09:29:42,559 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439879382, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'PWK2RWkdHYqRx9wHfoKTX65kJ5S5cptG', 'client_id': 'dNOR1D99YqKi', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=dNOR1D99YqKi', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '45f67d0e1442eae7faafff54674190cf648e2075758c3dd0038ef3f4', 'client_secret_expires_at': 1439965782}
2015-08-18 09:29:42,559 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439879382, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=dNOR1D99YqKi', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'PWK2RWkdHYqRx9wHfoKTX65kJ5S5cptG', 'response_types': [u'code'], 'client_id': 'dNOR1D99YqKi', 'client_secret': '45f67d0e1442eae7faafff54674190cf648e2075758c3dd0038ef3f4', 'client_secret_expires_at': 1439965782}
2015-08-18 09:29:42,571 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:29:42,571 oic.oauth2.provider:DEBUG Request: 'nonce=bGLI5nAg8FRzzhTG&acr_values=SAML&state=nFjiZK9ScG0QaWOt&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=dNOR1D99YqKi&scope=openid+profile+email+address+phone'
2015-08-18 09:29:42,571 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f37b390>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:29:42,571 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'bGLI5nAg8FRzzhTG', 'acr_values': 'SAML', 'state': 'nFjiZK9ScG0QaWOt', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'dNOR1D99YqKi', 'scope': 'openid profile email address phone'}
2015-08-18 09:29:42,573 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'bGLI5nAg8FRzzhTG', 'acr_values': 'SAML', 'state': 'nFjiZK9ScG0QaWOt', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'dNOR1D99YqKi', 'scope': 'openid profile email address phone'}
2015-08-18 09:29:42,574 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:29:42,575 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:29:42,575 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:29:42,575 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:29:42,575 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=bGLI5nAg8FRzzhTG&acr_values=SAML&state=nFjiZK9ScG0QaWOt&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=dNOR1D99YqKi&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-18 09:29:42,596 oicServer:INFO callback: <function css at 0x10ec811b8>
2015-08-18 09:29:47,620 oicServer:INFO callback: <function auth_verify at 0x10f336e60>
2015-08-18 09:29:47,621 oic.utils.authn.user:DEBUG verify(query=nonce%3DbGLI5nAg8FRzzhTG%26acr_values%3DSAML%26state%3DnFjiZK9ScG0QaWOt%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26client_id%3DdNOR1D99YqKi%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 09:29:47,621 oic.utils.authn.user:DEBUG dict: {u'query': [u'nonce=bGLI5nAg8FRzzhTG&acr_values=SAML&state=nFjiZK9ScG0QaWOt&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=dNOR1D99YqKi&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-18 09:29:47,621 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 09:29:47,621 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'bGLI5nAg8FRzzhTG'], u'acr_values': [u'SAML'], u'state': [u'nFjiZK9ScG0QaWOt'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'dNOR1D99YqKi'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-18 09:29:47,648 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:29:47,648 oic.oauth2.provider:DEBUG Request: 'nonce=bGLI5nAg8FRzzhTG&acr_values=SAML&state=nFjiZK9ScG0QaWOt&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=dNOR1D99YqKi&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-18 09:29:47,648 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f37b390>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:29:47,648 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'bGLI5nAg8FRzzhTG', 'acr_values': 'SAML', 'state': 'nFjiZK9ScG0QaWOt', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'dNOR1D99YqKi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:29:47,649 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'bGLI5nAg8FRzzhTG', 'acr_values': 'SAML', 'state': 'nFjiZK9ScG0QaWOt', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'dNOR1D99YqKi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:29:47,650 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:29:47,650 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:29:47,651 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:29:47,651 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:29:47,651 oic.oic.provider:DEBUG - authenticated -
2015-08-18 09:29:47,651 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-18 09:29:47,651 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['3f04bbc62c670d96579409666d91f98f72d06873bba39fafd59173e8', '614a709cf95584444a3634ca20f4e4c440cdc39629ea114e0a33dc5d', '4d91e1de57fa50548a62912534c3fe6a8541c4e2e0266bab21a7f7a0']}
2015-08-18 09:29:47,651 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 09:29:47,651 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 09:29:47,653 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=nFjiZK9ScG0QaWOt&code=Nz1%2FlnyZ8NxUzWPx%2BVAGEMigftariVUCdzylHulUvtkW7iorFWP0gN%2BHOAS5T79oLoiB6AQ0jQzabxmLOPpYnDMISNJsegztPO8eQmMkV7E%3D' (<type 'str'>)
2015-08-18 09:33:33,997 oicServer:INFO callback: <function webfinger at 0x10ee85320>
2015-08-18 09:33:34,008 oicServer:INFO callback: <function op_info at 0x10ee84f50>
2015-08-18 09:33:34,008 root:INFO op_info
2015-08-18 09:33:34,009 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 09:33:34,009 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 09:33:34,047 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10ee83610>
2015-08-18 09:33:34,047 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-18 09:33:34,047 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:33:34,052 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439879614, 'registration_access_token': '6wymsImLwKY1uYPUscFT9wC9o2OAslyh', 'client_id': 'UeVxUCJTiESt', 'client_secret': '8bfa8a79410f20e7e81d3a22cfbf5f24776073fc3ac85c26a78cb706', 'registration_client_uri': 'https://localhost:8092/registration?client_id=UeVxUCJTiESt', 'client_secret_expires_at': 1439966014}
2015-08-18 09:33:34,052 oic.utils.keyio:DEBUG loading keys for issuer: UeVxUCJTiESt
2015-08-18 09:33:34,052 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:33:34,052 oic.oic.provider:DEBUG keys for UeVxUCJTiESt: []
2015-08-18 09:33:34,054 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439879614, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': '6wymsImLwKY1uYPUscFT9wC9o2OAslyh', 'client_id': 'UeVxUCJTiESt', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=UeVxUCJTiESt', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '8bfa8a79410f20e7e81d3a22cfbf5f24776073fc3ac85c26a78cb706', 'client_secret_expires_at': 1439966014}
2015-08-18 09:33:34,054 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439879614, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=UeVxUCJTiESt', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': '6wymsImLwKY1uYPUscFT9wC9o2OAslyh', 'response_types': [u'code'], 'client_id': 'UeVxUCJTiESt', 'client_secret': '8bfa8a79410f20e7e81d3a22cfbf5f24776073fc3ac85c26a78cb706', 'client_secret_expires_at': 1439966014}
2015-08-18 09:33:34,067 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:33:34,067 oic.oauth2.provider:DEBUG Request: 'nonce=YKBbp3XGaLo8sVES&acr_values=SAML&state=yAn5uTG5qH5TuPPi&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=UeVxUCJTiESt&scope=openid+profile+email+address+phone'
2015-08-18 09:33:34,068 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f37b810>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:33:34,068 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'YKBbp3XGaLo8sVES', 'acr_values': 'SAML', 'state': 'yAn5uTG5qH5TuPPi', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'UeVxUCJTiESt', 'scope': 'openid profile email address phone'}
2015-08-18 09:33:34,069 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'YKBbp3XGaLo8sVES', 'acr_values': 'SAML', 'state': 'yAn5uTG5qH5TuPPi', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'UeVxUCJTiESt', 'scope': 'openid profile email address phone'}
2015-08-18 09:33:34,071 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:33:34,071 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:33:34,071 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:33:34,072 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:33:34,072 oic.oic.provider:DEBUG - authenticated -
2015-08-18 09:33:34,072 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'scope']
2015-08-18 09:33:34,072 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['3f04bbc62c670d96579409666d91f98f72d06873bba39fafd59173e8', '614a709cf95584444a3634ca20f4e4c440cdc39629ea114e0a33dc5d', '4d91e1de57fa50548a62912534c3fe6a8541c4e2e0266bab21a7f7a0', 'bd4d304d9f26085f9687756a5c4abdf527d0452ea938d5b0ea353048']}
2015-08-18 09:33:34,073 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 09:33:34,073 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 09:33:34,076 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=yAn5uTG5qH5TuPPi&code=%2Bw1b0t0CvH%2BAz3%2B%2B38uNUBHUx9gdpFdQGuwYgTRNWkYd%2Bdhhytdo68jF7oYDjEioob%2Bvvq8HM%2BBBY9plYoyyryeFhSxdoxtEs%2FY5Ejjj7Hk%3D' (<type 'str'>)
2015-08-18 09:38:43,923 oicServer:INFO callback: <function webfinger at 0x10ee85320>
2015-08-18 09:38:43,936 oicServer:INFO callback: <function op_info at 0x10ee84f50>
2015-08-18 09:38:43,936 root:INFO op_info
2015-08-18 09:38:43,936 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 09:38:43,936 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 09:38:43,978 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10ee83610>
2015-08-18 09:38:43,978 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-18 09:38:43,978 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:38:43,983 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439879923, 'registration_access_token': '6AJipRgQDxZJUtAMj6LcwFVlAoGovIpf', 'client_id': 'EMqAY1U8BPWX', 'client_secret': '8761c043b7f0009b707d1cdfd3dd78d10ee5a383e8e854599f970624', 'registration_client_uri': 'https://localhost:8092/registration?client_id=EMqAY1U8BPWX', 'client_secret_expires_at': 1439966323}
2015-08-18 09:38:43,983 oic.utils.keyio:DEBUG loading keys for issuer: EMqAY1U8BPWX
2015-08-18 09:38:43,983 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:38:43,983 oic.oic.provider:DEBUG keys for EMqAY1U8BPWX: []
2015-08-18 09:38:43,985 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439879923, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': '6AJipRgQDxZJUtAMj6LcwFVlAoGovIpf', 'client_id': 'EMqAY1U8BPWX', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=EMqAY1U8BPWX', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '8761c043b7f0009b707d1cdfd3dd78d10ee5a383e8e854599f970624', 'client_secret_expires_at': 1439966323}
2015-08-18 09:38:43,986 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439879923, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=EMqAY1U8BPWX', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': '6AJipRgQDxZJUtAMj6LcwFVlAoGovIpf', 'response_types': [u'code'], 'client_id': 'EMqAY1U8BPWX', 'client_secret': '8761c043b7f0009b707d1cdfd3dd78d10ee5a383e8e854599f970624', 'client_secret_expires_at': 1439966323}
2015-08-18 09:38:43,998 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:38:43,998 oic.oauth2.provider:DEBUG Request: 'nonce=mxj97lVMSc1XsJ0i&acr_values=SAML&state=gLT0AgYvmp3ue5mu&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=EMqAY1U8BPWX&scope=openid+profile+email+address+phone'
2015-08-18 09:38:43,999 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f37ba10>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:38:43,999 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'mxj97lVMSc1XsJ0i', 'acr_values': 'SAML', 'state': 'gLT0AgYvmp3ue5mu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'EMqAY1U8BPWX', 'scope': 'openid profile email address phone'}
2015-08-18 09:38:44,000 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'mxj97lVMSc1XsJ0i', 'acr_values': 'SAML', 'state': 'gLT0AgYvmp3ue5mu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'EMqAY1U8BPWX', 'scope': 'openid profile email address phone'}
2015-08-18 09:38:44,003 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:38:44,003 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:38:44,003 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:38:44,003 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:38:44,003 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=mxj97lVMSc1XsJ0i&acr_values=SAML&state=gLT0AgYvmp3ue5mu&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=EMqAY1U8BPWX&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-18 09:38:44,025 oicServer:INFO callback: <function css at 0x10ec811b8>
2015-08-18 09:38:49,231 oicServer:INFO callback: <function auth_verify at 0x10f336e60>
2015-08-18 09:38:49,231 oic.utils.authn.user:DEBUG verify(query=nonce%3Dmxj97lVMSc1XsJ0i%26acr_values%3DSAML%26state%3DgLT0AgYvmp3ue5mu%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26client_id%3DEMqAY1U8BPWX%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 09:38:49,231 oic.utils.authn.user:DEBUG dict: {u'query': [u'nonce=mxj97lVMSc1XsJ0i&acr_values=SAML&state=gLT0AgYvmp3ue5mu&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=EMqAY1U8BPWX&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-18 09:38:49,232 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 09:38:49,232 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'mxj97lVMSc1XsJ0i'], u'acr_values': [u'SAML'], u'state': [u'gLT0AgYvmp3ue5mu'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'EMqAY1U8BPWX'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-18 09:38:49,254 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10ee83550>
2015-08-18 09:38:49,254 oic.oauth2.provider:DEBUG Request: 'nonce=mxj97lVMSc1XsJ0i&acr_values=SAML&state=gLT0AgYvmp3ue5mu&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=EMqAY1U8BPWX&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-18 09:38:49,254 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10f37ba10>, <jwkest.jwk.RSAKey object at 0x10f3416d0>, <jwkest.jwk.ECKey object at 0x10f364ed0>]
2015-08-18 09:38:49,254 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'mxj97lVMSc1XsJ0i', 'acr_values': 'SAML', 'state': 'gLT0AgYvmp3ue5mu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'EMqAY1U8BPWX', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:38:49,255 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'mxj97lVMSc1XsJ0i', 'acr_values': 'SAML', 'state': 'gLT0AgYvmp3ue5mu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'EMqAY1U8BPWX', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:38:49,256 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:38:49,256 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:38:49,256 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:38:49,257 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:38:49,257 oic.oic.provider:DEBUG - authenticated -
2015-08-18 09:38:49,257 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-18 09:38:49,257 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['3f04bbc62c670d96579409666d91f98f72d06873bba39fafd59173e8', '614a709cf95584444a3634ca20f4e4c440cdc39629ea114e0a33dc5d', '4d91e1de57fa50548a62912534c3fe6a8541c4e2e0266bab21a7f7a0', 'bd4d304d9f26085f9687756a5c4abdf527d0452ea938d5b0ea353048', 'c5e579fa73e6b97d5763994399e461b6f3ca7a6511c28c9793fd87fb']}
2015-08-18 09:38:49,257 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 09:38:49,257 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 09:38:49,260 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=gLT0AgYvmp3ue5mu&code=jSCGX%2FSBa8vWtpJw3D4d8heNb%2F%2FJj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOaHPtpxmAcbePtQZKQf66RIe09n9brp3vV8AbpIVqNrcQ%3D' (<type 'str'>)
2015-08-18 09:38:52,398 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10ee83590>
2015-08-18 09:38:52,398 oic.oic.provider:DEBUG - token -
2015-08-18 09:38:52,398 oic.oic.provider:INFO token_request: code=jSCGX%2FSBa8vWtpJw3D4d8heNb%2F%2FJj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOaHPtpxmAcbePtQZKQf66RIe09n9brp3vV8AbpIVqNrcQ%3D&key=eyJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAifQ%3D%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=EMqAY1U8BPWX&client_secret=8761c043b7f0009b707d1cdfd3dd78d10ee5a383e8e854599f970624&grant_type=authorization_code
2015-08-18 09:38:52,399 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'jSCGX/SBa8vWtpJw3D4d8heNb//Jj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOaHPtpxmAcbePtQZKQf66RIe09n9brp3vV8AbpIVqNrcQ=', u'key': u'eyJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'EMqAY1U8BPWX', u'client_secret': u'8761c043b7f0009b707d1cdfd3dd78d10ee5a383e8e854599f970624', 'grant_type': u'authorization_code'}
2015-08-18 09:38:52,399 oic.utils.authn.client:DEBUG REQ: {u'code': u'jSCGX/SBa8vWtpJw3D4d8heNb//Jj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOaHPtpxmAcbePtQZKQf66RIe09n9brp3vV8AbpIVqNrcQ=', u'key': u'eyJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'EMqAY1U8BPWX', u'client_secret': u'8761c043b7f0009b707d1cdfd3dd78d10ee5a383e8e854599f970624', 'grant_type': u'authorization_code'}
2015-08-18 09:38:52,400 oic.utils.authn.client:DEBUG Verified Client ID: EMqAY1U8BPWX
2015-08-18 09:38:52,404 oic.oic.provider:DEBUG All checks OK
2015-08-18 09:38:52,404 oic.oic:DEBUG authzreq: {'nonce': u'mxj97lVMSc1XsJ0i', 'acr_values': u'SAML', 'state': u'gLT0AgYvmp3ue5mu', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'EMqAY1U8BPWX', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 09:38:52,404 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 09:38:52,404 oic.oic:DEBUG authzreq: {'nonce': u'mxj97lVMSc1XsJ0i', 'acr_values': u'SAML', 'state': u'gLT0AgYvmp3ue5mu', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'EMqAY1U8BPWX', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 09:38:52,404 oic.oic.provider:DEBUG id_token: {'nonce': 'mxj97lVMSc1XsJ0i', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439962732, 'auth_time': 1439883529, 'iat': 1439883532, 'aud': ['EMqAY1U8BPWX']}
2015-08-18 09:38:52,406 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 09:38:52,406 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "CHuUMgWOS__P5iW0PSZCpiMVsM4m7us3kC8S26qG2ok", "x": "cgd1QrQ5AbxXiuotn7cvHJk-wd20_qdbxNaYCeCdXk8", "kid": "op2"}]}
2015-08-18 09:38:52,406 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "nFpeycCMfvLtws3SiKUyg6dHRGJKK22iJdk74dGHN9E", "x": "ok5vFJHwwvVhLO6fxJIbsKJ1TCTYTCiyOVeVAXfRBkA", "kid": "op3"}]}
2015-08-18 09:38:52,406 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10f3416d0>]
2015-08-18 09:38:52,414 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 09:38:52,414 oic.oic.provider:DEBUG _tinfo: {'nonce': 'mxj97lVMSc1XsJ0i', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10f37bd10>, 'code': u'jSCGX/SBa8vWtpJw3D4d8heNb//Jj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOaHPtpxmAcbePtQZKQf66RIe09n9brp3vV8AbpIVqNrcQ=', 'authzreq': '{"nonce": "mxj97lVMSc1XsJ0i", "acr_values": "SAML", "state": "gLT0AgYvmp3ue5mu", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "EMqAY1U8BPWX", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'jSCGX/SBa8vWtpJw3D4d8heNb//Jj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOa+xoo0nhJE1V1D1yRCowD5QXS4v5HisKmFo3rddv8nII=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJteGo5N2xWTVNjMVhzSjBpIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2MjczMiwgImF1dGhfdGltZSI6IDE0Mzk4ODM1MjksICJpYXQiOiAxNDM5ODgzNTMyLCAiYXVkIjogWyJFTXFBWTFVOEJQV1giXX0.UdphtnvhqhkF8hqcbJ1e8K2WD3s_SdiKME1w_Z2lGPilhO-mtE6bE8dndujOWvmJm6QYfheq73lGB1XO5fVleWYSYeMyl3xKN-7JOJTDOoNWIPTF708NzLhPZGIXLD6oAOHFyNuTT1WH4yT2qX_EpgKFH7xZ_bZ1UCDAsmhgYNFU-rm_TQzINFNMtIrb_DZsSMviBgUPlL5blItWSse-cxsQt4WNnYVez2plciaTYf3GM7maUkagnE4KP4ur-ZGhqmw1eHSUjqEINE5oS2S36aqjTYTGmxUAg9HwEZYsU1vXq7DrPACPI8kHsKW0itun-8yvTDkk-Ct4s8iPsDDMdQ', 'token_expires_at': 1439883532, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'gLT0AgYvmp3ue5mu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'EMqAY1U8BPWX', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'jSCGX/SBa8vWtpJw3D4d8heNb//Jj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOaYtW/50LIDR9aQ9GiQsD1R0TPQLxfYfSYxJX6mh8F+6g=', 'sub': '-fdfb4a841dce167'}
2015-08-18 09:38:52,414 oic.oic.provider:DEBUG access_token_response: {'access_token': u'jSCGX/SBa8vWtpJw3D4d8heNb//Jj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOa+xoo0nhJE1V1D1yRCowD5QXS4v5HisKmFo3rddv8nII=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJteGo5N2xWTVNjMVhzSjBpIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2MjczMiwgImF1dGhfdGltZSI6IDE0Mzk4ODM1MjksICJpYXQiOiAxNDM5ODgzNTMyLCAiYXVkIjogWyJFTXFBWTFVOEJQV1giXX0.UdphtnvhqhkF8hqcbJ1e8K2WD3s_SdiKME1w_Z2lGPilhO-mtE6bE8dndujOWvmJm6QYfheq73lGB1XO5fVleWYSYeMyl3xKN-7JOJTDOoNWIPTF708NzLhPZGIXLD6oAOHFyNuTT1WH4yT2qX_EpgKFH7xZ_bZ1UCDAsmhgYNFU-rm_TQzINFNMtIrb_DZsSMviBgUPlL5blItWSse-cxsQt4WNnYVez2plciaTYf3GM7maUkagnE4KP4ur-ZGhqmw1eHSUjqEINE5oS2S36aqjTYTGmxUAg9HwEZYsU1vXq7DrPACPI8kHsKW0itun-8yvTDkk-Ct4s8iPsDDMdQ', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'gLT0AgYvmp3ue5mu', 'scope': 'openid profile email address phone', 'refresh_token': u'jSCGX/SBa8vWtpJw3D4d8heNb//Jj89FWLPqb5mtny0PYxIfZw5xl8kEnBGrXFOaYtW/50LIDR9aQ9GiQsD1R0TPQLxfYfSYxJX6mh8F+6g='}
2015-08-18 09:38:52,429 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 09:38:52,446 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10ee835d0>
2015-08-18 09:38:52,449 oicServer:ERROR _parse_access_token() takes exactly 2 arguments (3 given)
Traceback (most recent call last):
  File "/Users/mathiashedstrom/work/DIRG/pyoidc/pyoidc/oidc_example/op2/server.py", line 353, in application
    return callback(environ, start_response, logger)
  File "/Users/mathiashedstrom/work/DIRG/pyoidc/pyoidc/src/oic/oauth2/provider.py", line 57, in __call__
    return self.func(*args, **kwargs)
  File "/Users/mathiashedstrom/work/DIRG/pyoidc/pyoidc/oidc_example/op2/server.py", line 129, in userinfo
    logger=logger)
  File "/Users/mathiashedstrom/work/DIRG/pyoidc/pyoidc/src/oic/utils/http_util.py", line 353, in wsgi_wrapper
    args = func(**kwargs)
  File "/Users/mathiashedstrom/work/DIRG/pyoidc/pyoidc/src/oic/oic/provider.py", line 993, in userinfo_endpoint
    _token = self._parse_access_token(request, kwargs)
TypeError: _parse_access_token() takes exactly 2 arguments (3 given)
2015-08-18 09:41:04,186 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 09:41:04,187 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 09:41:04,187 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 09:41:04,187 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 09:41:20,031 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 09:41:20,042 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 09:41:20,042 root:INFO op_info
2015-08-18 09:41:20,042 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 09:41:20,042 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 09:41:20,082 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 09:41:20,082 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-18 09:41:20,083 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:41:20,091 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439880080, 'registration_access_token': 'SrvqiAG60ZGqoGV16xI5fuEuYTK6UzdC', 'client_id': 'PEXmhEnzmnQ4', 'client_secret': '9f1edb0a9635657c19961f499c70696c7e86b15749edbe78ff919fe7', 'registration_client_uri': 'https://localhost:8092/registration?client_id=PEXmhEnzmnQ4', 'client_secret_expires_at': 1439966480}
2015-08-18 09:41:20,091 oic.utils.keyio:DEBUG loading keys for issuer: PEXmhEnzmnQ4
2015-08-18 09:41:20,091 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'response_types': [u'code'], 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success']}
2015-08-18 09:41:20,091 oic.oic.provider:DEBUG keys for PEXmhEnzmnQ4: []
2015-08-18 09:41:20,093 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439880080, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'SrvqiAG60ZGqoGV16xI5fuEuYTK6UzdC', 'client_id': 'PEXmhEnzmnQ4', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=PEXmhEnzmnQ4', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '9f1edb0a9635657c19961f499c70696c7e86b15749edbe78ff919fe7', 'client_secret_expires_at': 1439966480}
2015-08-18 09:41:20,093 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439880080, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=PEXmhEnzmnQ4', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'SrvqiAG60ZGqoGV16xI5fuEuYTK6UzdC', 'response_types': [u'code'], 'client_id': 'PEXmhEnzmnQ4', 'client_secret': '9f1edb0a9635657c19961f499c70696c7e86b15749edbe78ff919fe7', 'client_secret_expires_at': 1439966480}
2015-08-18 09:41:20,107 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 09:41:20,107 oic.oauth2.provider:DEBUG Request: 'nonce=oTo5o2jpbQtsIkuQ&acr_values=SAML&state=6QxKkzj0Z4YXbdle&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=PEXmhEnzmnQ4&scope=openid+profile+email+address+phone'
2015-08-18 09:41:20,108 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efcb610>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 09:41:20,108 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'oTo5o2jpbQtsIkuQ', 'acr_values': 'SAML', 'state': '6QxKkzj0Z4YXbdle', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'PEXmhEnzmnQ4', 'scope': 'openid profile email address phone'}
2015-08-18 09:41:20,109 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'oTo5o2jpbQtsIkuQ', 'acr_values': 'SAML', 'state': '6QxKkzj0Z4YXbdle', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'PEXmhEnzmnQ4', 'scope': 'openid profile email address phone'}
2015-08-18 09:41:20,111 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:41:20,111 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:41:20,111 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:41:20,111 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:41:20,111 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=oTo5o2jpbQtsIkuQ&acr_values=SAML&state=6QxKkzj0Z4YXbdle&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=PEXmhEnzmnQ4&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-18 09:41:20,129 oicServer:INFO callback: <function css at 0x10e8dd1b8>
2015-08-18 09:41:25,277 oicServer:INFO callback: <function auth_verify at 0x10ef92e60>
2015-08-18 09:41:25,277 oic.utils.authn.user:DEBUG verify(query=nonce%3DoTo5o2jpbQtsIkuQ%26acr_values%3DSAML%26state%3D6QxKkzj0Z4YXbdle%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26client_id%3DPEXmhEnzmnQ4%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 09:41:25,277 oic.utils.authn.user:DEBUG dict: {u'query': [u'nonce=oTo5o2jpbQtsIkuQ&acr_values=SAML&state=6QxKkzj0Z4YXbdle&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=PEXmhEnzmnQ4&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-18 09:41:25,277 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 09:41:25,278 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'oTo5o2jpbQtsIkuQ'], u'acr_values': [u'SAML'], u'state': [u'6QxKkzj0Z4YXbdle'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'PEXmhEnzmnQ4'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-18 09:41:25,299 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 09:41:25,299 oic.oauth2.provider:DEBUG Request: 'nonce=oTo5o2jpbQtsIkuQ&acr_values=SAML&state=6QxKkzj0Z4YXbdle&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=PEXmhEnzmnQ4&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-18 09:41:25,299 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efcb610>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 09:41:25,300 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'oTo5o2jpbQtsIkuQ', 'acr_values': 'SAML', 'state': '6QxKkzj0Z4YXbdle', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'PEXmhEnzmnQ4', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:41:25,300 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'oTo5o2jpbQtsIkuQ', 'acr_values': 'SAML', 'state': '6QxKkzj0Z4YXbdle', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'PEXmhEnzmnQ4', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 09:41:25,303 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:41:25,303 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 09:41:25,303 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 09:41:25,303 oic.oauth2.provider:INFO No active authentication
2015-08-18 09:41:25,303 oic.oic.provider:DEBUG - authenticated -
2015-08-18 09:41:25,303 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-18 09:41:25,304 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5']}
2015-08-18 09:41:25,304 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 09:41:25,304 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 09:41:25,305 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=6QxKkzj0Z4YXbdle&code=d1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1%2ByyWGSLFjaqLe%2BrVLL9YDlWiYj%2FHaWFCOgWuBmOI1WKFpBdVFtfjv4pmgW4%3D' (<type 'str'>)
2015-08-18 09:41:29,098 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 09:41:29,099 oic.oic.provider:DEBUG - token -
2015-08-18 09:41:29,099 oic.oic.provider:INFO token_request: code=d1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1%2ByyWGSLFjaqLe%2BrVLL9YDlWiYj%2FHaWFCOgWuBmOI1WKFpBdVFtfjv4pmgW4%3D&key=eyJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAifQ%3D%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=PEXmhEnzmnQ4&client_secret=9f1edb0a9635657c19961f499c70696c7e86b15749edbe78ff919fe7&grant_type=authorization_code
2015-08-18 09:41:29,099 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVLL9YDlWiYj/HaWFCOgWuBmOI1WKFpBdVFtfjv4pmgW4=', u'key': u'eyJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'PEXmhEnzmnQ4', u'client_secret': u'9f1edb0a9635657c19961f499c70696c7e86b15749edbe78ff919fe7', 'grant_type': u'authorization_code'}
2015-08-18 09:41:29,099 oic.utils.authn.client:DEBUG REQ: {u'code': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVLL9YDlWiYj/HaWFCOgWuBmOI1WKFpBdVFtfjv4pmgW4=', u'key': u'eyJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'PEXmhEnzmnQ4', u'client_secret': u'9f1edb0a9635657c19961f499c70696c7e86b15749edbe78ff919fe7', 'grant_type': u'authorization_code'}
2015-08-18 09:41:29,100 oic.utils.authn.client:DEBUG Verified Client ID: PEXmhEnzmnQ4
2015-08-18 09:41:29,103 oic.oic.provider:DEBUG All checks OK
2015-08-18 09:41:29,104 oic.oic:DEBUG authzreq: {'nonce': u'oTo5o2jpbQtsIkuQ', 'acr_values': u'SAML', 'state': u'6QxKkzj0Z4YXbdle', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'PEXmhEnzmnQ4', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 09:41:29,104 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 09:41:29,104 oic.oic:DEBUG authzreq: {'nonce': u'oTo5o2jpbQtsIkuQ', 'acr_values': u'SAML', 'state': u'6QxKkzj0Z4YXbdle', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'PEXmhEnzmnQ4', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 09:41:29,104 oic.oic.provider:DEBUG id_token: {'nonce': 'oTo5o2jpbQtsIkuQ', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439962889, 'auth_time': 1439883685, 'iat': 1439883689, 'aud': ['PEXmhEnzmnQ4']}
2015-08-18 09:41:29,106 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 09:41:29,106 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 09:41:29,106 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 09:41:29,107 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 09:41:29,113 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 09:41:29,113 oic.oic.provider:DEBUG _tinfo: {'nonce': 'oTo5o2jpbQtsIkuQ', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efcbe10>, 'code': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVLL9YDlWiYj/HaWFCOgWuBmOI1WKFpBdVFtfjv4pmgW4=', 'authzreq': '{"nonce": "oTo5o2jpbQtsIkuQ", "acr_values": "SAML", "state": "6QxKkzj0Z4YXbdle", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "PEXmhEnzmnQ4", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVDGPOQUy7eDxaN0ZauWClnKhwPihK60ZuQuKikMziMLc=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJvVG81bzJqcGJRdHNJa3VRIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2Mjg4OSwgImF1dGhfdGltZSI6IDE0Mzk4ODM2ODUsICJpYXQiOiAxNDM5ODgzNjg5LCAiYXVkIjogWyJQRVhtaEVuem1uUTQiXX0.WLVLgF7WZ9hfRdgHyg5sgro190VhGHHo8fNEEmLteNAJcGoVKuPBjIHpshIRHWDVA5vAHRsf69xTrLaqZEnDztiO5aCh_YY0SszxrWErSVTEA0T5y4QViyV7KM76ZQG63rkYIHoeuHB5NToKdAMgCYADwfYsNH3Nkj45kjjx3BltEEk3ttTZOCa0PiB8C2Zxw3-h-6JSRDScG5aXmQFOXHgOy_2QJXGXeNi-I68Z1kHjx6X5YGjSahgCVZOZChl6ydfxbeHZVD-cZ1vxG1-DZOu0aeSnYT-2oRCIxDCKMIbQvenSMyIzEX6kjamwvbluVm_Kh9Nd6D9B1z0DhaqGLg', 'token_expires_at': 1439883689, 'expires_in': 3600, 'token_type': 'Bearer', 'state': '6QxKkzj0Z4YXbdle', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'PEXmhEnzmnQ4', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVagBhD5wswyDUSbORsYvbY9nEdstuerOnobB30Yt63Ps=', 'sub': '-fdfb4a841dce167'}
2015-08-18 09:41:29,113 oic.oic.provider:DEBUG access_token_response: {'access_token': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVDGPOQUy7eDxaN0ZauWClnKhwPihK60ZuQuKikMziMLc=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJvVG81bzJqcGJRdHNJa3VRIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2Mjg4OSwgImF1dGhfdGltZSI6IDE0Mzk4ODM2ODUsICJpYXQiOiAxNDM5ODgzNjg5LCAiYXVkIjogWyJQRVhtaEVuem1uUTQiXX0.WLVLgF7WZ9hfRdgHyg5sgro190VhGHHo8fNEEmLteNAJcGoVKuPBjIHpshIRHWDVA5vAHRsf69xTrLaqZEnDztiO5aCh_YY0SszxrWErSVTEA0T5y4QViyV7KM76ZQG63rkYIHoeuHB5NToKdAMgCYADwfYsNH3Nkj45kjjx3BltEEk3ttTZOCa0PiB8C2Zxw3-h-6JSRDScG5aXmQFOXHgOy_2QJXGXeNi-I68Z1kHjx6X5YGjSahgCVZOZChl6ydfxbeHZVD-cZ1vxG1-DZOu0aeSnYT-2oRCIxDCKMIbQvenSMyIzEX6kjamwvbluVm_Kh9Nd6D9B1z0DhaqGLg', 'expires_in': 3600, 'token_type': 'Bearer', 'state': '6QxKkzj0Z4YXbdle', 'scope': 'openid profile email address phone', 'refresh_token': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVagBhD5wswyDUSbORsYvbY9nEdstuerOnobB30Yt63Ps='}
2015-08-18 09:41:29,126 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 09:41:29,145 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10eadf5d0>
2015-08-18 09:41:29,145 oic.oic:DEBUG verify keys: None
2015-08-18 09:41:29,145 oic.oic.provider:DEBUG user_info_request: {u'access_token': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVDGPOQUy7eDxaN0ZauWClnKhwPihK60ZuQuKikMziMLc='}
2015-08-18 09:41:29,145 oicServer:DEBUG access_token type: 'T'
2015-08-18 09:41:29,145 oic.oic:DEBUG authzreq: {'nonce': u'oTo5o2jpbQtsIkuQ', 'acr_values': u'SAML', 'state': u'6QxKkzj0Z4YXbdle', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'PEXmhEnzmnQ4', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 09:41:29,145 oic.oic.provider:DEBUG userinfo_claim: {'profile': None, 'family_name': None, 'gender': None, 'middle_name': None, 'sub': None, 'phone_number_verified': None, 'picture': None, 'locale': None, 'email_verified': None, 'zoneinfo': None, 'preferred_username': None, 'updated_at': None, 'birthdate': None, 'website': None, 'nickname': None, 'given_name': None, 'address': None, 'phone_number': None, 'email': None, 'name': None}
2015-08-18 09:41:29,145 oic.oic.provider:DEBUG Session info: {'nonce': 'oTo5o2jpbQtsIkuQ', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efcbe10>, 'code': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVLL9YDlWiYj/HaWFCOgWuBmOI1WKFpBdVFtfjv4pmgW4=', 'authzreq': '{"nonce": "oTo5o2jpbQtsIkuQ", "acr_values": "SAML", "state": "6QxKkzj0Z4YXbdle", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "PEXmhEnzmnQ4", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVDGPOQUy7eDxaN0ZauWClnKhwPihK60ZuQuKikMziMLc=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJvVG81bzJqcGJRdHNJa3VRIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2Mjg4OSwgImF1dGhfdGltZSI6IDE0Mzk4ODM2ODUsICJpYXQiOiAxNDM5ODgzNjg5LCAiYXVkIjogWyJQRVhtaEVuem1uUTQiXX0.WLVLgF7WZ9hfRdgHyg5sgro190VhGHHo8fNEEmLteNAJcGoVKuPBjIHpshIRHWDVA5vAHRsf69xTrLaqZEnDztiO5aCh_YY0SszxrWErSVTEA0T5y4QViyV7KM76ZQG63rkYIHoeuHB5NToKdAMgCYADwfYsNH3Nkj45kjjx3BltEEk3ttTZOCa0PiB8C2Zxw3-h-6JSRDScG5aXmQFOXHgOy_2QJXGXeNi-I68Z1kHjx6X5YGjSahgCVZOZChl6ydfxbeHZVD-cZ1vxG1-DZOu0aeSnYT-2oRCIxDCKMIbQvenSMyIzEX6kjamwvbluVm_Kh9Nd6D9B1z0DhaqGLg', 'token_expires_at': 1439883689, 'expires_in': 3600, 'token_type': 'Bearer', 'state': '6QxKkzj0Z4YXbdle', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'PEXmhEnzmnQ4', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'd1dRopaIus8pdXDeAYbIKU2Q36TE6NYY0LuRVhWfkgItEwO1+yyWGSLFjaqLe+rVagBhD5wswyDUSbORsYvbY9nEdstuerOnobB30Yt63Ps=', 'sub': '-fdfb4a841dce167'}
2015-08-18 09:41:29,146 oic.oic.provider:DEBUG user_info_response: {'phone_number': '+46 90 7865000', 'family_name': 'Krall', 'sub': '-fdfb4a841dce167', 'email_verified': False, 'given_name': 'Diana', 'address': {'country': 'Sweden', 'postal_code': 'SE-90187', 'street_address': 'Ume\xc3\xa5 Universitet', 'locality': 'Ume\xc3\xa5'}, 'nickname': 'Dina', 'email': 'diana@example.org', 'name': 'Diana Krall'}
2015-08-18 10:02:45,082 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 10:02:45,097 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 10:02:45,097 root:INFO op_info
2015-08-18 10:02:45,097 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 10:02:45,097 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 10:02:45,272 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 10:02:45,272 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 10:02:45,273 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:02:45,278 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439881365, 'registration_access_token': 'v0cuupd91OCSJ08vIlT8ILpdanfZFTDn', 'client_id': 'H2WMsazHcgDQ', 'client_secret': '2c85a21f8367d52dee11523f17d924d3c955158fd84df91725544440', 'registration_client_uri': 'https://localhost:8092/registration?client_id=H2WMsazHcgDQ', 'client_secret_expires_at': 1439967765}
2015-08-18 10:02:45,278 oic.utils.keyio:DEBUG loading keys for issuer: H2WMsazHcgDQ
2015-08-18 10:02:45,278 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:02:45,279 oic.oic.provider:DEBUG keys for H2WMsazHcgDQ: []
2015-08-18 10:02:45,280 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439881365, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'v0cuupd91OCSJ08vIlT8ILpdanfZFTDn', 'client_id': 'H2WMsazHcgDQ', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=H2WMsazHcgDQ', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '2c85a21f8367d52dee11523f17d924d3c955158fd84df91725544440', 'client_secret_expires_at': 1439967765}
2015-08-18 10:02:45,280 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439881365, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=H2WMsazHcgDQ', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'v0cuupd91OCSJ08vIlT8ILpdanfZFTDn', 'response_types': [u'code'], 'client_id': 'H2WMsazHcgDQ', 'client_secret': '2c85a21f8367d52dee11523f17d924d3c955158fd84df91725544440', 'client_secret_expires_at': 1439967765}
2015-08-18 10:02:45,298 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:02:45,298 oic.oauth2.provider:DEBUG Request: 'response_type=code&nonce=5Ru6Ue8zcwZTn74g&client_id=H2WMsazHcgDQ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=MS6uriZjl4BfrUTm&acr_values=SAML&scope=openid+profile+email+address+phone'
2015-08-18 10:02:45,298 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd61d0>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:02:45,298 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': '5Ru6Ue8zcwZTn74g', 'acr_values': 'SAML', 'state': 'MS6uriZjl4BfrUTm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'H2WMsazHcgDQ', 'scope': 'openid profile email address phone'}
2015-08-18 10:02:45,300 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': '5Ru6Ue8zcwZTn74g', 'acr_values': 'SAML', 'state': 'MS6uriZjl4BfrUTm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'H2WMsazHcgDQ', 'scope': 'openid profile email address phone'}
2015-08-18 10:02:45,301 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:02:45,302 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:02:45,302 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:02:45,302 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:02:45,302 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'response_type=code&nonce=5Ru6Ue8zcwZTn74g&client_id=H2WMsazHcgDQ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=MS6uriZjl4BfrUTm&acr_values=SAML&scope=openid+profile+email+address+phone', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-18 10:02:45,314 oicServer:INFO callback: <function css at 0x10e8dd1b8>
2015-08-18 10:02:50,649 oicServer:INFO callback: <function auth_verify at 0x10ef92e60>
2015-08-18 10:02:50,649 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26nonce%3D5Ru6Ue8zcwZTn74g%26client_id%3DH2WMsazHcgDQ%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26state%3DMS6uriZjl4BfrUTm%26acr_values%3DSAML%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 10:02:50,649 oic.utils.authn.user:DEBUG dict: {u'query': [u'response_type=code&nonce=5Ru6Ue8zcwZTn74g&client_id=H2WMsazHcgDQ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=MS6uriZjl4BfrUTm&acr_values=SAML&scope=openid+profile+email+address+phone'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-18 10:02:50,649 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 10:02:50,650 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'5Ru6Ue8zcwZTn74g'], u'acr_values': [u'SAML'], u'state': [u'MS6uriZjl4BfrUTm'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'H2WMsazHcgDQ'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-18 10:02:50,671 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:02:50,671 oic.oauth2.provider:DEBUG Request: 'nonce=5Ru6Ue8zcwZTn74g&acr_values=SAML&state=MS6uriZjl4BfrUTm&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=H2WMsazHcgDQ&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-18 10:02:50,671 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd61d0>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:02:50,672 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': '5Ru6Ue8zcwZTn74g', 'acr_values': 'SAML', 'state': 'MS6uriZjl4BfrUTm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'H2WMsazHcgDQ', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 10:02:50,672 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': '5Ru6Ue8zcwZTn74g', 'acr_values': 'SAML', 'state': 'MS6uriZjl4BfrUTm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'H2WMsazHcgDQ', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 10:02:50,674 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:02:50,674 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:02:50,674 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:02:50,674 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:02:50,674 oic.oic.provider:DEBUG - authenticated -
2015-08-18 10:02:50,674 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-18 10:02:50,675 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5', '7bdfc17ab4d563acc25e46397c85a35dfc1899aa3310cecb4273966c']}
2015-08-18 10:02:50,675 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 10:02:50,675 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 10:02:50,676 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=MS6uriZjl4BfrUTm&code=Nv3%2BDDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT%2FswUfTUaWd9wQXObdlZQonwpxamvVEb98k2lN7pI%2BO6ioqxE5voFjHEU3VaW%2FSyuaUY%3D' (<type 'str'>)
2015-08-18 10:02:53,909 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 10:02:53,910 oic.oic.provider:DEBUG - token -
2015-08-18 10:02:53,910 oic.oic.provider:INFO token_request: key=eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&client_secret=2c85a21f8367d52dee11523f17d924d3c955158fd84df91725544440&grant_type=authorization_code&code=Nv3%2BDDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT%2FswUfTUaWd9wQXObdlZQonwpxamvVEb98k2lN7pI%2BO6ioqxE5voFjHEU3VaW%2FSyuaUY%3D&client_id=H2WMsazHcgDQ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-18 10:02:53,910 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'Nv3+DDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT/swUfTUaWd9wQXObdlZQonwpxamvVEb98k2lN7pI+O6ioqxE5voFjHEU3VaW/SyuaUY=', u'key': u'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'H2WMsazHcgDQ', u'client_secret': u'2c85a21f8367d52dee11523f17d924d3c955158fd84df91725544440', 'grant_type': u'authorization_code'}
2015-08-18 10:02:53,910 oic.utils.authn.client:DEBUG REQ: {u'code': u'Nv3+DDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT/swUfTUaWd9wQXObdlZQonwpxamvVEb98k2lN7pI+O6ioqxE5voFjHEU3VaW/SyuaUY=', u'key': u'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'H2WMsazHcgDQ', u'client_secret': u'2c85a21f8367d52dee11523f17d924d3c955158fd84df91725544440', 'grant_type': u'authorization_code'}
2015-08-18 10:02:53,911 oic.utils.authn.client:DEBUG Verified Client ID: H2WMsazHcgDQ
2015-08-18 10:02:53,913 oic.oic.provider:DEBUG All checks OK
2015-08-18 10:02:53,914 oic.oic:DEBUG authzreq: {'nonce': u'5Ru6Ue8zcwZTn74g', 'acr_values': u'SAML', 'state': u'MS6uriZjl4BfrUTm', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'H2WMsazHcgDQ', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 10:02:53,914 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 10:02:53,914 oic.oic:DEBUG authzreq: {'nonce': u'5Ru6Ue8zcwZTn74g', 'acr_values': u'SAML', 'state': u'MS6uriZjl4BfrUTm', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'H2WMsazHcgDQ', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 10:02:53,914 oic.oic.provider:DEBUG id_token: {'nonce': '5Ru6Ue8zcwZTn74g', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439964173, 'auth_time': 1439884970, 'iat': 1439884973, 'aud': ['H2WMsazHcgDQ']}
2015-08-18 10:02:53,916 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 10:02:53,917 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 10:02:53,917 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 10:02:53,917 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 10:02:53,923 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 10:02:53,924 oic.oic.provider:DEBUG _tinfo: {'nonce': '5Ru6Ue8zcwZTn74g', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd6590>, 'code': u'Nv3+DDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT/swUfTUaWd9wQXObdlZQonwpxamvVEb98k2lN7pI+O6ioqxE5voFjHEU3VaW/SyuaUY=', 'authzreq': '{"nonce": "5Ru6Ue8zcwZTn74g", "acr_values": "SAML", "state": "MS6uriZjl4BfrUTm", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "H2WMsazHcgDQ", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'Nv3+DDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT/swUfTUaWd9wQXObdlZQonwpbGe8mNien6UlA6CQjQYvsIsOoA8j7R4MYiWT7ek5Mlo=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICI1UnU2VWU4emN3WlRuNzRnIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NDE3MywgImF1dGhfdGltZSI6IDE0Mzk4ODQ5NzAsICJpYXQiOiAxNDM5ODg0OTczLCAiYXVkIjogWyJIMldNc2F6SGNnRFEiXX0.nmTVU-Pw5xZFvttRtTnF3g1gWWyJIr3E1UWsvwIc_hJ_Htb2huTp4ImTicKobf-m3EI2nr3pSjhyhuTbJZGVxCoQhLe7nuqZFdCrossMJ3XJsVUBKOZFVMTlcMm85K9T-Ar3Q99ieK7Vp-uCqkWlFPFqbxvca6h1FNmtSgCY27YIP2_fbBKghHhBVQpboS93w5efeyaZNTuBHbi-wQ3koluUsD1pG05U5_EUvZUJh1chp4KfcHUfTnuQ9ZM5BwoVp4swiJa59CFF_9D4WeXGZ92xfLmlhq3wRJl6Z_X-iMtKX-XnT1acqezBR-bNFdHuiNOCPf3MQhCNch7enm8WLg', 'token_expires_at': 1439884973, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'MS6uriZjl4BfrUTm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'H2WMsazHcgDQ', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'Nv3+DDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT/swUfTUaWd9wQXObdlZQonwp92fTd+R8mC3H8m+ZHds6eVxa9uHa7Ndmde1eccXIHzM=', 'sub': '-fdfb4a841dce167'}
2015-08-18 10:02:53,924 oic.oic.provider:DEBUG access_token_response: {'access_token': u'Nv3+DDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT/swUfTUaWd9wQXObdlZQonwpbGe8mNien6UlA6CQjQYvsIsOoA8j7R4MYiWT7ek5Mlo=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICI1UnU2VWU4emN3WlRuNzRnIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NDE3MywgImF1dGhfdGltZSI6IDE0Mzk4ODQ5NzAsICJpYXQiOiAxNDM5ODg0OTczLCAiYXVkIjogWyJIMldNc2F6SGNnRFEiXX0.nmTVU-Pw5xZFvttRtTnF3g1gWWyJIr3E1UWsvwIc_hJ_Htb2huTp4ImTicKobf-m3EI2nr3pSjhyhuTbJZGVxCoQhLe7nuqZFdCrossMJ3XJsVUBKOZFVMTlcMm85K9T-Ar3Q99ieK7Vp-uCqkWlFPFqbxvca6h1FNmtSgCY27YIP2_fbBKghHhBVQpboS93w5efeyaZNTuBHbi-wQ3koluUsD1pG05U5_EUvZUJh1chp4KfcHUfTnuQ9ZM5BwoVp4swiJa59CFF_9D4WeXGZ92xfLmlhq3wRJl6Z_X-iMtKX-XnT1acqezBR-bNFdHuiNOCPf3MQhCNch7enm8WLg', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'MS6uriZjl4BfrUTm', 'scope': 'openid profile email address phone', 'refresh_token': u'Nv3+DDM4pIBMkAlHr4TaCj3MYhh7tTsoMXW3TdXT/swUfTUaWd9wQXObdlZQonwp92fTd+R8mC3H8m+ZHds6eVxa9uHa7Ndmde1eccXIHzM='}
2015-08-18 10:02:53,941 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 10:13:17,849 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 10:13:17,864 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 10:13:17,864 root:INFO op_info
2015-08-18 10:13:17,864 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 10:13:17,865 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 10:13:17,932 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 10:13:17,932 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "response_types": ["code"], "redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web"}>>
2015-08-18 10:13:17,932 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:13:17,937 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439881997, 'registration_access_token': 'QQQi7QCoa8DvD5TBmbDdwsHw5YrAkDOY', 'client_id': 'fhTDEy0mIpSr', 'client_secret': 'c56f7da7fe9acc73fd4584ddd393c1e0ffe99111d1973dcbd23b6159', 'registration_client_uri': 'https://localhost:8092/registration?client_id=fhTDEy0mIpSr', 'client_secret_expires_at': 1439968397}
2015-08-18 10:13:17,937 oic.utils.keyio:DEBUG loading keys for issuer: fhTDEy0mIpSr
2015-08-18 10:13:17,937 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:13:17,937 oic.oic.provider:DEBUG keys for fhTDEy0mIpSr: []
2015-08-18 10:13:17,938 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439881997, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'QQQi7QCoa8DvD5TBmbDdwsHw5YrAkDOY', 'client_id': 'fhTDEy0mIpSr', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=fhTDEy0mIpSr', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': 'c56f7da7fe9acc73fd4584ddd393c1e0ffe99111d1973dcbd23b6159', 'client_secret_expires_at': 1439968397}
2015-08-18 10:13:17,938 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439881997, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=fhTDEy0mIpSr', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'QQQi7QCoa8DvD5TBmbDdwsHw5YrAkDOY', 'response_types': [u'code'], 'client_id': 'fhTDEy0mIpSr', 'client_secret': 'c56f7da7fe9acc73fd4584ddd393c1e0ffe99111d1973dcbd23b6159', 'client_secret_expires_at': 1439968397}
2015-08-18 10:13:17,951 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:13:17,952 oic.oauth2.provider:DEBUG Request: 'response_type=code&scope=openid+profile+email+address+phone&state=lMHwZgpF1abpIiEA&acr_values=SAML&nonce=8zJCDGXQuOfo64YQ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=fhTDEy0mIpSr'
2015-08-18 10:13:17,952 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd64d0>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:13:17,952 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': '8zJCDGXQuOfo64YQ', 'acr_values': 'SAML', 'state': 'lMHwZgpF1abpIiEA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'fhTDEy0mIpSr', 'scope': 'openid profile email address phone'}
2015-08-18 10:13:17,954 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': '8zJCDGXQuOfo64YQ', 'acr_values': 'SAML', 'state': 'lMHwZgpF1abpIiEA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'fhTDEy0mIpSr', 'scope': 'openid profile email address phone'}
2015-08-18 10:13:17,955 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:13:17,955 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:13:17,955 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:13:17,955 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:13:17,955 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'response_type=code&scope=openid+profile+email+address+phone&state=lMHwZgpF1abpIiEA&acr_values=SAML&nonce=8zJCDGXQuOfo64YQ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=fhTDEy0mIpSr', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-18 10:13:17,978 oicServer:INFO callback: <function css at 0x10e8dd1b8>
2015-08-18 10:13:24,117 oicServer:INFO callback: <function auth_verify at 0x10ef92e60>
2015-08-18 10:13:24,118 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3DlMHwZgpF1abpIiEA%26acr_values%3DSAML%26nonce%3D8zJCDGXQuOfo64YQ%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26client_id%3DfhTDEy0mIpSr&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 10:13:24,118 oic.utils.authn.user:DEBUG dict: {u'query': [u'response_type=code&scope=openid+profile+email+address+phone&state=lMHwZgpF1abpIiEA&acr_values=SAML&nonce=8zJCDGXQuOfo64YQ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=fhTDEy0mIpSr'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-18 10:13:24,118 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 10:13:24,118 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'8zJCDGXQuOfo64YQ'], u'acr_values': [u'SAML'], u'state': [u'lMHwZgpF1abpIiEA'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'fhTDEy0mIpSr'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-18 10:13:24,142 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:13:24,142 oic.oauth2.provider:DEBUG Request: 'nonce=8zJCDGXQuOfo64YQ&acr_values=SAML&state=lMHwZgpF1abpIiEA&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=fhTDEy0mIpSr&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-18 10:13:24,142 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd64d0>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:13:24,142 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': '8zJCDGXQuOfo64YQ', 'acr_values': 'SAML', 'state': 'lMHwZgpF1abpIiEA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'fhTDEy0mIpSr', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 10:13:24,143 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': '8zJCDGXQuOfo64YQ', 'acr_values': 'SAML', 'state': 'lMHwZgpF1abpIiEA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'fhTDEy0mIpSr', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 10:13:24,145 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:13:24,145 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:13:24,145 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:13:24,145 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:13:24,146 oic.oic.provider:DEBUG - authenticated -
2015-08-18 10:13:24,146 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-18 10:13:24,146 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5', '7bdfc17ab4d563acc25e46397c85a35dfc1899aa3310cecb4273966c', '49ad66648d40838b0c3ed5eee4e15b9ae6a0db3bc998adaa67998faa']}
2015-08-18 10:13:24,146 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 10:13:24,146 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 10:13:24,150 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=lMHwZgpF1abpIiEA&code=zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK%2FghBwKDkap09QIlWi7HLHcKmXWoF4RYVkJFr3Q1eshl%2FaGRTj7%2BW1A%3D' (<type 'str'>)
2015-08-18 10:13:28,016 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 10:13:28,016 oic.oic.provider:DEBUG - token -
2015-08-18 10:13:28,016 oic.oic.provider:INFO token_request: code=zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK%2FghBwKDkap09QIlWi7HLHcKmXWoF4RYVkJFr3Q1eshl%2FaGRTj7%2BW1A%3D&client_id=fhTDEy0mIpSr&client_secret=c56f7da7fe9acc73fd4584ddd393c1e0ffe99111d1973dcbd23b6159&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&grant_type=authorization_code&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAia3R5IjogIlJTQSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ%3D%3D
2015-08-18 10:13:28,016 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK/ghBwKDkap09QIlWi7HLHcKmXWoF4RYVkJFr3Q1eshl/aGRTj7+W1A=', u'client_id': u'fhTDEy0mIpSr', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAia3R5IjogIlJTQSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', u'client_secret': u'c56f7da7fe9acc73fd4584ddd393c1e0ffe99111d1973dcbd23b6159', 'grant_type': u'authorization_code'}
2015-08-18 10:13:28,016 oic.utils.authn.client:DEBUG REQ: {u'code': u'zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK/ghBwKDkap09QIlWi7HLHcKmXWoF4RYVkJFr3Q1eshl/aGRTj7+W1A=', u'client_id': u'fhTDEy0mIpSr', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAia3R5IjogIlJTQSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', u'client_secret': u'c56f7da7fe9acc73fd4584ddd393c1e0ffe99111d1973dcbd23b6159', 'grant_type': u'authorization_code'}
2015-08-18 10:13:28,017 oic.utils.authn.client:DEBUG Verified Client ID: fhTDEy0mIpSr
2015-08-18 10:13:28,024 oic.oic.provider:DEBUG All checks OK
2015-08-18 10:13:28,024 oic.oic:DEBUG authzreq: {'nonce': u'8zJCDGXQuOfo64YQ', 'acr_values': u'SAML', 'state': u'lMHwZgpF1abpIiEA', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'fhTDEy0mIpSr', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 10:13:28,024 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 10:13:28,024 oic.oic:DEBUG authzreq: {'nonce': u'8zJCDGXQuOfo64YQ', 'acr_values': u'SAML', 'state': u'lMHwZgpF1abpIiEA', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'fhTDEy0mIpSr', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 10:13:28,025 oic.oic.provider:DEBUG id_token: {'nonce': '8zJCDGXQuOfo64YQ', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439964808, 'auth_time': 1439885604, 'iat': 1439885608, 'aud': ['fhTDEy0mIpSr']}
2015-08-18 10:13:28,026 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 10:13:28,026 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 10:13:28,026 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 10:13:28,026 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 10:13:28,032 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 10:13:28,033 oic.oic.provider:DEBUG _tinfo: {'nonce': '8zJCDGXQuOfo64YQ', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd6990>, 'code': u'zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK/ghBwKDkap09QIlWi7HLHcKmXWoF4RYVkJFr3Q1eshl/aGRTj7+W1A=', 'authzreq': '{"nonce": "8zJCDGXQuOfo64YQ", "acr_values": "SAML", "state": "lMHwZgpF1abpIiEA", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "fhTDEy0mIpSr", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK/ghBwKDkap0aE4kX+G+s7rV9BlmSGZPWe8jdy+nnjj0xf44e7eOxxA=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICI4ekpDREdYUXVPZm82NFlRIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NDgwOCwgImF1dGhfdGltZSI6IDE0Mzk4ODU2MDQsICJpYXQiOiAxNDM5ODg1NjA4LCAiYXVkIjogWyJmaFRERXkwbUlwU3IiXX0.dIJuznn_jmPgVVg6E77K3U_wHBZSWuYZ6FjEB0gFGhM408tVqDOL0Cy9tJ19TFG0Z-fFcOhS_Xf9TfK-4tgcgXSqCxTO1B-DPLQE5LptOSrS38OvQMSDqwoWwU7U3hQY8tOmneAZLunn9iHpfay3HbxoSNIpDIcEW-hNkNbH1xGZYojU3R_L4KoVDfnJL7UcgbS2PpHrOMkJd7YFfExaXQo9Hl2cNdEq5xkAezQ3aMGH9xU8rIcIpU0mbXQzKs7oYWwABDp9_Z0VjLqCk28cA1CtmZW4T21X-QTwGKR6nm14AeyoXTr3Y3wXaToxpdXkWUYVy8kgsMioTqx8AcMAVw', 'token_expires_at': 1439885608, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'lMHwZgpF1abpIiEA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'fhTDEy0mIpSr', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK/ghBwKDkap0U965p73w9+MEzG9Soyb1k/cOqeU+SOBhIwVm5YBAeXw=', 'sub': '-fdfb4a841dce167'}
2015-08-18 10:13:28,033 oic.oic.provider:DEBUG access_token_response: {'access_token': u'zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK/ghBwKDkap0aE4kX+G+s7rV9BlmSGZPWe8jdy+nnjj0xf44e7eOxxA=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICI4ekpDREdYUXVPZm82NFlRIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NDgwOCwgImF1dGhfdGltZSI6IDE0Mzk4ODU2MDQsICJpYXQiOiAxNDM5ODg1NjA4LCAiYXVkIjogWyJmaFRERXkwbUlwU3IiXX0.dIJuznn_jmPgVVg6E77K3U_wHBZSWuYZ6FjEB0gFGhM408tVqDOL0Cy9tJ19TFG0Z-fFcOhS_Xf9TfK-4tgcgXSqCxTO1B-DPLQE5LptOSrS38OvQMSDqwoWwU7U3hQY8tOmneAZLunn9iHpfay3HbxoSNIpDIcEW-hNkNbH1xGZYojU3R_L4KoVDfnJL7UcgbS2PpHrOMkJd7YFfExaXQo9Hl2cNdEq5xkAezQ3aMGH9xU8rIcIpU0mbXQzKs7oYWwABDp9_Z0VjLqCk28cA1CtmZW4T21X-QTwGKR6nm14AeyoXTr3Y3wXaToxpdXkWUYVy8kgsMioTqx8AcMAVw', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'lMHwZgpF1abpIiEA', 'scope': 'openid profile email address phone', 'refresh_token': u'zCMwcNXcVQkZfIUidRnqJ1wkxsJQ4PEh0RogwkbuJ7UCmbeLVdBfK/ghBwKDkap0U965p73w9+MEzG9Soyb1k/cOqeU+SOBhIwVm5YBAeXw='}
2015-08-18 10:13:28,051 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 10:15:34,751 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 10:15:34,768 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 10:15:34,768 root:INFO op_info
2015-08-18 10:15:34,768 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 10:15:34,768 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 10:15:34,833 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 10:15:34,833 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "application_type": "web"}>>
2015-08-18 10:15:34,833 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:15:34,838 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439882134, 'registration_access_token': 'dahhAmbADFXXNu0mbwpVd93gxpWNBsPV', 'client_id': 'hORefAqA2S7K', 'client_secret': 'd705ac8850d26ac5413d51c3f3837ddbb594a330aab8d64873cd580d', 'registration_client_uri': 'https://localhost:8092/registration?client_id=hORefAqA2S7K', 'client_secret_expires_at': 1439968534}
2015-08-18 10:15:34,838 oic.utils.keyio:DEBUG loading keys for issuer: hORefAqA2S7K
2015-08-18 10:15:34,838 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:15:34,838 oic.oic.provider:DEBUG keys for hORefAqA2S7K: []
2015-08-18 10:15:34,839 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439882134, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'dahhAmbADFXXNu0mbwpVd93gxpWNBsPV', 'client_id': 'hORefAqA2S7K', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=hORefAqA2S7K', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': 'd705ac8850d26ac5413d51c3f3837ddbb594a330aab8d64873cd580d', 'client_secret_expires_at': 1439968534}
2015-08-18 10:15:34,839 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439882134, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=hORefAqA2S7K', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'dahhAmbADFXXNu0mbwpVd93gxpWNBsPV', 'response_types': [u'code'], 'client_id': 'hORefAqA2S7K', 'client_secret': 'd705ac8850d26ac5413d51c3f3837ddbb594a330aab8d64873cd580d', 'client_secret_expires_at': 1439968534}
2015-08-18 10:15:34,854 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:15:34,855 oic.oauth2.provider:DEBUG Request: 'response_type=code&client_id=hORefAqA2S7K&nonce=nUFgrnJdpxOmkcXC&acr_values=SAML&state=df5AFMXorkgpD1qP&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 10:15:34,855 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd6a10>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:15:34,855 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'nUFgrnJdpxOmkcXC', 'acr_values': 'SAML', 'state': 'df5AFMXorkgpD1qP', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'hORefAqA2S7K', 'scope': 'openid profile email address phone'}
2015-08-18 10:15:34,857 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'nUFgrnJdpxOmkcXC', 'acr_values': 'SAML', 'state': 'df5AFMXorkgpD1qP', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'hORefAqA2S7K', 'scope': 'openid profile email address phone'}
2015-08-18 10:15:34,858 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:15:34,858 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:15:34,858 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:15:34,859 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:15:34,859 oic.oic.provider:DEBUG - authenticated -
2015-08-18 10:15:34,859 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'scope']
2015-08-18 10:15:34,860 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5', '7bdfc17ab4d563acc25e46397c85a35dfc1899aa3310cecb4273966c', '49ad66648d40838b0c3ed5eee4e15b9ae6a0db3bc998adaa67998faa', '0274106a72bbe5b0afa2dfee94bb92e7ab11909ae1c0ee831d175bc0']}
2015-08-18 10:15:34,860 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 10:15:34,860 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 10:15:34,862 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=df5AFMXorkgpD1qP&code=kVpfZKD2V7S3lex%2FzoW%2FmNR0S5kkR9%2Br1QRlnHtHLKs2VusjHfDyjZPC%2BX5eFc6c1HpdpVyCVH%2FRDxubQkgvfNQ%2F5Wqz9yQeHb%2Fs7QAPtrI%3D' (<type 'str'>)
2015-08-18 10:15:34,880 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 10:15:34,880 oic.oic.provider:DEBUG - token -
2015-08-18 10:15:34,880 oic.oic.provider:INFO token_request: grant_type=authorization_code&client_secret=d705ac8850d26ac5413d51c3f3837ddbb594a330aab8d64873cd580d&code=kVpfZKD2V7S3lex%2FzoW%2FmNR0S5kkR9%2Br1QRlnHtHLKs2VusjHfDyjZPC%2BX5eFc6c1HpdpVyCVH%2FRDxubQkgvfNQ%2F5Wqz9yQeHb%2Fs7QAPtrI%3D&client_id=hORefAqA2S7K&key=eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImt0eSI6ICJSU0EiLCAiZSI6ICJBUUFCIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-18 10:15:34,880 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'kVpfZKD2V7S3lex/zoW/mNR0S5kkR9+r1QRlnHtHLKs2VusjHfDyjZPC+X5eFc6c1HpdpVyCVH/RDxubQkgvfNQ/5Wqz9yQeHb/s7QAPtrI=', u'client_id': u'hORefAqA2S7K', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImt0eSI6ICJSU0EiLCAiZSI6ICJBUUFCIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', u'client_secret': u'd705ac8850d26ac5413d51c3f3837ddbb594a330aab8d64873cd580d', 'grant_type': u'authorization_code'}
2015-08-18 10:15:34,880 oic.utils.authn.client:DEBUG REQ: {u'code': u'kVpfZKD2V7S3lex/zoW/mNR0S5kkR9+r1QRlnHtHLKs2VusjHfDyjZPC+X5eFc6c1HpdpVyCVH/RDxubQkgvfNQ/5Wqz9yQeHb/s7QAPtrI=', u'client_id': u'hORefAqA2S7K', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImt0eSI6ICJSU0EiLCAiZSI6ICJBUUFCIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', u'client_secret': u'd705ac8850d26ac5413d51c3f3837ddbb594a330aab8d64873cd580d', 'grant_type': u'authorization_code'}
2015-08-18 10:15:34,882 oic.utils.authn.client:DEBUG Verified Client ID: hORefAqA2S7K
2015-08-18 10:15:34,884 oic.oic.provider:DEBUG All checks OK
2015-08-18 10:15:34,885 oic.oic:DEBUG authzreq: {'nonce': u'nUFgrnJdpxOmkcXC', 'acr_values': u'SAML', 'state': u'df5AFMXorkgpD1qP', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'hORefAqA2S7K', 'scope': u'openid profile email address phone'}
2015-08-18 10:15:34,885 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 10:15:34,885 oic.oic:DEBUG authzreq: {'nonce': u'nUFgrnJdpxOmkcXC', 'acr_values': u'SAML', 'state': u'df5AFMXorkgpD1qP', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'hORefAqA2S7K', 'scope': u'openid profile email address phone'}
2015-08-18 10:15:34,885 oic.oic.provider:DEBUG id_token: {'nonce': 'nUFgrnJdpxOmkcXC', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439964934, 'auth_time': 1439885604, 'iat': 1439885734, 'aud': ['hORefAqA2S7K']}
2015-08-18 10:15:34,887 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 10:15:34,887 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 10:15:34,887 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 10:15:34,887 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 10:15:34,892 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 10:15:34,893 oic.oic.provider:DEBUG _tinfo: {'nonce': 'nUFgrnJdpxOmkcXC', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd6bd0>, 'code': u'kVpfZKD2V7S3lex/zoW/mNR0S5kkR9+r1QRlnHtHLKs2VusjHfDyjZPC+X5eFc6c1HpdpVyCVH/RDxubQkgvfNQ/5Wqz9yQeHb/s7QAPtrI=', 'authzreq': '{"nonce": "nUFgrnJdpxOmkcXC", "acr_values": "SAML", "state": "df5AFMXorkgpD1qP", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "hORefAqA2S7K", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'kVpfZKD2V7S3lex/zoW/mNR0S5kkR9+r1QRlnHtHLKs2VusjHfDyjZPC+X5eFc6c4md/zwB0eAorFhKvYdOp5dGPyfleQLSdICIkbj8ahMs=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJuVUZncm5KZHB4T21rY1hDIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NDkzNCwgImF1dGhfdGltZSI6IDE0Mzk4ODU2MDQsICJpYXQiOiAxNDM5ODg1NzM0LCAiYXVkIjogWyJoT1JlZkFxQTJTN0siXX0.naIPqL3NGtXIeXqZuNQIe2kIGknUisJQgx8_EaoQS-MCXW2KV23-40U6cVvMhlRkk5lZoUe-sus8pCu-BrxJ3AQw6tZPixrZIggLtPehu1FYl0kuD9WMkEPXN2DeSiUazhS0nWsrADa9fPJDOE4gEjL9WG9dABSpnnBDTQJjjI6_G3-LKlh03qD6QMFfTzgmnwdm7RnPSE0X6mKCHYp-AjKKZCnLGsIV67kGjN0RrwKfENMeiWkTHEl3GbS9QAucMEJ7Z1ZcKPnMtl93uA7rvVIObMoiyDK8HNi_q-f6wW_Fxo_-0NfUPjqJuJWJ7sbHFYocn0C_wH5WwlQruAUKeQ', 'token_expires_at': 1439885734, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'df5AFMXorkgpD1qP', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'hORefAqA2S7K', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'kVpfZKD2V7S3lex/zoW/mNR0S5kkR9+r1QRlnHtHLKs2VusjHfDyjZPC+X5eFc6cR3e5uMxJ54puheueqR9hzFyw5ydLUq6kZDFSIYd+P8E=', 'sub': '-fdfb4a841dce167'}
2015-08-18 10:15:34,893 oic.oic.provider:DEBUG access_token_response: {'access_token': u'kVpfZKD2V7S3lex/zoW/mNR0S5kkR9+r1QRlnHtHLKs2VusjHfDyjZPC+X5eFc6c4md/zwB0eAorFhKvYdOp5dGPyfleQLSdICIkbj8ahMs=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJuVUZncm5KZHB4T21rY1hDIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NDkzNCwgImF1dGhfdGltZSI6IDE0Mzk4ODU2MDQsICJpYXQiOiAxNDM5ODg1NzM0LCAiYXVkIjogWyJoT1JlZkFxQTJTN0siXX0.naIPqL3NGtXIeXqZuNQIe2kIGknUisJQgx8_EaoQS-MCXW2KV23-40U6cVvMhlRkk5lZoUe-sus8pCu-BrxJ3AQw6tZPixrZIggLtPehu1FYl0kuD9WMkEPXN2DeSiUazhS0nWsrADa9fPJDOE4gEjL9WG9dABSpnnBDTQJjjI6_G3-LKlh03qD6QMFfTzgmnwdm7RnPSE0X6mKCHYp-AjKKZCnLGsIV67kGjN0RrwKfENMeiWkTHEl3GbS9QAucMEJ7Z1ZcKPnMtl93uA7rvVIObMoiyDK8HNi_q-f6wW_Fxo_-0NfUPjqJuJWJ7sbHFYocn0C_wH5WwlQruAUKeQ', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'df5AFMXorkgpD1qP', 'scope': 'openid profile email address phone', 'refresh_token': u'kVpfZKD2V7S3lex/zoW/mNR0S5kkR9+r1QRlnHtHLKs2VusjHfDyjZPC+X5eFc6cR3e5uMxJ54puheueqR9hzFyw5ydLUq6kZDFSIYd+P8E='}
2015-08-18 10:15:34,911 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 10:57:40,511 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 10:57:40,530 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 10:57:40,530 root:INFO op_info
2015-08-18 10:57:40,530 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 10:57:40,530 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 10:57:40,609 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 10:57:40,610 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "contacts": ["ops@example.com"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 10:57:40,610 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:57:40,616 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439884660, 'registration_access_token': 'Z3OPyj7Mig9naIkxTo3u2DxlGLhQvxTt', 'client_id': 'evXXhnRw9Zhj', 'client_secret': '9461be708d34238285cd212080d486898b29281bbb45ed0525201498', 'registration_client_uri': 'https://localhost:8092/registration?client_id=evXXhnRw9Zhj', 'client_secret_expires_at': 1439971060}
2015-08-18 10:57:40,616 oic.utils.keyio:DEBUG loading keys for issuer: evXXhnRw9Zhj
2015-08-18 10:57:40,616 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:57:40,616 oic.oic.provider:DEBUG keys for evXXhnRw9Zhj: []
2015-08-18 10:57:40,618 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439884660, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'Z3OPyj7Mig9naIkxTo3u2DxlGLhQvxTt', 'client_id': 'evXXhnRw9Zhj', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=evXXhnRw9Zhj', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '9461be708d34238285cd212080d486898b29281bbb45ed0525201498', 'client_secret_expires_at': 1439971060}
2015-08-18 10:57:40,618 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439884660, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=evXXhnRw9Zhj', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'Z3OPyj7Mig9naIkxTo3u2DxlGLhQvxTt', 'response_types': [u'code'], 'client_id': 'evXXhnRw9Zhj', 'client_secret': '9461be708d34238285cd212080d486898b29281bbb45ed0525201498', 'client_secret_expires_at': 1439971060}
2015-08-18 10:57:40,631 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:57:40,631 oic.oauth2.provider:DEBUG Request: 'state=dIiCO0hn7fgOXKgE&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=sbAwqMQQIhoigAhs&response_type=code&client_id=evXXhnRw9Zhj&scope=openid+profile+email+address+phone&acr_values=SAML'
2015-08-18 10:57:40,631 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efc5fd0>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:57:40,631 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'sbAwqMQQIhoigAhs', 'acr_values': 'SAML', 'state': 'dIiCO0hn7fgOXKgE', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'evXXhnRw9Zhj', 'scope': 'openid profile email address phone'}
2015-08-18 10:57:40,633 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'sbAwqMQQIhoigAhs', 'acr_values': 'SAML', 'state': 'dIiCO0hn7fgOXKgE', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'evXXhnRw9Zhj', 'scope': 'openid profile email address phone'}
2015-08-18 10:57:40,634 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:57:40,634 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:57:40,635 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:57:40,635 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:57:40,635 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'title': 'User log in', 'login_title': 'Username', 'acr': ['SAML'], 'tos_uri': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'state=dIiCO0hn7fgOXKgE&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=sbAwqMQQIhoigAhs&response_type=code&client_id=evXXhnRw9Zhj&scope=openid+profile+email+address+phone&acr_values=SAML', 'login': '', 'password': '', 'logo_uri': ''}
2015-08-18 10:57:40,642 oicServer:INFO callback: <function css at 0x10e8dd1b8>
2015-08-18 10:57:44,942 oicServer:INFO callback: <function auth_verify at 0x10ef92e60>
2015-08-18 10:57:44,942 oic.utils.authn.user:DEBUG verify(query=state%3DdIiCO0hn7fgOXKgE%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3DsbAwqMQQIhoigAhs%26response_type%3Dcode%26client_id%3DevXXhnRw9Zhj%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DSAML&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 10:57:44,942 oic.utils.authn.user:DEBUG dict: {u'query': [u'state=dIiCO0hn7fgOXKgE&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=sbAwqMQQIhoigAhs&response_type=code&client_id=evXXhnRw9Zhj&scope=openid+profile+email+address+phone&acr_values=SAML'], u'login': [u'diana'], u'password': [u'krall'], u'form.commit': [u'Submit'], u'acr_values': [u"['SAML']"]}
2015-08-18 10:57:44,942 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 10:57:44,943 oic.utils.authn.user:DEBUG kwargs: {u'nonce': [u'sbAwqMQQIhoigAhs'], u'acr_values': [u'SAML'], u'state': [u'dIiCO0hn7fgOXKgE'], u'redirect_uri': [u'http://localhost:8666/authz_cb'], u'response_type': [u'code'], u'client_id': [u'evXXhnRw9Zhj'], 'upm_answer': 'true', u'scope': [u'openid profile email address phone']}
2015-08-18 10:57:44,969 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:57:44,969 oic.oauth2.provider:DEBUG Request: 'nonce=sbAwqMQQIhoigAhs&acr_values=SAML&state=dIiCO0hn7fgOXKgE&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=evXXhnRw9Zhj&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-18 10:57:44,969 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efc5fd0>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:57:44,970 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'sbAwqMQQIhoigAhs', 'acr_values': 'SAML', 'state': 'dIiCO0hn7fgOXKgE', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'evXXhnRw9Zhj', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 10:57:44,970 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'sbAwqMQQIhoigAhs', 'acr_values': 'SAML', 'state': 'dIiCO0hn7fgOXKgE', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'evXXhnRw9Zhj', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 10:57:44,972 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:57:44,972 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:57:44,972 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:57:44,972 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:57:44,972 oic.oic.provider:DEBUG - authenticated -
2015-08-18 10:57:44,972 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'upm_answer', 'scope']
2015-08-18 10:57:44,973 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5', '7bdfc17ab4d563acc25e46397c85a35dfc1899aa3310cecb4273966c', '49ad66648d40838b0c3ed5eee4e15b9ae6a0db3bc998adaa67998faa', '0274106a72bbe5b0afa2dfee94bb92e7ab11909ae1c0ee831d175bc0', 'a25379dc8929256b8314f19319170ad6443b6dac119bd7ec7c21b25d']}
2015-08-18 10:57:44,973 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 10:57:44,973 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 10:57:44,974 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=dIiCO0hn7fgOXKgE&code=UrvQTcqramGKq7Y0bfgGHQW%2FSoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUUt60x%2F9zHhhvVgviR7CjtygqVnaVrKawBOhalTYuGs64%3D' (<type 'str'>)
2015-08-18 10:57:44,994 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 10:57:44,994 oic.oic.provider:DEBUG - token -
2015-08-18 10:57:44,994 oic.oic.provider:INFO token_request: redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=UrvQTcqramGKq7Y0bfgGHQW%2FSoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUUt60x%2F9zHhhvVgviR7CjtygqVnaVrKawBOhalTYuGs64%3D&key=eyJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJraWQiOiAiYTAifQ%3D%3D&grant_type=authorization_code&client_secret=9461be708d34238285cd212080d486898b29281bbb45ed0525201498&client_id=evXXhnRw9Zhj
2015-08-18 10:57:44,994 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'UrvQTcqramGKq7Y0bfgGHQW/SoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUUt60x/9zHhhvVgviR7CjtygqVnaVrKawBOhalTYuGs64=', u'key': u'eyJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJraWQiOiAiYTAifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'evXXhnRw9Zhj', u'client_secret': u'9461be708d34238285cd212080d486898b29281bbb45ed0525201498', 'grant_type': u'authorization_code'}
2015-08-18 10:57:44,994 oic.utils.authn.client:DEBUG REQ: {u'code': u'UrvQTcqramGKq7Y0bfgGHQW/SoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUUt60x/9zHhhvVgviR7CjtygqVnaVrKawBOhalTYuGs64=', u'key': u'eyJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJraWQiOiAiYTAifQ==', u'redirect_uri': u'http://localhost:8666/authz_cb', u'client_id': u'evXXhnRw9Zhj', u'client_secret': u'9461be708d34238285cd212080d486898b29281bbb45ed0525201498', 'grant_type': u'authorization_code'}
2015-08-18 10:57:44,996 oic.utils.authn.client:DEBUG Verified Client ID: evXXhnRw9Zhj
2015-08-18 10:57:45,001 oic.oic.provider:DEBUG All checks OK
2015-08-18 10:57:45,001 oic.oic:DEBUG authzreq: {'nonce': u'sbAwqMQQIhoigAhs', 'acr_values': u'SAML', 'state': u'dIiCO0hn7fgOXKgE', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'evXXhnRw9Zhj', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 10:57:45,001 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 10:57:45,002 oic.oic:DEBUG authzreq: {'nonce': u'sbAwqMQQIhoigAhs', 'acr_values': u'SAML', 'state': u'dIiCO0hn7fgOXKgE', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'evXXhnRw9Zhj', u'upm_answer': u'true', 'scope': u'openid profile email address phone'}
2015-08-18 10:57:45,002 oic.oic.provider:DEBUG id_token: {'nonce': 'sbAwqMQQIhoigAhs', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439967465, 'auth_time': 1439888264, 'iat': 1439888265, 'aud': ['evXXhnRw9Zhj']}
2015-08-18 10:57:45,004 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 10:57:45,004 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 10:57:45,004 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 10:57:45,004 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 10:57:45,010 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 10:57:45,010 oic.oic.provider:DEBUG _tinfo: {'nonce': 'sbAwqMQQIhoigAhs', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd6c10>, 'code': u'UrvQTcqramGKq7Y0bfgGHQW/SoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUUt60x/9zHhhvVgviR7CjtygqVnaVrKawBOhalTYuGs64=', 'authzreq': '{"nonce": "sbAwqMQQIhoigAhs", "acr_values": "SAML", "state": "dIiCO0hn7fgOXKgE", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "evXXhnRw9Zhj", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'UrvQTcqramGKq7Y0bfgGHQW/SoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUUhoCu/GXzbYG8oTumOIvBSBBW6oojExB03pj1r1DwKhE=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJzYkF3cU1RUUlob2lnQWhzIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzQ2NSwgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4MjY1LCAiYXVkIjogWyJldlhYaG5SdzlaaGoiXX0.Nv4c8izIn80vDtV44_fDIuL94U8EdF_EAaQ9heqPtEQq1JUa-UfbWcRhA21o3SzCCHzZVmvCdTCiseyKDL7F4A_EfrHbKEdsuYwTlUK6BRsMKofDnS4qY0u7qEEypIDTnIzwfmU-JXokXM6J9tdTN7SlBC4AleNq59kL21lOhCU66zA9V7MW1TwUszEEFjeGEBq6l-7RUfRPGdbUcdI8EL9uPR_XvPuA9P-92aoXu3cwEAGL29lCRX1XCLPj6fxfXqhizoSF3eDzc8gqfz-Z8QlImeMIo1cIbhdpKNZtmp6jKStZ5KPnpJ5roqYL_clcdOKXa-fBLP_qSA3SZ1D-VQ', 'token_expires_at': 1439888265, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'dIiCO0hn7fgOXKgE', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'evXXhnRw9Zhj', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'UrvQTcqramGKq7Y0bfgGHQW/SoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUU3eBwhmR2xXTBRyv8MnBxCQCFSKps0ODdn26UM4DglVM=', 'sub': '-fdfb4a841dce167'}
2015-08-18 10:57:45,011 oic.oic.provider:DEBUG access_token_response: {'access_token': u'UrvQTcqramGKq7Y0bfgGHQW/SoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUUhoCu/GXzbYG8oTumOIvBSBBW6oojExB03pj1r1DwKhE=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJzYkF3cU1RUUlob2lnQWhzIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzQ2NSwgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4MjY1LCAiYXVkIjogWyJldlhYaG5SdzlaaGoiXX0.Nv4c8izIn80vDtV44_fDIuL94U8EdF_EAaQ9heqPtEQq1JUa-UfbWcRhA21o3SzCCHzZVmvCdTCiseyKDL7F4A_EfrHbKEdsuYwTlUK6BRsMKofDnS4qY0u7qEEypIDTnIzwfmU-JXokXM6J9tdTN7SlBC4AleNq59kL21lOhCU66zA9V7MW1TwUszEEFjeGEBq6l-7RUfRPGdbUcdI8EL9uPR_XvPuA9P-92aoXu3cwEAGL29lCRX1XCLPj6fxfXqhizoSF3eDzc8gqfz-Z8QlImeMIo1cIbhdpKNZtmp6jKStZ5KPnpJ5roqYL_clcdOKXa-fBLP_qSA3SZ1D-VQ', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'dIiCO0hn7fgOXKgE', 'scope': 'openid profile email address phone', 'refresh_token': u'UrvQTcqramGKq7Y0bfgGHQW/SoxmAhYcUYqmEfr7ZZYI7RDYh5go35havMAgjtUU3eBwhmR2xXTBRyv8MnBxCQCFSKps0ODdn26UM4DglVM='}
2015-08-18 10:57:45,032 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 10:58:27,237 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 10:58:27,255 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 10:58:27,255 root:INFO op_info
2015-08-18 10:58:27,255 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 10:58:27,255 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 10:58:27,324 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 10:58:27,324 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "response_types": ["code"]}>>
2015-08-18 10:58:27,325 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:58:27,330 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439884707, 'registration_access_token': 'OdaqEds1RJph8rjsOIpkGx9RJNqEaMSo', 'client_id': '2RRBEY27ivQg', 'client_secret': '4ddedd9f799f6328cbb4db308c68dbe440c7eeb5a730c5e442bf890e', 'registration_client_uri': 'https://localhost:8092/registration?client_id=2RRBEY27ivQg', 'client_secret_expires_at': 1439971107}
2015-08-18 10:58:27,330 oic.utils.keyio:DEBUG loading keys for issuer: 2RRBEY27ivQg
2015-08-18 10:58:27,330 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 10:58:27,330 oic.oic.provider:DEBUG keys for 2RRBEY27ivQg: []
2015-08-18 10:58:27,331 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439884707, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'OdaqEds1RJph8rjsOIpkGx9RJNqEaMSo', 'client_id': '2RRBEY27ivQg', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=2RRBEY27ivQg', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '4ddedd9f799f6328cbb4db308c68dbe440c7eeb5a730c5e442bf890e', 'client_secret_expires_at': 1439971107}
2015-08-18 10:58:27,332 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439884707, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=2RRBEY27ivQg', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'OdaqEds1RJph8rjsOIpkGx9RJNqEaMSo', 'response_types': [u'code'], 'client_id': '2RRBEY27ivQg', 'client_secret': '4ddedd9f799f6328cbb4db308c68dbe440c7eeb5a730c5e442bf890e', 'client_secret_expires_at': 1439971107}
2015-08-18 10:58:27,344 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 10:58:27,344 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=SXtTdvUtUdI314b3&response_type=code&client_id=2RRBEY27ivQg&state=OrcaOBIC6SvfBKIo'
2015-08-18 10:58:27,345 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd6850>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 10:58:27,345 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'SXtTdvUtUdI314b3', 'acr_values': 'SAML', 'state': 'OrcaOBIC6SvfBKIo', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '2RRBEY27ivQg', 'scope': 'openid profile email address phone'}
2015-08-18 10:58:27,346 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'SXtTdvUtUdI314b3', 'acr_values': 'SAML', 'state': 'OrcaOBIC6SvfBKIo', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '2RRBEY27ivQg', 'scope': 'openid profile email address phone'}
2015-08-18 10:58:27,348 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:58:27,348 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 10:58:27,348 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 10:58:27,348 oic.oauth2.provider:INFO No active authentication
2015-08-18 10:58:27,348 oic.oic.provider:DEBUG - authenticated -
2015-08-18 10:58:27,348 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'scope']
2015-08-18 10:58:27,348 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5', '7bdfc17ab4d563acc25e46397c85a35dfc1899aa3310cecb4273966c', '49ad66648d40838b0c3ed5eee4e15b9ae6a0db3bc998adaa67998faa', '0274106a72bbe5b0afa2dfee94bb92e7ab11909ae1c0ee831d175bc0', 'a25379dc8929256b8314f19319170ad6443b6dac119bd7ec7c21b25d', '0139f2ff1842089e43b812104848e35ce3d2ce74ee5d9570e113b502']}
2015-08-18 10:58:27,348 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 10:58:27,348 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 10:58:27,350 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=OrcaOBIC6SvfBKIo&code=fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOk83QpXmVPVwenQlns7hrmX7%2FGsmlV71fPt2cwbeQCYs%3D' (<type 'str'>)
2015-08-18 10:58:27,370 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 10:58:27,371 oic.oic.provider:DEBUG - token -
2015-08-18 10:58:27,371 oic.oic.provider:INFO token_request: grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=2RRBEY27ivQg&code=fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOk83QpXmVPVwenQlns7hrmX7%2FGsmlV71fPt2cwbeQCYs%3D&key=eyJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInVzZSI6ICJzaWcifQ%3D%3D&client_secret=4ddedd9f799f6328cbb4db308c68dbe440c7eeb5a730c5e442bf890e
2015-08-18 10:58:27,371 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOk83QpXmVPVwenQlns7hrmX7/GsmlV71fPt2cwbeQCYs=', u'client_id': u'2RRBEY27ivQg', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInVzZSI6ICJzaWcifQ==', u'client_secret': u'4ddedd9f799f6328cbb4db308c68dbe440c7eeb5a730c5e442bf890e', 'grant_type': u'authorization_code'}
2015-08-18 10:58:27,371 oic.utils.authn.client:DEBUG REQ: {u'code': u'fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOk83QpXmVPVwenQlns7hrmX7/GsmlV71fPt2cwbeQCYs=', u'client_id': u'2RRBEY27ivQg', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInVzZSI6ICJzaWcifQ==', u'client_secret': u'4ddedd9f799f6328cbb4db308c68dbe440c7eeb5a730c5e442bf890e', 'grant_type': u'authorization_code'}
2015-08-18 10:58:27,373 oic.utils.authn.client:DEBUG Verified Client ID: 2RRBEY27ivQg
2015-08-18 10:58:27,375 oic.oic.provider:DEBUG All checks OK
2015-08-18 10:58:27,376 oic.oic:DEBUG authzreq: {'nonce': u'SXtTdvUtUdI314b3', 'acr_values': u'SAML', 'state': u'OrcaOBIC6SvfBKIo', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'2RRBEY27ivQg', 'scope': u'openid profile email address phone'}
2015-08-18 10:58:27,376 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 10:58:27,376 oic.oic:DEBUG authzreq: {'nonce': u'SXtTdvUtUdI314b3', 'acr_values': u'SAML', 'state': u'OrcaOBIC6SvfBKIo', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'2RRBEY27ivQg', 'scope': u'openid profile email address phone'}
2015-08-18 10:58:27,376 oic.oic.provider:DEBUG id_token: {'nonce': 'SXtTdvUtUdI314b3', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439967507, 'auth_time': 1439888264, 'iat': 1439888307, 'aud': ['2RRBEY27ivQg']}
2015-08-18 10:58:27,378 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 10:58:27,378 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 10:58:27,378 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 10:58:27,378 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 10:58:27,383 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 10:58:27,383 oic.oic.provider:DEBUG _tinfo: {'nonce': 'SXtTdvUtUdI314b3', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd6810>, 'code': u'fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOk83QpXmVPVwenQlns7hrmX7/GsmlV71fPt2cwbeQCYs=', 'authzreq': '{"nonce": "SXtTdvUtUdI314b3", "acr_values": "SAML", "state": "OrcaOBIC6SvfBKIo", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "2RRBEY27ivQg", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOIW0V35T9XTPiD1BGt9pR++/WHEsN4RSWJuRJ8ho803E=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJTWHRUZHZVdFVkSTMxNGIzIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzUwNywgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4MzA3LCAiYXVkIjogWyIyUlJCRVkyN2l2UWciXX0.RlxX4FIw-5SH0i9tPkCehYW6uWtAZuWnVTKc3RzorE2XYgeR-qbp6szRHOzqI_NZt0m0dLmmIar0m6IdXFiYZOC3z-EX3yH70NDgEwgtE8tr3QXHX0MgW17OTjQadpjBhfor3iza5H4YURn7SQS-sK1O5Z-1vnSm9q8pZDs8mp168A-ULHB8lzKFONFtwz0TyVOZhPA3yf8CSD2Ud_Fyvq-nwK5NTcLznTr5ttGL8q_A-P3n27HHtJfpmlG5WrC76k69lokkaxg6riVIdMSx6t7Ekc0VOocBCey3oBrb6Bu4MQORLpTWTwXRTqilLySlzbVGecyCifOyrVkJ5EtQAQ', 'token_expires_at': 1439888307, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'OrcaOBIC6SvfBKIo', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': '2RRBEY27ivQg', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOmHFKO6AIlcr2jZxFtaWwQlF7fRP8NCAflQQkGB+s4Gk=', 'sub': '-fdfb4a841dce167'}
2015-08-18 10:58:27,384 oic.oic.provider:DEBUG access_token_response: {'access_token': u'fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOIW0V35T9XTPiD1BGt9pR++/WHEsN4RSWJuRJ8ho803E=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJTWHRUZHZVdFVkSTMxNGIzIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzUwNywgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4MzA3LCAiYXVkIjogWyIyUlJCRVkyN2l2UWciXX0.RlxX4FIw-5SH0i9tPkCehYW6uWtAZuWnVTKc3RzorE2XYgeR-qbp6szRHOzqI_NZt0m0dLmmIar0m6IdXFiYZOC3z-EX3yH70NDgEwgtE8tr3QXHX0MgW17OTjQadpjBhfor3iza5H4YURn7SQS-sK1O5Z-1vnSm9q8pZDs8mp168A-ULHB8lzKFONFtwz0TyVOZhPA3yf8CSD2Ud_Fyvq-nwK5NTcLznTr5ttGL8q_A-P3n27HHtJfpmlG5WrC76k69lokkaxg6riVIdMSx6t7Ekc0VOocBCey3oBrb6Bu4MQORLpTWTwXRTqilLySlzbVGecyCifOyrVkJ5EtQAQ', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'OrcaOBIC6SvfBKIo', 'scope': 'openid profile email address phone', 'refresh_token': u'fc3Cz688gtnjWsUMguNJmlsi4vXPHFiiGEW59YDpIlQ1dCMj9BecNIGCMVOoSfJOmHFKO6AIlcr2jZxFtaWwQlF7fRP8NCAflQQkGB+s4Gk='}
2015-08-18 10:58:27,401 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:00:09,730 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 11:00:09,747 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 11:00:09,747 root:INFO op_info
2015-08-18 11:00:09,748 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:00:09,748 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 11:00:09,813 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 11:00:09,813 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "response_types": ["code"]}>>
2015-08-18 11:00:09,813 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 11:00:09,818 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439884809, 'registration_access_token': '4tjjSpUtx8lKLnQ1cJbX6X4b2YHKkOUR', 'client_id': 'C2RbUdXiqP6e', 'client_secret': '72062a99480d5f35ef0f657710f566115a75f53a69bbd79978671500', 'registration_client_uri': 'https://localhost:8092/registration?client_id=C2RbUdXiqP6e', 'client_secret_expires_at': 1439971209}
2015-08-18 11:00:09,818 oic.utils.keyio:DEBUG loading keys for issuer: C2RbUdXiqP6e
2015-08-18 11:00:09,819 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 11:00:09,819 oic.oic.provider:DEBUG keys for C2RbUdXiqP6e: []
2015-08-18 11:00:09,820 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439884809, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': '4tjjSpUtx8lKLnQ1cJbX6X4b2YHKkOUR', 'client_id': 'C2RbUdXiqP6e', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=C2RbUdXiqP6e', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '72062a99480d5f35ef0f657710f566115a75f53a69bbd79978671500', 'client_secret_expires_at': 1439971209}
2015-08-18 11:00:09,820 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439884809, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=C2RbUdXiqP6e', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': '4tjjSpUtx8lKLnQ1cJbX6X4b2YHKkOUR', 'response_types': [u'code'], 'client_id': 'C2RbUdXiqP6e', 'client_secret': '72062a99480d5f35ef0f657710f566115a75f53a69bbd79978671500', 'client_secret_expires_at': 1439971209}
2015-08-18 11:00:09,835 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 11:00:09,835 oic.oauth2.provider:DEBUG Request: 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&client_id=C2RbUdXiqP6e&response_type=code&state=dsA5OKYV3JT5lWSF&scope=openid+profile+email+address+phone&nonce=WWxp5jpeNzI3aghI'
2015-08-18 11:00:09,835 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd6710>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 11:00:09,835 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'WWxp5jpeNzI3aghI', 'acr_values': 'SAML', 'state': 'dsA5OKYV3JT5lWSF', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'C2RbUdXiqP6e', 'scope': 'openid profile email address phone'}
2015-08-18 11:00:09,837 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'WWxp5jpeNzI3aghI', 'acr_values': 'SAML', 'state': 'dsA5OKYV3JT5lWSF', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'C2RbUdXiqP6e', 'scope': 'openid profile email address phone'}
2015-08-18 11:00:09,838 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:00:09,839 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:00:09,839 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:00:09,839 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:00:09,839 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:00:09,839 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'scope']
2015-08-18 11:00:09,839 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5', '7bdfc17ab4d563acc25e46397c85a35dfc1899aa3310cecb4273966c', '49ad66648d40838b0c3ed5eee4e15b9ae6a0db3bc998adaa67998faa', '0274106a72bbe5b0afa2dfee94bb92e7ab11909ae1c0ee831d175bc0', 'a25379dc8929256b8314f19319170ad6443b6dac119bd7ec7c21b25d', '0139f2ff1842089e43b812104848e35ce3d2ce74ee5d9570e113b502', '4aea075bce89296ef62a0370c4e8bb0b59e72839d83a019dd2684aaf']}
2015-08-18 11:00:09,839 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:00:09,839 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:00:09,841 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=dsA5OKYV3JT5lWSF&code=vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B%2FEHtC%2Bh1grkAfseQXKDAO0K3qR6q779n%2BslxrOEvlD76TonW%2F5IaVi%2BCOOs%3D' (<type 'str'>)
2015-08-18 11:00:09,858 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 11:00:09,859 oic.oic.provider:DEBUG - token -
2015-08-18 11:00:09,859 oic.oic.provider:INFO token_request: redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=C2RbUdXiqP6e&code=vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B%2FEHtC%2Bh1grkAfseQXKDAO0K3qR6q779n%2BslxrOEvlD76TonW%2F5IaVi%2BCOOs%3D&grant_type=authorization_code&key=eyJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ%3D%3D&client_secret=72062a99480d5f35ef0f657710f566115a75f53a69bbd79978671500
2015-08-18 11:00:09,859 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B/EHtC+h1grkAfseQXKDAO0K3qR6q779n+slxrOEvlD76TonW/5IaVi+COOs=', u'client_id': u'C2RbUdXiqP6e', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ==', u'client_secret': u'72062a99480d5f35ef0f657710f566115a75f53a69bbd79978671500', 'grant_type': u'authorization_code'}
2015-08-18 11:00:09,859 oic.utils.authn.client:DEBUG REQ: {u'code': u'vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B/EHtC+h1grkAfseQXKDAO0K3qR6q779n+slxrOEvlD76TonW/5IaVi+COOs=', u'client_id': u'C2RbUdXiqP6e', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ==', u'client_secret': u'72062a99480d5f35ef0f657710f566115a75f53a69bbd79978671500', 'grant_type': u'authorization_code'}
2015-08-18 11:00:09,861 oic.utils.authn.client:DEBUG Verified Client ID: C2RbUdXiqP6e
2015-08-18 11:00:09,864 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:00:09,864 oic.oic:DEBUG authzreq: {'nonce': u'WWxp5jpeNzI3aghI', 'acr_values': u'SAML', 'state': u'dsA5OKYV3JT5lWSF', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'C2RbUdXiqP6e', 'scope': u'openid profile email address phone'}
2015-08-18 11:00:09,864 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:00:09,864 oic.oic:DEBUG authzreq: {'nonce': u'WWxp5jpeNzI3aghI', 'acr_values': u'SAML', 'state': u'dsA5OKYV3JT5lWSF', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'C2RbUdXiqP6e', 'scope': u'openid profile email address phone'}
2015-08-18 11:00:09,864 oic.oic.provider:DEBUG id_token: {'nonce': 'WWxp5jpeNzI3aghI', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439967609, 'auth_time': 1439888264, 'iat': 1439888409, 'aud': ['C2RbUdXiqP6e']}
2015-08-18 11:00:09,866 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 11:00:09,866 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 11:00:09,866 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 11:00:09,866 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 11:00:09,872 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:00:09,873 oic.oic.provider:DEBUG _tinfo: {'nonce': 'WWxp5jpeNzI3aghI', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd62d0>, 'code': u'vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B/EHtC+h1grkAfseQXKDAO0K3qR6q779n+slxrOEvlD76TonW/5IaVi+COOs=', 'authzreq': '{"nonce": "WWxp5jpeNzI3aghI", "acr_values": "SAML", "state": "dsA5OKYV3JT5lWSF", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "C2RbUdXiqP6e", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B/EHtC+h1grkAfseQvYPP2OHK5oaS6fX8tP8XnkzaG0oGPuc73UYKAVJ78AE=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJXV3hwNWpwZU56STNhZ2hJIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzYwOSwgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4NDA5LCAiYXVkIjogWyJDMlJiVWRYaXFQNmUiXX0.Usd4sBkO2rltae9AhYU7ajRfjfsK2x5CjXshN2z44Bqiv4HA8gEOyq4MJ1Z5czqX1YPPVKzSXshn0rRy48ouxaJYgOa8bx4nJq1MFR4j1mxFH0tZ_G5rKSVLupiNjX1ngi6JPUMNEbIZ4rjiV5BYwerRgyVosLQfvmACcKHAoPp0ViN4eHaFwINK5iQPqpGdFmLZuRWVmWWRKETsn378BQxEGhA-HkQGkZQ80o9l6X11A7c5fORqLCesz8SmvgCXGm0dfbwP4mn1y00LsBMrVd724kGpcxpHL5ywlYDWvWbijvh1MlBSdxu5S5l62OUn9tHPFgPb2Pj_dS4tAh_LTg', 'token_expires_at': 1439888409, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'dsA5OKYV3JT5lWSF', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': 'C2RbUdXiqP6e', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B/EHtC+h1grkAfseQICuq6lcqUne467C3vxMRE0tlv3aGoqPYAz+oOqJWimo=', 'sub': '-fdfb4a841dce167'}
2015-08-18 11:00:09,873 oic.oic.provider:DEBUG access_token_response: {'access_token': u'vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B/EHtC+h1grkAfseQvYPP2OHK5oaS6fX8tP8XnkzaG0oGPuc73UYKAVJ78AE=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJXV3hwNWpwZU56STNhZ2hJIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzYwOSwgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4NDA5LCAiYXVkIjogWyJDMlJiVWRYaXFQNmUiXX0.Usd4sBkO2rltae9AhYU7ajRfjfsK2x5CjXshN2z44Bqiv4HA8gEOyq4MJ1Z5czqX1YPPVKzSXshn0rRy48ouxaJYgOa8bx4nJq1MFR4j1mxFH0tZ_G5rKSVLupiNjX1ngi6JPUMNEbIZ4rjiV5BYwerRgyVosLQfvmACcKHAoPp0ViN4eHaFwINK5iQPqpGdFmLZuRWVmWWRKETsn378BQxEGhA-HkQGkZQ80o9l6X11A7c5fORqLCesz8SmvgCXGm0dfbwP4mn1y00LsBMrVd724kGpcxpHL5ywlYDWvWbijvh1MlBSdxu5S5l62OUn9tHPFgPb2Pj_dS4tAh_LTg', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'dsA5OKYV3JT5lWSF', 'scope': 'openid profile email address phone', 'refresh_token': u'vRFM3ECPwC8hzXh1aq6hnPvtCSzCWiFNKBAV3qk6R6dKO60B/EHtC+h1grkAfseQICuq6lcqUne467C3vxMRE0tlv3aGoqPYAz+oOqJWimo='}
2015-08-18 11:00:09,893 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:00:38,993 oicServer:INFO callback: <function webfinger at 0x10eae1320>
2015-08-18 11:00:39,012 oicServer:INFO callback: <function op_info at 0x10eae0f50>
2015-08-18 11:00:39,012 root:INFO op_info
2015-08-18 11:00:39,012 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:00:39,013 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'claims_supported': ['profile', 'family_name', 'phone_number', 'email_verified', 'middle_name', 'name', 'phone_number_verified', 'picture', 'locale', 'gender', 'zoneinfo', 'preferred_username', 'updated_at', 'birthdate', 'website', 'given_name', 'address', 'nickname', 'email', 'sub'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_uri_parameter_supported': True, 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'offline_access', 'phone', 'address', 'email', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'ES256', 'RS384'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['ES512', 'RS512', 'HS512', 'PS384', 'RS256', 'ES384', 'HS256', 'PS512', 'HS384', 'PS256', 'none', 'ES256', 'RS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 11:00:39,085 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10eadf610>
2015-08-18 11:00:39,085 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "contacts": ["ops@example.com"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 11:00:39,085 oic.oic.provider:INFO registration_request:{'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 11:00:39,090 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439884839, 'registration_access_token': 'NEo77ZPXBhH9F9fxWUfVB6GR8w3sU6Qy', 'client_id': '8Sj5EqEWInBV', 'client_secret': '9ab050bd66587c7741c27cde3d1220c78ebb9821df29b1530fa5ca09', 'registration_client_uri': 'https://localhost:8092/registration?client_id=8Sj5EqEWInBV', 'client_secret_expires_at': 1439971239}
2015-08-18 11:00:39,090 oic.utils.keyio:DEBUG loading keys for issuer: 8Sj5EqEWInBV
2015-08-18 11:00:39,090 oic.utils.keyio:DEBUG pcr: {'application_type': u'web', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'response_types': [u'code'], 'contacts': [u'ops@example.com']}
2015-08-18 11:00:39,090 oic.oic.provider:DEBUG keys for 8Sj5EqEWInBV: []
2015-08-18 11:00:39,092 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439884839, 'redirect_uris': [(u'http://localhost:8666/authz_cb', None)], 'application_type': u'web', 'registration_access_token': 'NEo77ZPXBhH9F9fxWUfVB6GR8w3sU6Qy', 'client_id': '8Sj5EqEWInBV', 'contacts': [u'ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=8Sj5EqEWInBV', 'post_logout_redirect_uris': [(u'http://localhost:8666/logout_success', None)], 'response_types': [u'code'], 'client_secret': '9ab050bd66587c7741c27cde3d1220c78ebb9821df29b1530fa5ca09', 'client_secret_expires_at': 1439971239}
2015-08-18 11:00:39,092 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439884839, 'redirect_uris': [u'http://localhost:8666/authz_cb'], 'contacts': [u'ops@example.com'], 'application_type': u'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=8Sj5EqEWInBV', 'post_logout_redirect_uris': [u'http://localhost:8666/logout_success'], 'registration_access_token': 'NEo77ZPXBhH9F9fxWUfVB6GR8w3sU6Qy', 'response_types': [u'code'], 'client_id': '8Sj5EqEWInBV', 'client_secret': '9ab050bd66587c7741c27cde3d1220c78ebb9821df29b1530fa5ca09', 'client_secret_expires_at': 1439971239}
2015-08-18 11:00:39,107 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10eadf550>
2015-08-18 11:00:39,107 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&client_id=8Sj5EqEWInBV&response_type=code&nonce=iAi6booi4vD50oVh&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&state=yqeTZoEA6xegizpl'
2015-08-18 11:00:39,107 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10efd6290>, <jwkest.jwk.RSAKey object at 0x10ef9d6d0>, <jwkest.jwk.ECKey object at 0x10efc0fd0>]
2015-08-18 11:00:39,107 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'iAi6booi4vD50oVh', 'acr_values': 'SAML', 'state': 'yqeTZoEA6xegizpl', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '8Sj5EqEWInBV', 'scope': 'openid profile email address phone'}
2015-08-18 11:00:39,109 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'iAi6booi4vD50oVh', 'acr_values': 'SAML', 'state': 'yqeTZoEA6xegizpl', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '8Sj5EqEWInBV', 'scope': 'openid profile email address phone'}
2015-08-18 11:00:39,111 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:00:39,111 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:00:39,111 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:00:39,111 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:00:39,111 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:00:39,111 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'state', 'redirect_uri', 'response_type', 'client_id', 'scope']
2015-08-18 11:00:39,111 oic.utils.sdb:DEBUG uid2sid: {u'diana': ['25ec94b312e6786912bb84f5486c76b465db4d99759d628b3ec538e5', '7bdfc17ab4d563acc25e46397c85a35dfc1899aa3310cecb4273966c', '49ad66648d40838b0c3ed5eee4e15b9ae6a0db3bc998adaa67998faa', '0274106a72bbe5b0afa2dfee94bb92e7ab11909ae1c0ee831d175bc0', 'a25379dc8929256b8314f19319170ad6443b6dac119bd7ec7c21b25d', '0139f2ff1842089e43b812104848e35ce3d2ce74ee5d9570e113b502', '4aea075bce89296ef62a0370c4e8bb0b59e72839d83a019dd2684aaf', 'b74e888537cc0844d7e64f7e495408df6233a01de8424ec69bd18e66']}
2015-08-18 11:00:39,111 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:00:39,111 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:00:39,113 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=yqeTZoEA6xegizpl&code=CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ%2FA2idHcFPcFfLpIx1zXzbAlmGLwVV5CWUU2vwFm33BUdHT%2B1lxsYKZGcwZe65AIJddu94%3D' (<type 'str'>)
2015-08-18 11:00:39,138 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10eadf590>
2015-08-18 11:00:39,138 oic.oic.provider:DEBUG - token -
2015-08-18 11:00:39,138 oic.oic.provider:INFO token_request: grant_type=authorization_code&client_id=8Sj5EqEWInBV&code=CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ%2FA2idHcFPcFfLpIx1zXzbAlmGLwVV5CWUU2vwFm33BUdHT%2B1lxsYKZGcwZe65AIJddu94%3D&key=eyJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=9ab050bd66587c7741c27cde3d1220c78ebb9821df29b1530fa5ca09
2015-08-18 11:00:39,139 oic.oic.provider:DEBUG AccessTokenRequest: {u'code': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLwVV5CWUU2vwFm33BUdHT+1lxsYKZGcwZe65AIJddu94=', u'client_id': u'8Sj5EqEWInBV', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', u'client_secret': u'9ab050bd66587c7741c27cde3d1220c78ebb9821df29b1530fa5ca09', 'grant_type': u'authorization_code'}
2015-08-18 11:00:39,139 oic.utils.authn.client:DEBUG REQ: {u'code': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLwVV5CWUU2vwFm33BUdHT+1lxsYKZGcwZe65AIJddu94=', u'client_id': u'8Sj5EqEWInBV', u'redirect_uri': u'http://localhost:8666/authz_cb', u'key': u'eyJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', u'client_secret': u'9ab050bd66587c7741c27cde3d1220c78ebb9821df29b1530fa5ca09', 'grant_type': u'authorization_code'}
2015-08-18 11:00:39,140 oic.utils.authn.client:DEBUG Verified Client ID: 8Sj5EqEWInBV
2015-08-18 11:00:39,143 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:00:39,143 oic.oic:DEBUG authzreq: {'nonce': u'iAi6booi4vD50oVh', 'acr_values': u'SAML', 'state': u'yqeTZoEA6xegizpl', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'8Sj5EqEWInBV', 'scope': u'openid profile email address phone'}
2015-08-18 11:00:39,143 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:00:39,143 oic.oic:DEBUG authzreq: {'nonce': u'iAi6booi4vD50oVh', 'acr_values': u'SAML', 'state': u'yqeTZoEA6xegizpl', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'8Sj5EqEWInBV', 'scope': u'openid profile email address phone'}
2015-08-18 11:00:39,144 oic.oic.provider:DEBUG id_token: {'nonce': 'iAi6booi4vD50oVh', 'sub': '-fdfb4a841dce167', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439967639, 'auth_time': 1439888264, 'iat': 1439888439, 'aud': ['8Sj5EqEWInBV']}
2015-08-18 11:00:39,146 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA"}]}
2015-08-18 11:00:39,147 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "y": "STJsNi0aBIerHuoWFcyPS_6pzOh1wYRoDgSkLSCK4sE", "x": "WP1KC2p4mBgJG4rPUvTBwpPqDZs45LeJb2w_IVfAu1k", "kid": "op2"}]}
2015-08-18 11:00:39,147 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "y": "Dh0L9pdv4G6TnshLOZsYgqkGxURhP-mWnmrhl-UbxMU", "x": "tCWB7QiTSfwnExruEW4fXHYg0tUHerPbiNZO9Qg_4gw", "kid": "op3"}]}
2015-08-18 11:00:39,147 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10ef9d6d0>]
2015-08-18 11:00:39,152 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:00:39,153 oic.oic.provider:DEBUG _tinfo: {'nonce': 'iAi6booi4vD50oVh', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd6ad0>, 'code': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLwVV5CWUU2vwFm33BUdHT+1lxsYKZGcwZe65AIJddu94=', 'authzreq': '{"nonce": "iAi6booi4vD50oVh", "acr_values": "SAML", "state": "yqeTZoEA6xegizpl", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "8Sj5EqEWInBV", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLLsTqndXrn8L08pmFC7+e4mrzcMQeiYwDSnQoyxTsv68=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJpQWk2Ym9vaTR2RDUwb1ZoIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzYzOSwgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4NDM5LCAiYXVkIjogWyI4U2o1RXFFV0luQlYiXX0.REMQzmKTeqAA3fzPKJCLLt50aQqE4aHS4VusEIGxA_vD_NGr0-rynWfWAVhdgiZJhNHdOFkgGVzjlVfCWIe5iRItXFGlPYEy8fwKhcOAMD2bkZS075BL0XBE8afRNEkRdmBBCULwdiGjAfOGNE9HhutQ3GgVVBvnYSk886D4i5-n5sOsC2Tifh238SABUFnlhLhrRXUOmxQpBJGeJQsN0MpHyJXXDm_tgXwE2IypDnbrrG-eGzKfoXUAzAi_jjESbMMq6LOzKb9nrnriPSKvvmvJKYncTicFXw4CLt0-dLsLa-dkJhFjAEG9i9Q8rf4sHKD8be8kchq50Y4GhzyfLg', 'token_expires_at': 1439888439, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'yqeTZoEA6xegizpl', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': '8Sj5EqEWInBV', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLyUhi6h/FYFKgyCLPlOilhUPXwq1P6AFZLrojIZh7LDM=', 'sub': '-fdfb4a841dce167'}
2015-08-18 11:00:39,153 oic.oic.provider:DEBUG access_token_response: {'access_token': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLLsTqndXrn8L08pmFC7+e4mrzcMQeiYwDSnQoyxTsv68=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJpQWk2Ym9vaTR2RDUwb1ZoIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzYzOSwgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4NDM5LCAiYXVkIjogWyI4U2o1RXFFV0luQlYiXX0.REMQzmKTeqAA3fzPKJCLLt50aQqE4aHS4VusEIGxA_vD_NGr0-rynWfWAVhdgiZJhNHdOFkgGVzjlVfCWIe5iRItXFGlPYEy8fwKhcOAMD2bkZS075BL0XBE8afRNEkRdmBBCULwdiGjAfOGNE9HhutQ3GgVVBvnYSk886D4i5-n5sOsC2Tifh238SABUFnlhLhrRXUOmxQpBJGeJQsN0MpHyJXXDm_tgXwE2IypDnbrrG-eGzKfoXUAzAi_jjESbMMq6LOzKb9nrnriPSKvvmvJKYncTicFXw4CLt0-dLsLa-dkJhFjAEG9i9Q8rf4sHKD8be8kchq50Y4GhzyfLg', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'yqeTZoEA6xegizpl', 'scope': 'openid profile email address phone', 'refresh_token': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLyUhi6h/FYFKgyCLPlOilhUPXwq1P6AFZLrojIZh7LDM='}
2015-08-18 11:00:39,171 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:00:42,452 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10eadf5d0>
2015-08-18 11:00:42,453 oic.oic:DEBUG verify keys: None
2015-08-18 11:00:42,453 oic.oic.provider:DEBUG user_info_request: {u'access_token': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLLsTqndXrn8L08pmFC7+e4mrzcMQeiYwDSnQoyxTsv68='}
2015-08-18 11:00:42,453 oicServer:DEBUG access_token type: 'T'
2015-08-18 11:00:42,453 oic.oic:DEBUG authzreq: {'nonce': u'iAi6booi4vD50oVh', 'acr_values': u'SAML', 'state': u'yqeTZoEA6xegizpl', 'redirect_uri': u'http://localhost:8666/authz_cb', 'response_type': u'code', 'client_id': u'8Sj5EqEWInBV', 'scope': u'openid profile email address phone'}
2015-08-18 11:00:42,453 oic.oic.provider:DEBUG userinfo_claim: {'profile': None, 'family_name': None, 'gender': None, 'middle_name': None, 'sub': None, 'phone_number_verified': None, 'picture': None, 'locale': None, 'email_verified': None, 'zoneinfo': None, 'preferred_username': None, 'updated_at': None, 'birthdate': None, 'website': None, 'nickname': None, 'given_name': None, 'address': None, 'phone_number': None, 'email': None, 'name': None}
2015-08-18 11:00:42,453 oic.oic.provider:DEBUG Session info: {'nonce': 'iAi6booi4vD50oVh', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10efd6ad0>, 'code': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLwVV5CWUU2vwFm33BUdHT+1lxsYKZGcwZe65AIJddu94=', 'authzreq': '{"nonce": "iAi6booi4vD50oVh", "acr_values": "SAML", "state": "yqeTZoEA6xegizpl", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "8Sj5EqEWInBV", "scope": "openid profile email address phone"}', 'revoked': False, 'permission': '', 'access_token': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLLsTqndXrn8L08pmFC7+e4mrzcMQeiYwDSnQoyxTsv68=', 'id_token': u'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJpQWk2Ym9vaTR2RDUwb1ZoIiwgInN1YiI6ICItZmRmYjRhODQxZGNlMTY3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQzOTk2NzYzOSwgImF1dGhfdGltZSI6IDE0Mzk4ODgyNjQsICJpYXQiOiAxNDM5ODg4NDM5LCAiYXVkIjogWyI4U2o1RXFFV0luQlYiXX0.REMQzmKTeqAA3fzPKJCLLt50aQqE4aHS4VusEIGxA_vD_NGr0-rynWfWAVhdgiZJhNHdOFkgGVzjlVfCWIe5iRItXFGlPYEy8fwKhcOAMD2bkZS075BL0XBE8afRNEkRdmBBCULwdiGjAfOGNE9HhutQ3GgVVBvnYSk886D4i5-n5sOsC2Tifh238SABUFnlhLhrRXUOmxQpBJGeJQsN0MpHyJXXDm_tgXwE2IypDnbrrG-eGzKfoXUAzAi_jjESbMMq6LOzKb9nrnriPSKvvmvJKYncTicFXw4CLt0-dLsLa-dkJhFjAEG9i9Q8rf4sHKD8be8kchq50Y4GhzyfLg', 'token_expires_at': 1439888439, 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'yqeTZoEA6xegizpl', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'client_id': '8Sj5EqEWInBV', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'oauth_state': 'token', 'access_token_scope': '?', 'refresh_token': u'CiFzZrMtORo0xfJ7JkXGsGCV7aFjfLp7BYvvSQ/A2idHcFPcFfLpIx1zXzbAlmGLyUhi6h/FYFKgyCLPlOilhUPXwq1P6AFZLrojIZh7LDM=', 'sub': '-fdfb4a841dce167'}
2015-08-18 11:00:42,453 oic.oic.provider:DEBUG user_info_response: {'phone_number': '+46 90 7865000', 'family_name': 'Krall', 'sub': '-fdfb4a841dce167', 'email_verified': False, 'given_name': 'Diana', 'address': {'country': 'Sweden', 'postal_code': 'SE-90187', 'street_address': 'Ume\xc3\xa5 Universitet', 'locality': 'Ume\xc3\xa5'}, 'nickname': 'Dina', 'email': 'diana@example.org', 'name': 'Diana Krall'}
2015-08-18 11:01:10,696 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kty": "RSA", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 11:01:10,696 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "x": "slDXpsmF_DWUZUKRarTEWBNEfaMqOudsvlSaZVhi3u4", "kid": "op2", "crv": "P-256", "y": "hVoyZ1id55U3qHdlO8MVc0GW77HIPhwqE3fJtNVYR7I"}]}
2015-08-18 11:01:10,697 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "x": "IUvITTgGG2Zdnr5cupw75cM0Ah0Bo7NWuObv-cmhm1E", "kid": "op3", "crv": "P-256", "y": "WgURfjv5VAjI64OZ1Cvi_6o7IbM0DaW1pVYNXuAvuJc"}]}
2015-08-18 11:01:10,697 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:01:19,747 oicServer:INFO callback: <function webfinger at 0x1042c5b70>
2015-08-18 11:01:19,765 oicServer:INFO callback: <function op_info at 0x1042c57b8>
2015-08-18 11:01:19,765 root:INFO op_info
2015-08-18 11:01:19,765 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:01:19,765 oic.oic.provider:INFO provider_info_response: {'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_uri_parameter_supported': True, 'scopes_supported': ['offline_access', 'phone', 'email', 'openid', 'profile', 'address', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_signing_alg_values_supported': ['HS256', 'RS384', 'PS512', 'PS384', 'ES256', 'PS256', 'none', 'HS384', 'HS512', 'ES384', 'ES512', 'RS512', 'RS256'], 'version': '3.0', 'userinfo_signing_alg_values_supported': ['HS256', 'RS384', 'PS512', 'PS384', 'ES256', 'PS256', 'none', 'HS384', 'HS512', 'ES384', 'ES512', 'RS512', 'RS256'], 'acr_values_supported': ['PASSWORD'], 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'RS384', 'PS512', 'PS384', 'ES256', 'PS256', 'HS384', 'HS512', 'ES384', 'ES512', 'RS512', 'RS256'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_parameter_supported': True, 'registration_endpoint': 'https://localhost:8092/registration', 'subject_types_supported': ['public', 'pairwise'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['HS256', 'RS384', 'PS512', 'PS384', 'ES256', 'PS256', 'none', 'HS384', 'HS512', 'ES384', 'ES512', 'RS512', 'RS256'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'require_request_uri_registration': True, 'claims_supported': ['nickname', 'given_name', 'sub', 'email', 'picture', 'updated_at', 'name', 'zoneinfo', 'family_name', 'profile', 'birthdate', 'phone_number', 'website', 'gender', 'address', 'phone_number_verified', 'middle_name', 'email_verified', 'preferred_username', 'locale']}
2015-08-18 11:01:19,830 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1042b9c88>
2015-08-18 11:01:19,830 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "response_types": ["code"]}>>
2015-08-18 11:01:19,830 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-18 11:01:19,837 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': '76XdaoRulZEpyYTeubenss9xw63uK6uU', 'registration_client_uri': 'https://localhost:8092/registration?client_id=WPBCTKFqVVPV', 'client_id_issued_at': 1439884879, 'client_id': 'WPBCTKFqVVPV', 'client_secret': '7ffc96fcf78ae77965544e44a28b7439a665a2b9b55a06f03ec76695', 'client_secret_expires_at': 1439971279}
2015-08-18 11:01:19,838 oic.utils.keyio:DEBUG loading keys for issuer: WPBCTKFqVVPV
2015-08-18 11:01:19,838 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-18 11:01:19,838 oic.oic.provider:DEBUG keys for WPBCTKFqVVPV: []
2015-08-18 11:01:19,839 oic.oic.provider:INFO Client info: {'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'registration_access_token': '76XdaoRulZEpyYTeubenss9xw63uK6uU', 'registration_client_uri': 'https://localhost:8092/registration?client_id=WPBCTKFqVVPV', 'client_id_issued_at': 1439884879, 'client_id': 'WPBCTKFqVVPV', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'client_secret': '7ffc96fcf78ae77965544e44a28b7439a665a2b9b55a06f03ec76695', 'client_secret_expires_at': 1439971279}
2015-08-18 11:01:19,839 oic.oic.provider:DEBUG registration_response: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'registration_access_token': '76XdaoRulZEpyYTeubenss9xw63uK6uU', 'registration_client_uri': 'https://localhost:8092/registration?client_id=WPBCTKFqVVPV', 'client_id_issued_at': 1439884879, 'client_id': 'WPBCTKFqVVPV', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'client_secret': '7ffc96fcf78ae77965544e44a28b7439a665a2b9b55a06f03ec76695', 'client_secret_expires_at': 1439971279}
2015-08-18 11:01:19,852 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x104522710>
2015-08-18 11:01:19,852 oic.oauth2.provider:DEBUG Request: 'nonce=W6Fq3SVCzkvSLd4s&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RbtDXSF6jt8LyQrX&client_id=WPBCTKFqVVPV&response_type=code&scope=openid+profile+email+address+phone'
2015-08-18 11:01:19,853 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10459d2b0>, <jwkest.jwk.RSAKey object at 0x10455d6d8>, <jwkest.jwk.ECKey object at 0x10455dac8>]
2015-08-18 11:01:19,853 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'WPBCTKFqVVPV', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'RbtDXSF6jt8LyQrX', 'nonce': 'W6Fq3SVCzkvSLd4s', 'scope': 'openid profile email address phone'}
2015-08-18 11:01:19,854 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'WPBCTKFqVVPV', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'RbtDXSF6jt8LyQrX', 'nonce': 'W6Fq3SVCzkvSLd4s', 'scope': 'openid profile email address phone'}
2015-08-18 11:01:19,856 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:01:19,856 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:01:19,856 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:01:19,857 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:01:19,857 oic.utils.authn.user:INFO do_authentication argv: {'login_title': 'Username', 'action': 'https://localhost:8092/verify', 'tos_uri': '', 'title': 'User log in', 'acr': ['SAML'], 'passwd_title': 'Password', 'login': '', 'logo_uri': '', 'client_policy_title': 'Client Policy', 'submit_text': 'Submit', 'password': '', 'policy_uri': '', 'query': 'nonce=W6Fq3SVCzkvSLd4s&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RbtDXSF6jt8LyQrX&client_id=WPBCTKFqVVPV&response_type=code&scope=openid+profile+email+address+phone'}
2015-08-18 11:01:19,906 oicServer:INFO callback: <function css at 0x10452cf28>
2015-08-18 11:01:24,118 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x1044a4c80>
2015-08-18 11:01:24,118 oic.utils.authn.user:DEBUG verify(query=nonce%3DW6Fq3SVCzkvSLd4s%26acr_values%3DSAML%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26state%3DRbtDXSF6jt8LyQrX%26client_id%3DWPBCTKFqVVPV%26response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:01:24,118 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'form.commit': ['Submit'], 'login': ['diana'], 'acr_values': ["['SAML']"], 'query': ['nonce=W6Fq3SVCzkvSLd4s&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RbtDXSF6jt8LyQrX&client_id=WPBCTKFqVVPV&response_type=code&scope=openid+profile+email+address+phone']}
2015-08-18 11:01:24,118 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-18 11:01:24,118 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'redirect_uri': ['http://localhost:8666/authz_cb'], 'acr_values': ['SAML'], 'response_type': ['code'], 'client_id': ['WPBCTKFqVVPV'], 'nonce': ['W6Fq3SVCzkvSLd4s'], 'state': ['RbtDXSF6jt8LyQrX'], 'scope': ['openid profile email address phone']}
2015-08-18 11:01:24,139 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x104522710>
2015-08-18 11:01:24,139 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&client_id=WPBCTKFqVVPV&nonce=W6Fq3SVCzkvSLd4s&state=RbtDXSF6jt8LyQrX&scope=openid+profile+email+address+phone'
2015-08-18 11:01:24,139 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10459d2b0>, <jwkest.jwk.RSAKey object at 0x10455d6d8>, <jwkest.jwk.ECKey object at 0x10455dac8>]
2015-08-18 11:01:24,139 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'WPBCTKFqVVPV', 'nonce': 'W6Fq3SVCzkvSLd4s', 'state': 'RbtDXSF6jt8LyQrX', 'scope': 'openid profile email address phone'}
2015-08-18 11:01:24,140 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'WPBCTKFqVVPV', 'nonce': 'W6Fq3SVCzkvSLd4s', 'state': 'RbtDXSF6jt8LyQrX', 'scope': 'openid profile email address phone'}
2015-08-18 11:01:24,141 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:01:24,141 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:01:24,141 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:01:24,142 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:01:24,142 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:01:24,142 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'redirect_uri', 'acr_values', 'response_type', 'client_id', 'nonce', 'state', 'scope']
2015-08-18 11:01:24,142 oic.utils.sdb:DEBUG uid2sid: {'diana': ['66f6bd53fcaab3d3d6600a2f590471abdf91bbdf54c79564bf57a843']}
2015-08-18 11:01:24,142 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:01:24,142 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:01:24,145 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=RbtDXSF6jt8LyQrX&scope=openid+profile+email+address+phone&code=XgyR6NtM%2BvD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW%2FZL2%2FyQuN2MZkaL51hyDxtizM9h4CZpISIzuQMc%2BcPO7ulTYeUSc%3D' (<class 'str'>)
2015-08-18 11:01:24,173 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1042b9be0>
2015-08-18 11:01:24,173 oic.oic.provider:DEBUG - token -
2015-08-18 11:01:24,173 oic.oic.provider:INFO token_request: key=eyJrdHkiOiAiUlNBIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImtpZCI6ICJhMCIsICJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ%3D%3D&code=XgyR6NtM%2BvD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW%2FZL2%2FyQuN2MZkaL51hyDxtizM9h4CZpISIzuQMc%2BcPO7ulTYeUSc%3D&grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=WPBCTKFqVVPV&client_secret=7ffc96fcf78ae77965544e44a28b7439a665a2b9b55a06f03ec76695
2015-08-18 11:01:24,174 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'key': 'eyJrdHkiOiAiUlNBIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImtpZCI6ICJhMCIsICJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'WPBCTKFqVVPV', 'client_secret': '7ffc96fcf78ae77965544e44a28b7439a665a2b9b55a06f03ec76695', 'code': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuN2MZkaL51hyDxtizM9h4CZpISIzuQMc+cPO7ulTYeUSc='}
2015-08-18 11:01:24,174 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'key': 'eyJrdHkiOiAiUlNBIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImtpZCI6ICJhMCIsICJ1c2UiOiAic2lnIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'WPBCTKFqVVPV', 'client_secret': '7ffc96fcf78ae77965544e44a28b7439a665a2b9b55a06f03ec76695', 'code': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuN2MZkaL51hyDxtizM9h4CZpISIzuQMc+cPO7ulTYeUSc='}
2015-08-18 11:01:24,176 oic.utils.authn.client:DEBUG Verified Client ID: WPBCTKFqVVPV
2015-08-18 11:01:24,178 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:01:24,179 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'WPBCTKFqVVPV', 'nonce': 'W6Fq3SVCzkvSLd4s', 'state': 'RbtDXSF6jt8LyQrX', 'scope': 'openid profile email address phone'}
2015-08-18 11:01:24,179 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:01:24,179 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'WPBCTKFqVVPV', 'nonce': 'W6Fq3SVCzkvSLd4s', 'state': 'RbtDXSF6jt8LyQrX', 'scope': 'openid profile email address phone'}
2015-08-18 11:01:24,179 oic.oic.provider:DEBUG id_token: {'acr': 'PASSWORD', 'iat': 1439888484, 'exp': 1439967684, 'aud': ['WPBCTKFqVVPV'], 'iss': 'https://localhost:8092/', 'nonce': 'W6Fq3SVCzkvSLd4s', 'sub': '-1011ede4f6814', 'auth_time': 1439888484}
2015-08-18 11:01:24,181 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "RSA", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kty": "RSA", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 11:01:24,181 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "x": "slDXpsmF_DWUZUKRarTEWBNEfaMqOudsvlSaZVhi3u4", "kid": "op2", "crv": "P-256", "y": "hVoyZ1id55U3qHdlO8MVc0GW77HIPhwqE3fJtNVYR7I"}]}
2015-08-18 11:01:24,181 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "x": "IUvITTgGG2Zdnr5cupw75cM0Ah0Bo7NWuObv-cmhm1E", "kid": "op3", "crv": "P-256", "y": "WgURfjv5VAjI64OZ1Cvi_6o7IbM0DaW1pVYNXuAvuJc"}]}
2015-08-18 11:01:24,181 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10455d6d8>]
2015-08-18 11:01:24,188 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:01:24,188 oic.oic.provider:DEBUG _tinfo: {'permission': '', 'expires_in': 3600, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAiaWF0IjogMTQzOTg4ODQ4NCwgImV4cCI6IDE0Mzk5Njc2ODQsICJhdWQiOiBbIldQQkNUS0ZxVlZQViJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgIm5vbmNlIjogIlc2RnEzU1ZDemt2U0xkNHMiLCAic3ViIjogIi0xMDExZWRlNGY2ODE0IiwgImF1dGhfdGltZSI6IDE0Mzk4ODg0ODR9.kY_fA1tBPknM8pNajiZScoJXvej-XBhDvL1_6aABCS0Hq0QWkZpm4Xwuyr8BJbg-biGw7PS7Xvfaue_EBJNiSYV8NRTZkMIROqZb9zlGLLRspr8Fjaxbkjsli5vkxea1mKbrwM-FfIYGqI_qB9OSp_ZdOf4PvM8MqaYrucScrSY9zQKjqOhTLzaPor2DJaK99dx1_blhj4vMaHCzNvzGGuc_aP6pbVKN86jU_xM-ZT4pdr3A6wrZI__1C8Zbxhh1TCa49YtVQtp49rL_SOKOrimleB057QkkIoQ7pNF0PToSrVBH0RmXbgszGoLEuvZ27FoSo-_fq9dxZYvMkmdLuw', 'sub': '-1011ede4f6814', 'code_used': True, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'refresh_token': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuN1cX24EYUt4niN5IDqfY2lDFszUdlxuDnd6kAVxAXcoc=', 'access_token_scope': '?', 'code': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuN2MZkaL51hyDxtizM9h4CZpISIzuQMc+cPO7ulTYeUSc=', 'state': 'RbtDXSF6jt8LyQrX', 'token_expires_at': 1439888484, 'redirect_uri': 'http://localhost:8666/authz_cb', 'access_token': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuNA2hHMRHLnLfMnSNl2zBc0VJWupJm+IZBvAmYdYbdPds=', 'authzreq': '{"upm_answer": "true", "redirect_uri": "http://localhost:8666/authz_cb", "acr_values": "SAML", "response_type": "code", "client_id": "WPBCTKFqVVPV", "nonce": "W6Fq3SVCzkvSLd4s", "state": "RbtDXSF6jt8LyQrX", "scope": "openid profile email address phone"}', 'nonce': 'W6Fq3SVCzkvSLd4s', 'client_id': 'WPBCTKFqVVPV', 'token_type': 'Bearer', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x107a144e0>, 'oauth_state': 'token', 'revoked': False}
2015-08-18 11:01:24,188 oic.oic.provider:DEBUG access_token_response: {'refresh_token': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuN1cX24EYUt4niN5IDqfY2lDFszUdlxuDnd6kAVxAXcoc=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAiaWF0IjogMTQzOTg4ODQ4NCwgImV4cCI6IDE0Mzk5Njc2ODQsICJhdWQiOiBbIldQQkNUS0ZxVlZQViJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgIm5vbmNlIjogIlc2RnEzU1ZDemt2U0xkNHMiLCAic3ViIjogIi0xMDExZWRlNGY2ODE0IiwgImF1dGhfdGltZSI6IDE0Mzk4ODg0ODR9.kY_fA1tBPknM8pNajiZScoJXvej-XBhDvL1_6aABCS0Hq0QWkZpm4Xwuyr8BJbg-biGw7PS7Xvfaue_EBJNiSYV8NRTZkMIROqZb9zlGLLRspr8Fjaxbkjsli5vkxea1mKbrwM-FfIYGqI_qB9OSp_ZdOf4PvM8MqaYrucScrSY9zQKjqOhTLzaPor2DJaK99dx1_blhj4vMaHCzNvzGGuc_aP6pbVKN86jU_xM-ZT4pdr3A6wrZI__1C8Zbxhh1TCa49YtVQtp49rL_SOKOrimleB057QkkIoQ7pNF0PToSrVBH0RmXbgszGoLEuvZ27FoSo-_fq9dxZYvMkmdLuw', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'state': 'RbtDXSF6jt8LyQrX', 'token_type': 'Bearer', 'access_token': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuNA2hHMRHLnLfMnSNl2zBc0VJWupJm+IZBvAmYdYbdPds='}
2015-08-18 11:01:24,210 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:01:27,341 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1042b9c50>
2015-08-18 11:01:27,341 oic.oic:DEBUG verify keys: None
2015-08-18 11:01:27,341 oic.oic.provider:DEBUG user_info_request: {'access_token': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuNA2hHMRHLnLfMnSNl2zBc0VJWupJm+IZBvAmYdYbdPds='}
2015-08-18 11:01:27,341 oicServer:DEBUG access_token type: 'T'
2015-08-18 11:01:27,341 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'WPBCTKFqVVPV', 'nonce': 'W6Fq3SVCzkvSLd4s', 'state': 'RbtDXSF6jt8LyQrX', 'scope': 'openid profile email address phone'}
2015-08-18 11:01:27,341 oic.oic.provider:DEBUG userinfo_claim: {'website': None, 'nickname': None, 'name': None, 'given_name': None, 'picture': None, 'updated_at': None, 'sub': None, 'zoneinfo': None, 'family_name': None, 'birthdate': None, 'address': None, 'phone_number': None, 'email': None, 'gender': None, 'middle_name': None, 'profile': None, 'email_verified': None, 'preferred_username': None, 'phone_number_verified': None, 'locale': None}
2015-08-18 11:01:27,341 oic.oic.provider:DEBUG Session info: {'permission': '', 'expires_in': 3600, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAiaWF0IjogMTQzOTg4ODQ4NCwgImV4cCI6IDE0Mzk5Njc2ODQsICJhdWQiOiBbIldQQkNUS0ZxVlZQViJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgIm5vbmNlIjogIlc2RnEzU1ZDemt2U0xkNHMiLCAic3ViIjogIi0xMDExZWRlNGY2ODE0IiwgImF1dGhfdGltZSI6IDE0Mzk4ODg0ODR9.kY_fA1tBPknM8pNajiZScoJXvej-XBhDvL1_6aABCS0Hq0QWkZpm4Xwuyr8BJbg-biGw7PS7Xvfaue_EBJNiSYV8NRTZkMIROqZb9zlGLLRspr8Fjaxbkjsli5vkxea1mKbrwM-FfIYGqI_qB9OSp_ZdOf4PvM8MqaYrucScrSY9zQKjqOhTLzaPor2DJaK99dx1_blhj4vMaHCzNvzGGuc_aP6pbVKN86jU_xM-ZT4pdr3A6wrZI__1C8Zbxhh1TCa49YtVQtp49rL_SOKOrimleB057QkkIoQ7pNF0PToSrVBH0RmXbgszGoLEuvZ27FoSo-_fq9dxZYvMkmdLuw', 'sub': '-1011ede4f6814', 'code_used': True, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'refresh_token': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuN1cX24EYUt4niN5IDqfY2lDFszUdlxuDnd6kAVxAXcoc=', 'access_token_scope': '?', 'code': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuN2MZkaL51hyDxtizM9h4CZpISIzuQMc+cPO7ulTYeUSc=', 'state': 'RbtDXSF6jt8LyQrX', 'token_expires_at': 1439888484, 'redirect_uri': 'http://localhost:8666/authz_cb', 'access_token': 'XgyR6NtM+vD8MAFtXntit7hbG8d4UbgPhntiGp2D6pTtQF1wrC039UW/ZL2/yQuNA2hHMRHLnLfMnSNl2zBc0VJWupJm+IZBvAmYdYbdPds=', 'authzreq': '{"upm_answer": "true", "redirect_uri": "http://localhost:8666/authz_cb", "acr_values": "SAML", "response_type": "code", "client_id": "WPBCTKFqVVPV", "nonce": "W6Fq3SVCzkvSLd4s", "state": "RbtDXSF6jt8LyQrX", "scope": "openid profile email address phone"}', 'nonce': 'W6Fq3SVCzkvSLd4s', 'client_id': 'WPBCTKFqVVPV', 'token_type': 'Bearer', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x107a144e0>, 'oauth_state': 'token', 'revoked': False}
2015-08-18 11:01:27,342 oic.oic.provider:DEBUG user_info_response: {'phone_number': '+46 90 7865000', 'email_verified': False, 'nickname': 'Dina', 'given_name': 'Diana', 'sub': '-1011ede4f6814', 'email': 'diana@example.org', 'name': 'Diana Krall', 'family_name': 'Krall', 'address': {'country': 'Sweden', 'locality': 'Ume', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187'}}
2015-08-18 11:05:55,220 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0"}, {"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1"}]}
2015-08-18 11:05:55,220 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "x": "ZGRS_9Frc7r_oUqSZWgBcH0nkY-oFcyIHwOafuHXIRw", "use": "sig", "y": "gv_9V3KKIXHlN4emYIrlRpm7Cs366hNG_ybJTaHqc8w", "kid": "op2"}]}
2015-08-18 11:05:55,220 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "x": "ZXuq2rqaB1OudjyjV8aqJM9Si_btiK7EoUcqSghhaFc", "use": "enc", "y": "zZIHXM7U6gWDgzoOmbpvwV1SweDAFuJGJc556s0aWHo", "kid": "op3"}]}
2015-08-18 11:05:55,220 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:06:03,764 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"use": "sig", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-18 11:06:03,764 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kid": "op2", "x": "AUsYhlhpF50ZpmP6DLENjNfBNb0zjTTsRq5tNo3AyRo", "crv": "P-256", "kty": "EC", "y": "7cWcsSveuIIDLR_e_0LOt0WwH9bSUrrhG6d_YM5qnso"}]}
2015-08-18 11:06:03,764 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op3", "x": "1rKZVgZxqsE--F6ThL5QCZV4Icnd2sB0s7k0omtY4y8", "crv": "P-256", "kty": "EC", "y": "qDBbmDrBx95qOiLgguu7B76qS07RuVcXvm-7107YCiI"}]}
2015-08-18 11:06:03,764 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:06:14,580 oicServer:INFO callback: <function webfinger at 0x1044446a8>
2015-08-18 11:06:14,598 oicServer:INFO callback: <function op_info at 0x1044442f0>
2015-08-18 11:06:14,598 root:INFO op_info
2015-08-18 11:06:14,598 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:06:14,598 oic.oic.provider:INFO provider_info_response: {'acr_values_supported': ['PASSWORD'], 'id_token_signing_alg_values_supported': ['ES256', 'PS256', 'ES512', 'HS512', 'HS256', 'RS256', 'RS384', 'none', 'ES384', 'PS512', 'PS384', 'HS384', 'RS512'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'scopes_supported': ['phone', 'profile', 'offline_access', 'address', 'openid', 'email', 'openid'], 'token_endpoint_auth_signing_alg_values_supported': ['ES256', 'PS256', 'ES512', 'HS512', 'HS256', 'RS256', 'RS384', 'ES384', 'PS512', 'PS384', 'HS384', 'RS512'], 'userinfo_signing_alg_values_supported': ['ES256', 'PS256', 'ES512', 'HS512', 'HS256', 'RS256', 'RS384', 'none', 'ES384', 'PS512', 'PS384', 'HS384', 'RS512'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'issuer': 'https://localhost:8092/', 'request_object_signing_alg_values_supported': ['ES256', 'PS256', 'ES512', 'HS512', 'HS256', 'RS256', 'RS384', 'none', 'ES384', 'PS512', 'PS384', 'HS384', 'RS512'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'subject_types_supported': ['public', 'pairwise'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8092/registration', 'claims_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_supported': ['middle_name', 'birthdate', 'nickname', 'picture', 'locale', 'preferred_username', 'email_verified', 'address', 'family_name', 'name', 'email', 'gender', 'phone_number', 'zoneinfo', 'updated_at', 'website', 'given_name', 'phone_number_verified', 'profile', 'sub'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint': 'https://localhost:8092/token', 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_parameter_supported': True, 'version': '3.0'}
2015-08-18 11:06:14,670 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1044401d0>
2015-08-18 11:06:14,670 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "contacts": ["ops@example.com"], "response_types": ["code"]}>>
2015-08-18 11:06:14,671 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web'}
2015-08-18 11:06:14,677 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': '6SrVz3OEX1oSR1PnonSftVIa5NJnxeI3', 'client_secret': 'd02548dfd252d622ad8a13072b0fe95f9602545227caf6271a910222', 'client_secret_expires_at': 1439971574, 'client_id': 'HzUgwGcw14qm', 'registration_client_uri': 'https://localhost:8092/registration?client_id=HzUgwGcw14qm', 'client_id_issued_at': 1439885174}
2015-08-18 11:06:14,678 oic.utils.keyio:DEBUG loading keys for issuer: HzUgwGcw14qm
2015-08-18 11:06:14,678 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web'}
2015-08-18 11:06:14,678 oic.oic.provider:DEBUG keys for HzUgwGcw14qm: []
2015-08-18 11:06:14,680 oic.oic.provider:INFO Client info: {'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'registration_access_token': '6SrVz3OEX1oSR1PnonSftVIa5NJnxeI3', 'client_secret': 'd02548dfd252d622ad8a13072b0fe95f9602545227caf6271a910222', 'client_secret_expires_at': 1439971574, 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_id': 'HzUgwGcw14qm', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=HzUgwGcw14qm', 'client_id_issued_at': 1439885174}
2015-08-18 11:06:14,680 oic.oic.provider:DEBUG registration_response: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'registration_access_token': '6SrVz3OEX1oSR1PnonSftVIa5NJnxeI3', 'client_secret': 'd02548dfd252d622ad8a13072b0fe95f9602545227caf6271a910222', 'client_secret_expires_at': 1439971574, 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_id': 'HzUgwGcw14qm', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=HzUgwGcw14qm', 'client_id_issued_at': 1439885174}
2015-08-18 11:06:14,696 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1043acc50>
2015-08-18 11:06:14,697 oic.oauth2.provider:DEBUG Request: 'state=IrEbf1dtGcuf28NG&client_id=HzUgwGcw14qm&response_type=code&acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Un24RL2t3E03WTzs'
2015-08-18 11:06:14,697 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x104744860>, <jwkest.jwk.RSAKey object at 0x10465bc50>, <jwkest.jwk.ECKey object at 0x10465bfd0>]
2015-08-18 11:06:14,697 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'nonce': 'Un24RL2t3E03WTzs', 'client_id': 'HzUgwGcw14qm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'state': 'IrEbf1dtGcuf28NG'}
2015-08-18 11:06:14,699 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'nonce': 'Un24RL2t3E03WTzs', 'client_id': 'HzUgwGcw14qm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'state': 'IrEbf1dtGcuf28NG'}
2015-08-18 11:06:14,700 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:06:14,700 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:06:14,701 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:06:14,701 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:06:14,701 oic.utils.authn.user:INFO do_authentication argv: {'login_title': 'Username', 'submit_text': 'Submit', 'acr': ['SAML'], 'passwd_title': 'Password', 'password': '', 'query': 'state=IrEbf1dtGcuf28NG&client_id=HzUgwGcw14qm&response_type=code&acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Un24RL2t3E03WTzs', 'tos_uri': '', 'policy_uri': '', 'logo_uri': '', 'action': 'https://localhost:8092/verify', 'client_policy_title': 'Client Policy', 'login': '', 'title': 'User log in'}
2015-08-18 11:06:14,723 oicServer:INFO callback: <function css at 0x1043b2a60>
2015-08-18 11:06:18,655 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x1045e37b8>
2015-08-18 11:06:18,655 oic.utils.authn.user:DEBUG verify(query=state%3DIrEbf1dtGcuf28NG%26client_id%3DHzUgwGcw14qm%26response_type%3Dcode%26acr_values%3DSAML%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3DUn24RL2t3E03WTzs&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:06:18,655 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'query': ['state=IrEbf1dtGcuf28NG&client_id=HzUgwGcw14qm&response_type=code&acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Un24RL2t3E03WTzs'], 'acr_values': ["['SAML']"], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-18 11:06:18,655 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-18 11:06:18,656 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'acr_values': ['SAML'], 'scope': ['openid profile email address phone'], 'nonce': ['Un24RL2t3E03WTzs'], 'client_id': ['HzUgwGcw14qm'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'upm_answer': 'true', 'state': ['IrEbf1dtGcuf28NG']}
2015-08-18 11:06:18,678 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1043acc50>
2015-08-18 11:06:18,678 oic.oauth2.provider:DEBUG Request: 'response_type=code&acr_values=SAML&scope=openid+profile+email+address+phone&nonce=Un24RL2t3E03WTzs&client_id=HzUgwGcw14qm&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true&state=IrEbf1dtGcuf28NG'
2015-08-18 11:06:18,679 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x104744860>, <jwkest.jwk.RSAKey object at 0x10465bc50>, <jwkest.jwk.ECKey object at 0x10465bfd0>]
2015-08-18 11:06:18,679 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'nonce': 'Un24RL2t3E03WTzs', 'client_id': 'HzUgwGcw14qm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'state': 'IrEbf1dtGcuf28NG'}
2015-08-18 11:06:18,680 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'nonce': 'Un24RL2t3E03WTzs', 'client_id': 'HzUgwGcw14qm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'state': 'IrEbf1dtGcuf28NG'}
2015-08-18 11:06:18,681 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:06:18,681 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:06:18,681 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:06:18,681 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:06:18,682 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:06:18,682 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'acr_values', 'scope', 'nonce', 'client_id', 'redirect_uri', 'upm_answer', 'state']
2015-08-18 11:06:18,682 oic.utils.sdb:DEBUG uid2sid: {'diana': ['e877c05e163f6be5400eba455f0d6da675bc40b73a0ba5cb878a99fd']}
2015-08-18 11:06:18,682 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:06:18,682 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:06:18,684 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3MZHGbZaCKms1%2BdwympmV%2FK%2FoFV17%2FZcUUP4MU%2BUPcpo%3D&state=IrEbf1dtGcuf28NG' (<class 'str'>)
2015-08-18 11:06:18,704 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x104440160>
2015-08-18 11:06:18,704 oic.oic.provider:DEBUG - token -
2015-08-18 11:06:18,704 oic.oic.provider:INFO token_request: key=eyJrdHkiOiAiUlNBIiwgImUiOiAiQVFBQiIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImtpZCI6ICJhMCIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&code=1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3MZHGbZaCKms1%2BdwympmV%2FK%2FoFV17%2FZcUUP4MU%2BUPcpo%3D&client_id=HzUgwGcw14qm&client_secret=d02548dfd252d622ad8a13072b0fe95f9602545227caf6271a910222&grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-18 11:06:18,704 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'client_secret': 'd02548dfd252d622ad8a13072b0fe95f9602545227caf6271a910222', 'redirect_uri': 'http://localhost:8666/authz_cb', 'key': 'eyJrdHkiOiAiUlNBIiwgImUiOiAiQVFBQiIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImtpZCI6ICJhMCIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'client_id': 'HzUgwGcw14qm', 'code': '1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3MZHGbZaCKms1+dwympmV/K/oFV17/ZcUUP4MU+UPcpo='}
2015-08-18 11:06:18,704 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'client_secret': 'd02548dfd252d622ad8a13072b0fe95f9602545227caf6271a910222', 'redirect_uri': 'http://localhost:8666/authz_cb', 'key': 'eyJrdHkiOiAiUlNBIiwgImUiOiAiQVFBQiIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImtpZCI6ICJhMCIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'client_id': 'HzUgwGcw14qm', 'code': '1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3MZHGbZaCKms1+dwympmV/K/oFV17/ZcUUP4MU+UPcpo='}
2015-08-18 11:06:18,706 oic.utils.authn.client:DEBUG Verified Client ID: HzUgwGcw14qm
2015-08-18 11:06:18,710 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:06:18,710 oic.oic:DEBUG authzreq: {'response_type': 'code', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'nonce': 'Un24RL2t3E03WTzs', 'client_id': 'HzUgwGcw14qm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'state': 'IrEbf1dtGcuf28NG'}
2015-08-18 11:06:18,711 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:06:18,711 oic.oic:DEBUG authzreq: {'response_type': 'code', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'nonce': 'Un24RL2t3E03WTzs', 'client_id': 'HzUgwGcw14qm', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'state': 'IrEbf1dtGcuf28NG'}
2015-08-18 11:06:18,711 oic.oic.provider:DEBUG id_token: {'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'iat': 1439888778, 'aud': ['HzUgwGcw14qm'], 'nonce': 'Un24RL2t3E03WTzs', 'auth_time': 1439888778, 'exp': 1439967978, 'sub': '-36d32176fd8d59ce'}
2015-08-18 11:06:18,713 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"use": "sig", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-18 11:06:18,713 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "kid": "op2", "x": "AUsYhlhpF50ZpmP6DLENjNfBNb0zjTTsRq5tNo3AyRo", "crv": "P-256", "kty": "EC", "y": "7cWcsSveuIIDLR_e_0LOt0WwH9bSUrrhG6d_YM5qnso"}]}
2015-08-18 11:06:18,714 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "kid": "op3", "x": "1rKZVgZxqsE--F6ThL5QCZV4Icnd2sB0s7k0omtY4y8", "crv": "P-256", "kty": "EC", "y": "qDBbmDrBx95qOiLgguu7B76qS07RuVcXvm-7107YCiI"}]}
2015-08-18 11:06:18,714 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10465bc50>]
2015-08-18 11:06:18,719 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:06:18,719 oic.oic.provider:DEBUG _tinfo: {'code_used': True, 'oauth_state': 'token', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_type': 'Bearer', 'client_id': 'HzUgwGcw14qm', 'authzreq': '{"response_type": "code", "acr_values": "SAML", "scope": "openid profile email address phone", "nonce": "Un24RL2t3E03WTzs", "client_id": "HzUgwGcw14qm", "redirect_uri": "http://localhost:8666/authz_cb", "upm_answer": "true", "state": "IrEbf1dtGcuf28NG"}', 'refresh_token': '1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3cjfe9kwqjaxCcRT0V+Z8q+9xCaH8xsm2tgiw+6/4bpg=', 'code': '1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3MZHGbZaCKms1+dwympmV/K/oFV17/ZcUUP4MU+UPcpo=', 'expires_in': 3600, 'revoked': False, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0Mzk4ODg3NzgsICJhdWQiOiBbIkh6VWd3R2N3MTRxbSJdLCAibm9uY2UiOiAiVW4yNFJMMnQzRTAzV1R6cyIsICJhdXRoX3RpbWUiOiAxNDM5ODg4Nzc4LCAiZXhwIjogMTQzOTk2Nzk3OCwgInN1YiI6ICItMzZkMzIxNzZmZDhkNTljZSJ9.BaDIxBz3tUP6PVzr2rxD6V-eKApb5lcbbs4bqJsAB1KhlKeH5WVEtABXiw8CeIZmexWXm6ceFXV2VeoShPz0IxFUHMbpVym0SMvLT0KOhtqLlnn9ERDN_jQWF8OmDXP8VmAcp4-WsCotEMq6XpO3YiU5gSp2qA1i1-SsVY84cAkoigp3xgOELw-dyHkydjHtj4MBX1syMAiN8RxzcIsayfMg6jsTLGs4lgHmcFZVkX280kvbMplzUsjhp4I4Ld3l10xReZjdeLOjqD5IjArcHc9U03r3T2Y2MaC9Z9FEZc5HaQweV53pltekXL-rWtWIb42pd5x-8Ne5L9O1TmVvaQ', 'redirect_uri': 'http://localhost:8666/authz_cb', 'state': 'IrEbf1dtGcuf28NG', 'access_token_scope': '?', 'nonce': 'Un24RL2t3E03WTzs', 'token_expires_at': 1439888778, 'permission': '', 'access_token': '1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3axdK5Fk20gSec7XgJ1Ezm3SaqKkjXpVR+FrId06Qeow=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10476b6d8>, 'sub': '-36d32176fd8d59ce'}
2015-08-18 11:06:18,719 oic.oic.provider:DEBUG access_token_response: {'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0Mzk4ODg3NzgsICJhdWQiOiBbIkh6VWd3R2N3MTRxbSJdLCAibm9uY2UiOiAiVW4yNFJMMnQzRTAzV1R6cyIsICJhdXRoX3RpbWUiOiAxNDM5ODg4Nzc4LCAiZXhwIjogMTQzOTk2Nzk3OCwgInN1YiI6ICItMzZkMzIxNzZmZDhkNTljZSJ9.BaDIxBz3tUP6PVzr2rxD6V-eKApb5lcbbs4bqJsAB1KhlKeH5WVEtABXiw8CeIZmexWXm6ceFXV2VeoShPz0IxFUHMbpVym0SMvLT0KOhtqLlnn9ERDN_jQWF8OmDXP8VmAcp4-WsCotEMq6XpO3YiU5gSp2qA1i1-SsVY84cAkoigp3xgOELw-dyHkydjHtj4MBX1syMAiN8RxzcIsayfMg6jsTLGs4lgHmcFZVkX280kvbMplzUsjhp4I4Ld3l10xReZjdeLOjqD5IjArcHc9U03r3T2Y2MaC9Z9FEZc5HaQweV53pltekXL-rWtWIb42pd5x-8Ne5L9O1TmVvaQ', 'scope': 'openid profile email address phone', 'token_type': 'Bearer', 'expires_in': 3600, 'refresh_token': '1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3cjfe9kwqjaxCcRT0V+Z8q+9xCaH8xsm2tgiw+6/4bpg=', 'state': 'IrEbf1dtGcuf28NG', 'access_token': '1Sg2alUJvzFsZycZE6aW3cKtpGMknRJ5qQtJy5paLAZaSYWYeEmWAsadcbWnXyL3axdK5Fk20gSec7XgJ1Ezm3SaqKkjXpVR+FrId06Qeow='}
2015-08-18 11:06:18,739 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:06:22,650 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x104440198>
2015-08-18 11:07:23,312 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 11:07:23,312 root:INFO OC3 server keys: {"keys": [{"y": "yFNLolgPYl9ojZQ-J065TZ7H2wgUunwlIWDbnUOQgO8", "use": "sig", "kid": "op2", "kty": "EC", "x": "nnmWR8LR_LS-tK1dktPsPRK1xLA-slOA2E-lOpl79AQ", "crv": "P-256"}]}
2015-08-18 11:07:23,313 root:INFO OC3 server keys: {"keys": [{"y": "qSiBr1t8bmPmdhQrBcR5OWyxFe-sYQTTrbQKHgvG1yk", "use": "enc", "kid": "op3", "kty": "EC", "x": "P-yGzR9NQ6-aTKUzjE0titGhw5q8T_mhM2YwYF4ozwo", "crv": "P-256"}]}
2015-08-18 11:07:23,313 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:07:26,908 oicServer:INFO callback: <function webfinger at 0x1055ec6a8>
2015-08-18 11:07:26,928 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055c12b0>
2015-08-18 11:07:26,929 oic.oauth2.provider:DEBUG Request: 'state=8arKKNgUBELbnIih&client_id=HzUgwGcw14qm&response_type=code&acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=RSUopVYIOqcrTnCn'
2015-08-18 11:07:26,929 oic.oic:DEBUG verify keys: [<jwkest.jwk.RSAKey object at 0x1057bef28>, <jwkest.jwk.ECKey object at 0x1057c3358>]
2015-08-18 11:07:26,930 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'state': '8arKKNgUBELbnIih', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'RSUopVYIOqcrTnCn', 'response_type': 'code', 'client_id': 'HzUgwGcw14qm', 'acr_values': 'SAML'}
2015-08-18 11:07:26,932 oic.oauth2.provider:ERROR Faulty redirect_uri: http://localhost:8666/authz_cb
2015-08-18 11:07:26,934 oic.oauth2.provider:INFO Unknown client: HzUgwGcw14qm
2015-08-18 11:07:50,729 oicServer:INFO callback: <function webfinger at 0x1055ec6a8>
2015-08-18 11:07:50,749 oicServer:INFO callback: <function op_info at 0x1055ec2f0>
2015-08-18 11:07:50,749 root:INFO op_info
2015-08-18 11:07:50,749 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:07:50,750 oic.oic.provider:INFO provider_info_response: {'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_object_signing_alg_values_supported': ['PS512', 'RS512', 'HS512', 'RS384', 'PS384', 'RS256', 'ES256', 'ES512', 'HS384', 'PS256', 'HS256', 'ES384', 'none'], 'claims_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_uri_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD'], 'userinfo_signing_alg_values_supported': ['PS512', 'RS512', 'HS512', 'RS384', 'PS384', 'RS256', 'ES256', 'ES512', 'HS384', 'PS256', 'HS256', 'ES384', 'none'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['offline_access', 'address', 'email', 'phone', 'openid', 'profile', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'version': '3.0', 'token_endpoint_auth_signing_alg_values_supported': ['PS512', 'RS512', 'HS512', 'RS384', 'PS384', 'RS256', 'ES256', 'ES512', 'HS384', 'PS256', 'HS256', 'ES384'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_signing_alg_values_supported': ['PS512', 'RS512', 'HS512', 'RS384', 'PS384', 'RS256', 'ES256', 'ES512', 'HS384', 'PS256', 'HS256', 'ES384', 'none'], 'subject_types_supported': ['public', 'pairwise'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'claims_supported': ['email_verified', 'website', 'updated_at', 'given_name', 'profile', 'birthdate', 'zoneinfo', 'middle_name', 'name', 'gender', 'preferred_username', 'address', 'email', 'family_name', 'phone_number', 'sub', 'nickname', 'picture', 'phone_number_verified', 'locale'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'end_session_endpoint': 'https://localhost:8092/end_session', 'require_request_uri_registration': True, 'token_endpoint': 'https://localhost:8092/token', 'request_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW']}
2015-08-18 11:07:50,820 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105646780>
2015-08-18 11:07:50,820 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "application_type": "web", "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 11:07:50,821 oic.oic.provider:INFO registration_request:{'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-18 11:07:50,828 oic.oic.provider:DEBUG _cinfo: {'client_secret_expires_at': 1439971670, 'registration_client_uri': 'https://localhost:8092/registration?client_id=TDIV0PNvtOaw', 'client_secret': 'fc7ba82aa84bb87975da3332b9f298147f497b2407519303eac4a0a3', 'registration_access_token': 'qEmej3JlNyhda5tPH70DybW6CdYxjKhJ', 'client_id': 'TDIV0PNvtOaw', 'client_id_issued_at': 1439885270}
2015-08-18 11:07:50,829 oic.utils.keyio:DEBUG loading keys for issuer: TDIV0PNvtOaw
2015-08-18 11:07:50,829 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-18 11:07:50,830 oic.oic.provider:DEBUG keys for TDIV0PNvtOaw: []
2015-08-18 11:07:50,832 oic.oic.provider:INFO Client info: {'response_types': ['code'], 'client_secret_expires_at': 1439971670, 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=TDIV0PNvtOaw', 'client_secret': 'fc7ba82aa84bb87975da3332b9f298147f497b2407519303eac4a0a3', 'registration_access_token': 'qEmej3JlNyhda5tPH70DybW6CdYxjKhJ', 'client_id': 'TDIV0PNvtOaw', 'application_type': 'web', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_id_issued_at': 1439885270, 'contacts': ['ops@example.com']}
2015-08-18 11:07:50,832 oic.oic.provider:DEBUG registration_response: {'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret': 'fc7ba82aa84bb87975da3332b9f298147f497b2407519303eac4a0a3', 'registration_client_uri': 'https://localhost:8092/registration?client_id=TDIV0PNvtOaw', 'client_id': 'TDIV0PNvtOaw', 'client_secret_expires_at': 1439971670, 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'registration_access_token': 'qEmej3JlNyhda5tPH70DybW6CdYxjKhJ', 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439885270}
2015-08-18 11:07:50,848 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055c12b0>
2015-08-18 11:07:50,848 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&state=j9KcP2VA7iCVSVyR&nonce=SIONJZNOnOb0O6jS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=TDIV0PNvtOaw&response_type=code'
2015-08-18 11:07:50,849 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f25c0>, <jwkest.jwk.RSAKey object at 0x1057bef28>, <jwkest.jwk.ECKey object at 0x1057c3358>]
2015-08-18 11:07:50,849 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'state': 'j9KcP2VA7iCVSVyR', 'client_id': 'TDIV0PNvtOaw', 'nonce': 'SIONJZNOnOb0O6jS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML'}
2015-08-18 11:07:50,851 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'state': 'j9KcP2VA7iCVSVyR', 'client_id': 'TDIV0PNvtOaw', 'nonce': 'SIONJZNOnOb0O6jS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML'}
2015-08-18 11:07:50,854 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:07:50,854 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:07:50,854 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:07:50,855 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:07:50,856 oic.utils.authn.user:INFO do_authentication argv: {'client_policy_title': 'Client Policy', 'title': 'User log in', 'tos_uri': '', 'policy_uri': '', 'passwd_title': 'Password', 'action': 'https://localhost:8092/verify', 'login': '', 'submit_text': 'Submit', 'query': 'acr_values=SAML&state=j9KcP2VA7iCVSVyR&nonce=SIONJZNOnOb0O6jS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=TDIV0PNvtOaw&response_type=code', 'login_title': 'Username', 'logo_uri': '', 'password': '', 'acr': ['SAML']}
2015-08-18 11:07:50,869 oicServer:INFO callback: <function css at 0x1055bd620>
2015-08-18 11:07:54,795 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105746598>
2015-08-18 11:07:54,796 oic.utils.authn.user:DEBUG verify(query=acr_values%3DSAML%26state%3Dj9KcP2VA7iCVSVyR%26nonce%3DSIONJZNOnOb0O6jS%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DTDIV0PNvtOaw%26response_type%3Dcode&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:07:54,796 oic.utils.authn.user:DEBUG dict: {'query': ['acr_values=SAML&state=j9KcP2VA7iCVSVyR&nonce=SIONJZNOnOb0O6jS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=TDIV0PNvtOaw&response_type=code'], 'form.commit': ['Submit'], 'login': ['diana'], 'password': ['krall'], 'acr_values': ["['SAML']"]}
2015-08-18 11:07:54,797 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 11:07:54,799 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'scope': ['openid profile email address phone'], 'state': ['j9KcP2VA7iCVSVyR'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'nonce': ['SIONJZNOnOb0O6jS'], 'client_id': ['TDIV0PNvtOaw'], 'response_type': ['code'], 'acr_values': ['SAML']}
2015-08-18 11:07:54,818 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055c12b0>
2015-08-18 11:07:54,818 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&scope=openid+profile+email+address+phone&state=j9KcP2VA7iCVSVyR&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=SIONJZNOnOb0O6jS&client_id=TDIV0PNvtOaw&response_type=code&acr_values=SAML'
2015-08-18 11:07:54,819 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f25c0>, <jwkest.jwk.RSAKey object at 0x1057bef28>, <jwkest.jwk.ECKey object at 0x1057c3358>]
2015-08-18 11:07:54,819 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'j9KcP2VA7iCVSVyR', 'client_id': 'TDIV0PNvtOaw', 'nonce': 'SIONJZNOnOb0O6jS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML'}
2015-08-18 11:07:54,821 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'j9KcP2VA7iCVSVyR', 'client_id': 'TDIV0PNvtOaw', 'nonce': 'SIONJZNOnOb0O6jS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML'}
2015-08-18 11:07:54,823 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:07:54,823 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:07:54,824 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:07:54,825 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:07:54,826 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:07:54,827 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'scope', 'state', 'redirect_uri', 'nonce', 'client_id', 'response_type', 'acr_values']
2015-08-18 11:07:54,828 oic.utils.sdb:DEBUG uid2sid: {'diana': ['173850148cc701ad29b12eb2b5c43a9054108137562315265ddbd065']}
2015-08-18 11:07:54,829 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:07:54,829 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:07:54,832 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=YkPXnVEuq1wfoWrO4NdffNEHSDCKljK%2FW9H8fZySIt4KlLnpQJezF9dDE3rICPlxFEH6rIFiFjI5j2Fbzj4Qpg4WQvfD8dNocp3pZOrfih8%3D&scope=openid+profile+email+address+phone&state=j9KcP2VA7iCVSVyR' (<class 'str'>)
2015-08-18 11:07:54,853 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055c1358>
2015-08-18 11:07:54,853 oic.oic.provider:DEBUG - token -
2015-08-18 11:07:54,854 oic.oic.provider:INFO token_request: client_id=TDIV0PNvtOaw&client_secret=fc7ba82aa84bb87975da3332b9f298147f497b2407519303eac4a0a3&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInVzZSI6ICJzaWcifQ%3D%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&grant_type=authorization_code&code=YkPXnVEuq1wfoWrO4NdffNEHSDCKljK%2FW9H8fZySIt4KlLnpQJezF9dDE3rICPlxFEH6rIFiFjI5j2Fbzj4Qpg4WQvfD8dNocp3pZOrfih8%3D
2015-08-18 11:07:54,854 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'YkPXnVEuq1wfoWrO4NdffNEHSDCKljK/W9H8fZySIt4KlLnpQJezF9dDE3rICPlxFEH6rIFiFjI5j2Fbzj4Qpg4WQvfD8dNocp3pZOrfih8=', 'client_secret': 'fc7ba82aa84bb87975da3332b9f298147f497b2407519303eac4a0a3', 'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'client_id': 'TDIV0PNvtOaw', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInVzZSI6ICJzaWcifQ=='}
2015-08-18 11:07:54,855 oic.utils.authn.client:DEBUG REQ: {'code': 'YkPXnVEuq1wfoWrO4NdffNEHSDCKljK/W9H8fZySIt4KlLnpQJezF9dDE3rICPlxFEH6rIFiFjI5j2Fbzj4Qpg4WQvfD8dNocp3pZOrfih8=', 'client_secret': 'fc7ba82aa84bb87975da3332b9f298147f497b2407519303eac4a0a3', 'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'client_id': 'TDIV0PNvtOaw', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInVzZSI6ICJzaWcifQ=='}
2015-08-18 11:07:54,857 oic.utils.authn.client:DEBUG Verified Client ID: TDIV0PNvtOaw
2015-08-18 11:07:54,862 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:07:54,864 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'j9KcP2VA7iCVSVyR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'SIONJZNOnOb0O6jS', 'client_id': 'TDIV0PNvtOaw', 'response_type': 'code', 'acr_values': 'SAML'}
2015-08-18 11:07:54,865 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:07:54,865 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': 'j9KcP2VA7iCVSVyR', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'SIONJZNOnOb0O6jS', 'client_id': 'TDIV0PNvtOaw', 'response_type': 'code', 'acr_values': 'SAML'}
2015-08-18 11:07:54,866 oic.oic.provider:DEBUG id_token: {'auth_time': 1439888874, 'iat': 1439888874, 'iss': 'https://localhost:8092/', 'aud': ['TDIV0PNvtOaw'], 'acr': 'PASSWORD', 'exp': 1439968074, 'sub': '-261bf5f646836921', 'nonce': 'SIONJZNOnOb0O6jS'}
2015-08-18 11:07:54,868 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 11:07:54,869 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "yFNLolgPYl9ojZQ-J065TZ7H2wgUunwlIWDbnUOQgO8", "use": "sig", "kid": "op2", "kty": "EC", "x": "nnmWR8LR_LS-tK1dktPsPRK1xLA-slOA2E-lOpl79AQ", "crv": "P-256"}]}
2015-08-18 11:07:54,870 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "qSiBr1t8bmPmdhQrBcR5OWyxFe-sYQTTrbQKHgvG1yk", "use": "enc", "kid": "op3", "kty": "EC", "x": "P-yGzR9NQ6-aTKUzjE0titGhw5q8T_mhM2YwYF4ozwo", "crv": "P-256"}]}
2015-08-18 11:07:54,870 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057bef28>]
2015-08-18 11:07:54,878 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:07:54,878 oic.oic.provider:DEBUG _tinfo: {'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5ODg4ODc0LCAiaWF0IjogMTQzOTg4ODg3NCwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhdWQiOiBbIlRESVYwUE52dE9hdyJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0Mzk5NjgwNzQsICJzdWIiOiAiLTI2MWJmNWY2NDY4MzY5MjEiLCAibm9uY2UiOiAiU0lPTkpaTk9uT2IwTzZqUyJ9.BFuRs7w5e67uogHqm2AnjCXIvaSxdAqyhFruA9eYVadmdJj7oq1WDKIAHwFohHuU4fGg2egiiR9e1_pow9ChlMlnoDBN1KrEjfaMW2bLO2fxypvD2ung0unzpRv-kWK90wFMAHhxAgNq_HQOc4-olWvIMcTZMbfG8M-vbjDR64gd_MXgLEGh2pzIMFuVNGjlzJSwwjEIWakAJobCe1Edw2u0OHy74PUMDHSFh4ditUezAUgtk1Uq_2L_hndF7VZotleK-q_Ka70AJFjiuZ9oXCAp_ssNDzQ_t6GNMxpj6_hvYv0KuRO2dDf782AJOJ3aTMeQ96m1uQJX6n_XaRsunw', 'access_token_scope': '?', 'code': 'YkPXnVEuq1wfoWrO4NdffNEHSDCKljK/W9H8fZySIt4KlLnpQJezF9dDE3rICPlxFEH6rIFiFjI5j2Fbzj4Qpg4WQvfD8dNocp3pZOrfih8=', 'expires_in': 3600, 'oauth_state': 'token', 'revoked': False, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f2a90>, 'redirect_uri': 'http://localhost:8666/authz_cb', 'access_token': 'YkPXnVEuq1wfoWrO4NdffNEHSDCKljK/W9H8fZySIt4KlLnpQJezF9dDE3rICPlxWZYM3G5MBS5zjJDIUyKOCeyWqxSMEvcMAuPXmZWseQk=', 'code_used': True, 'permission': '', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'state': 'j9KcP2VA7iCVSVyR', 'refresh_token': 'YkPXnVEuq1wfoWrO4NdffNEHSDCKljK/W9H8fZySIt4KlLnpQJezF9dDE3rICPlxwkiamiXc5cwrxiZq219CCVLEMtUBe4A/BHEocZD3eaw=', 'nonce': 'SIONJZNOnOb0O6jS', 'client_id': 'TDIV0PNvtOaw', 'sub': '-261bf5f646836921', 'authzreq': '{"upm_answer": "true", "scope": "openid profile email address phone", "state": "j9KcP2VA7iCVSVyR", "client_id": "TDIV0PNvtOaw", "nonce": "SIONJZNOnOb0O6jS", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "acr_values": "SAML"}', 'token_type': 'Bearer', 'token_expires_at': 1439888874}
2015-08-18 11:07:54,879 oic.oic.provider:DEBUG access_token_response: {'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5ODg4ODc0LCAiaWF0IjogMTQzOTg4ODg3NCwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhdWQiOiBbIlRESVYwUE52dE9hdyJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0Mzk5NjgwNzQsICJzdWIiOiAiLTI2MWJmNWY2NDY4MzY5MjEiLCAibm9uY2UiOiAiU0lPTkpaTk9uT2IwTzZqUyJ9.BFuRs7w5e67uogHqm2AnjCXIvaSxdAqyhFruA9eYVadmdJj7oq1WDKIAHwFohHuU4fGg2egiiR9e1_pow9ChlMlnoDBN1KrEjfaMW2bLO2fxypvD2ung0unzpRv-kWK90wFMAHhxAgNq_HQOc4-olWvIMcTZMbfG8M-vbjDR64gd_MXgLEGh2pzIMFuVNGjlzJSwwjEIWakAJobCe1Edw2u0OHy74PUMDHSFh4ditUezAUgtk1Uq_2L_hndF7VZotleK-q_Ka70AJFjiuZ9oXCAp_ssNDzQ_t6GNMxpj6_hvYv0KuRO2dDf782AJOJ3aTMeQ96m1uQJX6n_XaRsunw', 'scope': 'openid profile email address phone', 'refresh_token': 'YkPXnVEuq1wfoWrO4NdffNEHSDCKljK/W9H8fZySIt4KlLnpQJezF9dDE3rICPlxwkiamiXc5cwrxiZq219CCVLEMtUBe4A/BHEocZD3eaw=', 'state': 'j9KcP2VA7iCVSVyR', 'access_token': 'YkPXnVEuq1wfoWrO4NdffNEHSDCKljK/W9H8fZySIt4KlLnpQJezF9dDE3rICPlxWZYM3G5MBS5zjJDIUyKOCeyWqxSMEvcMAuPXmZWseQk=', 'token_type': 'Bearer', 'expires_in': 3600}
2015-08-18 11:07:54,902 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:07:58,500 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1056466d8>
2015-08-18 11:11:57,669 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}, {"e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}]}
2015-08-18 11:11:57,669 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "pFsgzpb-67Ro4XAm630Pca0ose6B2ohFvGKcNw5gDZA", "kid": "op2", "use": "sig", "kty": "EC", "y": "CN0I8IKsat4xIfIbZTi-kD38N5Fumtvn-s0WfL95XTc"}]}
2015-08-18 11:11:57,670 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "B5J0Gy6VJoMyip9cHYRyPGKpy5Mr7CsbDcF26hsY5Sc", "kid": "op3", "use": "enc", "kty": "EC", "y": "vKFUjYoU2bxiAeMMSGcEYsew1XHAx6z2I74W76cO7Q8"}]}
2015-08-18 11:11:57,670 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:12:00,749 oicServer:INFO callback: <function webfinger at 0x1054ed6a8>
2015-08-18 11:12:00,769 oicServer:INFO callback: <function op_info at 0x1054ed2f0>
2015-08-18 11:12:00,770 root:INFO op_info
2015-08-18 11:12:00,771 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:12:00,772 oic.oic.provider:INFO provider_info_response: {'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint': 'https://localhost:8092/token', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'scopes_supported': ['phone', 'openid', 'email', 'profile', 'address', 'offline_access', 'openid'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'version': '3.0', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_signing_alg_values_supported': ['HS256', 'PS256', 'none', 'PS384', 'ES512', 'ES384', 'HS384', 'RS384', 'RS256', 'RS512', 'ES256', 'PS512', 'HS512'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['HS256', 'PS256', 'none', 'PS384', 'ES512', 'ES384', 'HS384', 'RS384', 'RS256', 'RS512', 'ES256', 'PS512', 'HS512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'PS256', 'PS384', 'ES512', 'ES384', 'HS384', 'RS384', 'RS256', 'RS512', 'ES256', 'PS512', 'HS512'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_supported': ['locale', 'middle_name', 'email', 'family_name', 'profile', 'nickname', 'phone_number_verified', 'sub', 'given_name', 'picture', 'phone_number', 'website', 'gender', 'zoneinfo', 'address', 'preferred_username', 'name', 'email_verified', 'birthdate', 'updated_at'], 'request_parameter_supported': True, 'require_request_uri_registration': True, 'userinfo_signing_alg_values_supported': ['HS256', 'PS256', 'none', 'PS384', 'ES512', 'ES384', 'HS384', 'RS384', 'RS256', 'RS512', 'ES256', 'PS512', 'HS512'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'request_uri_parameter_supported': True}
2015-08-18 11:12:00,842 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1056467b8>
2015-08-18 11:12:00,843 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"]}>>
2015-08-18 11:12:00,843 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:12:00,850 oic.oic.provider:DEBUG _cinfo: {'client_secret_expires_at': 1439971920, 'client_id': 'bGQBXYKlCCGu', 'registration_access_token': 'KIs2IP8qGNEh8KLUTqcepPHW1X95tK2I', 'client_secret': 'abcb0b188322b811a2322dca8b8c6a8506102a26167ba115d98be332', 'registration_client_uri': 'https://localhost:8092/registration?client_id=bGQBXYKlCCGu', 'client_id_issued_at': 1439885520}
2015-08-18 11:12:00,852 oic.utils.keyio:DEBUG loading keys for issuer: bGQBXYKlCCGu
2015-08-18 11:12:00,852 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:12:00,853 oic.oic.provider:DEBUG keys for bGQBXYKlCCGu: []
2015-08-18 11:12:00,855 oic.oic.provider:INFO Client info: {'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_secret_expires_at': 1439971920, 'client_id': 'bGQBXYKlCCGu', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'registration_access_token': 'KIs2IP8qGNEh8KLUTqcepPHW1X95tK2I', 'application_type': 'web', 'client_secret': 'abcb0b188322b811a2322dca8b8c6a8506102a26167ba115d98be332', 'registration_client_uri': 'https://localhost:8092/registration?client_id=bGQBXYKlCCGu', 'client_id_issued_at': 1439885520}
2015-08-18 11:12:00,855 oic.oic.provider:DEBUG registration_response: {'registration_client_uri': 'https://localhost:8092/registration?client_id=bGQBXYKlCCGu', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_id': 'bGQBXYKlCCGu', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'client_secret': 'abcb0b188322b811a2322dca8b8c6a8506102a26167ba115d98be332', 'client_secret_expires_at': 1439971920, 'registration_access_token': 'KIs2IP8qGNEh8KLUTqcepPHW1X95tK2I', 'client_id_issued_at': 1439885520}
2015-08-18 11:12:00,870 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054bf2e8>
2015-08-18 11:12:00,871 oic.oauth2.provider:DEBUG Request: 'nonce=RVJwkVR2jLjVoZDN&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&response_type=code&client_id=bGQBXYKlCCGu&acr_values=SAML&state=XEqhAJlVFIsjVKTm'
2015-08-18 11:12:00,872 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f70f0>, <jwkest.jwk.RSAKey object at 0x1057bef60>, <jwkest.jwk.ECKey object at 0x1057c3438>]
2015-08-18 11:12:00,872 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'scope': 'openid profile email address phone', 'nonce': 'RVJwkVR2jLjVoZDN', 'state': 'XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:00,874 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'scope': 'openid profile email address phone', 'nonce': 'RVJwkVR2jLjVoZDN', 'state': 'XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:00,876 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:12:00,876 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:12:00,877 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:12:00,878 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:12:00,878 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'passwd_title': 'Password', 'login_title': 'Username', 'title': 'User log in', 'acr': ['SAML'], 'login': '', 'tos_uri': '', 'policy_uri': '', 'password': '', 'action': 'https://localhost:8092/verify', 'logo_uri': '', 'client_policy_title': 'Client Policy', 'query': 'nonce=RVJwkVR2jLjVoZDN&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&response_type=code&client_id=bGQBXYKlCCGu&acr_values=SAML&state=XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:00,908 oicServer:INFO callback: <function css at 0x1054be620>
2015-08-18 11:12:05,652 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105746598>
2015-08-18 11:12:05,652 oic.utils.authn.user:DEBUG verify(query=nonce%3DRVJwkVR2jLjVoZDN%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26client_id%3DbGQBXYKlCCGu%26acr_values%3DSAML%26state%3DXEqhAJlVFIsjVKTm&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:12:05,653 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'acr_values': ["['SAML']"], 'query': ['nonce=RVJwkVR2jLjVoZDN&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&response_type=code&client_id=bGQBXYKlCCGu&acr_values=SAML&state=XEqhAJlVFIsjVKTm'], 'form.commit': ['Submit'], 'password': ['krall']}
2015-08-18 11:12:05,653 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-18 11:12:05,656 oic.utils.authn.user:DEBUG kwargs: {'client_id': ['bGQBXYKlCCGu'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'acr_values': ['SAML'], 'response_type': ['code'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true', 'nonce': ['RVJwkVR2jLjVoZDN'], 'state': ['XEqhAJlVFIsjVKTm']}
2015-08-18 11:12:05,676 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054bf2e8>
2015-08-18 11:12:05,677 oic.oauth2.provider:DEBUG Request: 'client_id=bGQBXYKlCCGu&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&scope=openid+profile+email+address+phone&upm_answer=true&nonce=RVJwkVR2jLjVoZDN&state=XEqhAJlVFIsjVKTm'
2015-08-18 11:12:05,677 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f70f0>, <jwkest.jwk.RSAKey object at 0x1057bef60>, <jwkest.jwk.ECKey object at 0x1057c3438>]
2015-08-18 11:12:05,678 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'nonce': 'RVJwkVR2jLjVoZDN', 'state': 'XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:05,679 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'nonce': 'RVJwkVR2jLjVoZDN', 'state': 'XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:05,681 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:12:05,682 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:12:05,682 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:12:05,683 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:12:05,683 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:12:05,684 oic.oic.provider:DEBUG AREQ keys: ['client_id', 'redirect_uri', 'acr_values', 'response_type', 'scope', 'upm_answer', 'nonce', 'state']
2015-08-18 11:12:05,684 oic.utils.sdb:DEBUG uid2sid: {'diana': ['9f2f42ba1cbaaf694d0995c15f8726a7e87ceb968721b2b147deb821']}
2015-08-18 11:12:05,685 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:12:05,685 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:12:05,688 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=qRvdgFB4BL%2FO40F%2Bg%2F7EWSSBrsq%2Ba7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuQgSfky3g%2BW97CzHiC9Xau7TiSMGPO320P%2Bl%2Bvl%2BDroA%3D&state=XEqhAJlVFIsjVKTm' (<class 'str'>)
2015-08-18 11:12:05,711 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054bf390>
2015-08-18 11:12:05,713 oic.oic.provider:DEBUG - token -
2015-08-18 11:12:05,713 oic.oic.provider:INFO token_request: redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&key=eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImt0eSI6ICJSU0EiLCAiZSI6ICJBUUFCIiwgInVzZSI6ICJzaWcifQ%3D%3D&client_secret=abcb0b188322b811a2322dca8b8c6a8506102a26167ba115d98be332&grant_type=authorization_code&client_id=bGQBXYKlCCGu&code=qRvdgFB4BL%2FO40F%2Bg%2F7EWSSBrsq%2Ba7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuQgSfky3g%2BW97CzHiC9Xau7TiSMGPO320P%2Bl%2Bvl%2BDroA%3D
2015-08-18 11:12:05,714 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImt0eSI6ICJSU0EiLCAiZSI6ICJBUUFCIiwgInVzZSI6ICJzaWcifQ==', 'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code': 'qRvdgFB4BL/O40F+g/7EWSSBrsq+a7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuQgSfky3g+W97CzHiC9Xau7TiSMGPO320P+l+vl+DroA=', 'client_secret': 'abcb0b188322b811a2322dca8b8c6a8506102a26167ba115d98be332'}
2015-08-18 11:12:05,714 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImt0eSI6ICJSU0EiLCAiZSI6ICJBUUFCIiwgInVzZSI6ICJzaWcifQ==', 'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code': 'qRvdgFB4BL/O40F+g/7EWSSBrsq+a7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuQgSfky3g+W97CzHiC9Xau7TiSMGPO320P+l+vl+DroA=', 'client_secret': 'abcb0b188322b811a2322dca8b8c6a8506102a26167ba115d98be332'}
2015-08-18 11:12:05,717 oic.utils.authn.client:DEBUG Verified Client ID: bGQBXYKlCCGu
2015-08-18 11:12:05,720 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:12:05,722 oic.oic:DEBUG authzreq: {'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'nonce': 'RVJwkVR2jLjVoZDN', 'state': 'XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:05,723 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:12:05,724 oic.oic:DEBUG authzreq: {'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'nonce': 'RVJwkVR2jLjVoZDN', 'state': 'XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:05,725 oic.oic.provider:DEBUG id_token: {'aud': ['bGQBXYKlCCGu'], 'iat': 1439889125, 'auth_time': 1439889125, 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'sub': '410132ee6ef9c450', 'exp': 1439968325, 'nonce': 'RVJwkVR2jLjVoZDN'}
2015-08-18 11:12:05,728 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}, {"e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}]}
2015-08-18 11:12:05,729 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "x": "pFsgzpb-67Ro4XAm630Pca0ose6B2ohFvGKcNw5gDZA", "kid": "op2", "use": "sig", "kty": "EC", "y": "CN0I8IKsat4xIfIbZTi-kD38N5Fumtvn-s0WfL95XTc"}]}
2015-08-18 11:12:05,729 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "x": "B5J0Gy6VJoMyip9cHYRyPGKpy5Mr7CsbDcF26hsY5Sc", "kid": "op3", "use": "enc", "kty": "EC", "y": "vKFUjYoU2bxiAeMMSGcEYsew1XHAx6z2I74W76cO7Q8"}]}
2015-08-18 11:12:05,730 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057bef60>]
2015-08-18 11:12:05,737 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:12:05,738 oic.oic.provider:DEBUG _tinfo: {'permission': '', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f7e48>, 'revoked': False, 'access_token': 'qRvdgFB4BL/O40F+g/7EWSSBrsq+a7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuHvuGfc5TXuJPShoBK1+Xk/Au7Jm7dxzZNnFvV46lH54=', 'code': 'qRvdgFB4BL/O40F+g/7EWSSBrsq+a7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuQgSfky3g+W97CzHiC9Xau7TiSMGPO320P+l+vl+DroA=', 'oauth_state': 'token', 'authzreq': '{"client_id": "bGQBXYKlCCGu", "redirect_uri": "http://localhost:8666/authz_cb", "acr_values": "SAML", "response_type": "code", "scope": "openid profile email address phone", "upm_answer": "true", "nonce": "RVJwkVR2jLjVoZDN", "state": "XEqhAJlVFIsjVKTm"}', 'sub': '410132ee6ef9c450', 'state': 'XEqhAJlVFIsjVKTm', 'expires_in': 3600, 'access_token_scope': '?', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiBbImJHUUJYWUtsQ0NHdSJdLCAiaWF0IjogMTQzOTg4OTEyNSwgImF1dGhfdGltZSI6IDE0Mzk4ODkxMjUsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICI0MTAxMzJlZTZlZjljNDUwIiwgImV4cCI6IDE0Mzk5NjgzMjUsICJub25jZSI6ICJSVkp3a1ZSMmpMalZvWkROIn0.DwkVZ1ajrStNjY91rakemzqofgr4iTATYBBDodqEvx1o5M1D2ztp0A4OC9h2FLXqvRZZD66dz1uNZOrQRpjCK5kAFgZjMo67N0zOCUEsfED-D8EnlN-_k7fly0CwW1Lqcj3RK8runFduo_3JNajanOdnPYJnbAyLQngfRtYjDmpmpTQdeI1laHIcEvToncLIlRJEatpFwAaqSHfNUr2hATKOHVXFaltOCpNXdqsRa2fVQaX3tHp9bYc-TbRbTtiwgy_tQFy0ds3GsdPu_EEoEr9l4AKJP99ddad9XKJa6l5eAcBr2C1h83bQnZWcXdU5tVZDAWRM6ocqtdyKDj-_FA', 'token_type': 'Bearer', 'client_id': 'bGQBXYKlCCGu', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_expires_at': 1439889125, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'nonce': 'RVJwkVR2jLjVoZDN', 'code_used': True, 'refresh_token': 'qRvdgFB4BL/O40F+g/7EWSSBrsq+a7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuaB9/zW1Cn+OoWqplHgFOXuFUcX8R1ld/iZnEEXO3V1k='}
2015-08-18 11:12:05,738 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiBbImJHUUJYWUtsQ0NHdSJdLCAiaWF0IjogMTQzOTg4OTEyNSwgImF1dGhfdGltZSI6IDE0Mzk4ODkxMjUsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICI0MTAxMzJlZTZlZjljNDUwIiwgImV4cCI6IDE0Mzk5NjgzMjUsICJub25jZSI6ICJSVkp3a1ZSMmpMalZvWkROIn0.DwkVZ1ajrStNjY91rakemzqofgr4iTATYBBDodqEvx1o5M1D2ztp0A4OC9h2FLXqvRZZD66dz1uNZOrQRpjCK5kAFgZjMo67N0zOCUEsfED-D8EnlN-_k7fly0CwW1Lqcj3RK8runFduo_3JNajanOdnPYJnbAyLQngfRtYjDmpmpTQdeI1laHIcEvToncLIlRJEatpFwAaqSHfNUr2hATKOHVXFaltOCpNXdqsRa2fVQaX3tHp9bYc-TbRbTtiwgy_tQFy0ds3GsdPu_EEoEr9l4AKJP99ddad9XKJa6l5eAcBr2C1h83bQnZWcXdU5tVZDAWRM6ocqtdyKDj-_FA', 'refresh_token': 'qRvdgFB4BL/O40F+g/7EWSSBrsq+a7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuaB9/zW1Cn+OoWqplHgFOXuFUcX8R1ld/iZnEEXO3V1k=', 'access_token': 'qRvdgFB4BL/O40F+g/7EWSSBrsq+a7kAYGUm5pttVuKLrEcaM2OSc9Ij28vmfksuHvuGfc5TXuJPShoBK1+Xk/Au7Jm7dxzZNnFvV46lH54=', 'scope': 'openid profile email address phone', 'token_type': 'Bearer', 'state': 'XEqhAJlVFIsjVKTm'}
2015-08-18 11:12:05,763 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:12:09,106 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x105646710>
2015-08-18 11:13:28,117 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "enc", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "sig", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1"}]}
2015-08-18 11:13:28,118 root:INFO OC3 server keys: {"keys": [{"x": "eWg5DGl9uyi0XnCtzIm1gYmi-gANTFzRkbA5asTpuqs", "y": "fUgItNc2BbVr3SCwS9oSujytHyEAet-rKqIiBdwrYtk", "crv": "P-256", "use": "sig", "kty": "EC", "kid": "op2"}]}
2015-08-18 11:13:28,119 root:INFO OC3 server keys: {"keys": [{"x": "KZC98O7CgbVMjbeidcUP9Sgqa1VpQhNfMlbfnsd4DkU", "y": "nt-4Awy9vO8whpmApkJiUzBMb0w8hCulS8nH1nDiARE", "crv": "P-256", "use": "enc", "kty": "EC", "kid": "op3"}]}
2015-08-18 11:13:28,121 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:13:37,175 oicServer:INFO callback: <function webfinger at 0x1054d16a8>
2015-08-18 11:13:37,192 oicServer:INFO callback: <function op_info at 0x1054d12f0>
2015-08-18 11:13:37,193 root:INFO op_info
2015-08-18 11:13:37,193 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:13:37,195 oic.oic.provider:INFO provider_info_response: {'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'acr_values_supported': ['PASSWORD'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_signing_alg_values_supported': ['none', 'PS384', 'RS256', 'PS256', 'HS512', 'ES384', 'ES512', 'HS384', 'RS384', 'ES256', 'RS512', 'HS256', 'PS512'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_signing_alg_values_supported': ['none', 'PS384', 'RS256', 'PS256', 'HS512', 'ES384', 'ES512', 'HS384', 'RS384', 'ES256', 'RS512', 'HS256', 'PS512'], 'claims_parameter_supported': True, 'id_token_signing_alg_values_supported': ['none', 'PS384', 'RS256', 'PS256', 'HS512', 'ES384', 'ES512', 'HS384', 'RS384', 'ES256', 'RS512', 'HS256', 'PS512'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'require_request_uri_registration': True, 'version': '3.0', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['sub', 'profile', 'given_name', 'email_verified', 'phone_number', 'zoneinfo', 'nickname', 'updated_at', 'picture', 'gender', 'locale', 'middle_name', 'birthdate', 'preferred_username', 'email', 'website', 'phone_number_verified', 'name', 'family_name', 'address'], 'token_endpoint_auth_signing_alg_values_supported': ['PS384', 'RS256', 'PS256', 'HS512', 'ES384', 'ES512', 'HS384', 'RS384', 'ES256', 'RS512', 'HS256', 'PS512'], 'issuer': 'https://localhost:8092/', 'request_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'token_endpoint': 'https://localhost:8092/token', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'scopes_supported': ['email', 'profile', 'phone', 'offline_access', 'openid', 'address', 'openid']}
2015-08-18 11:13:37,261 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1056467f0>
2015-08-18 11:13:37,262 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"]}>>
2015-08-18 11:13:37,262 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:13:37,269 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'b66332b68544e890ead5ba8c7965e3915595d5eab0008ad82b3db7a6', 'client_id_issued_at': 1439885617, 'registration_client_uri': 'https://localhost:8092/registration?client_id=HRLjUYiXdWqy', 'client_secret_expires_at': 1439972017, 'registration_access_token': '2dXq7xXgyCOleE5BCgqjieFLaUZC6aZg', 'client_id': 'HRLjUYiXdWqy'}
2015-08-18 11:13:37,270 oic.utils.keyio:DEBUG loading keys for issuer: HRLjUYiXdWqy
2015-08-18 11:13:37,270 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:13:37,271 oic.oic.provider:DEBUG keys for HRLjUYiXdWqy: []
2015-08-18 11:13:37,273 oic.oic.provider:INFO Client info: {'client_secret': 'b66332b68544e890ead5ba8c7965e3915595d5eab0008ad82b3db7a6', 'client_id_issued_at': 1439885617, 'registration_client_uri': 'https://localhost:8092/registration?client_id=HRLjUYiXdWqy', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'application_type': 'web', 'client_secret_expires_at': 1439972017, 'contacts': ['ops@example.com'], 'registration_access_token': '2dXq7xXgyCOleE5BCgqjieFLaUZC6aZg', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'response_types': ['code'], 'client_id': 'HRLjUYiXdWqy'}
2015-08-18 11:13:37,273 oic.oic.provider:DEBUG registration_response: {'client_secret': 'b66332b68544e890ead5ba8c7965e3915595d5eab0008ad82b3db7a6', 'client_id_issued_at': 1439885617, 'registration_client_uri': 'https://localhost:8092/registration?client_id=HRLjUYiXdWqy', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret_expires_at': 1439972017, 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'registration_access_token': '2dXq7xXgyCOleE5BCgqjieFLaUZC6aZg', 'response_types': ['code'], 'client_id': 'HRLjUYiXdWqy'}
2015-08-18 11:13:37,289 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a3320>
2015-08-18 11:13:37,289 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&nonce=fheQsMHZN5WG9aJc&scope=openid+profile+email+address+phone&state=uGCXIA9Vs39Bwcl6&client_id=HRLjUYiXdWqy'
2015-08-18 11:13:37,290 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f6128>, <jwkest.jwk.RSAKey object at 0x1057bef98>, <jwkest.jwk.ECKey object at 0x1057c3358>]
2015-08-18 11:13:37,290 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'state': 'uGCXIA9Vs39Bwcl6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'fheQsMHZN5WG9aJc', 'response_type': 'code', 'client_id': 'HRLjUYiXdWqy', 'scope': 'openid profile email address phone'}
2015-08-18 11:13:37,293 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'state': 'uGCXIA9Vs39Bwcl6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'fheQsMHZN5WG9aJc', 'response_type': 'code', 'client_id': 'HRLjUYiXdWqy', 'scope': 'openid profile email address phone'}
2015-08-18 11:13:37,296 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:13:37,296 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:13:37,297 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:13:37,298 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:13:37,298 oic.utils.authn.user:INFO do_authentication argv: {'title': 'User log in', 'client_policy_title': 'Client Policy', 'logo_uri': '', 'tos_uri': '', 'login_title': 'Username', 'query': 'acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&nonce=fheQsMHZN5WG9aJc&scope=openid+profile+email+address+phone&state=uGCXIA9Vs39Bwcl6&client_id=HRLjUYiXdWqy', 'acr': ['SAML'], 'action': 'https://localhost:8092/verify', 'policy_uri': '', 'login': '', 'passwd_title': 'Password', 'password': '', 'submit_text': 'Submit'}
2015-08-18 11:13:37,318 oicServer:INFO callback: <function css at 0x1054a2620>
2015-08-18 11:13:42,375 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105745598>
2015-08-18 11:13:42,376 oic.utils.authn.user:DEBUG verify(query=acr_values%3DSAML%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26nonce%3DfheQsMHZN5WG9aJc%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3DuGCXIA9Vs39Bwcl6%26client_id%3DHRLjUYiXdWqy&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:13:42,376 oic.utils.authn.user:DEBUG dict: {'query': ['acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&nonce=fheQsMHZN5WG9aJc&scope=openid+profile+email+address+phone&state=uGCXIA9Vs39Bwcl6&client_id=HRLjUYiXdWqy'], 'acr_values': ["['SAML']"], 'form.commit': ['Submit'], 'password': ['krall'], 'login': ['diana']}
2015-08-18 11:13:42,377 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-18 11:13:42,379 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'state': ['uGCXIA9Vs39Bwcl6'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'upm_answer': 'true', 'nonce': ['fheQsMHZN5WG9aJc'], 'response_type': ['code'], 'client_id': ['HRLjUYiXdWqy'], 'scope': ['openid profile email address phone']}
2015-08-18 11:13:42,397 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a3320>
2015-08-18 11:13:42,397 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&state=uGCXIA9Vs39Bwcl6&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true&nonce=fheQsMHZN5WG9aJc&response_type=code&client_id=HRLjUYiXdWqy&scope=openid+profile+email+address+phone'
2015-08-18 11:13:42,398 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f6128>, <jwkest.jwk.RSAKey object at 0x1057bef98>, <jwkest.jwk.ECKey object at 0x1057c3358>]
2015-08-18 11:13:42,398 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'state': 'uGCXIA9Vs39Bwcl6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'fheQsMHZN5WG9aJc', 'response_type': 'code', 'client_id': 'HRLjUYiXdWqy', 'scope': 'openid profile email address phone'}
2015-08-18 11:13:42,400 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'state': 'uGCXIA9Vs39Bwcl6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'fheQsMHZN5WG9aJc', 'response_type': 'code', 'client_id': 'HRLjUYiXdWqy', 'scope': 'openid profile email address phone'}
2015-08-18 11:13:42,402 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:13:42,403 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:13:42,403 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:13:42,405 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:13:42,405 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:13:42,406 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'state', 'redirect_uri', 'upm_answer', 'nonce', 'response_type', 'client_id', 'scope']
2015-08-18 11:13:42,408 oic.utils.sdb:DEBUG uid2sid: {'diana': ['03107b6a20624e1c44c359a1387567b8c399c51aa3cc364497f3b0ee']}
2015-08-18 11:13:42,409 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:13:42,410 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:13:42,414 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=uGCXIA9Vs39Bwcl6&scope=openid+profile+email+address+phone&code=%2BLBV%2BLHWLpkrMkyGFrX%2BEqIqaz9BQUuwe5lTpr3WR%2Ff8FL%2Bs25Q3qOnyFF%2Fq%2BZLqroMiiHugP9HPX1t6%2BiIdqjMzGyK0hIDYzyVIbvgQ2L8%3D' (<class 'str'>)
2015-08-18 11:13:42,437 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054a33c8>
2015-08-18 11:13:42,438 oic.oic.provider:DEBUG - token -
2015-08-18 11:13:42,438 oic.oic.provider:INFO token_request: grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&key=eyJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAidXNlIjogInNpZyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIifQ%3D%3D&client_id=HRLjUYiXdWqy&client_secret=b66332b68544e890ead5ba8c7965e3915595d5eab0008ad82b3db7a6&code=%2BLBV%2BLHWLpkrMkyGFrX%2BEqIqaz9BQUuwe5lTpr3WR%2Ff8FL%2Bs25Q3qOnyFF%2Fq%2BZLqroMiiHugP9HPX1t6%2BiIdqjMzGyK0hIDYzyVIbvgQ2L8%3D
2015-08-18 11:13:42,439 oic.oic.provider:DEBUG AccessTokenRequest: {'client_secret': 'b66332b68544e890ead5ba8c7965e3915595d5eab0008ad82b3db7a6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'key': 'eyJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAidXNlIjogInNpZyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIifQ==', 'grant_type': 'authorization_code', 'code': '+LBV+LHWLpkrMkyGFrX+EqIqaz9BQUuwe5lTpr3WR/f8FL+s25Q3qOnyFF/q+ZLqroMiiHugP9HPX1t6+iIdqjMzGyK0hIDYzyVIbvgQ2L8=', 'client_id': 'HRLjUYiXdWqy'}
2015-08-18 11:13:42,439 oic.utils.authn.client:DEBUG REQ: {'client_secret': 'b66332b68544e890ead5ba8c7965e3915595d5eab0008ad82b3db7a6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'key': 'eyJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAidXNlIjogInNpZyIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIifQ==', 'grant_type': 'authorization_code', 'code': '+LBV+LHWLpkrMkyGFrX+EqIqaz9BQUuwe5lTpr3WR/f8FL+s25Q3qOnyFF/q+ZLqroMiiHugP9HPX1t6+iIdqjMzGyK0hIDYzyVIbvgQ2L8=', 'client_id': 'HRLjUYiXdWqy'}
2015-08-18 11:13:42,442 oic.utils.authn.client:DEBUG Verified Client ID: HRLjUYiXdWqy
2015-08-18 11:13:42,448 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:13:42,449 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'state': 'uGCXIA9Vs39Bwcl6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'fheQsMHZN5WG9aJc', 'response_type': 'code', 'client_id': 'HRLjUYiXdWqy', 'scope': 'openid profile email address phone'}
2015-08-18 11:13:42,450 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:13:42,450 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'state': 'uGCXIA9Vs39Bwcl6', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'fheQsMHZN5WG9aJc', 'response_type': 'code', 'client_id': 'HRLjUYiXdWqy', 'scope': 'openid profile email address phone'}
2015-08-18 11:13:42,451 oic.oic.provider:DEBUG id_token: {'iat': 1439889222, 'exp': 1439968422, 'sub': '5fd24b0d8c2bd5c7', 'acr': 'PASSWORD', 'nonce': 'fheQsMHZN5WG9aJc', 'aud': ['HRLjUYiXdWqy'], 'iss': 'https://localhost:8092/', 'auth_time': 1439889222}
2015-08-18 11:13:42,453 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "enc", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "sig", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1"}]}
2015-08-18 11:13:42,453 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "eWg5DGl9uyi0XnCtzIm1gYmi-gANTFzRkbA5asTpuqs", "y": "fUgItNc2BbVr3SCwS9oSujytHyEAet-rKqIiBdwrYtk", "crv": "P-256", "use": "sig", "kty": "EC", "kid": "op2"}]}
2015-08-18 11:13:42,454 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "KZC98O7CgbVMjbeidcUP9Sgqa1VpQhNfMlbfnsd4DkU", "y": "nt-4Awy9vO8whpmApkJiUzBMb0w8hCulS8nH1nDiARE", "crv": "P-256", "use": "enc", "kty": "EC", "kid": "op3"}]}
2015-08-18 11:13:42,454 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057bef98>]
2015-08-18 11:13:42,463 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:13:42,463 oic.oic.provider:DEBUG _tinfo: {'state': 'uGCXIA9Vs39Bwcl6', 'sub': '5fd24b0d8c2bd5c7', 'refresh_token': '+LBV+LHWLpkrMkyGFrX+EqIqaz9BQUuwe5lTpr3WR/f8FL+s25Q3qOnyFF/q+ZLqa3sPQ289ND+9M5JSuVNyBWhuYzUFNVIgyu/HTTZ41Gs=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'authzreq': '{"acr_values": "SAML", "state": "uGCXIA9Vs39Bwcl6", "redirect_uri": "http://localhost:8666/authz_cb", "upm_answer": "true", "nonce": "fheQsMHZN5WG9aJc", "response_type": "code", "client_id": "HRLjUYiXdWqy", "scope": "openid profile email address phone"}', 'nonce': 'fheQsMHZN5WG9aJc', 'access_token': '+LBV+LHWLpkrMkyGFrX+EqIqaz9BQUuwe5lTpr3WR/f8FL+s25Q3qOnyFF/q+ZLqdBwtdHGhJTuIOKO9KYEVru27SqGl6ZfNH5m9pLZUWCg=', 'code': '+LBV+LHWLpkrMkyGFrX+EqIqaz9BQUuwe5lTpr3WR/f8FL+s25Q3qOnyFF/q+ZLqroMiiHugP9HPX1t6+iIdqjMzGyK0hIDYzyVIbvgQ2L8=', 'client_id': 'HRLjUYiXdWqy', 'token_expires_at': 1439889222, 'revoked': False, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5ODg5MjIyLCAiZXhwIjogMTQzOTk2ODQyMiwgInN1YiI6ICI1ZmQyNGIwZDhjMmJkNWM3IiwgImFjciI6ICJQQVNTV09SRCIsICJub25jZSI6ICJmaGVRc01IWk41V0c5YUpjIiwgImF1ZCI6IFsiSFJMalVZaVhkV3F5Il0sICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXV0aF90aW1lIjogMTQzOTg4OTIyMn0.o3n2rsRs8Luo6mZ9yNO2hE9TSJ4friCVbaq1c2MdJepC1QpbUKe_MyTQuW8KdIEUt43EJB5MMp9kW4m6jLNSXrHhmUjlAzBpVj9dqOa9e-7eKO4BVoWU0oL2k0G01LX9-n1t1PGPooqg26jwcoHni1Zeto1JqT3GjiKnXm0L8hEb5BajuMKmasdzFchu3aYxEr_4pJRbMXDO6L7GBBcpTbjBOGtHEI_Sh8HarpmQKUro7WfF7QHJSjivouaXsO0SbEj-8wUhxCWdFxpPxPiRBZXSoVT_CinieeBXOfMtHNHmFKhof5mZDE8836a1qtqcvdSfqQaf0QhZHw0n9Dp7Zg', 'expires_in': 3600, 'access_token_scope': '?', 'permission': '', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f6e80>, 'token_type': 'Bearer', 'code_used': True, 'oauth_state': 'token'}
2015-08-18 11:13:42,464 oic.oic.provider:DEBUG access_token_response: {'state': 'uGCXIA9Vs39Bwcl6', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'access_token': '+LBV+LHWLpkrMkyGFrX+EqIqaz9BQUuwe5lTpr3WR/f8FL+s25Q3qOnyFF/q+ZLqdBwtdHGhJTuIOKO9KYEVru27SqGl6ZfNH5m9pLZUWCg=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5ODg5MjIyLCAiZXhwIjogMTQzOTk2ODQyMiwgInN1YiI6ICI1ZmQyNGIwZDhjMmJkNWM3IiwgImFjciI6ICJQQVNTV09SRCIsICJub25jZSI6ICJmaGVRc01IWk41V0c5YUpjIiwgImF1ZCI6IFsiSFJMalVZaVhkV3F5Il0sICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXV0aF90aW1lIjogMTQzOTg4OTIyMn0.o3n2rsRs8Luo6mZ9yNO2hE9TSJ4friCVbaq1c2MdJepC1QpbUKe_MyTQuW8KdIEUt43EJB5MMp9kW4m6jLNSXrHhmUjlAzBpVj9dqOa9e-7eKO4BVoWU0oL2k0G01LX9-n1t1PGPooqg26jwcoHni1Zeto1JqT3GjiKnXm0L8hEb5BajuMKmasdzFchu3aYxEr_4pJRbMXDO6L7GBBcpTbjBOGtHEI_Sh8HarpmQKUro7WfF7QHJSjivouaXsO0SbEj-8wUhxCWdFxpPxPiRBZXSoVT_CinieeBXOfMtHNHmFKhof5mZDE8836a1qtqcvdSfqQaf0QhZHw0n9Dp7Zg', 'token_type': 'Bearer', 'refresh_token': '+LBV+LHWLpkrMkyGFrX+EqIqaz9BQUuwe5lTpr3WR/f8FL+s25Q3qOnyFF/q+ZLqa3sPQ289ND+9M5JSuVNyBWhuYzUFNVIgyu/HTTZ41Gs='}
2015-08-18 11:13:42,485 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:13:45,727 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x105646748>
2015-08-18 11:15:33,124 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 11:15:33,125 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "crv": "P-256", "use": "sig", "x": "woncFgfVfpW6vwjwfqaZau-bByzr_y4gZYoQPD4ByYI", "y": "2leiPL6LozXMmNOZuohrh3HNHnbc5trRiS8_aJq-HsQ", "kty": "EC"}]}
2015-08-18 11:15:33,125 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "crv": "P-256", "use": "enc", "x": "stnfv-slVJ5Hb_NZDjllxWjuO0WoNIr2t4y7UxPTzVY", "y": "kS6_c4gcvT1S9tXf6LsV7V1qHBV6GV7EewvzKdHM-8A", "kty": "EC"}]}
2015-08-18 11:15:33,126 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:15:33,499 oicServer:INFO callback: <function webfinger at 0x1054d26a8>
2015-08-18 11:15:33,520 oicServer:INFO callback: <function op_info at 0x1054d22f0>
2015-08-18 11:15:33,521 root:INFO op_info
2015-08-18 11:15:33,522 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:15:33,523 oic.oic.provider:INFO provider_info_response: {'claims_supported': ['address', 'birthdate', 'given_name', 'website', 'updated_at', 'family_name', 'sub', 'profile', 'zoneinfo', 'email', 'locale', 'phone_number_verified', 'preferred_username', 'nickname', 'name', 'picture', 'middle_name', 'phone_number', 'gender', 'email_verified'], 'request_object_signing_alg_values_supported': ['HS512', 'ES384', 'PS512', 'PS256', 'RS512', 'HS384', 'ES256', 'ES512', 'HS256', 'PS384', 'RS384', 'none', 'RS256'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_signing_alg_values_supported': ['HS512', 'ES384', 'PS512', 'PS256', 'RS512', 'HS384', 'ES256', 'ES512', 'HS256', 'PS384', 'RS384', 'RS256'], 'issuer': 'https://localhost:8092/', 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'userinfo_signing_alg_values_supported': ['HS512', 'ES384', 'PS512', 'PS256', 'RS512', 'HS384', 'ES256', 'ES512', 'HS256', 'PS384', 'RS384', 'none', 'RS256'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'token_endpoint': 'https://localhost:8092/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'subject_types_supported': ['public', 'pairwise'], 'registration_endpoint': 'https://localhost:8092/registration', 'scopes_supported': ['address', 'openid', 'profile', 'phone', 'email', 'offline_access', 'openid'], 'request_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['HS512', 'ES384', 'PS512', 'PS256', 'RS512', 'HS384', 'ES256', 'ES512', 'HS256', 'PS384', 'RS384', 'none', 'RS256'], 'request_uri_parameter_supported': True, 'version': '3.0'}
2015-08-18 11:15:33,591 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105646828>
2015-08-18 11:15:33,592 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "contacts": ["ops@example.com"]}>>
2015-08-18 11:15:33,592 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:15:33,599 oic.oic.provider:DEBUG _cinfo: {'registration_client_uri': 'https://localhost:8092/registration?client_id=VHBK7ZydUQIJ', 'client_id_issued_at': 1439885733, 'registration_access_token': 'XAVEoRoMRUzC0I1p4lsNzDjJLYs3k7u4', 'client_secret': '098b0632ed16152a897358c1ae03e1e8dd8c085409192241d570c95d', 'client_secret_expires_at': 1439972133, 'client_id': 'VHBK7ZydUQIJ'}
2015-08-18 11:15:33,600 oic.utils.keyio:DEBUG loading keys for issuer: VHBK7ZydUQIJ
2015-08-18 11:15:33,601 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:15:33,601 oic.oic.provider:DEBUG keys for VHBK7ZydUQIJ: []
2015-08-18 11:15:33,603 oic.oic.provider:INFO Client info: {'registration_client_uri': 'https://localhost:8092/registration?client_id=VHBK7ZydUQIJ', 'application_type': 'web', 'response_types': ['code'], 'client_id_issued_at': 1439885733, 'registration_access_token': 'XAVEoRoMRUzC0I1p4lsNzDjJLYs3k7u4', 'contacts': ['ops@example.com'], 'client_secret': '098b0632ed16152a897358c1ae03e1e8dd8c085409192241d570c95d', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_secret_expires_at': 1439972133, 'client_id': 'VHBK7ZydUQIJ', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)]}
2015-08-18 11:15:33,603 oic.oic.provider:DEBUG registration_response: {'registration_client_uri': 'https://localhost:8092/registration?client_id=VHBK7ZydUQIJ', 'application_type': 'web', 'response_types': ['code'], 'client_id_issued_at': 1439885733, 'registration_access_token': 'XAVEoRoMRUzC0I1p4lsNzDjJLYs3k7u4', 'contacts': ['ops@example.com'], 'client_secret': '098b0632ed16152a897358c1ae03e1e8dd8c085409192241d570c95d', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret_expires_at': 1439972133, 'client_id': 'VHBK7ZydUQIJ', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:15:33,618 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a5358>
2015-08-18 11:15:33,619 oic.oauth2.provider:DEBUG Request: 'nonce=CBfPAzaXsXsvz3K7&acr_values=SAML&state=VgyOTqml4JJo5q7I&client_id=VHBK7ZydUQIJ&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'
2015-08-18 11:15:33,620 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f8160>, <jwkest.jwk.RSAKey object at 0x1057befd0>, <jwkest.jwk.ECKey object at 0x1057c3438>]
2015-08-18 11:15:33,620 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'CBfPAzaXsXsvz3K7', 'state': 'VgyOTqml4JJo5q7I', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'VHBK7ZydUQIJ', 'acr_values': 'SAML'}
2015-08-18 11:15:33,622 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'CBfPAzaXsXsvz3K7', 'state': 'VgyOTqml4JJo5q7I', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'VHBK7ZydUQIJ', 'acr_values': 'SAML'}
2015-08-18 11:15:33,626 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:15:33,626 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:15:33,626 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:15:33,627 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:15:33,628 oic.utils.authn.user:INFO do_authentication argv: {'client_policy_title': 'Client Policy', 'tos_uri': '', 'password': '', 'passwd_title': 'Password', 'logo_uri': '', 'action': 'https://localhost:8092/verify', 'query': 'nonce=CBfPAzaXsXsvz3K7&acr_values=SAML&state=VgyOTqml4JJo5q7I&client_id=VHBK7ZydUQIJ&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code', 'login_title': 'Username', 'title': 'User log in', 'policy_uri': '', 'submit_text': 'Submit', 'login': '', 'acr': ['SAML']}
2015-08-18 11:15:33,647 oicServer:INFO callback: <function css at 0x1054a3620>
2015-08-18 11:15:37,323 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105746598>
2015-08-18 11:15:37,324 oic.utils.authn.user:DEBUG verify(query=nonce%3DCBfPAzaXsXsvz3K7%26acr_values%3DSAML%26state%3DVgyOTqml4JJo5q7I%26client_id%3DVHBK7ZydUQIJ%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:15:37,325 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'password': ['krall'], 'query': ['nonce=CBfPAzaXsXsvz3K7&acr_values=SAML&state=VgyOTqml4JJo5q7I&client_id=VHBK7ZydUQIJ&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'], 'acr_values': ["['SAML']"], 'login': ['diana']}
2015-08-18 11:15:37,325 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-18 11:15:37,327 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['CBfPAzaXsXsvz3K7'], 'upm_answer': 'true', 'scope': ['openid profile email address phone'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'response_type': ['code'], 'client_id': ['VHBK7ZydUQIJ'], 'state': ['VgyOTqml4JJo5q7I'], 'acr_values': ['SAML']}
2015-08-18 11:15:37,346 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a5358>
2015-08-18 11:15:37,346 oic.oauth2.provider:DEBUG Request: 'nonce=CBfPAzaXsXsvz3K7&upm_answer=true&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=VHBK7ZydUQIJ&state=VgyOTqml4JJo5q7I&acr_values=SAML'
2015-08-18 11:15:37,347 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f8160>, <jwkest.jwk.RSAKey object at 0x1057befd0>, <jwkest.jwk.ECKey object at 0x1057c3438>]
2015-08-18 11:15:37,348 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'CBfPAzaXsXsvz3K7', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'VHBK7ZydUQIJ', 'state': 'VgyOTqml4JJo5q7I', 'acr_values': 'SAML'}
2015-08-18 11:15:37,351 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'CBfPAzaXsXsvz3K7', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'VHBK7ZydUQIJ', 'state': 'VgyOTqml4JJo5q7I', 'acr_values': 'SAML'}
2015-08-18 11:15:37,354 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:15:37,355 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:15:37,355 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:15:37,357 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:15:37,357 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:15:37,358 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'upm_answer', 'scope', 'redirect_uri', 'response_type', 'client_id', 'state', 'acr_values']
2015-08-18 11:15:37,360 oic.utils.sdb:DEBUG uid2sid: {'diana': ['f8c67e70a2ac269825bd978de2e5b49b07addb674be30f8565982ead']}
2015-08-18 11:15:37,360 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:15:37,360 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:15:37,363 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=VgyOTqml4JJo5q7I&scope=openid+profile+email+address+phone&code=tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi%2BuLvXk2fLI%2Bdqo%2FrMsNgKVazEPGxI1Zm6fQQLQtBMpUwngMqlNtaMKGRFISY0tos%3D' (<class 'str'>)
2015-08-18 11:16:32,557 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054a5400>
2015-08-18 11:16:32,558 oic.oic.provider:DEBUG - token -
2015-08-18 11:16:32,559 oic.oic.provider:INFO token_request: grant_type=authorization_code&key=eyJlIjogIkFRQUIiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImtpZCI6ICJhMCIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImt0eSI6ICJSU0EifQ%3D%3D&client_secret=098b0632ed16152a897358c1ae03e1e8dd8c085409192241d570c95d&client_id=VHBK7ZydUQIJ&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi%2BuLvXk2fLI%2Bdqo%2FrMsNgKVazEPGxI1Zm6fQQLQtBMpUwngMqlNtaMKGRFISY0tos%3D
2015-08-18 11:16:32,559 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'key': 'eyJlIjogIkFRQUIiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImtpZCI6ICJhMCIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImt0eSI6ICJSU0EifQ==', 'code': 'tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi+uLvXk2fLI+dqo/rMsNgKVazEPGxI1Zm6fQQLQtBMpUwngMqlNtaMKGRFISY0tos=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '098b0632ed16152a897358c1ae03e1e8dd8c085409192241d570c95d', 'client_id': 'VHBK7ZydUQIJ'}
2015-08-18 11:16:32,560 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'key': 'eyJlIjogIkFRQUIiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImtpZCI6ICJhMCIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImt0eSI6ICJSU0EifQ==', 'code': 'tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi+uLvXk2fLI+dqo/rMsNgKVazEPGxI1Zm6fQQLQtBMpUwngMqlNtaMKGRFISY0tos=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '098b0632ed16152a897358c1ae03e1e8dd8c085409192241d570c95d', 'client_id': 'VHBK7ZydUQIJ'}
2015-08-18 11:16:32,561 oic.utils.authn.client:DEBUG Verified Client ID: VHBK7ZydUQIJ
2015-08-18 11:16:32,564 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:16:32,566 oic.oic:DEBUG authzreq: {'nonce': 'CBfPAzaXsXsvz3K7', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'VHBK7ZydUQIJ', 'state': 'VgyOTqml4JJo5q7I', 'acr_values': 'SAML'}
2015-08-18 11:16:32,566 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:16:32,567 oic.oic:DEBUG authzreq: {'nonce': 'CBfPAzaXsXsvz3K7', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'VHBK7ZydUQIJ', 'state': 'VgyOTqml4JJo5q7I', 'acr_values': 'SAML'}
2015-08-18 11:16:32,567 oic.oic.provider:DEBUG id_token: {'iat': 1439889392, 'exp': 1439968592, 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'auth_time': 1439889337, 'sub': '2e2b343790126bff', 'aud': ['VHBK7ZydUQIJ'], 'nonce': 'CBfPAzaXsXsvz3K7'}
2015-08-18 11:16:32,569 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 11:16:32,570 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op2", "crv": "P-256", "use": "sig", "x": "woncFgfVfpW6vwjwfqaZau-bByzr_y4gZYoQPD4ByYI", "y": "2leiPL6LozXMmNOZuohrh3HNHnbc5trRiS8_aJq-HsQ", "kty": "EC"}]}
2015-08-18 11:16:32,571 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op3", "crv": "P-256", "use": "enc", "x": "stnfv-slVJ5Hb_NZDjllxWjuO0WoNIr2t4y7UxPTzVY", "y": "kS6_c4gcvT1S9tXf6LsV7V1qHBV6GV7EewvzKdHM-8A", "kty": "EC"}]}
2015-08-18 11:16:32,571 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057befd0>]
2015-08-18 11:16:32,579 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:16:32,579 oic.oic.provider:DEBUG _tinfo: {'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5ODg5MzkyLCAiZXhwIjogMTQzOTk2ODU5MiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQzOTg4OTMzNywgInN1YiI6ICIyZTJiMzQzNzkwMTI2YmZmIiwgImF1ZCI6IFsiVkhCSzdaeWRVUUlKIl0sICJub25jZSI6ICJDQmZQQXphWHNYc3Z6M0s3In0.w6ggiaflGznlR0nPkqmohv6xQIVkjivb7SdSJkCvkUZbdNDlGLXZqLfmIQxyOPjlcmnO8HVmrvWnLlWIN8ViIeGFu3mjIX6lEEpn3Y12OULPj79vB8GQueA6yJMFNA1Wp9HYAeaTy-ENUaQB8D99mcGUmQy7bvdwBKFXFFUDA2vWWO2VLVYwsZEZW4eL-rF6Z3krY6ccmnzcPreMzCSHhoQ_-J4YYF73mUErAuSerU5W1pZAux9yMwQQ1aF9D7GFDEfPEzlsAuAx4rbbzQHrpm27e7KnBqOg8Rqt3bdU2EYzJEXjgfOtSev5cvJtCkCB0aNL1HEi7oEjctwe-rvKDg', 'nonce': 'CBfPAzaXsXsvz3K7', 'state': 'VgyOTqml4JJo5q7I', 'revoked': False, 'expires_in': 3600, 'authzreq': '{"nonce": "CBfPAzaXsXsvz3K7", "upm_answer": "true", "scope": "openid profile email address phone", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "VHBK7ZydUQIJ", "state": "VgyOTqml4JJo5q7I", "acr_values": "SAML"}', 'code_used': True, 'access_token': 'tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi+uLvXk2fLI+dqo/rMsNgKYzKiFDOmttaZDrzqPWPlOAzc4DntXA6/SwKxDWFN80s=', 'sub': '2e2b343790126bff', 'code': 'tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi+uLvXk2fLI+dqo/rMsNgKVazEPGxI1Zm6fQQLQtBMpUwngMqlNtaMKGRFISY0tos=', 'client_id': 'VHBK7ZydUQIJ', 'token_type': 'Bearer', 'permission': '', 'refresh_token': 'tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi+uLvXk2fLI+dqo/rMsNgKmeWxKnKLCzJXbeev8nQF3buWhWZ/Awvhye1e1PzIToM=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_expires_at': 1439889392, 'oauth_state': 'token', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token_scope': '?', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f8eb8>}
2015-08-18 11:16:32,580 oic.oic.provider:DEBUG access_token_response: {'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5ODg5MzkyLCAiZXhwIjogMTQzOTk2ODU5MiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQzOTg4OTMzNywgInN1YiI6ICIyZTJiMzQzNzkwMTI2YmZmIiwgImF1ZCI6IFsiVkhCSzdaeWRVUUlKIl0sICJub25jZSI6ICJDQmZQQXphWHNYc3Z6M0s3In0.w6ggiaflGznlR0nPkqmohv6xQIVkjivb7SdSJkCvkUZbdNDlGLXZqLfmIQxyOPjlcmnO8HVmrvWnLlWIN8ViIeGFu3mjIX6lEEpn3Y12OULPj79vB8GQueA6yJMFNA1Wp9HYAeaTy-ENUaQB8D99mcGUmQy7bvdwBKFXFFUDA2vWWO2VLVYwsZEZW4eL-rF6Z3krY6ccmnzcPreMzCSHhoQ_-J4YYF73mUErAuSerU5W1pZAux9yMwQQ1aF9D7GFDEfPEzlsAuAx4rbbzQHrpm27e7KnBqOg8Rqt3bdU2EYzJEXjgfOtSev5cvJtCkCB0aNL1HEi7oEjctwe-rvKDg', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'access_token': 'tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi+uLvXk2fLI+dqo/rMsNgKYzKiFDOmttaZDrzqPWPlOAzc4DntXA6/SwKxDWFN80s=', 'state': 'VgyOTqml4JJo5q7I', 'token_type': 'Bearer', 'refresh_token': 'tLfxKDQSY2DcVpw3Icj0LRt1QBq1lNJb5dmfCL4K9Wi+uLvXk2fLI+dqo/rMsNgKmeWxKnKLCzJXbeev8nQF3buWhWZ/Awvhye1e1PzIToM='}
2015-08-18 11:16:32,599 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:17:14,301 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"e": "AQAB", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-18 11:17:14,302 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "y": "97RAF1zJk5NqDbZJpeHs3SrRhOCSNcF1Uwg6Hval35Y", "x": "S32EvNJ2Eh4zm9Z8mZWH1zW1oLPGBuKErC7QLVltb70", "kty": "EC", "use": "sig", "kid": "op2"}]}
2015-08-18 11:17:14,302 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "y": "WaP1Q2RrTSet65AuW2Ukc_CwcuVMhu5EDdsM24LSn8s", "x": "mKhlRaOIaQvuVU_2IW6O9CAMiwu5ZcIcwePsE7oZwmg", "kty": "EC", "use": "enc", "kid": "op3"}]}
2015-08-18 11:17:14,303 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:17:16,082 oicServer:INFO callback: <function webfinger at 0x1054ed6a8>
2015-08-18 11:17:16,104 oicServer:INFO callback: <function op_info at 0x1054ed2f0>
2015-08-18 11:17:16,104 root:INFO op_info
2015-08-18 11:17:16,104 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:17:16,105 oic.oic.provider:INFO provider_info_response: {'claims_supported': ['phone_number', 'locale', 'updated_at', 'sub', 'zoneinfo', 'email', 'website', 'name', 'middle_name', 'address', 'gender', 'birthdate', 'email_verified', 'preferred_username', 'nickname', 'picture', 'family_name', 'phone_number_verified', 'given_name', 'profile'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'issuer': 'https://localhost:8092/', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'require_request_uri_registration': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'version': '3.0', 'request_uri_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'id_token_signing_alg_values_supported': ['HS384', 'RS256', 'RS384', 'PS512', 'HS256', 'ES384', 'PS384', 'PS256', 'RS512', 'ES256', 'none', 'ES512', 'HS512'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'subject_types_supported': ['public', 'pairwise'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_signing_alg_values_supported': ['HS384', 'RS256', 'RS384', 'PS512', 'HS256', 'ES384', 'PS384', 'PS256', 'RS512', 'ES256', 'none', 'ES512', 'HS512'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'RS256', 'RS384', 'PS512', 'HS256', 'ES384', 'PS384', 'PS256', 'RS512', 'ES256', 'ES512', 'HS512'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'scopes_supported': ['address', 'phone', 'offline_access', 'email', 'openid', 'profile', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'claims_parameter_supported': True, 'request_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_signing_alg_values_supported': ['HS384', 'RS256', 'RS384', 'PS512', 'HS256', 'ES384', 'PS384', 'PS256', 'RS512', 'ES256', 'none', 'ES512', 'HS512']}
2015-08-18 11:17:16,176 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105646860>
2015-08-18 11:17:16,177 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "response_types": ["code"], "redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 11:17:16,177 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:17:16,184 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'e004922c11c36d362b79f687724ee9b11552bb5ff046cc1468bd60f4', 'client_id': 'ft4gRcrzE9nr', 'registration_client_uri': 'https://localhost:8092/registration?client_id=ft4gRcrzE9nr', 'registration_access_token': 'oY04qBvka3QAEg2bXeLRaMbFkI0tSbZa', 'client_secret_expires_at': 1439972236, 'client_id_issued_at': 1439885836}
2015-08-18 11:17:16,185 oic.utils.keyio:DEBUG loading keys for issuer: ft4gRcrzE9nr
2015-08-18 11:17:16,186 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:17:16,186 oic.oic.provider:DEBUG keys for ft4gRcrzE9nr: []
2015-08-18 11:17:16,188 oic.oic.provider:INFO Client info: {'application_type': 'web', 'response_types': ['code'], 'client_secret': 'e004922c11c36d362b79f687724ee9b11552bb5ff046cc1468bd60f4', 'client_id': 'ft4gRcrzE9nr', 'registration_client_uri': 'https://localhost:8092/registration?client_id=ft4gRcrzE9nr', 'registration_access_token': 'oY04qBvka3QAEg2bXeLRaMbFkI0tSbZa', 'client_secret_expires_at': 1439972236, 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1439885836, 'contacts': ['ops@example.com']}
2015-08-18 11:17:16,188 oic.oic.provider:DEBUG registration_response: {'application_type': 'web', 'response_types': ['code'], 'client_secret': 'e004922c11c36d362b79f687724ee9b11552bb5ff046cc1468bd60f4', 'client_id': 'ft4gRcrzE9nr', 'registration_client_uri': 'https://localhost:8092/registration?client_id=ft4gRcrzE9nr', 'registration_access_token': 'oY04qBvka3QAEg2bXeLRaMbFkI0tSbZa', 'client_secret_expires_at': 1439972236, 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_id_issued_at': 1439885836, 'contacts': ['ops@example.com']}
2015-08-18 11:17:16,204 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054bf390>
2015-08-18 11:17:16,205 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&nonce=1LFreGzItQfmwLlE&acr_values=SAML&response_type=code&client_id=ft4gRcrzE9nr&state=8gk4TIhT7urPcPC2&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 11:17:16,205 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f8198>, <jwkest.jwk.RSAKey object at 0x1057c3048>, <jwkest.jwk.ECKey object at 0x1057c3400>]
2015-08-18 11:17:16,206 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'state': '8gk4TIhT7urPcPC2', 'scope': 'openid profile email address phone', 'client_id': 'ft4gRcrzE9nr', 'nonce': '1LFreGzItQfmwLlE', 'acr_values': 'SAML', 'response_type': 'code'}
2015-08-18 11:17:16,208 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'http://localhost:8666/authz_cb', 'state': '8gk4TIhT7urPcPC2', 'scope': 'openid profile email address phone', 'client_id': 'ft4gRcrzE9nr', 'nonce': '1LFreGzItQfmwLlE', 'acr_values': 'SAML', 'response_type': 'code'}
2015-08-18 11:17:16,210 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:17:16,210 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:17:16,211 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:17:16,212 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:17:16,212 oic.utils.authn.user:INFO do_authentication argv: {'login': '', 'title': 'User log in', 'query': 'scope=openid+profile+email+address+phone&nonce=1LFreGzItQfmwLlE&acr_values=SAML&response_type=code&client_id=ft4gRcrzE9nr&state=8gk4TIhT7urPcPC2&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'logo_uri': '', 'password': '', 'acr': ['SAML'], 'submit_text': 'Submit', 'client_policy_title': 'Client Policy', 'login_title': 'Username', 'passwd_title': 'Password', 'action': 'https://localhost:8092/verify', 'tos_uri': '', 'policy_uri': ''}
2015-08-18 11:17:16,231 oicServer:INFO callback: <function css at 0x1054be620>
2015-08-18 11:17:19,894 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105747598>
2015-08-18 11:17:19,894 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26nonce%3D1LFreGzItQfmwLlE%26acr_values%3DSAML%26response_type%3Dcode%26client_id%3Dft4gRcrzE9nr%26state%3D8gk4TIhT7urPcPC2%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:17:19,895 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'acr_values': ["['SAML']"], 'query': ['scope=openid+profile+email+address+phone&nonce=1LFreGzItQfmwLlE&acr_values=SAML&response_type=code&client_id=ft4gRcrzE9nr&state=8gk4TIhT7urPcPC2&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'], 'form.commit': ['Submit'], 'password': ['krall']}
2015-08-18 11:17:19,895 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 11:17:19,898 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['http://localhost:8666/authz_cb'], 'state': ['8gk4TIhT7urPcPC2'], 'acr_values': ['SAML'], 'client_id': ['ft4gRcrzE9nr'], 'nonce': ['1LFreGzItQfmwLlE'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true', 'response_type': ['code']}
2015-08-18 11:17:19,916 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054bf390>
2015-08-18 11:17:19,916 oic.oauth2.provider:DEBUG Request: 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=8gk4TIhT7urPcPC2&acr_values=SAML&client_id=ft4gRcrzE9nr&nonce=1LFreGzItQfmwLlE&scope=openid+profile+email+address+phone&upm_answer=true&response_type=code'
2015-08-18 11:17:19,917 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f8198>, <jwkest.jwk.RSAKey object at 0x1057c3048>, <jwkest.jwk.ECKey object at 0x1057c3400>]
2015-08-18 11:17:19,917 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'state': '8gk4TIhT7urPcPC2', 'scope': 'openid profile email address phone', 'client_id': 'ft4gRcrzE9nr', 'nonce': '1LFreGzItQfmwLlE', 'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code'}
2015-08-18 11:17:19,919 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'http://localhost:8666/authz_cb', 'state': '8gk4TIhT7urPcPC2', 'scope': 'openid profile email address phone', 'client_id': 'ft4gRcrzE9nr', 'nonce': '1LFreGzItQfmwLlE', 'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code'}
2015-08-18 11:17:19,923 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:17:19,923 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:17:19,924 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:17:19,925 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:17:19,925 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:17:19,926 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'state', 'acr_values', 'client_id', 'nonce', 'scope', 'upm_answer', 'response_type']
2015-08-18 11:17:19,927 oic.utils.sdb:DEBUG uid2sid: {'diana': ['39bba6a78fd744be206092ffb2c721eabc4a84d224493e2a261c06bc']}
2015-08-18 11:17:19,927 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:17:19,928 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:17:19,932 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=8gk4TIhT7urPcPC2&scope=openid+profile+email+address+phone&code=8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW%2FIh2kWmb8dieEsx5uwIZL9CFvlUPQKc88ay55Qo%2BzYx8%3D' (<class 'str'>)
2015-08-18 11:17:22,522 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054bf438>
2015-08-18 11:17:46,152 oic.oic.provider:DEBUG - token -
2015-08-18 11:17:46,153 oic.oic.provider:INFO token_request: key=eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImt0eSI6ICJSU0EiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJlIjogIkFRQUIiLCAia2lkIjogImEwIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ%3D%3D&client_id=ft4gRcrzE9nr&client_secret=e004922c11c36d362b79f687724ee9b11552bb5ff046cc1468bd60f4&code=8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW%2FIh2kWmb8dieEsx5uwIZL9CFvlUPQKc88ay55Qo%2BzYx8%3D&grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-18 11:17:46,154 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': 'e004922c11c36d362b79f687724ee9b11552bb5ff046cc1468bd60f4', 'client_id': 'ft4gRcrzE9nr', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImt0eSI6ICJSU0EiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJlIjogIkFRQUIiLCAia2lkIjogImEwIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'grant_type': 'authorization_code', 'code': '8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW/Ih2kWmb8dieEsx5uwIZL9CFvlUPQKc88ay55Qo+zYx8='}
2015-08-18 11:17:46,154 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': 'e004922c11c36d362b79f687724ee9b11552bb5ff046cc1468bd60f4', 'client_id': 'ft4gRcrzE9nr', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImt0eSI6ICJSU0EiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJlIjogIkFRQUIiLCAia2lkIjogImEwIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'grant_type': 'authorization_code', 'code': '8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW/Ih2kWmb8dieEsx5uwIZL9CFvlUPQKc88ay55Qo+zYx8='}
2015-08-18 11:17:46,155 oic.utils.authn.client:DEBUG Verified Client ID: ft4gRcrzE9nr
2015-08-18 11:17:46,159 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:17:46,161 oic.oic:DEBUG authzreq: {'redirect_uri': 'http://localhost:8666/authz_cb', 'state': '8gk4TIhT7urPcPC2', 'acr_values': 'SAML', 'client_id': 'ft4gRcrzE9nr', 'nonce': '1LFreGzItQfmwLlE', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'response_type': 'code'}
2015-08-18 11:17:46,161 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:17:46,162 oic.oic:DEBUG authzreq: {'redirect_uri': 'http://localhost:8666/authz_cb', 'state': '8gk4TIhT7urPcPC2', 'acr_values': 'SAML', 'client_id': 'ft4gRcrzE9nr', 'nonce': '1LFreGzItQfmwLlE', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'response_type': 'code'}
2015-08-18 11:17:46,162 oic.oic.provider:DEBUG id_token: {'iat': 1439889466, 'sub': '-2f7dc7b1495b47e2', 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/', 'nonce': '1LFreGzItQfmwLlE', 'aud': ['ft4gRcrzE9nr'], 'auth_time': 1439889439, 'exp': 1439968666}
2015-08-18 11:17:46,164 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"e": "AQAB", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"e": "AQAB", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-18 11:17:46,165 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "y": "97RAF1zJk5NqDbZJpeHs3SrRhOCSNcF1Uwg6Hval35Y", "x": "S32EvNJ2Eh4zm9Z8mZWH1zW1oLPGBuKErC7QLVltb70", "kty": "EC", "use": "sig", "kid": "op2"}]}
2015-08-18 11:17:46,165 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "y": "WaP1Q2RrTSet65AuW2Ukc_CwcuVMhu5EDdsM24LSn8s", "x": "mKhlRaOIaQvuVU_2IW6O9CAMiwu5ZcIcwePsE7oZwmg", "kty": "EC", "use": "enc", "kid": "op3"}]}
2015-08-18 11:17:46,166 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c3048>]
2015-08-18 11:17:46,174 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:17:46,175 oic.oic.provider:DEBUG _tinfo: {'redirect_uri': 'http://localhost:8666/authz_cb', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f8ef0>, 'access_token_scope': '?', 'oauth_state': 'token', 'sub': '-2f7dc7b1495b47e2', 'token_type': 'Bearer', 'code_used': True, 'code': '8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW/Ih2kWmb8dieEsx5uwIZL9CFvlUPQKc88ay55Qo+zYx8=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5ODg5NDY2LCAic3ViIjogIi0yZjdkYzdiMTQ5NWI0N2UyIiwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAibm9uY2UiOiAiMUxGcmVHekl0UWZtd0xsRSIsICJhdWQiOiBbImZ0NGdSY3J6RTluciJdLCAiYXV0aF90aW1lIjogMTQzOTg4OTQzOSwgImV4cCI6IDE0Mzk5Njg2NjZ9.st_YxS03vOBCCTFXjgTUgi6n_CVrhyDuJzfkdAwSiMUuZeS5JDnMzGj-ITtn62b_EiNj4iDl3uyznoFw-7itHv2UMf_O-34HCmycKlBnyfeQox9MsQwj1DGMNNMXDxVaMi0QAi0DBOJmmKp6hwe71Y5hq5cuIhMvDXDpoKWl4Gf3UlM_VkPlS_xqxQo97HXb_rSM5KkfsK5PuVntuilWA_2KBHMzYKffwXdsc4mmk_TWjJgeKmnX432GB9bCSIl2tX5LJmugXcFmU3AVFcD6NCiaaSzz_xtbgd7nhKeskwu0ShCObk7YttyqZNaviZ5Jayn8mVmbbsiSBKDC7jfi2w', 'permission': '', 'state': '8gk4TIhT7urPcPC2', 'token_expires_at': 1439889466, 'client_id': 'ft4gRcrzE9nr', 'access_token': '8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW/pMSGV0w1wCe16t3nhXwxFcCo78DKhQy+QVPcIj72JCY=', 'refresh_token': '8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW/MZvJpN7lmbcNch/caXCTHs+vuaBKC0AVTbHUcJpBy2A=', 'expires_in': 3600, 'nonce': '1LFreGzItQfmwLlE', 'authzreq': '{"redirect_uri": "http://localhost:8666/authz_cb", "state": "8gk4TIhT7urPcPC2", "scope": "openid profile email address phone", "client_id": "ft4gRcrzE9nr", "nonce": "1LFreGzItQfmwLlE", "acr_values": "SAML", "upm_answer": "true", "response_type": "code"}', 'revoked': False}
2015-08-18 11:17:46,176 oic.oic.provider:DEBUG access_token_response: {'token_type': 'Bearer', 'state': '8gk4TIhT7urPcPC2', 'refresh_token': '8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW/MZvJpN7lmbcNch/caXCTHs+vuaBKC0AVTbHUcJpBy2A=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOiAxNDM5ODg5NDY2LCAic3ViIjogIi0yZjdkYzdiMTQ5NWI0N2UyIiwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAibm9uY2UiOiAiMUxGcmVHekl0UWZtd0xsRSIsICJhdWQiOiBbImZ0NGdSY3J6RTluciJdLCAiYXV0aF90aW1lIjogMTQzOTg4OTQzOSwgImV4cCI6IDE0Mzk5Njg2NjZ9.st_YxS03vOBCCTFXjgTUgi6n_CVrhyDuJzfkdAwSiMUuZeS5JDnMzGj-ITtn62b_EiNj4iDl3uyznoFw-7itHv2UMf_O-34HCmycKlBnyfeQox9MsQwj1DGMNNMXDxVaMi0QAi0DBOJmmKp6hwe71Y5hq5cuIhMvDXDpoKWl4Gf3UlM_VkPlS_xqxQo97HXb_rSM5KkfsK5PuVntuilWA_2KBHMzYKffwXdsc4mmk_TWjJgeKmnX432GB9bCSIl2tX5LJmugXcFmU3AVFcD6NCiaaSzz_xtbgd7nhKeskwu0ShCObk7YttyqZNaviZ5Jayn8mVmbbsiSBKDC7jfi2w', 'access_token': '8s44GoNfEjGbDKwM6L1NUXuKwG8fOuClEYRBOxQPQEZxlBVxNasKPdSn8POlLwW/pMSGV0w1wCe16t3nhXwxFcCo78DKhQy+QVPcIj72JCY=', 'expires_in': 3600, 'scope': 'openid profile email address phone'}
2015-08-18 11:18:43,140 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"use": "sig", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 11:18:43,141 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "kid": "op2", "x": "-iiOez2sMVo629ouEtD5z8d5JrllUl82IKHZ-VuQ-Xg", "y": "EUgE1oFpxBSK4coUWJKAFlb4aJcrvBnvn_URkyX8_ig", "crv": "P-256"}]}
2015-08-18 11:18:43,141 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "kid": "op3", "x": "3JEeMLccJclSIs9-rPJVnRYEswFhOmRDaCiTmZ9I6Gc", "y": "2AP9gayZavGVifHx6G9TSiTyy74-KUwXrtij1JN1g1U", "crv": "P-256"}]}
2015-08-18 11:18:43,142 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:18:54,593 oicServer:INFO callback: <function webfinger at 0x1054d36a8>
2015-08-18 11:18:54,610 oicServer:INFO callback: <function op_info at 0x1054d32f0>
2015-08-18 11:18:54,610 root:INFO op_info
2015-08-18 11:18:54,611 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:18:54,611 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['PS256', 'ES384', 'PS384', 'RS384', 'none', 'ES256', 'ES512', 'HS512', 'RS512', 'HS256', 'PS512', 'HS384', 'RS256'], 'token_endpoint': 'https://localhost:8092/token', 'claims_supported': ['name', 'locale', 'sub', 'picture', 'given_name', 'address', 'middle_name', 'profile', 'gender', 'zoneinfo', 'email', 'birthdate', 'email_verified', 'updated_at', 'website', 'phone_number', 'phone_number_verified', 'nickname', 'preferred_username', 'family_name'], 'request_object_signing_alg_values_supported': ['PS256', 'ES384', 'PS384', 'RS384', 'none', 'ES256', 'ES512', 'HS512', 'RS512', 'HS256', 'PS512', 'HS384', 'RS256'], 'token_endpoint_auth_signing_alg_values_supported': ['PS256', 'ES384', 'PS384', 'RS384', 'ES256', 'ES512', 'HS512', 'RS512', 'HS256', 'PS512', 'HS384', 'RS256'], 'scopes_supported': ['email', 'openid', 'offline_access', 'address', 'profile', 'phone', 'openid'], 'claims_parameter_supported': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_uri_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'version': '3.0', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'issuer': 'https://localhost:8092/', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'require_request_uri_registration': True, 'id_token_signing_alg_values_supported': ['PS256', 'ES384', 'PS384', 'RS384', 'none', 'ES256', 'ES512', 'HS512', 'RS512', 'HS256', 'PS512', 'HS384', 'RS256'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_parameter_supported': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD']}
2015-08-18 11:18:54,682 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105648860>
2015-08-18 11:18:54,683 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 11:18:54,683 oic.oic.provider:INFO registration_request:{'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-18 11:18:54,690 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'VZGqE6OdXJItzxM2JOpGYROmgspMHhDV', 'client_secret_expires_at': 1439972334, 'registration_client_uri': 'https://localhost:8092/registration?client_id=oJ2US8VWUBb6', 'client_id': 'oJ2US8VWUBb6', 'client_secret': 'ba05b38074932f1e42a69cd6beb5e27c515b396d1e4dbe2bb55c6986', 'client_id_issued_at': 1439885934}
2015-08-18 11:18:54,691 oic.utils.keyio:DEBUG loading keys for issuer: oJ2US8VWUBb6
2015-08-18 11:18:54,692 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-18 11:18:54,692 oic.oic.provider:DEBUG keys for oJ2US8VWUBb6: []
2015-08-18 11:18:54,694 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'registration_access_token': 'VZGqE6OdXJItzxM2JOpGYROmgspMHhDV', 'client_secret_expires_at': 1439972334, 'registration_client_uri': 'https://localhost:8092/registration?client_id=oJ2US8VWUBb6', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id': 'oJ2US8VWUBb6', 'application_type': 'web', 'client_secret': 'ba05b38074932f1e42a69cd6beb5e27c515b396d1e4dbe2bb55c6986', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'response_types': ['code'], 'client_id_issued_at': 1439885934}
2015-08-18 11:18:54,695 oic.oic.provider:DEBUG registration_response: {'contacts': ['ops@example.com'], 'registration_access_token': 'VZGqE6OdXJItzxM2JOpGYROmgspMHhDV', 'client_secret_expires_at': 1439972334, 'registration_client_uri': 'https://localhost:8092/registration?client_id=oJ2US8VWUBb6', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_id': 'oJ2US8VWUBb6', 'application_type': 'web', 'client_secret': 'ba05b38074932f1e42a69cd6beb5e27c515b396d1e4dbe2bb55c6986', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'client_id_issued_at': 1439885934}
2015-08-18 11:18:54,714 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a4390>
2015-08-18 11:18:54,714 oic.oauth2.provider:DEBUG Request: 'state=nDMCbQfXwsQygMAR&response_type=code&client_id=oJ2US8VWUBb6&nonce=ld1s5qP1Yocm1wpW&acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 11:18:54,715 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057fa198>, <jwkest.jwk.RSAKey object at 0x1057c3048>, <jwkest.jwk.ECKey object at 0x1057c3400>]
2015-08-18 11:18:54,715 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'nonce': 'ld1s5qP1Yocm1wpW', 'scope': 'openid profile email address phone', 'client_id': 'oJ2US8VWUBb6', 'state': 'nDMCbQfXwsQygMAR', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:18:54,718 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'nonce': 'ld1s5qP1Yocm1wpW', 'scope': 'openid profile email address phone', 'client_id': 'oJ2US8VWUBb6', 'state': 'nDMCbQfXwsQygMAR', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:18:54,720 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:18:54,720 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:18:54,720 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:18:54,721 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:18:54,721 oic.utils.authn.user:INFO do_authentication argv: {'password': '', 'acr': ['SAML'], 'action': 'https://localhost:8092/verify', 'policy_uri': '', 'passwd_title': 'Password', 'query': 'state=nDMCbQfXwsQygMAR&response_type=code&client_id=oJ2US8VWUBb6&nonce=ld1s5qP1Yocm1wpW&acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'login': '', 'login_title': 'Username', 'logo_uri': '', 'submit_text': 'Submit', 'title': 'User log in', 'client_policy_title': 'Client Policy', 'tos_uri': ''}
2015-08-18 11:18:54,740 oicServer:INFO callback: <function css at 0x1054a3620>
2015-08-18 11:18:58,553 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105747598>
2015-08-18 11:18:58,553 oic.utils.authn.user:DEBUG verify(query=state%3DnDMCbQfXwsQygMAR%26response_type%3Dcode%26client_id%3DoJ2US8VWUBb6%26nonce%3Dld1s5qP1Yocm1wpW%26acr_values%3DSAML%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:18:58,554 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'acr_values': ["['SAML']"], 'query': ['state=nDMCbQfXwsQygMAR&response_type=code&client_id=oJ2US8VWUBb6&nonce=ld1s5qP1Yocm1wpW&acr_values=SAML&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'], 'form.commit': ['Submit'], 'login': ['diana']}
2015-08-18 11:18:58,554 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-18 11:18:58,557 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'upm_answer': 'true', 'nonce': ['ld1s5qP1Yocm1wpW'], 'scope': ['openid profile email address phone'], 'client_id': ['oJ2US8VWUBb6'], 'state': ['nDMCbQfXwsQygMAR'], 'acr_values': ['SAML'], 'redirect_uri': ['http://localhost:8666/authz_cb']}
2015-08-18 11:18:58,577 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a4390>
2015-08-18 11:18:58,578 oic.oauth2.provider:DEBUG Request: 'response_type=code&upm_answer=true&nonce=ld1s5qP1Yocm1wpW&scope=openid+profile+email+address+phone&client_id=oJ2US8VWUBb6&state=nDMCbQfXwsQygMAR&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 11:18:58,578 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057fa198>, <jwkest.jwk.RSAKey object at 0x1057c3048>, <jwkest.jwk.ECKey object at 0x1057c3400>]
2015-08-18 11:18:58,581 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'upm_answer': 'true', 'nonce': 'ld1s5qP1Yocm1wpW', 'scope': 'openid profile email address phone', 'client_id': 'oJ2US8VWUBb6', 'state': 'nDMCbQfXwsQygMAR', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:18:58,583 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'upm_answer': 'true', 'nonce': 'ld1s5qP1Yocm1wpW', 'scope': 'openid profile email address phone', 'client_id': 'oJ2US8VWUBb6', 'state': 'nDMCbQfXwsQygMAR', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:18:58,585 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:18:58,585 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:18:58,585 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:18:58,586 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:18:58,587 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:18:58,587 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'upm_answer', 'nonce', 'scope', 'client_id', 'state', 'acr_values', 'redirect_uri']
2015-08-18 11:18:58,588 oic.utils.sdb:DEBUG uid2sid: {'diana': ['86d0c192148053f4c91552ce8e14d9919c0bb52d269415ea630be2e1']}
2015-08-18 11:18:58,588 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:18:58,588 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:18:58,593 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj%2FMOMx5BFHMvyfcSzumEVfq2KEKQI5RTeBZZe11Oa%2BCb%2FuvkZgI%3D&state=nDMCbQfXwsQygMAR' (<class 'str'>)
2015-08-18 11:19:00,978 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054a4438>
2015-08-18 11:19:03,698 oic.oic.provider:DEBUG - token -
2015-08-18 11:19:03,699 oic.oic.provider:INFO token_request: token_type=pop&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ%3D%3D&client_secret=ba05b38074932f1e42a69cd6beb5e27c515b396d1e4dbe2bb55c6986&client_id=oJ2US8VWUBb6&grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj%2FMOMx5BFHMvyfcSzumEVfq2KEKQI5RTeBZZe11Oa%2BCb%2FuvkZgI%3D
2015-08-18 11:19:03,700 oic.oic.provider:DEBUG AccessTokenRequest: {'token_type': 'pop', 'code': 'Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj/MOMx5BFHMvyfcSzumEVfq2KEKQI5RTeBZZe11Oa+Cb/uvkZgI=', 'client_id': 'oJ2US8VWUBb6', 'client_secret': 'ba05b38074932f1e42a69cd6beb5e27c515b396d1e4dbe2bb55c6986', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ==', 'grant_type': 'authorization_code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:19:03,701 oic.utils.authn.client:DEBUG REQ: {'token_type': 'pop', 'code': 'Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj/MOMx5BFHMvyfcSzumEVfq2KEKQI5RTeBZZe11Oa+Cb/uvkZgI=', 'client_id': 'oJ2US8VWUBb6', 'client_secret': 'ba05b38074932f1e42a69cd6beb5e27c515b396d1e4dbe2bb55c6986', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ==', 'grant_type': 'authorization_code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:19:03,702 oic.utils.authn.client:DEBUG Verified Client ID: oJ2US8VWUBb6
2015-08-18 11:19:03,706 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:19:03,707 oic.oic:DEBUG authzreq: {'response_type': 'code', 'upm_answer': 'true', 'nonce': 'ld1s5qP1Yocm1wpW', 'scope': 'openid profile email address phone', 'client_id': 'oJ2US8VWUBb6', 'state': 'nDMCbQfXwsQygMAR', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:19:03,708 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:19:03,708 oic.oic:DEBUG authzreq: {'response_type': 'code', 'upm_answer': 'true', 'nonce': 'ld1s5qP1Yocm1wpW', 'scope': 'openid profile email address phone', 'client_id': 'oJ2US8VWUBb6', 'state': 'nDMCbQfXwsQygMAR', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:19:03,709 oic.oic.provider:DEBUG id_token: {'iat': 1439889543, 'acr': 'PASSWORD', 'sub': '2f26a8c410858590', 'aud': ['oJ2US8VWUBb6'], 'nonce': 'ld1s5qP1Yocm1wpW', 'iss': 'https://localhost:8092/', 'exp': 1439968743, 'auth_time': 1439889538}
2015-08-18 11:19:03,711 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"use": "sig", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 11:19:03,712 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "kid": "op2", "x": "-iiOez2sMVo629ouEtD5z8d5JrllUl82IKHZ-VuQ-Xg", "y": "EUgE1oFpxBSK4coUWJKAFlb4aJcrvBnvn_URkyX8_ig", "crv": "P-256"}]}
2015-08-18 11:19:03,713 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "kid": "op3", "x": "3JEeMLccJclSIs9-rPJVnRYEswFhOmRDaCiTmZ9I6Gc", "y": "2AP9gayZavGVifHx6G9TSiTyy74-KUwXrtij1JN1g1U", "crv": "P-256"}]}
2015-08-18 11:19:03,713 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c3048>]
2015-08-18 11:19:03,720 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:19:03,721 oic.oic.provider:DEBUG _tinfo: {'code_used': True, 'code': 'Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj/MOMx5BFHMvyfcSzumEVfq2KEKQI5RTeBZZe11Oa+Cb/uvkZgI=', 'sub': '2f26a8c410858590', 'nonce': 'ld1s5qP1Yocm1wpW', 'authzreq': '{"response_type": "code", "upm_answer": "true", "nonce": "ld1s5qP1Yocm1wpW", "scope": "openid profile email address phone", "client_id": "oJ2US8VWUBb6", "state": "nDMCbQfXwsQygMAR", "acr_values": "SAML", "redirect_uri": "http://localhost:8666/authz_cb"}', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'revoked': False, 'state': 'nDMCbQfXwsQygMAR', 'token_type': 'Bearer', 'refresh_token': 'Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj/MOMx5B1EPStx23f7JaDxAc7U3H6hxdtMp/mEcJX6n+hfJpdho=', 'permission': '', 'oauth_state': 'token', 'access_token_scope': '?', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5ODg5NTQzLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICIyZjI2YThjNDEwODU4NTkwIiwgImF1ZCI6IFsib0oyVVM4VldVQmI2Il0sICJub25jZSI6ICJsZDFzNXFQMVlvY20xd3BXIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJleHAiOiAxNDM5OTY4NzQzLCAiYXV0aF90aW1lIjogMTQzOTg4OTUzOH0.c_Q_XZ_ohb72Le0c59EJ8ga1qcKNDS1mrbmyVO3KjhfzQyx4DJY-j3WboDr6C-uvLFai6DhFLBlgnFpMszDj9qkTTJCmYOoFgsiyylqgjCATSYOA1aDFKLRGvI3qs4kyin8HWl3TKAAR42KHfiRxpOwhiZuGaZA8MUuTMdlHSl_6_iycdRY3e3H1W1t1WjGe3Bj44tkTFwqBVIDqm06f3-fpZyKxfHgxXPkdD_MmL8L6RRzxttx7zeIlEjBRGWYoY3cqg_wBrco0GTsxBGTcclmgPJzQn_d3C5qTtIfE3SYdfTOTXimm4odlpfXMygORUeQhW4unCWxFys8g3tGfwg', 'access_token': 'Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj/MOMx5BxlxqcV9lvYSp0E/3GmtzK8LcGm3kjsdLdgKs4I2D6BQ=', 'client_id': 'oJ2US8VWUBb6', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057faef0>, 'expires_in': 3600, 'token_expires_at': 1439889543, 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:19:03,721 oic.oic.provider:DEBUG access_token_response: {'token_type': 'Bearer', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5ODg5NTQzLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICIyZjI2YThjNDEwODU4NTkwIiwgImF1ZCI6IFsib0oyVVM4VldVQmI2Il0sICJub25jZSI6ICJsZDFzNXFQMVlvY20xd3BXIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJleHAiOiAxNDM5OTY4NzQzLCAiYXV0aF90aW1lIjogMTQzOTg4OTUzOH0.c_Q_XZ_ohb72Le0c59EJ8ga1qcKNDS1mrbmyVO3KjhfzQyx4DJY-j3WboDr6C-uvLFai6DhFLBlgnFpMszDj9qkTTJCmYOoFgsiyylqgjCATSYOA1aDFKLRGvI3qs4kyin8HWl3TKAAR42KHfiRxpOwhiZuGaZA8MUuTMdlHSl_6_iycdRY3e3H1W1t1WjGe3Bj44tkTFwqBVIDqm06f3-fpZyKxfHgxXPkdD_MmL8L6RRzxttx7zeIlEjBRGWYoY3cqg_wBrco0GTsxBGTcclmgPJzQn_d3C5qTtIfE3SYdfTOTXimm4odlpfXMygORUeQhW4unCWxFys8g3tGfwg', 'access_token': 'Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj/MOMx5BxlxqcV9lvYSp0E/3GmtzK8LcGm3kjsdLdgKs4I2D6BQ=', 'scope': 'openid profile email address phone', 'state': 'nDMCbQfXwsQygMAR', 'expires_in': 3600, 'refresh_token': 'Iby4l3mEsMUIsytupEXj7fPpL64zoWGioMqAno7CjyJUCsFotVvHqZcCj/MOMx5B1EPStx23f7JaDxAc7U3H6hxdtMp/mEcJX6n+hfJpdho='}
2015-08-18 11:19:11,576 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:19:11,595 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:19:15,293 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1056487b8>
2015-08-18 11:19:35,665 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 11:20:48,413 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-18 11:21:36,900 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 11:21:36,901 root:INFO OC3 server keys: {"keys": [{"x": "Y3Vs_B5sYjUqmcNSZcYJK9qnfT6211NwiHWq3xb_5A4", "use": "sig", "y": "YkCWlwttUIfWZFzJQSkHz-AMsCUpTdBiSthg3FBuOhM", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-18 11:21:36,901 root:INFO OC3 server keys: {"keys": [{"x": "fH0WYGusMK4YKyA9PqZq7PeSQl9Jv7SXA8N_U_l5bc0", "use": "enc", "y": "z1NMvAtjEdW6zf2P5aSIroNfxLsuGwlVlr_qSNiSqm4", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-18 11:21:36,902 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:21:39,686 oicServer:INFO callback: <function webfinger at 0x1054c36a8>
2015-08-18 11:21:39,705 oicServer:INFO callback: <function op_info at 0x1054c32f0>
2015-08-18 11:21:39,705 root:INFO op_info
2015-08-18 11:21:39,705 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:21:39,706 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['RS256', 'RS512', 'ES512', 'none', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'PS256', 'PS384', 'ES384'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'acr_values_supported': ['PASSWORD'], 'id_token_signing_alg_values_supported': ['RS256', 'RS512', 'ES512', 'none', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'PS256', 'PS384', 'ES384'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'issuer': 'https://localhost:8092/', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_parameter_supported': True, 'request_object_signing_alg_values_supported': ['RS256', 'RS512', 'ES512', 'none', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'PS256', 'PS384', 'ES384'], 'claims_supported': ['name', 'updated_at', 'email', 'phone_number_verified', 'zoneinfo', 'preferred_username', 'middle_name', 'address', 'family_name', 'profile', 'website', 'nickname', 'locale', 'phone_number', 'sub', 'email_verified', 'picture', 'birthdate', 'gender', 'given_name'], 'scopes_supported': ['email', 'offline_access', 'phone', 'openid', 'address', 'profile', 'openid'], 'registration_endpoint': 'https://localhost:8092/registration', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'subject_types_supported': ['public', 'pairwise'], 'token_endpoint': 'https://localhost:8092/token', 'claims_parameter_supported': True, 'require_request_uri_registration': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'version': '3.0', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'token_endpoint_auth_signing_alg_values_supported': ['RS256', 'RS512', 'ES512', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'PS256', 'PS384', 'ES384']}
2015-08-18 11:21:39,776 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105519908>
2015-08-18 11:21:39,776 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"]}>>
2015-08-18 11:21:39,777 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:21:39,783 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'cfe66d1b23098d17f896a67fa1eb74d56491105ce4ecb608edc3fb23', 'registration_client_uri': 'https://localhost:8092/registration?client_id=SKaznrW9G5X2', 'client_id_issued_at': 1439886099, 'client_id': 'SKaznrW9G5X2', 'client_secret_expires_at': 1439972499, 'registration_access_token': 'xdT7rmpVedqkfQgtrR8MljWa8Fj1T2wO'}
2015-08-18 11:21:39,785 oic.utils.keyio:DEBUG loading keys for issuer: SKaznrW9G5X2
2015-08-18 11:21:39,785 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:21:39,785 oic.oic.provider:DEBUG keys for SKaznrW9G5X2: []
2015-08-18 11:21:39,788 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'response_types': ['code'], 'application_type': 'web', 'client_secret': 'cfe66d1b23098d17f896a67fa1eb74d56491105ce4ecb608edc3fb23', 'registration_client_uri': 'https://localhost:8092/registration?client_id=SKaznrW9G5X2', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1439886099, 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_id': 'SKaznrW9G5X2', 'client_secret_expires_at': 1439972499, 'registration_access_token': 'xdT7rmpVedqkfQgtrR8MljWa8Fj1T2wO'}
2015-08-18 11:21:39,788 oic.oic.provider:DEBUG registration_response: {'contacts': ['ops@example.com'], 'response_types': ['code'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=SKaznrW9G5X2', 'client_id_issued_at': 1439886099, 'client_secret': 'cfe66d1b23098d17f896a67fa1eb74d56491105ce4ecb608edc3fb23', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_id': 'SKaznrW9G5X2', 'client_secret_expires_at': 1439972499, 'registration_access_token': 'xdT7rmpVedqkfQgtrR8MljWa8Fj1T2wO'}
2015-08-18 11:21:39,803 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105495438>
2015-08-18 11:21:39,804 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&client_id=SKaznrW9G5X2&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=9eXclVppVVfe7WvG&acr_values=SAML&state=YFIIKcQKhC5C9CcH'
2015-08-18 11:21:39,804 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056c8240>, <jwkest.jwk.RSAKey object at 0x1056970f0>, <jwkest.jwk.ECKey object at 0x105697518>]
2015-08-18 11:21:39,805 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'state': 'YFIIKcQKhC5C9CcH', 'nonce': '9eXclVppVVfe7WvG', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'SKaznrW9G5X2'}
2015-08-18 11:21:39,807 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'state': 'YFIIKcQKhC5C9CcH', 'nonce': '9eXclVppVVfe7WvG', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'SKaznrW9G5X2'}
2015-08-18 11:21:39,809 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:21:39,810 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:21:39,810 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:21:39,811 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:21:39,811 oic.utils.authn.user:INFO do_authentication argv: {'query': 'scope=openid+profile+email+address+phone&client_id=SKaznrW9G5X2&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=9eXclVppVVfe7WvG&acr_values=SAML&state=YFIIKcQKhC5C9CcH', 'login': '', 'title': 'User log in', 'action': 'https://localhost:8092/verify', 'tos_uri': '', 'acr': ['SAML'], 'client_policy_title': 'Client Policy', 'submit_text': 'Submit', 'login_title': 'Username', 'password': '', 'logo_uri': '', 'passwd_title': 'Password', 'policy_uri': ''}
2015-08-18 11:21:39,830 oicServer:INFO callback: <function css at 0x105493620>
2015-08-18 11:21:43,927 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10561c598>
2015-08-18 11:21:43,927 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DSKaznrW9G5X2%26response_type%3Dcode%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3D9eXclVppVVfe7WvG%26acr_values%3DSAML%26state%3DYFIIKcQKhC5C9CcH&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:21:43,928 oic.utils.authn.user:DEBUG dict: {'query': ['scope=openid+profile+email+address+phone&client_id=SKaznrW9G5X2&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=9eXclVppVVfe7WvG&acr_values=SAML&state=YFIIKcQKhC5C9CcH'], 'form.commit': ['Submit'], 'login': ['diana'], 'password': ['krall'], 'acr_values': ["['SAML']"]}
2015-08-18 11:21:43,928 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-18 11:21:43,931 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['http://localhost:8666/authz_cb'], 'response_type': ['code'], 'state': ['YFIIKcQKhC5C9CcH'], 'nonce': ['9eXclVppVVfe7WvG'], 'scope': ['openid profile email address phone'], 'client_id': ['SKaznrW9G5X2'], 'upm_answer': 'true', 'acr_values': ['SAML']}
2015-08-18 11:21:43,949 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105495438>
2015-08-18 11:21:43,950 oic.oauth2.provider:DEBUG Request: 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&state=YFIIKcQKhC5C9CcH&nonce=9eXclVppVVfe7WvG&scope=openid+profile+email+address+phone&client_id=SKaznrW9G5X2&upm_answer=true&acr_values=SAML'
2015-08-18 11:21:43,951 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056c8240>, <jwkest.jwk.RSAKey object at 0x1056970f0>, <jwkest.jwk.ECKey object at 0x105697518>]
2015-08-18 11:21:43,951 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'state': 'YFIIKcQKhC5C9CcH', 'client_id': 'SKaznrW9G5X2', 'acr_values': 'SAML', 'nonce': '9eXclVppVVfe7WvG', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 11:21:43,953 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'state': 'YFIIKcQKhC5C9CcH', 'client_id': 'SKaznrW9G5X2', 'acr_values': 'SAML', 'nonce': '9eXclVppVVfe7WvG', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-18 11:21:43,958 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:21:43,958 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:21:43,959 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:21:43,960 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:21:43,960 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:21:43,960 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'response_type', 'state', 'acr_values', 'scope', 'client_id', 'upm_answer', 'nonce']
2015-08-18 11:21:43,961 oic.utils.sdb:DEBUG uid2sid: {'diana': ['e728fe747746bb8d24a2b4d7d94381a0fd503e3e06e70fc01d0340bf']}
2015-08-18 11:21:43,962 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:21:43,962 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:21:43,965 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=YFIIKcQKhC5C9CcH&code=AWzk%2BNHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw%2FDFkI9PrpUKDpcz%2FDiRUGhP2sNZusVWETDjZxJ5LUOSai4tEKl%2BBiYxH8%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 11:21:46,405 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054954e0>
2015-08-18 11:21:47,498 oic.oic.provider:DEBUG - token -
2015-08-18 11:21:47,499 oic.oic.provider:INFO token_request: code=AWzk%2BNHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw%2FDFkI9PrpUKDpcz%2FDiRUGhP2sNZusVWETDjZxJ5LUOSai4tEKl%2BBiYxH8%3D&token_type=pop&client_secret=cfe66d1b23098d17f896a67fa1eb74d56491105ce4ecb608edc3fb23&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=SKaznrW9G5X2&grant_type=authorization_code&key=eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EifQ%3D%3D
2015-08-18 11:21:47,500 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'client_secret': 'cfe66d1b23098d17f896a67fa1eb74d56491105ce4ecb608edc3fb23', 'code': 'AWzk+NHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw/DFkI9PrpUKDpcz/DiRUGhP2sNZusVWETDjZxJ5LUOSai4tEKl+BiYxH8=', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EifQ==', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'SKaznrW9G5X2'}
2015-08-18 11:21:47,500 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'client_secret': 'cfe66d1b23098d17f896a67fa1eb74d56491105ce4ecb608edc3fb23', 'code': 'AWzk+NHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw/DFkI9PrpUKDpcz/DiRUGhP2sNZusVWETDjZxJ5LUOSai4tEKl+BiYxH8=', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EifQ==', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'SKaznrW9G5X2'}
2015-08-18 11:21:47,502 oic.utils.authn.client:DEBUG Verified Client ID: SKaznrW9G5X2
2015-08-18 11:21:47,505 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:21:47,507 oic.oic:DEBUG authzreq: {'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'state': 'YFIIKcQKhC5C9CcH', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'client_id': 'SKaznrW9G5X2', 'upm_answer': 'true', 'nonce': '9eXclVppVVfe7WvG'}
2015-08-18 11:21:47,507 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:21:47,508 oic.oic:DEBUG authzreq: {'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'state': 'YFIIKcQKhC5C9CcH', 'acr_values': 'SAML', 'scope': 'openid profile email address phone', 'client_id': 'SKaznrW9G5X2', 'upm_answer': 'true', 'nonce': '9eXclVppVVfe7WvG'}
2015-08-18 11:21:47,509 oic.oic.provider:DEBUG id_token: {'auth_time': 1439889703, 'exp': 1439968907, 'nonce': '9eXclVppVVfe7WvG', 'acr': 'PASSWORD', 'iat': 1439889707, 'iss': 'https://localhost:8092/', 'sub': '-1c0b4006ee6c6a2a', 'aud': ['SKaznrW9G5X2']}
2015-08-18 11:21:47,511 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 11:21:47,512 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "Y3Vs_B5sYjUqmcNSZcYJK9qnfT6211NwiHWq3xb_5A4", "use": "sig", "y": "YkCWlwttUIfWZFzJQSkHz-AMsCUpTdBiSthg3FBuOhM", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-18 11:21:47,512 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "fH0WYGusMK4YKyA9PqZq7PeSQl9Jv7SXA8N_U_l5bc0", "use": "enc", "y": "z1NMvAtjEdW6zf2P5aSIroNfxLsuGwlVlr_qSNiSqm4", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-18 11:21:47,513 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1056970f0>]
2015-08-18 11:21:47,520 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:21:47,521 oic.oic.provider:DEBUG _tinfo: {'oauth_state': 'token', 'refresh_token': 'AWzk+NHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw/DFkI9PrpUKDpcI2Qi+Z0K/P8e+uKjhkosA6TQ4U12IRNNDNFfAIwaiGI=', 'nonce': '9eXclVppVVfe7WvG', 'permission': '', 'token_type': 'Bearer', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5ODg5NzAzLCAiZXhwIjogMTQzOTk2ODkwNywgIm5vbmNlIjogIjllWGNsVnBwVlZmZTdXdkciLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0Mzk4ODk3MDcsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAic3ViIjogIi0xYzBiNDAwNmVlNmM2YTJhIiwgImF1ZCI6IFsiU0them5yVzlHNVgyIl19.qkpdI1tbrGn5ECcweSEaY26Z_-Po3GWrAXAYjaku_LdL6a1p0-6RwKR0YZxkY57XINj85IPPFnYXgT1CHRgmV-eUJh6i_xIeJ8InVpWaUsDJFEgu1CE5mFEIuZ-4ePpx2UY3XFis2To3Lmf2UR2RVHbqidU-4nZUfhlQfUT-PAYCk_kFZwZp7PNpGzRmJs8P0-EImIgbWXAxcuinANCpR61runlISjXfJt59lh-vAHatl6w9K1CCfkD7KjiIh2JUgwNJKI_HNQBeSkGbK3Vkgb1b8B9Hwz_ARxd0BMa4v4dDCXlKS8t_6XUmdfh78a9IdJxzvEfVs5ekkOwaYHYASQ', 'revoked': False, 'code': 'AWzk+NHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw/DFkI9PrpUKDpcz/DiRUGhP2sNZusVWETDjZxJ5LUOSai4tEKl+BiYxH8=', 'client_id': 'SKaznrW9G5X2', 'state': 'YFIIKcQKhC5C9CcH', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code_used': True, 'sub': '-1c0b4006ee6c6a2a', 'expires_in': 3600, 'token_expires_at': 1439889707, 'authzreq': '{"response_type": "code", "state": "YFIIKcQKhC5C9CcH", "client_id": "SKaznrW9G5X2", "acr_values": "SAML", "nonce": "9eXclVppVVfe7WvG", "redirect_uri": "http://localhost:8666/authz_cb", "upm_answer": "true", "scope": "openid profile email address phone"}', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1056c8f98>, 'redirect_uri': 'http://localhost:8666/authz_cb', 'access_token_scope': '?', 'access_token': 'AWzk+NHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw/DFkI9PrpUKDpc7gd+7z2khky4IxjsKHSg0M7EWRS6YaofWLuttXpPDqc='}
2015-08-18 11:21:47,521 oic.oic.provider:DEBUG access_token_response: {'state': 'YFIIKcQKhC5C9CcH', 'refresh_token': 'AWzk+NHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw/DFkI9PrpUKDpcI2Qi+Z0K/P8e+uKjhkosA6TQ4U12IRNNDNFfAIwaiGI=', 'token_type': 'Bearer', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5ODg5NzAzLCAiZXhwIjogMTQzOTk2ODkwNywgIm5vbmNlIjogIjllWGNsVnBwVlZmZTdXdkciLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0Mzk4ODk3MDcsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAic3ViIjogIi0xYzBiNDAwNmVlNmM2YTJhIiwgImF1ZCI6IFsiU0them5yVzlHNVgyIl19.qkpdI1tbrGn5ECcweSEaY26Z_-Po3GWrAXAYjaku_LdL6a1p0-6RwKR0YZxkY57XINj85IPPFnYXgT1CHRgmV-eUJh6i_xIeJ8InVpWaUsDJFEgu1CE5mFEIuZ-4ePpx2UY3XFis2To3Lmf2UR2RVHbqidU-4nZUfhlQfUT-PAYCk_kFZwZp7PNpGzRmJs8P0-EImIgbWXAxcuinANCpR61runlISjXfJt59lh-vAHatl6w9K1CCfkD7KjiIh2JUgwNJKI_HNQBeSkGbK3Vkgb1b8B9Hwz_ARxd0BMa4v4dDCXlKS8t_6XUmdfh78a9IdJxzvEfVs5ekkOwaYHYASQ', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'access_token': 'AWzk+NHuOHBzgGxaot98WKkp8UFPwtkE1UxXTavYG5VJttL0nw/DFkI9PrpUKDpc7gd+7z2khky4IxjsKHSg0M7EWRS6YaofWLuttXpPDqc='}
2015-08-18 11:21:47,529 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:21:47,548 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:21:50,182 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x105519860>
2015-08-18 11:21:53,688 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 11:23:51,968 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "kid": "op0", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "kid": "op1", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}]}
2015-08-18 11:23:51,969 root:INFO OC3 server keys: {"keys": [{"x": "kU5beK8T0HoZtJM_rQhpzmCSbMPbcOiZKK6GQqO-wXg", "kid": "op2", "use": "sig", "kty": "EC", "y": "ctXi3CQiOM217zuTy3mc6Hsg6Pe6soqswnmuzIbmusw", "crv": "P-256"}]}
2015-08-18 11:23:51,970 root:INFO OC3 server keys: {"keys": [{"x": "3p5Mtucdy5cVh34dxsMWxaqnqF2E2L0PfKpRl6EHkZM", "kid": "op3", "use": "enc", "kty": "EC", "y": "scHgy28zuoiksQF7n825rGqWMviNf08JnHjA8YACH4Q", "crv": "P-256"}]}
2015-08-18 11:23:51,970 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:23:54,478 oicServer:INFO callback: <function webfinger at 0x1054ee6a8>
2015-08-18 11:23:54,497 oicServer:INFO callback: <function op_info at 0x1054ee2f0>
2015-08-18 11:23:54,497 root:INFO op_info
2015-08-18 11:23:54,498 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:23:54,499 oic.oic.provider:INFO provider_info_response: {'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_signing_alg_values_supported': ['RS512', 'RS256', 'HS256', 'ES384', 'ES512', 'HS384', 'PS512', 'none', 'PS384', 'PS256', 'RS384', 'HS512', 'ES256'], 'acr_values_supported': ['PASSWORD'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'token_endpoint_auth_signing_alg_values_supported': ['RS512', 'RS256', 'HS256', 'ES384', 'ES512', 'HS384', 'PS512', 'PS384', 'PS256', 'RS384', 'HS512', 'ES256'], 'registration_endpoint': 'https://localhost:8092/registration', 'scopes_supported': ['offline_access', 'openid', 'address', 'profile', 'email', 'phone', 'openid'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_uri_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_signing_alg_values_supported': ['RS512', 'RS256', 'HS256', 'ES384', 'ES512', 'HS384', 'PS512', 'none', 'PS384', 'PS256', 'RS384', 'HS512', 'ES256'], 'request_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'issuer': 'https://localhost:8092/', 'token_endpoint': 'https://localhost:8092/token', 'require_request_uri_registration': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'version': '3.0', 'authorization_endpoint': 'https://localhost:8092/authorization', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'claims_parameter_supported': True, 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'claims_supported': ['middle_name', 'given_name', 'updated_at', 'phone_number_verified', 'nickname', 'gender', 'phone_number', 'sub', 'website', 'preferred_username', 'picture', 'address', 'profile', 'family_name', 'zoneinfo', 'birthdate', 'locale', 'name', 'email', 'email_verified'], 'request_object_signing_alg_values_supported': ['RS512', 'RS256', 'HS256', 'ES384', 'ES512', 'HS384', 'PS512', 'none', 'PS384', 'PS256', 'RS384', 'HS512', 'ES256']}
2015-08-18 11:23:54,568 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105645898>
2015-08-18 11:23:54,568 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "contacts": ["ops@example.com"]}>>
2015-08-18 11:23:54,569 oic.oic.provider:INFO registration_request:{'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:23:54,575 oic.oic.provider:DEBUG _cinfo: {'client_secret_expires_at': 1439972634, 'registration_access_token': 'TsAQB3JdsrPx5xn0LL0MEInEMo73vdZt', 'client_id': 'gyuaNSd35BUi', 'client_secret': '6a229c87b7fd3e8e3544e91f4fb3bfe1317e6c2290d871f94b19e08c', 'registration_client_uri': 'https://localhost:8092/registration?client_id=gyuaNSd35BUi', 'client_id_issued_at': 1439886234}
2015-08-18 11:23:54,577 oic.utils.keyio:DEBUG loading keys for issuer: gyuaNSd35BUi
2015-08-18 11:23:54,577 oic.utils.keyio:DEBUG pcr: {'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 11:23:54,578 oic.oic.provider:DEBUG keys for gyuaNSd35BUi: []
2015-08-18 11:23:54,580 oic.oic.provider:INFO Client info: {'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439972634, 'application_type': 'web', 'registration_access_token': 'TsAQB3JdsrPx5xn0LL0MEInEMo73vdZt', 'client_id': 'gyuaNSd35BUi', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_secret': '6a229c87b7fd3e8e3544e91f4fb3bfe1317e6c2290d871f94b19e08c', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=gyuaNSd35BUi', 'client_id_issued_at': 1439886234}
2015-08-18 11:23:54,581 oic.oic.provider:DEBUG registration_response: {'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439972634, 'application_type': 'web', 'registration_access_token': 'TsAQB3JdsrPx5xn0LL0MEInEMo73vdZt', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret': '6a229c87b7fd3e8e3544e91f4fb3bfe1317e6c2290d871f94b19e08c', 'response_types': ['code'], 'client_id': 'gyuaNSd35BUi', 'registration_client_uri': 'https://localhost:8092/registration?client_id=gyuaNSd35BUi', 'client_id_issued_at': 1439886234}
2015-08-18 11:23:54,597 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054bf3c8>
2015-08-18 11:23:54,598 oic.oauth2.provider:DEBUG Request: 'nonce=wJKAeymLgYMnLJ5Z&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=gyuaNSd35BUi&state=MVbcVj7l1Un5Op5O&acr_values=SAML&response_type=code'
2015-08-18 11:23:54,598 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f31d0>, <jwkest.jwk.RSAKey object at 0x1057c2080>, <jwkest.jwk.ECKey object at 0x1057c2470>]
2015-08-18 11:23:54,599 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'wJKAeymLgYMnLJ5Z', 'response_type': 'code', 'client_id': 'gyuaNSd35BUi', 'scope': 'openid profile email address phone', 'state': 'MVbcVj7l1Un5Op5O', 'acr_values': 'SAML'}
2015-08-18 11:23:54,601 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'wJKAeymLgYMnLJ5Z', 'response_type': 'code', 'client_id': 'gyuaNSd35BUi', 'scope': 'openid profile email address phone', 'state': 'MVbcVj7l1Un5Op5O', 'acr_values': 'SAML'}
2015-08-18 11:23:54,604 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:23:54,605 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:23:54,605 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:23:54,606 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:23:54,606 oic.utils.authn.user:INFO do_authentication argv: {'query': 'nonce=wJKAeymLgYMnLJ5Z&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=gyuaNSd35BUi&state=MVbcVj7l1Un5Op5O&acr_values=SAML&response_type=code', 'logo_uri': '', 'password': '', 'policy_uri': '', 'acr': ['SAML'], 'submit_text': 'Submit', 'passwd_title': 'Password', 'tos_uri': '', 'login': '', 'client_policy_title': 'Client Policy', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'login_title': 'Username'}
2015-08-18 11:23:54,623 oicServer:INFO callback: <function css at 0x1054bd620>
2015-08-18 11:23:58,267 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105746598>
2015-08-18 11:23:58,268 oic.utils.authn.user:DEBUG verify(query=nonce%3DwJKAeymLgYMnLJ5Z%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DgyuaNSd35BUi%26state%3DMVbcVj7l1Un5Op5O%26acr_values%3DSAML%26response_type%3Dcode&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:23:58,269 oic.utils.authn.user:DEBUG dict: {'query': ['nonce=wJKAeymLgYMnLJ5Z&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=gyuaNSd35BUi&state=MVbcVj7l1Un5Op5O&acr_values=SAML&response_type=code'], 'form.commit': ['Submit'], 'password': ['krall'], 'login': ['diana'], 'acr_values': ["['SAML']"]}
2015-08-18 11:23:58,269 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-18 11:23:58,271 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'state': ['MVbcVj7l1Un5Op5O'], 'response_type': ['code'], 'client_id': ['gyuaNSd35BUi'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone'], 'nonce': ['wJKAeymLgYMnLJ5Z'], 'acr_values': ['SAML']}
2015-08-18 11:23:58,293 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054bf3c8>
2015-08-18 11:23:58,294 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&state=MVbcVj7l1Un5Op5O&response_type=code&client_id=gyuaNSd35BUi&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=wJKAeymLgYMnLJ5Z&acr_values=SAML'
2015-08-18 11:23:58,294 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f31d0>, <jwkest.jwk.RSAKey object at 0x1057c2080>, <jwkest.jwk.ECKey object at 0x1057c2470>]
2015-08-18 11:23:58,295 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'nonce': 'wJKAeymLgYMnLJ5Z', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gyuaNSd35BUi', 'scope': 'openid profile email address phone', 'state': 'MVbcVj7l1Un5Op5O', 'acr_values': 'SAML'}
2015-08-18 11:23:58,296 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'nonce': 'wJKAeymLgYMnLJ5Z', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'gyuaNSd35BUi', 'scope': 'openid profile email address phone', 'state': 'MVbcVj7l1Un5Op5O', 'acr_values': 'SAML'}
2015-08-18 11:23:58,298 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:23:58,299 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:23:58,299 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:23:58,300 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:23:58,300 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:23:58,300 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'state', 'response_type', 'client_id', 'redirect_uri', 'scope', 'nonce', 'acr_values']
2015-08-18 11:23:58,301 oic.utils.sdb:DEBUG uid2sid: {'diana': ['7f521f0201721d7c4d8a0b12ce7f3a6fc686ea53b6ae17f6eb9effc8']}
2015-08-18 11:23:58,301 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:23:58,302 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:23:58,305 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=udfIAHl6XgmGUQVOd3ZCRWKu9%2BK%2Bs8S7oCR9d%2FaoFFH7V4O7FMov3mOSA3nBbuzlv9OxnvnjJrWgOpbmfbiMQrehVsS1xrEXafaqB97IZQQ%3D&scope=openid+profile+email+address+phone&state=MVbcVj7l1Un5Op5O' (<class 'str'>)
2015-08-18 11:24:00,412 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054bf470>
2015-08-18 11:24:00,823 oic.oic.provider:DEBUG - token -
2015-08-18 11:24:00,823 oic.oic.provider:INFO token_request: code=udfIAHl6XgmGUQVOd3ZCRWKu9%2BK%2Bs8S7oCR9d%2FaoFFH7V4O7FMov3mOSA3nBbuzlv9OxnvnjJrWgOpbmfbiMQrehVsS1xrEXafaqB97IZQQ%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=6a229c87b7fd3e8e3544e91f4fb3bfe1317e6c2290d871f94b19e08c&grant_type=authorization_code&client_id=gyuaNSd35BUi&key=eyJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ%3D%3D&token_type=pop
2015-08-18 11:24:00,825 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '6a229c87b7fd3e8e3544e91f4fb3bfe1317e6c2290d871f94b19e08c', 'code': 'udfIAHl6XgmGUQVOd3ZCRWKu9+K+s8S7oCR9d/aoFFH7V4O7FMov3mOSA3nBbuzlv9OxnvnjJrWgOpbmfbiMQrehVsS1xrEXafaqB97IZQQ=', 'client_id': 'gyuaNSd35BUi', 'grant_type': 'authorization_code', 'key': 'eyJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'token_type': 'pop'}
2015-08-18 11:24:00,826 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '6a229c87b7fd3e8e3544e91f4fb3bfe1317e6c2290d871f94b19e08c', 'code': 'udfIAHl6XgmGUQVOd3ZCRWKu9+K+s8S7oCR9d/aoFFH7V4O7FMov3mOSA3nBbuzlv9OxnvnjJrWgOpbmfbiMQrehVsS1xrEXafaqB97IZQQ=', 'client_id': 'gyuaNSd35BUi', 'grant_type': 'authorization_code', 'key': 'eyJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'token_type': 'pop'}
2015-08-18 11:24:00,827 oic.utils.authn.client:DEBUG Verified Client ID: gyuaNSd35BUi
2015-08-18 11:24:00,835 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:24:00,838 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'state': 'MVbcVj7l1Un5Op5O', 'response_type': 'code', 'client_id': 'gyuaNSd35BUi', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'nonce': 'wJKAeymLgYMnLJ5Z', 'acr_values': 'SAML'}
2015-08-18 11:24:00,839 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:24:00,840 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'state': 'MVbcVj7l1Un5Op5O', 'response_type': 'code', 'client_id': 'gyuaNSd35BUi', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'nonce': 'wJKAeymLgYMnLJ5Z', 'acr_values': 'SAML'}
2015-08-18 11:24:00,841 oic.oic.provider:DEBUG id_token: {'sub': '160df85e42d27790', 'iss': 'https://localhost:8092/', 'iat': 1439889840, 'auth_time': 1439889838, 'aud': ['gyuaNSd35BUi'], 'acr': 'PASSWORD', 'nonce': 'wJKAeymLgYMnLJ5Z', 'exp': 1439969040}
2015-08-18 11:24:00,843 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "kid": "op0", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "kid": "op1", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}]}
2015-08-18 11:24:00,844 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "kU5beK8T0HoZtJM_rQhpzmCSbMPbcOiZKK6GQqO-wXg", "kid": "op2", "use": "sig", "kty": "EC", "y": "ctXi3CQiOM217zuTy3mc6Hsg6Pe6soqswnmuzIbmusw", "crv": "P-256"}]}
2015-08-18 11:24:00,844 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "3p5Mtucdy5cVh34dxsMWxaqnqF2E2L0PfKpRl6EHkZM", "kid": "op3", "use": "enc", "kty": "EC", "y": "scHgy28zuoiksQF7n825rGqWMviNf08JnHjA8YACH4Q", "crv": "P-256"}]}
2015-08-18 11:24:00,844 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c2080>]
2015-08-18 11:24:00,857 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:24:00,858 oic.oic.provider:DEBUG _tinfo: {'refresh_token': 'udfIAHl6XgmGUQVOd3ZCRWKu9+K+s8S7oCR9d/aoFFH7V4O7FMov3mOSA3nBbuzloMG6L/ZkxnpI1JDB8whL6J/Hp67rDQ4NUwHrzGXvQJ0=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'expires_in': 3600, 'oauth_state': 'token', 'client_id': 'gyuaNSd35BUi', 'code_used': True, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f3f28>, 'access_token_scope': '?', 'nonce': 'wJKAeymLgYMnLJ5Z', 'token_expires_at': 1439889840, 'sub': '160df85e42d27790', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiMTYwZGY4NWU0MmQyNzc5MCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQzOTg4OTg0MCwgImF1dGhfdGltZSI6IDE0Mzk4ODk4MzgsICJhdWQiOiBbImd5dWFOU2QzNUJVaSJdLCAiYWNyIjogIlBBU1NXT1JEIiwgIm5vbmNlIjogIndKS0FleW1MZ1lNbkxKNVoiLCAiZXhwIjogMTQzOTk2OTA0MH0.smsX1aYr8BYH3m5IKdYNOD-P0teeb1tfvq8O1thtsKVBE1_pndCrSM_AjFH2NrmcM3WqbpRWWkrXX2JfU_8JNjdBgqWcHFloch1WtJZnFjZwkzRI3qgvPT9YQM4dzQgIMKr6faDFNnlmd6LiXxwUzmIjbx75HiOwBqYjPEZREQEghaUteJe8YZB4Hul5i1AxDizYiCq69_aDdIOrFzzguu_84bYiX_pEnc5zpiU8luoYbKB33pyCp_M6A9ajmuZ92vA22wDOlrPw5SxwIi9RRmgUDHk80vvY6TP-uO7xAuJw91VQ5yxEwNGH_zsd1QpbMrPK9qHHHdvwHvpLPEjkDA', 'access_token': 'udfIAHl6XgmGUQVOd3ZCRWKu9+K+s8S7oCR9d/aoFFH7V4O7FMov3mOSA3nBbuzlflTNHGgUacS25FSs4LSVTOVBMe1/K20+D3ofG+wTcVs=', 'token_type': 'Bearer', 'code': 'udfIAHl6XgmGUQVOd3ZCRWKu9+K+s8S7oCR9d/aoFFH7V4O7FMov3mOSA3nBbuzlv9OxnvnjJrWgOpbmfbiMQrehVsS1xrEXafaqB97IZQQ=', 'revoked': False, 'permission': '', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'state': 'MVbcVj7l1Un5Op5O', 'authzreq': '{"upm_answer": "true", "nonce": "wJKAeymLgYMnLJ5Z", "response_type": "code", "redirect_uri": "http://localhost:8666/authz_cb", "client_id": "gyuaNSd35BUi", "scope": "openid profile email address phone", "state": "MVbcVj7l1Un5Op5O", "acr_values": "SAML"}'}
2015-08-18 11:24:00,859 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'access_token': 'udfIAHl6XgmGUQVOd3ZCRWKu9+K+s8S7oCR9d/aoFFH7V4O7FMov3mOSA3nBbuzlflTNHGgUacS25FSs4LSVTOVBMe1/K20+D3ofG+wTcVs=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJzdWIiOiAiMTYwZGY4NWU0MmQyNzc5MCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQzOTg4OTg0MCwgImF1dGhfdGltZSI6IDE0Mzk4ODk4MzgsICJhdWQiOiBbImd5dWFOU2QzNUJVaSJdLCAiYWNyIjogIlBBU1NXT1JEIiwgIm5vbmNlIjogIndKS0FleW1MZ1lNbkxKNVoiLCAiZXhwIjogMTQzOTk2OTA0MH0.smsX1aYr8BYH3m5IKdYNOD-P0teeb1tfvq8O1thtsKVBE1_pndCrSM_AjFH2NrmcM3WqbpRWWkrXX2JfU_8JNjdBgqWcHFloch1WtJZnFjZwkzRI3qgvPT9YQM4dzQgIMKr6faDFNnlmd6LiXxwUzmIjbx75HiOwBqYjPEZREQEghaUteJe8YZB4Hul5i1AxDizYiCq69_aDdIOrFzzguu_84bYiX_pEnc5zpiU8luoYbKB33pyCp_M6A9ajmuZ92vA22wDOlrPw5SxwIi9RRmgUDHk80vvY6TP-uO7xAuJw91VQ5yxEwNGH_zsd1QpbMrPK9qHHHdvwHvpLPEjkDA', 'token_type': 'Bearer', 'scope': 'openid profile email address phone', 'state': 'MVbcVj7l1Un5Op5O', 'refresh_token': 'udfIAHl6XgmGUQVOd3ZCRWKu9+K+s8S7oCR9d/aoFFH7V4O7FMov3mOSA3nBbuzloMG6L/ZkxnpI1JDB8whL6J/Hp67rDQ4NUwHrzGXvQJ0='}
2015-08-18 11:24:00,875 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:24:00,906 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:24:02,178 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1056457f0>
2015-08-18 11:24:04,479 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 11:24:08,452 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-18 11:24:34,163 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig"}]}
2015-08-18 11:24:34,164 root:INFO OC3 server keys: {"keys": [{"y": "lUDVdcvFCc0oN5pP7a48ZQiyGyzaBk8egN1BY5Q2JfE", "crv": "P-256", "kty": "EC", "x": "WavoTXOjilzVHCEE2fLOcK65h6D71r9rUwL5TcjveKE", "use": "sig", "kid": "op2"}]}
2015-08-18 11:24:34,164 root:INFO OC3 server keys: {"keys": [{"y": "Kb4IkrRlOk3YeM8r4t4tJyrfxg3_rJD7z_XGG0sETPA", "crv": "P-256", "kty": "EC", "x": "Ry327Yz620idCpEIW1oRc5DjU8v72NIA8jxMADnYNnc", "use": "enc", "kid": "op3"}]}
2015-08-18 11:24:34,165 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:24:39,121 oicServer:INFO callback: <function webfinger at 0x1055ed6a8>
2015-08-18 11:24:39,142 oicServer:INFO callback: <function op_info at 0x1055ed2f0>
2015-08-18 11:24:39,143 root:INFO op_info
2015-08-18 11:24:39,144 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:24:39,144 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['none', 'PS384', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'ES384', 'PS256', 'RS512', 'ES512', 'RS256'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'subject_types_supported': ['public', 'pairwise'], 'claims_parameter_supported': True, 'require_request_uri_registration': True, 'end_session_endpoint': 'https://localhost:8092/end_session', 'issuer': 'https://localhost:8092/', 'acr_values_supported': ['PASSWORD'], 'token_endpoint_auth_signing_alg_values_supported': ['PS384', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'ES384', 'PS256', 'RS512', 'ES512', 'RS256'], 'version': '3.0', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'scopes_supported': ['address', 'profile', 'phone', 'offline_access', 'email', 'openid', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_supported': ['website', 'middle_name', 'picture', 'profile', 'nickname', 'updated_at', 'family_name', 'locale', 'zoneinfo', 'phone_number_verified', 'address', 'given_name', 'phone_number', 'gender', 'name', 'birthdate', 'preferred_username', 'email', 'email_verified', 'sub'], 'request_parameter_supported': True, 'request_object_signing_alg_values_supported': ['none', 'PS384', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'ES384', 'PS256', 'RS512', 'ES512', 'RS256'], 'registration_endpoint': 'https://localhost:8092/registration', 'authorization_endpoint': 'https://localhost:8092/authorization', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'id_token_signing_alg_values_supported': ['none', 'PS384', 'HS512', 'ES256', 'HS256', 'HS384', 'PS512', 'RS384', 'ES384', 'PS256', 'RS512', 'ES512', 'RS256']}
2015-08-18 11:24:39,219 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105645898>
2015-08-18 11:24:39,219 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "response_types": ["code"], "contacts": ["ops@example.com"], "application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 11:24:39,220 oic.oic.provider:INFO registration_request:{'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-18 11:24:39,226 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': '3SO98jF0CRIOTNtHsAfjntc8ghtMquf0', 'client_id_issued_at': 1439886279, 'client_secret_expires_at': 1439972679, 'client_secret': 'ffe21c929bbc5f97539c3fbd08a1595c7074a5a86814bbb3c255ed76', 'client_id': '6rucO77zJwT5', 'registration_client_uri': 'https://localhost:8092/registration?client_id=6rucO77zJwT5'}
2015-08-18 11:24:39,228 oic.utils.keyio:DEBUG loading keys for issuer: 6rucO77zJwT5
2015-08-18 11:24:39,228 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-18 11:24:39,229 oic.oic.provider:DEBUG keys for 6rucO77zJwT5: []
2015-08-18 11:24:39,231 oic.oic.provider:INFO Client info: {'registration_access_token': '3SO98jF0CRIOTNtHsAfjntc8ghtMquf0', 'application_type': 'web', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1439886279, 'client_secret_expires_at': 1439972679, 'client_secret': 'ffe21c929bbc5f97539c3fbd08a1595c7074a5a86814bbb3c255ed76', 'client_id': '6rucO77zJwT5', 'registration_client_uri': 'https://localhost:8092/registration?client_id=6rucO77zJwT5', 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-18 11:24:39,231 oic.oic.provider:DEBUG registration_response: {'registration_access_token': '3SO98jF0CRIOTNtHsAfjntc8ghtMquf0', 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_id_issued_at': 1439886279, 'client_secret_expires_at': 1439972679, 'client_secret': 'ffe21c929bbc5f97539c3fbd08a1595c7074a5a86814bbb3c255ed76', 'client_id': '6rucO77zJwT5', 'registration_client_uri': 'https://localhost:8092/registration?client_id=6rucO77zJwT5', 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-18 11:24:39,250 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf3c8>
2015-08-18 11:24:39,251 oic.oauth2.provider:DEBUG Request: 'state=PE97jKNEAUTHq7PO&scope=openid+profile+email+address+phone&client_id=6rucO77zJwT5&acr_values=SAML&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=VkdNcW7SVfCQdGge'
2015-08-18 11:24:39,252 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f41d0>, <jwkest.jwk.RSAKey object at 0x1057c2080>, <jwkest.jwk.ECKey object at 0x1057c2400>]
2015-08-18 11:24:39,252 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'PE97jKNEAUTHq7PO', 'client_id': '6rucO77zJwT5', 'scope': 'openid profile email address phone', 'nonce': 'VkdNcW7SVfCQdGge'}
2015-08-18 11:24:39,255 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'PE97jKNEAUTHq7PO', 'client_id': '6rucO77zJwT5', 'scope': 'openid profile email address phone', 'nonce': 'VkdNcW7SVfCQdGge'}
2015-08-18 11:24:39,257 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:24:39,257 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:24:39,257 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:24:39,258 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:24:39,259 oic.utils.authn.user:INFO do_authentication argv: {'action': 'https://localhost:8092/verify', 'tos_uri': '', 'passwd_title': 'Password', 'policy_uri': '', 'title': 'User log in', 'submit_text': 'Submit', 'logo_uri': '', 'query': 'state=PE97jKNEAUTHq7PO&scope=openid+profile+email+address+phone&client_id=6rucO77zJwT5&acr_values=SAML&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=VkdNcW7SVfCQdGge', 'password': '', 'acr': ['SAML'], 'login': '', 'client_policy_title': 'Client Policy', 'login_title': 'Username'}
2015-08-18 11:24:39,281 oicServer:INFO callback: <function css at 0x1055bd620>
2015-08-18 11:24:44,836 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105745598>
2015-08-18 11:24:44,836 oic.utils.authn.user:DEBUG verify(query=state%3DPE97jKNEAUTHq7PO%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3D6rucO77zJwT5%26acr_values%3DSAML%26response_type%3Dcode%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3DVkdNcW7SVfCQdGge&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:24:44,837 oic.utils.authn.user:DEBUG dict: {'query': ['state=PE97jKNEAUTHq7PO&scope=openid+profile+email+address+phone&client_id=6rucO77zJwT5&acr_values=SAML&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=VkdNcW7SVfCQdGge'], 'password': ['krall'], 'login': ['diana'], 'acr_values': ["['SAML']"], 'form.commit': ['Submit']}
2015-08-18 11:24:44,837 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 11:24:44,839 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['http://localhost:8666/authz_cb'], 'upm_answer': 'true', 'response_type': ['code'], 'acr_values': ['SAML'], 'state': ['PE97jKNEAUTHq7PO'], 'client_id': ['6rucO77zJwT5'], 'scope': ['openid profile email address phone'], 'nonce': ['VkdNcW7SVfCQdGge']}
2015-08-18 11:24:44,857 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf3c8>
2015-08-18 11:24:44,858 oic.oauth2.provider:DEBUG Request: 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true&response_type=code&acr_values=SAML&state=PE97jKNEAUTHq7PO&client_id=6rucO77zJwT5&scope=openid+profile+email+address+phone&nonce=VkdNcW7SVfCQdGge'
2015-08-18 11:24:44,859 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f41d0>, <jwkest.jwk.RSAKey object at 0x1057c2080>, <jwkest.jwk.ECKey object at 0x1057c2400>]
2015-08-18 11:24:44,859 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'PE97jKNEAUTHq7PO', 'client_id': '6rucO77zJwT5', 'scope': 'openid profile email address phone', 'nonce': 'VkdNcW7SVfCQdGge'}
2015-08-18 11:24:44,860 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'PE97jKNEAUTHq7PO', 'client_id': '6rucO77zJwT5', 'scope': 'openid profile email address phone', 'nonce': 'VkdNcW7SVfCQdGge'}
2015-08-18 11:24:44,866 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:24:44,866 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:24:44,866 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 11:24:44,867 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:24:44,868 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:24:44,868 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'upm_answer', 'response_type', 'acr_values', 'state', 'client_id', 'scope', 'nonce']
2015-08-18 11:24:44,869 oic.utils.sdb:DEBUG uid2sid: {'diana': ['bba5a2ed424fdc3c59836cdf67acc76aee9a0d6afbbfc27b8d6e38d1']}
2015-08-18 11:24:44,869 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:24:44,869 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:24:44,873 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=PE97jKNEAUTHq7PO&code=vdeUiRokkId7LLTbe7s6ok1i7PEHKmp%2BPdH%2BZXY5R03BjbRf5fW%2FmVyv4lEcCM5FEbr8Iz8NniHe5M8R2ARWQxtdmRpKVoo%2BBObaDCohXhU%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 11:24:50,901 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055bf470>
2015-08-18 11:24:51,461 oic.oic.provider:DEBUG - token -
2015-08-18 11:24:51,461 oic.oic.provider:INFO token_request: grant_type=authorization_code&client_secret=ffe21c929bbc5f97539c3fbd08a1595c7074a5a86814bbb3c255ed76&key=eyJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWciLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJraWQiOiAiYTAifQ%3D%3D&client_id=6rucO77zJwT5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=vdeUiRokkId7LLTbe7s6ok1i7PEHKmp%2BPdH%2BZXY5R03BjbRf5fW%2FmVyv4lEcCM5FEbr8Iz8NniHe5M8R2ARWQxtdmRpKVoo%2BBObaDCohXhU%3D&token_type=pop
2015-08-18 11:24:51,462 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'code': 'vdeUiRokkId7LLTbe7s6ok1i7PEHKmp+PdH+ZXY5R03BjbRf5fW/mVyv4lEcCM5FEbr8Iz8NniHe5M8R2ARWQxtdmRpKVoo+BObaDCohXhU=', 'token_type': 'pop', 'client_secret': 'ffe21c929bbc5f97539c3fbd08a1595c7074a5a86814bbb3c255ed76', 'grant_type': 'authorization_code', 'key': 'eyJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWciLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJraWQiOiAiYTAifQ==', 'client_id': '6rucO77zJwT5'}
2015-08-18 11:24:51,463 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'code': 'vdeUiRokkId7LLTbe7s6ok1i7PEHKmp+PdH+ZXY5R03BjbRf5fW/mVyv4lEcCM5FEbr8Iz8NniHe5M8R2ARWQxtdmRpKVoo+BObaDCohXhU=', 'token_type': 'pop', 'client_secret': 'ffe21c929bbc5f97539c3fbd08a1595c7074a5a86814bbb3c255ed76', 'grant_type': 'authorization_code', 'key': 'eyJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWciLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJraWQiOiAiYTAifQ==', 'client_id': '6rucO77zJwT5'}
2015-08-18 11:24:51,464 oic.utils.authn.client:DEBUG Verified Client ID: 6rucO77zJwT5
2015-08-18 11:24:51,469 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:24:51,471 oic.oic:DEBUG authzreq: {'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'PE97jKNEAUTHq7PO', 'client_id': '6rucO77zJwT5', 'scope': 'openid profile email address phone', 'nonce': 'VkdNcW7SVfCQdGge'}
2015-08-18 11:24:51,472 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:24:51,472 oic.oic:DEBUG authzreq: {'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'PE97jKNEAUTHq7PO', 'client_id': '6rucO77zJwT5', 'scope': 'openid profile email address phone', 'nonce': 'VkdNcW7SVfCQdGge'}
2015-08-18 11:24:51,473 oic.oic.provider:DEBUG id_token: {'aud': ['6rucO77zJwT5'], 'nonce': 'VkdNcW7SVfCQdGge', 'auth_time': 1439889884, 'iat': 1439889891, 'acr': 'PASSWORD', 'sub': '3f1e02a82cdfd828', 'exp': 1439969091, 'iss': 'https://localhost:8092/'}
2015-08-18 11:24:51,475 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig"}]}
2015-08-18 11:24:51,476 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "lUDVdcvFCc0oN5pP7a48ZQiyGyzaBk8egN1BY5Q2JfE", "crv": "P-256", "kty": "EC", "x": "WavoTXOjilzVHCEE2fLOcK65h6D71r9rUwL5TcjveKE", "use": "sig", "kid": "op2"}]}
2015-08-18 11:24:51,476 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "Kb4IkrRlOk3YeM8r4t4tJyrfxg3_rJD7z_XGG0sETPA", "crv": "P-256", "kty": "EC", "x": "Ry327Yz620idCpEIW1oRc5DjU8v72NIA8jxMADnYNnc", "use": "enc", "kid": "op3"}]}
2015-08-18 11:24:51,477 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c2080>]
2015-08-18 11:24:51,484 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:24:51,485 oic.oic.provider:DEBUG _tinfo: {'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhdWQiOiBbIjZydWNPNzd6SndUNSJdLCAibm9uY2UiOiAiVmtkTmNXN1NWZkNRZEdnZSIsICJhdXRoX3RpbWUiOiAxNDM5ODg5ODg0LCAiaWF0IjogMTQzOTg4OTg5MSwgImFjciI6ICJQQVNTV09SRCIsICJzdWIiOiAiM2YxZTAyYTgyY2RmZDgyOCIsICJleHAiOiAxNDM5OTY5MDkxLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIn0.VAryKtRV_3t9tOJ25TATKBdBOSlFnvzlpvf8e_r52zWIXvhD2Ol7d9y_JezfObxqfCXb3kHEVWx8UyreRqaX7nPv-HK_AGwP7cc3rH8NfVDxWDIS5AEbjUjzOTgR3VSHYuP8m2-EsxcOY4dJxEH0Hg4QXxamAU8TV4TJMMyhb6xElcsczelXsDNs7a-0h13Rb5J1TPOBsRcANqClNK_PUlorGRGWbVkQTUOVLK5_1ASJHsmwetU6yOI7djV4V7TqpM7ST4o4_zvVAGpMSG6k27Xd-GhMUtiMgFjAXdzsi6j_68b39QKdfWDKSyxBbKUMjJBibPs6jaKTI5hlfsaoUw', 'nonce': 'VkdNcW7SVfCQdGge', 'expires_in': 3600, 'access_token': 'vdeUiRokkId7LLTbe7s6ok1i7PEHKmp+PdH+ZXY5R03BjbRf5fW/mVyv4lEcCM5FeJdO6uQKbS36w+UfDM8Bqsw3O1xOkrqXWmsb8V9SCdc=', 'token_type': 'Bearer', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f4f28>, 'authzreq': '{"redirect_uri": "http://localhost:8666/authz_cb", "upm_answer": "true", "response_type": "code", "acr_values": "SAML", "state": "PE97jKNEAUTHq7PO", "client_id": "6rucO77zJwT5", "scope": "openid profile email address phone", "nonce": "VkdNcW7SVfCQdGge"}', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token_scope': '?', 'oauth_state': 'token', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code': 'vdeUiRokkId7LLTbe7s6ok1i7PEHKmp+PdH+ZXY5R03BjbRf5fW/mVyv4lEcCM5FEbr8Iz8NniHe5M8R2ARWQxtdmRpKVoo+BObaDCohXhU=', 'token_expires_at': 1439889891, 'revoked': False, 'refresh_token': 'vdeUiRokkId7LLTbe7s6ok1i7PEHKmp+PdH+ZXY5R03BjbRf5fW/mVyv4lEcCM5FIyIb2j7ALbuQvRq3MCYrv6mTZUvalJjs8Ugprh7Svwk=', 'state': 'PE97jKNEAUTHq7PO', 'code_used': True, 'sub': '3f1e02a82cdfd828', 'client_id': '6rucO77zJwT5', 'permission': ''}
2015-08-18 11:24:51,486 oic.oic.provider:DEBUG access_token_response: {'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhdWQiOiBbIjZydWNPNzd6SndUNSJdLCAibm9uY2UiOiAiVmtkTmNXN1NWZkNRZEdnZSIsICJhdXRoX3RpbWUiOiAxNDM5ODg5ODg0LCAiaWF0IjogMTQzOTg4OTg5MSwgImFjciI6ICJQQVNTV09SRCIsICJzdWIiOiAiM2YxZTAyYTgyY2RmZDgyOCIsICJleHAiOiAxNDM5OTY5MDkxLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIn0.VAryKtRV_3t9tOJ25TATKBdBOSlFnvzlpvf8e_r52zWIXvhD2Ol7d9y_JezfObxqfCXb3kHEVWx8UyreRqaX7nPv-HK_AGwP7cc3rH8NfVDxWDIS5AEbjUjzOTgR3VSHYuP8m2-EsxcOY4dJxEH0Hg4QXxamAU8TV4TJMMyhb6xElcsczelXsDNs7a-0h13Rb5J1TPOBsRcANqClNK_PUlorGRGWbVkQTUOVLK5_1ASJHsmwetU6yOI7djV4V7TqpM7ST4o4_zvVAGpMSG6k27Xd-GhMUtiMgFjAXdzsi6j_68b39QKdfWDKSyxBbKUMjJBibPs6jaKTI5hlfsaoUw', 'token_type': 'Bearer', 'expires_in': 3600, 'state': 'PE97jKNEAUTHq7PO', 'refresh_token': 'vdeUiRokkId7LLTbe7s6ok1i7PEHKmp+PdH+ZXY5R03BjbRf5fW/mVyv4lEcCM5FIyIb2j7ALbuQvRq3MCYrv6mTZUvalJjs8Ugprh7Svwk=', 'scope': 'openid profile email address phone', 'access_token': 'vdeUiRokkId7LLTbe7s6ok1i7PEHKmp+PdH+ZXY5R03BjbRf5fW/mVyv4lEcCM5FeJdO6uQKbS36w+UfDM8Bqsw3O1xOkrqXWmsb8V9SCdc='}
2015-08-18 11:24:51,495 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:24:51,515 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:24:53,283 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1056457f0>
2015-08-18 11:24:55,593 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 11:25:29,812 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-18 11:29:11,014 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kty": "RSA", "e": "AQAB"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kty": "RSA", "e": "AQAB"}]}
2015-08-18 11:29:11,015 root:INFO OC3 server keys: {"keys": [{"x": "I05VJRAWQ8lIqfbeDhjQFlU7zn5Fqv-eiOJaYokkewA", "kid": "op2", "crv": "P-256", "use": "sig", "kty": "EC", "y": "nqHtnPuK47SM7-NjVIVTds6iyGEraViMvBmuGP5Ix9o"}]}
2015-08-18 11:29:11,015 root:INFO OC3 server keys: {"keys": [{"x": "NvKXJaK7zKVVRvkdkoN7A9j0IM7aqryR9IlEYMYu__g", "kid": "op3", "crv": "P-256", "use": "enc", "kty": "EC", "y": "aGN9rBxJJG2TIhxAuxl2oEauLASr-DIFafCYHVay5mo"}]}
2015-08-18 11:29:11,016 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:29:13,568 oicServer:INFO callback: <function webfinger at 0x1055ed620>
2015-08-18 11:29:13,588 oicServer:INFO callback: <function op_info at 0x1055ed268>
2015-08-18 11:29:13,589 root:INFO op_info
2015-08-18 11:29:13,589 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:29:13,590 oic.oic.provider:INFO provider_info_response: {'response_modes_supported': ['query', 'fragment', 'form_post'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'version': '3.0', 'claims_supported': ['picture', 'email', 'nickname', 'given_name', 'profile', 'phone_number', 'preferred_username', 'middle_name', 'email_verified', 'name', 'zoneinfo', 'updated_at', 'address', 'phone_number_verified', 'family_name', 'gender', 'locale', 'website', 'sub', 'birthdate'], 'require_request_uri_registration': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'issuer': 'https://localhost:8092/', 'request_uri_parameter_supported': True, 'id_token_signing_alg_values_supported': ['PS384', 'HS256', 'RS256', 'RS512', 'ES512', 'HS384', 'ES384', 'PS512', 'ES256', 'PS256', 'RS384', 'none', 'HS512'], 'claims_parameter_supported': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_signing_alg_values_supported': ['PS384', 'HS256', 'RS256', 'RS512', 'ES512', 'HS384', 'ES384', 'PS512', 'ES256', 'PS256', 'RS384', 'HS512'], 'subject_types_supported': ['public', 'pairwise'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_signing_alg_values_supported': ['PS384', 'HS256', 'RS256', 'RS512', 'ES512', 'HS384', 'ES384', 'PS512', 'ES256', 'PS256', 'RS384', 'none', 'HS512'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_signing_alg_values_supported': ['PS384', 'HS256', 'RS256', 'RS512', 'ES512', 'HS384', 'ES384', 'PS512', 'ES256', 'PS256', 'RS384', 'none', 'HS512'], 'token_endpoint': 'https://localhost:8092/token', 'end_session_endpoint': 'https://localhost:8092/end_session', 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_parameter_supported': True, 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['offline_access', 'email', 'profile', 'openid', 'phone', 'address', 'openid'], 'jwks_uri': 'https://localhost:8092/static/jwks.json'}
2015-08-18 11:29:13,661 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105644908>
2015-08-18 11:29:13,662 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "application_type": "web", "contacts": ["ops@example.com"]}>>
2015-08-18 11:29:13,662 oic.oic.provider:INFO registration_request:{'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:29:13,670 oic.oic.provider:DEBUG _cinfo: {'client_id': 'dsWg86nS5DdL', 'registration_access_token': 'mmqaak46mheCDJykypzR0w5MaVIwlK2Q', 'client_secret': '3bd0d3a333847a2517f025d525584916b172c8bb0766c0e6854bf83f', 'registration_client_uri': 'https://localhost:8092/registration?client_id=dsWg86nS5DdL', 'client_secret_expires_at': 1439972953, 'client_id_issued_at': 1439886553}
2015-08-18 11:29:13,671 oic.utils.keyio:DEBUG loading keys for issuer: dsWg86nS5DdL
2015-08-18 11:29:13,672 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:29:13,672 oic.oic.provider:DEBUG keys for dsWg86nS5DdL: []
2015-08-18 11:29:13,674 oic.oic.provider:INFO Client info: {'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id': 'dsWg86nS5DdL', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'contacts': ['ops@example.com'], 'registration_access_token': 'mmqaak46mheCDJykypzR0w5MaVIwlK2Q', 'client_secret': '3bd0d3a333847a2517f025d525584916b172c8bb0766c0e6854bf83f', 'registration_client_uri': 'https://localhost:8092/registration?client_id=dsWg86nS5DdL', 'response_types': ['code'], 'application_type': 'web', 'client_secret_expires_at': 1439972953, 'client_id_issued_at': 1439886553}
2015-08-18 11:29:13,675 oic.oic.provider:DEBUG registration_response: {'client_id': 'dsWg86nS5DdL', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'registration_access_token': 'mmqaak46mheCDJykypzR0w5MaVIwlK2Q', 'client_secret': '3bd0d3a333847a2517f025d525584916b172c8bb0766c0e6854bf83f', 'registration_client_uri': 'https://localhost:8092/registration?client_id=dsWg86nS5DdL', 'client_id_issued_at': 1439886553, 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'client_secret_expires_at': 1439972953, 'response_types': ['code']}
2015-08-18 11:29:13,691 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf438>
2015-08-18 11:29:13,692 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&nonce=tt90cr5ajwrXsjh5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&client_id=dsWg86nS5DdL&state=WDYZfRunbdwygGHy&response_type=code'
2015-08-18 11:29:13,693 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f5240>, <jwkest.jwk.RSAKey object at 0x1057c20f0>, <jwkest.jwk.ECKey object at 0x1057c2588>]
2015-08-18 11:29:13,693 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'dsWg86nS5DdL', 'scope': 'openid profile email address phone', 'nonce': 'tt90cr5ajwrXsjh5', 'state': 'WDYZfRunbdwygGHy', 'response_type': 'code', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:13,696 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'dsWg86nS5DdL', 'scope': 'openid profile email address phone', 'nonce': 'tt90cr5ajwrXsjh5', 'state': 'WDYZfRunbdwygGHy', 'response_type': 'code', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:13,698 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:29:13,698 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:29:13,698 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:29:13,699 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:29:13,699 oic.utils.authn.user:INFO do_authentication argv: {'title': 'User log in', 'query': 'scope=openid+profile+email+address+phone&nonce=tt90cr5ajwrXsjh5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&client_id=dsWg86nS5DdL&state=WDYZfRunbdwygGHy&response_type=code', 'login_title': 'Username', 'login': '', 'acr': ['SAML'], 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'logo_uri': '', 'action': 'https://localhost:8092/verify', 'submit_text': 'Submit', 'tos_uri': '', 'password': '', 'policy_uri': ''}
2015-08-18 11:29:13,712 oicServer:INFO callback: <function css at 0x1055bd598>
2015-08-18 11:29:19,093 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105747510>
2015-08-18 11:29:19,093 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26nonce%3Dtt90cr5ajwrXsjh5%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26acr_values%3DSAML%26client_id%3DdsWg86nS5DdL%26state%3DWDYZfRunbdwygGHy%26response_type%3Dcode&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:29:19,094 oic.utils.authn.user:DEBUG dict: {'query': ['scope=openid+profile+email+address+phone&nonce=tt90cr5ajwrXsjh5&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&client_id=dsWg86nS5DdL&state=WDYZfRunbdwygGHy&response_type=code'], 'acr_values': ["['SAML']"], 'login': ['diana'], 'password': ['krall'], 'form.commit': ['Submit']}
2015-08-18 11:29:19,094 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-18 11:29:19,097 oic.utils.authn.user:DEBUG kwargs: {'client_id': ['dsWg86nS5DdL'], 'scope': ['openid profile email address phone'], 'nonce': ['tt90cr5ajwrXsjh5'], 'state': ['WDYZfRunbdwygGHy'], 'upm_answer': 'true', 'acr_values': ['SAML'], 'response_type': ['code'], 'redirect_uri': ['http://localhost:8666/authz_cb']}
2015-08-18 11:29:19,117 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf438>
2015-08-18 11:29:19,117 oic.oauth2.provider:DEBUG Request: 'client_id=dsWg86nS5DdL&scope=openid+profile+email+address+phone&nonce=tt90cr5ajwrXsjh5&state=WDYZfRunbdwygGHy&upm_answer=true&acr_values=SAML&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 11:29:19,118 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f5240>, <jwkest.jwk.RSAKey object at 0x1057c20f0>, <jwkest.jwk.ECKey object at 0x1057c2588>]
2015-08-18 11:29:19,119 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'dsWg86nS5DdL', 'scope': 'openid profile email address phone', 'nonce': 'tt90cr5ajwrXsjh5', 'state': 'WDYZfRunbdwygGHy', 'upm_answer': 'true', 'acr_values': 'SAML', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:19,120 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'dsWg86nS5DdL', 'scope': 'openid profile email address phone', 'nonce': 'tt90cr5ajwrXsjh5', 'state': 'WDYZfRunbdwygGHy', 'upm_answer': 'true', 'acr_values': 'SAML', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:19,122 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:29:19,122 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:29:19,123 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:29:19,124 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:29:19,124 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:29:19,124 oic.oic.provider:DEBUG AREQ keys: ['client_id', 'scope', 'nonce', 'state', 'upm_answer', 'acr_values', 'response_type', 'redirect_uri']
2015-08-18 11:29:19,125 oic.utils.sdb:DEBUG uid2sid: {'diana': ['2577059926b64f8969e10aec332031db099c3693804740beb5d04927']}
2015-08-18 11:29:19,126 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:29:19,126 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:29:19,132 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=WDYZfRunbdwygGHy&code=9FdKg%2FCtg6JX%2Bfy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf%2BOdsChA5FfHFzMakXNUiOuZ9S4nIREi8QiBA400qE3AFW0kI%3D' (<class 'str'>)
2015-08-18 11:29:24,774 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055bf4e0>
2015-08-18 11:29:29,234 oic.oic.provider:DEBUG - token -
2015-08-18 11:29:29,235 oic.oic.provider:INFO token_request: code=9FdKg%2FCtg6JX%2Bfy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf%2BOdsChA5FfHFzMakXNUiOuZ9S4nIREi8QiBA400qE3AFW0kI%3D&token_type=pop&grant_type=authorization_code&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInVzZSI6ICJzaWciLCAia3R5IjogIlJTQSIsICJlIjogIkFRQUIifQ%3D%3D&client_id=dsWg86nS5DdL&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=3bd0d3a333847a2517f025d525584916b172c8bb0766c0e6854bf83f
2015-08-18 11:29:29,236 oic.oic.provider:DEBUG AccessTokenRequest: {'client_id': 'dsWg86nS5DdL', 'code': '9FdKg/Ctg6JX+fy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf+OdsChA5FfHFzMakXNUiOuZ9S4nIREi8QiBA400qE3AFW0kI=', 'grant_type': 'authorization_code', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInVzZSI6ICJzaWciLCAia3R5IjogIlJTQSIsICJlIjogIkFRQUIifQ==', 'client_secret': '3bd0d3a333847a2517f025d525584916b172c8bb0766c0e6854bf83f', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:29,237 oic.utils.authn.client:DEBUG REQ: {'client_id': 'dsWg86nS5DdL', 'code': '9FdKg/Ctg6JX+fy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf+OdsChA5FfHFzMakXNUiOuZ9S4nIREi8QiBA400qE3AFW0kI=', 'grant_type': 'authorization_code', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInVzZSI6ICJzaWciLCAia3R5IjogIlJTQSIsICJlIjogIkFRQUIifQ==', 'client_secret': '3bd0d3a333847a2517f025d525584916b172c8bb0766c0e6854bf83f', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:29,238 oic.utils.authn.client:DEBUG Verified Client ID: dsWg86nS5DdL
2015-08-18 11:29:29,243 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:29:29,245 oic.oic:DEBUG authzreq: {'client_id': 'dsWg86nS5DdL', 'scope': 'openid profile email address phone', 'nonce': 'tt90cr5ajwrXsjh5', 'state': 'WDYZfRunbdwygGHy', 'upm_answer': 'true', 'acr_values': 'SAML', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:29,245 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:29:29,246 oic.oic:DEBUG authzreq: {'client_id': 'dsWg86nS5DdL', 'scope': 'openid profile email address phone', 'nonce': 'tt90cr5ajwrXsjh5', 'state': 'WDYZfRunbdwygGHy', 'upm_answer': 'true', 'acr_values': 'SAML', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 11:29:29,247 oic.oic.provider:DEBUG id_token: {'nonce': 'tt90cr5ajwrXsjh5', 'auth_time': 1439890159, 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'exp': 1439969369, 'sub': '-463a8390818660fb', 'aud': ['dsWg86nS5DdL'], 'iat': 1439890169}
2015-08-18 11:29:29,249 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kty": "RSA", "e": "AQAB"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kty": "RSA", "e": "AQAB"}]}
2015-08-18 11:29:29,249 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "I05VJRAWQ8lIqfbeDhjQFlU7zn5Fqv-eiOJaYokkewA", "kid": "op2", "crv": "P-256", "use": "sig", "kty": "EC", "y": "nqHtnPuK47SM7-NjVIVTds6iyGEraViMvBmuGP5Ix9o"}]}
2015-08-18 11:29:29,250 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "NvKXJaK7zKVVRvkdkoN7A9j0IM7aqryR9IlEYMYu__g", "kid": "op3", "crv": "P-256", "use": "enc", "kty": "EC", "y": "aGN9rBxJJG2TIhxAuxl2oEauLASr-DIFafCYHVay5mo"}]}
2015-08-18 11:29:29,250 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c20f0>]
2015-08-18 11:29:29,259 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:29:29,259 oic.oic.provider:DEBUG _tinfo: {'client_id': 'dsWg86nS5DdL', 'access_token': '9FdKg/Ctg6JX+fy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf+OdsCucQkDadDKUintuoUpRTMeMi9o5Qfk85C2qhDc5rDb6I=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code': '9FdKg/Ctg6JX+fy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf+OdsChA5FfHFzMakXNUiOuZ9S4nIREi8QiBA400qE3AFW0kI=', 'expires_in': 3600, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f5f98>, 'nonce': 'tt90cr5ajwrXsjh5', 'code_used': True, 'revoked': False, 'authzreq': '{"client_id": "dsWg86nS5DdL", "scope": "openid profile email address phone", "nonce": "tt90cr5ajwrXsjh5", "state": "WDYZfRunbdwygGHy", "upm_answer": "true", "acr_values": "SAML", "response_type": "code", "redirect_uri": "http://localhost:8666/authz_cb"}', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJ0dDkwY3I1YWp3clhzamg1IiwgImF1dGhfdGltZSI6IDE0Mzk4OTAxNTksICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0Mzk5NjkzNjksICJzdWIiOiAiLTQ2M2E4MzkwODE4NjYwZmIiLCAiYXVkIjogWyJkc1dnODZuUzVEZEwiXSwgImlhdCI6IDE0Mzk4OTAxNjl9.fgWFtrw7fvV_a0Ormrosfpqglllj4fiMmR8mnosBUhD-ztV3cxP-ko7woWGZ4K1BTc3qGzaaQkwZMBFIAt5ENo7RVX54MGyOTv8Zl-FFFF5_q8ABNV-9L9Ys5wtW9peEA_kMGzq20Jm6SYa08dGwHroQO5pzgZ7U4i9yuRpWwz39_Qg0ulWjADW3EZCRVq6azL29feI1974e03COfhoDJu6BNDrF8a3CFEaUHIYGg824cJjY_JbSeW-SiJbainqY5WFZ4-sS7Ynz3UQLUOaWXNBd4eC1ybYxVYZeZqBBR08aiViUUWY70GML9EuM6EZdbPNAv5lVR5tXu8jF_-pyEw', 'permission': '', 'state': 'WDYZfRunbdwygGHy', 'token_type': 'Bearer', 'refresh_token': '9FdKg/Ctg6JX+fy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf+OdsCXv4Z6Y3Ml/+goujgyr/Eu6ICuEUpgh+BCQWjJK/VMXQ=', 'oauth_state': 'token', 'sub': '-463a8390818660fb', 'token_expires_at': 1439890169, 'redirect_uri': 'http://localhost:8666/authz_cb', 'access_token_scope': '?'}
2015-08-18 11:29:29,260 oic.oic.provider:DEBUG access_token_response: {'access_token': '9FdKg/Ctg6JX+fy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf+OdsCucQkDadDKUintuoUpRTMeMi9o5Qfk85C2qhDc5rDb6I=', 'scope': 'openid profile email address phone', 'refresh_token': '9FdKg/Ctg6JX+fy8LE6zNGizW0zSwCUwbIEFo8t63E9W8W5VnRDDc6VT9Lf+OdsCXv4Z6Y3Ml/+goujgyr/Eu6ICuEUpgh+BCQWjJK/VMXQ=', 'expires_in': 3600, 'state': 'WDYZfRunbdwygGHy', 'token_type': 'Bearer', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJ0dDkwY3I1YWp3clhzamg1IiwgImF1dGhfdGltZSI6IDE0Mzk4OTAxNTksICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0Mzk5NjkzNjksICJzdWIiOiAiLTQ2M2E4MzkwODE4NjYwZmIiLCAiYXVkIjogWyJkc1dnODZuUzVEZEwiXSwgImlhdCI6IDE0Mzk4OTAxNjl9.fgWFtrw7fvV_a0Ormrosfpqglllj4fiMmR8mnosBUhD-ztV3cxP-ko7woWGZ4K1BTc3qGzaaQkwZMBFIAt5ENo7RVX54MGyOTv8Zl-FFFF5_q8ABNV-9L9Ys5wtW9peEA_kMGzq20Jm6SYa08dGwHroQO5pzgZ7U4i9yuRpWwz39_Qg0ulWjADW3EZCRVq6azL29feI1974e03COfhoDJu6BNDrF8a3CFEaUHIYGg824cJjY_JbSeW-SiJbainqY5WFZ4-sS7Ynz3UQLUOaWXNBd4eC1ybYxVYZeZqBBR08aiViUUWY70GML9EuM6EZdbPNAv5lVR5tXu8jF_-pyEw'}
2015-08-18 11:29:29,269 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:29:29,288 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:29:33,315 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x105644860>
2015-08-18 11:29:36,866 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 11:29:40,578 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-18 11:29:47,773 oic.oauth2.provider:ERROR access_denied
2015-08-18 11:35:00,502 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"kid": "op1", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-18 11:35:00,503 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "x": "WfeGzEeMpEx-l93KH9q7DEWluyqz7l_8965vlc1N-UY", "y": "tyoC-NbbKAElUd6ZG_HHblVoRwRfcsCy1o13VTx7Mdo", "use": "sig", "crv": "P-256"}]}
2015-08-18 11:35:00,503 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "x": "xHBT0vPNPDyzsJUV6Uuad5gr8ZoIWObgORzvqBdLEzk", "y": "fIGZh4M1-qIA_cpLWZWwI5BoLWJW0dJBkfL5QOcYraI", "use": "enc", "crv": "P-256"}]}
2015-08-18 11:35:00,504 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 11:35:01,890 oicServer:INFO callback: <function webfinger at 0x1055e46a8>
2015-08-18 11:35:01,914 oicServer:INFO callback: <function op_info at 0x1055e42f0>
2015-08-18 11:35:01,914 root:INFO op_info
2015-08-18 11:35:01,915 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 11:35:01,916 oic.oic.provider:INFO provider_info_response: {'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'request_object_signing_alg_values_supported': ['HS512', 'ES512', 'RS512', 'RS256', 'HS256', 'PS384', 'none', 'PS512', 'RS384', 'ES256', 'HS384', 'PS256', 'ES384'], 'userinfo_signing_alg_values_supported': ['HS512', 'ES512', 'RS512', 'RS256', 'HS256', 'PS384', 'none', 'PS512', 'RS384', 'ES256', 'HS384', 'PS256', 'ES384'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_signing_alg_values_supported': ['HS512', 'ES512', 'RS512', 'RS256', 'HS256', 'PS384', 'PS512', 'RS384', 'ES256', 'HS384', 'PS256', 'ES384'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'version': '3.0', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_uri_parameter_supported': True, 'claims_supported': ['zoneinfo', 'email', 'phone_number', 'nickname', 'email_verified', 'gender', 'name', 'picture', 'preferred_username', 'given_name', 'profile', 'middle_name', 'sub', 'locale', 'website', 'address', 'phone_number_verified', 'family_name', 'birthdate', 'updated_at'], 'id_token_signing_alg_values_supported': ['HS512', 'ES512', 'RS512', 'RS256', 'HS256', 'PS384', 'none', 'PS512', 'RS384', 'ES256', 'HS384', 'PS256', 'ES384'], 'require_request_uri_registration': True, 'claims_parameter_supported': True, 'scopes_supported': ['profile', 'email', 'openid', 'address', 'phone', 'offline_access', 'openid'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'acr_values_supported': ['PASSWORD'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'end_session_endpoint': 'https://localhost:8092/end_session', 'subject_types_supported': ['public', 'pairwise']}
2015-08-18 11:35:01,984 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x10563a8d0>
2015-08-18 11:35:01,984 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "application_type": "web", "response_types": ["code"], "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 11:35:01,985 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-18 11:35:01,991 oic.oic.provider:DEBUG _cinfo: {'registration_client_uri': 'https://localhost:8092/registration?client_id=e6HvLjZHAP7R', 'client_id': 'e6HvLjZHAP7R', 'registration_access_token': '4h8cDJcRMiF8jW082NhmOugfwLdyq3vN', 'client_secret': '3af589e43c987768a77ebf99d645df3ba833fb267293b8be327af049', 'client_secret_expires_at': 1439973301, 'client_id_issued_at': 1439886901}
2015-08-18 11:35:01,993 oic.utils.keyio:DEBUG loading keys for issuer: e6HvLjZHAP7R
2015-08-18 11:35:01,993 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-18 11:35:01,994 oic.oic.provider:DEBUG keys for e6HvLjZHAP7R: []
2015-08-18 11:35:01,996 oic.oic.provider:INFO Client info: {'registration_client_uri': 'https://localhost:8092/registration?client_id=e6HvLjZHAP7R', 'client_id': 'e6HvLjZHAP7R', 'registration_access_token': '4h8cDJcRMiF8jW082NhmOugfwLdyq3vN', 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_secret': '3af589e43c987768a77ebf99d645df3ba833fb267293b8be327af049', 'client_secret_expires_at': 1439973301, 'client_id_issued_at': 1439886901, 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)]}
2015-08-18 11:35:01,996 oic.oic.provider:DEBUG registration_response: {'registration_client_uri': 'https://localhost:8092/registration?client_id=e6HvLjZHAP7R', 'client_id': 'e6HvLjZHAP7R', 'registration_access_token': '4h8cDJcRMiF8jW082NhmOugfwLdyq3vN', 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_secret': '3af589e43c987768a77ebf99d645df3ba833fb267293b8be327af049', 'client_secret_expires_at': 1439973301, 'client_id_issued_at': 1439886901, 'redirect_uris': ['http://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 11:35:02,015 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b6400>
2015-08-18 11:35:02,016 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&state=utd70Lg0WCmhSn9e&client_id=e6HvLjZHAP7R&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&nonce=SeZJZJZspbWMiRDc'
2015-08-18 11:35:02,017 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e8208>, <jwkest.jwk.RSAKey object at 0x1057b80b8>, <jwkest.jwk.ECKey object at 0x1057b84a8>]
2015-08-18 11:35:02,017 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'e6HvLjZHAP7R', 'scope': 'openid profile email address phone', 'state': 'utd70Lg0WCmhSn9e', 'acr_values': 'SAML', 'nonce': 'SeZJZJZspbWMiRDc', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-18 11:35:02,019 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'e6HvLjZHAP7R', 'scope': 'openid profile email address phone', 'state': 'utd70Lg0WCmhSn9e', 'acr_values': 'SAML', 'nonce': 'SeZJZJZspbWMiRDc', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-18 11:35:02,021 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:35:02,022 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:35:02,022 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:35:02,023 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:35:02,023 oic.utils.authn.user:INFO do_authentication argv: {'client_policy_title': 'Client Policy', 'query': 'scope=openid+profile+email+address+phone&state=utd70Lg0WCmhSn9e&client_id=e6HvLjZHAP7R&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&nonce=SeZJZJZspbWMiRDc', 'passwd_title': 'Password', 'password': '', 'title': 'User log in', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'submit_text': 'Submit', 'acr': ['SAML'], 'tos_uri': '', 'login_title': 'Username', 'login': '', 'logo_uri': ''}
2015-08-18 11:35:02,040 oicServer:INFO callback: <function css at 0x1055b4620>
2015-08-18 11:35:05,856 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10573c598>
2015-08-18 11:35:05,856 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3Dutd70Lg0WCmhSn9e%26client_id%3De6HvLjZHAP7R%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26acr_values%3DSAML%26response_type%3Dcode%26nonce%3DSeZJZJZspbWMiRDc&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 11:35:05,857 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'login': ['diana'], 'password': ['krall'], 'acr_values': ["['SAML']"], 'query': ['scope=openid+profile+email+address+phone&state=utd70Lg0WCmhSn9e&client_id=e6HvLjZHAP7R&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&nonce=SeZJZJZspbWMiRDc']}
2015-08-18 11:35:05,857 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-18 11:35:05,860 oic.utils.authn.user:DEBUG kwargs: {'client_id': ['e6HvLjZHAP7R'], 'scope': ['openid profile email address phone'], 'state': ['utd70Lg0WCmhSn9e'], 'acr_values': ['SAML'], 'upm_answer': 'true', 'nonce': ['SeZJZJZspbWMiRDc'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'response_type': ['code']}
2015-08-18 11:35:05,877 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b6400>
2015-08-18 11:35:05,877 oic.oauth2.provider:DEBUG Request: 'client_id=e6HvLjZHAP7R&scope=openid+profile+email+address+phone&state=utd70Lg0WCmhSn9e&acr_values=SAML&upm_answer=true&nonce=SeZJZJZspbWMiRDc&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'
2015-08-18 11:35:05,878 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e8208>, <jwkest.jwk.RSAKey object at 0x1057b80b8>, <jwkest.jwk.ECKey object at 0x1057b84a8>]
2015-08-18 11:35:05,879 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'e6HvLjZHAP7R', 'scope': 'openid profile email address phone', 'state': 'utd70Lg0WCmhSn9e', 'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'SeZJZJZspbWMiRDc', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-18 11:35:05,880 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'e6HvLjZHAP7R', 'scope': 'openid profile email address phone', 'state': 'utd70Lg0WCmhSn9e', 'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'SeZJZJZspbWMiRDc', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-18 11:35:05,884 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:35:05,884 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 11:35:05,885 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 11:35:05,886 oic.oauth2.provider:INFO No active authentication
2015-08-18 11:35:05,887 oic.oic.provider:DEBUG - authenticated -
2015-08-18 11:35:05,887 oic.oic.provider:DEBUG AREQ keys: ['client_id', 'scope', 'state', 'acr_values', 'upm_answer', 'nonce', 'redirect_uri', 'response_type']
2015-08-18 11:35:05,888 oic.utils.sdb:DEBUG uid2sid: {'diana': ['81d35ee5a264a6288fea1e89eb46c31aa232fa648879a5d09d6bb6b4']}
2015-08-18 11:35:05,888 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 11:35:05,889 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 11:35:05,892 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=3PK1vZuaHOkTxoA37%2FdpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2daEf0V0AI2x9qcpNcFFG6d1%2BKvD5KILK%2FjeAF0fJ9swXA%3D&scope=openid+profile+email+address+phone&state=utd70Lg0WCmhSn9e' (<class 'str'>)
2015-08-18 11:35:08,005 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055b64a8>
2015-08-18 11:35:08,738 oic.oic.provider:DEBUG - token -
2015-08-18 11:35:08,739 oic.oic.provider:INFO token_request: token_type=pop&grant_type=authorization_code&code=3PK1vZuaHOkTxoA37%2FdpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2daEf0V0AI2x9qcpNcFFG6d1%2BKvD5KILK%2FjeAF0fJ9swXA%3D&client_id=e6HvLjZHAP7R&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=3af589e43c987768a77ebf99d645df3ba833fb267293b8be327af049&key=eyJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAia3R5IjogIlJTQSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ%3D%3D
2015-08-18 11:35:08,741 oic.oic.provider:DEBUG AccessTokenRequest: {'client_id': 'e6HvLjZHAP7R', 'code': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2daEf0V0AI2x9qcpNcFFG6d1+KvD5KILK/jeAF0fJ9swXA=', 'client_secret': '3af589e43c987768a77ebf99d645df3ba833fb267293b8be327af049', 'key': 'eyJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAia3R5IjogIlJTQSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code'}
2015-08-18 11:35:08,741 oic.utils.authn.client:DEBUG REQ: {'client_id': 'e6HvLjZHAP7R', 'code': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2daEf0V0AI2x9qcpNcFFG6d1+KvD5KILK/jeAF0fJ9swXA=', 'client_secret': '3af589e43c987768a77ebf99d645df3ba833fb267293b8be327af049', 'key': 'eyJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInVzZSI6ICJzaWciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAia3R5IjogIlJTQSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code'}
2015-08-18 11:35:08,742 oic.utils.authn.client:DEBUG Verified Client ID: e6HvLjZHAP7R
2015-08-18 11:35:08,746 oic.oic.provider:DEBUG All checks OK
2015-08-18 11:35:08,747 oic.oic:DEBUG authzreq: {'client_id': 'e6HvLjZHAP7R', 'scope': 'openid profile email address phone', 'state': 'utd70Lg0WCmhSn9e', 'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'SeZJZJZspbWMiRDc', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-18 11:35:08,748 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 11:35:08,748 oic.oic:DEBUG authzreq: {'client_id': 'e6HvLjZHAP7R', 'scope': 'openid profile email address phone', 'state': 'utd70Lg0WCmhSn9e', 'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'SeZJZJZspbWMiRDc', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-18 11:35:08,749 oic.oic.provider:DEBUG id_token: {'sub': '23cfbb0e65bf9791', 'exp': 1439969708, 'nonce': 'SeZJZJZspbWMiRDc', 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/', 'iat': 1439890508, 'auth_time': 1439890505, 'aud': ['e6HvLjZHAP7R']}
2015-08-18 11:35:08,751 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"kid": "op1", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-18 11:35:08,752 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "x": "WfeGzEeMpEx-l93KH9q7DEWluyqz7l_8965vlc1N-UY", "y": "tyoC-NbbKAElUd6ZG_HHblVoRwRfcsCy1o13VTx7Mdo", "use": "sig", "crv": "P-256"}]}
2015-08-18 11:35:08,753 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "x": "xHBT0vPNPDyzsJUV6Uuad5gr8ZoIWObgORzvqBdLEzk", "y": "fIGZh4M1-qIA_cpLWZWwI5BoLWJW0dJBkfL5QOcYraI", "use": "enc", "crv": "P-256"}]}
2015-08-18 11:35:08,753 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057b80b8>]
2015-08-18 11:35:08,762 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:35:08,762 oic.oic.provider:DEBUG _tinfo: {'access_token': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2da6Y/Qqj+RUM+X8AOzAMVKZmo8SFTbE3e8Zw8RSxUTvl0=', 'permission': '', 'client_id': 'e6HvLjZHAP7R', 'state': 'utd70Lg0WCmhSn9e', 'sub': '23cfbb0e65bf9791', 'oauth_state': 'token', 'token_type': 'Bearer', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'revoked': False, 'expires_in': 3600, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_expires_at': 1439890508, 'authzreq': '{"client_id": "e6HvLjZHAP7R", "scope": "openid profile email address phone", "state": "utd70Lg0WCmhSn9e", "acr_values": "SAML", "upm_answer": "true", "nonce": "SeZJZJZspbWMiRDc", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code"}', 'access_token_scope': '?', 'code': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2daEf0V0AI2x9qcpNcFFG6d1+KvD5KILK/jeAF0fJ9swXA=', 'nonce': 'SeZJZJZspbWMiRDc', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiAiMjNjZmJiMGU2NWJmOTc5MSIsICJleHAiOiAxNDM5OTY5NzA4LCAibm9uY2UiOiAiU2VaSlpKWnNwYldNaVJEYyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0Mzk4OTA1MDgsICJhdXRoX3RpbWUiOiAxNDM5ODkwNTA1LCAiYXVkIjogWyJlNkh2TGpaSEFQN1IiXX0.iOVtQXkrOdr7Fo8y5L1c2T2aaD8-Q2rLXBWQngNAotmborCpU0RaQgwfm-KQY0Wl4w-cV3BNhlTk0PyCH-WUJXzMUBwUi6_-hjj7yyQg5US45Hvt9RIYDvnLZGPnAn-zVRHBd0p0pjXGdJwWNpsa5C9KZG9OUl8TIp1D_TXT7Lr2gK3MD5oStm6a4dqjy0CPVRri4H7dw3RFZDOJZ87-TScrf13Xuk-PmQR4Df8pvvBlp_7IIVFjrw4PExEdEPJPW8Qojwws3efqxRuoWHnj7sbQgymxGvE4poeZVa7ebDplkwt_aeyUF3kYCP4zpsq7cY8BTOfqpwX9Ywnnr2xwDg', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x108b20240>, 'refresh_token': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2dasx4lEQfEN1LCOLgkWkUURDqeXSIOOVKaFjzIL/q7Rew='}
2015-08-18 11:35:08,763 oic.oic.provider:DEBUG access_token_response: {'access_token': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2da6Y/Qqj+RUM+X8AOzAMVKZmo8SFTbE3e8Zw8RSxUTvl0=', 'expires_in': 3600, 'state': 'utd70Lg0WCmhSn9e', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiAiMjNjZmJiMGU2NWJmOTc5MSIsICJleHAiOiAxNDM5OTY5NzA4LCAibm9uY2UiOiAiU2VaSlpKWnNwYldNaVJEYyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0Mzk4OTA1MDgsICJhdXRoX3RpbWUiOiAxNDM5ODkwNTA1LCAiYXVkIjogWyJlNkh2TGpaSEFQN1IiXX0.iOVtQXkrOdr7Fo8y5L1c2T2aaD8-Q2rLXBWQngNAotmborCpU0RaQgwfm-KQY0Wl4w-cV3BNhlTk0PyCH-WUJXzMUBwUi6_-hjj7yyQg5US45Hvt9RIYDvnLZGPnAn-zVRHBd0p0pjXGdJwWNpsa5C9KZG9OUl8TIp1D_TXT7Lr2gK3MD5oStm6a4dqjy0CPVRri4H7dw3RFZDOJZ87-TScrf13Xuk-PmQR4Df8pvvBlp_7IIVFjrw4PExEdEPJPW8Qojwws3efqxRuoWHnj7sbQgymxGvE4poeZVa7ebDplkwt_aeyUF3kYCP4zpsq7cY8BTOfqpwX9Ywnnr2xwDg', 'scope': 'openid profile email address phone', 'token_type': 'Bearer', 'refresh_token': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2dasx4lEQfEN1LCOLgkWkUURDqeXSIOOVKaFjzIL/q7Rew='}
2015-08-18 11:35:08,771 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 11:35:08,792 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 11:35:10,188 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x10563a828>
2015-08-18 11:35:12,706 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 11:35:16,259 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-18 11:35:18,870 oic.oic.provider:DEBUG access_token type: 'T'
2015-08-18 11:35:18,871 oic.oic:DEBUG authzreq: {'client_id': 'e6HvLjZHAP7R', 'scope': 'openid profile email address phone', 'state': 'utd70Lg0WCmhSn9e', 'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'SeZJZJZspbWMiRDc', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-18 11:35:18,871 oic.oic.provider:DEBUG userinfo_claim: {'zoneinfo': None, 'email': None, 'phone_number': None, 'nickname': None, 'email_verified': None, 'gender': None, 'picture': None, 'name': None, 'address': None, 'preferred_username': None, 'given_name': None, 'profile': None, 'sub': None, 'middle_name': None, 'locale': None, 'website': None, 'phone_number_verified': None, 'family_name': None, 'birthdate': None, 'updated_at': None}
2015-08-18 11:35:18,872 oic.oic.provider:DEBUG Session info: {'access_token': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2da6Y/Qqj+RUM+X8AOzAMVKZmo8SFTbE3e8Zw8RSxUTvl0=', 'permission': '', 'client_id': 'e6HvLjZHAP7R', 'state': 'utd70Lg0WCmhSn9e', 'sub': '23cfbb0e65bf9791', 'oauth_state': 'token', 'token_type': 'Bearer', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'revoked': False, 'expires_in': 3600, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_expires_at': 1439890508, 'authzreq': '{"client_id": "e6HvLjZHAP7R", "scope": "openid profile email address phone", "state": "utd70Lg0WCmhSn9e", "acr_values": "SAML", "upm_answer": "true", "nonce": "SeZJZJZspbWMiRDc", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code"}', 'access_token_scope': '?', 'code': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2daEf0V0AI2x9qcpNcFFG6d1+KvD5KILK/jeAF0fJ9swXA=', 'nonce': 'SeZJZJZspbWMiRDc', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiAiMjNjZmJiMGU2NWJmOTc5MSIsICJleHAiOiAxNDM5OTY5NzA4LCAibm9uY2UiOiAiU2VaSlpKWnNwYldNaVJEYyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0Mzk4OTA1MDgsICJhdXRoX3RpbWUiOiAxNDM5ODkwNTA1LCAiYXVkIjogWyJlNkh2TGpaSEFQN1IiXX0.iOVtQXkrOdr7Fo8y5L1c2T2aaD8-Q2rLXBWQngNAotmborCpU0RaQgwfm-KQY0Wl4w-cV3BNhlTk0PyCH-WUJXzMUBwUi6_-hjj7yyQg5US45Hvt9RIYDvnLZGPnAn-zVRHBd0p0pjXGdJwWNpsa5C9KZG9OUl8TIp1D_TXT7Lr2gK3MD5oStm6a4dqjy0CPVRri4H7dw3RFZDOJZ87-TScrf13Xuk-PmQR4Df8pvvBlp_7IIVFjrw4PExEdEPJPW8Qojwws3efqxRuoWHnj7sbQgymxGvE4poeZVa7ebDplkwt_aeyUF3kYCP4zpsq7cY8BTOfqpwX9Ywnnr2xwDg', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x108b20240>, 'refresh_token': '3PK1vZuaHOkTxoA37/dpD9Eg6lfVHnizOloIPOcXDFC8jDjLBIWiTuBkoHzGJ2dasx4lEQfEN1LCOLgkWkUURDqeXSIOOVKaFjzIL/q7Rew='}
2015-08-18 11:35:18,872 oic.oic.provider:DEBUG user_info_response: {'email': 'diana@example.org', 'phone_number': '+46 90 7865000', 'nickname': 'Dina', 'email_verified': False, 'sub': '23cfbb0e65bf9791', 'name': 'Diana Krall', 'address': {'locality': 'Ume', 'country': 'Sweden', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187'}, 'family_name': 'Krall', 'given_name': 'Diana'}
2015-08-18 13:27:41,467 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA"}, {"kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA"}]}
2015-08-18 13:27:41,468 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "use": "sig", "y": "7ClLz6b1RsY36GAlKmDvIFEI12aOOH8qqQA-c3MLft4", "crv": "P-256", "x": "KBDwsEl2e6XuZ2t2b_NHgYiwDc_hqN2P0R4Q9LwCfXA", "kty": "EC"}]}
2015-08-18 13:27:41,469 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "use": "enc", "y": "wSIkKsutHNi9DG9KxKq9MR8hZI3LohDX0H1008MtFxA", "crv": "P-256", "x": "YTZh9faNUNeV8ZGmdqczwdPdSvw3yqNijAtgf2Lpej8", "kty": "EC"}]}
2015-08-18 13:27:41,469 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 13:28:02,252 oicServer:INFO callback: <function webfinger at 0x1055ed598>
2015-08-18 13:28:02,273 oicServer:INFO callback: <function op_info at 0x1055ed1e0>
2015-08-18 13:28:02,273 root:INFO op_info
2015-08-18 13:28:02,273 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 13:28:02,274 oic.oic.provider:INFO provider_info_response: {'claims_parameter_supported': True, 'request_parameter_supported': True, 'id_token_signing_alg_values_supported': ['HS384', 'none', 'HS512', 'PS384', 'ES256', 'RS256', 'HS256', 'RS384', 'ES512', 'PS512', 'ES384', 'PS256', 'RS512'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'version': '3.0', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'request_object_signing_alg_values_supported': ['HS384', 'none', 'HS512', 'PS384', 'ES256', 'RS256', 'HS256', 'RS384', 'ES512', 'PS512', 'ES384', 'PS256', 'RS512'], 'userinfo_signing_alg_values_supported': ['HS384', 'none', 'HS512', 'PS384', 'ES256', 'RS256', 'HS256', 'RS384', 'ES512', 'PS512', 'ES384', 'PS256', 'RS512'], 'require_request_uri_registration': True, 'request_uri_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['zoneinfo', 'sub', 'given_name', 'gender', 'nickname', 'email', 'name', 'birthdate', 'phone_number', 'email_verified', 'locale', 'profile', 'picture', 'preferred_username', 'updated_at', 'phone_number_verified', 'middle_name', 'family_name', 'website', 'address'], 'subject_types_supported': ['public', 'pairwise'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'HS512', 'PS384', 'ES256', 'RS256', 'HS256', 'RS384', 'ES512', 'PS512', 'ES384', 'PS256', 'RS512'], 'registration_endpoint': 'https://localhost:8092/registration', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'token_endpoint': 'https://localhost:8092/token', 'scopes_supported': ['offline_access', 'openid', 'profile', 'phone', 'address', 'email', 'openid'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-18 13:28:02,453 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105644a20>
2015-08-18 13:28:02,454 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "response_types": ["code"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 13:28:02,455 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 13:28:02,465 oic.oic.provider:DEBUG _cinfo: {'client_secret': '053c5b81f1a5ab29f0d02f910e20a634c6cefdf87ef14ea81bb204da', 'registration_access_token': '10mM2WuBwIacKogcy0DDy5R4Y6OERWPH', 'client_secret_expires_at': 1439980082, 'client_id': '7manymkIxPHD', 'registration_client_uri': 'https://localhost:8092/registration?client_id=7manymkIxPHD', 'client_id_issued_at': 1439893682}
2015-08-18 13:28:02,468 oic.utils.keyio:DEBUG loading keys for issuer: 7manymkIxPHD
2015-08-18 13:28:02,469 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 13:28:02,469 oic.oic.provider:DEBUG keys for 7manymkIxPHD: []
2015-08-18 13:28:02,472 oic.oic.provider:INFO Client info: {'client_secret': '053c5b81f1a5ab29f0d02f910e20a634c6cefdf87ef14ea81bb204da', 'registration_access_token': '10mM2WuBwIacKogcy0DDy5R4Y6OERWPH', 'client_secret_expires_at': 1439980082, 'client_id': '7manymkIxPHD', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=7manymkIxPHD', 'application_type': 'web', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439893682}
2015-08-18 13:28:02,473 oic.oic.provider:DEBUG registration_response: {'client_secret': '053c5b81f1a5ab29f0d02f910e20a634c6cefdf87ef14ea81bb204da', 'registration_access_token': '10mM2WuBwIacKogcy0DDy5R4Y6OERWPH', 'client_secret_expires_at': 1439980082, 'client_id': '7manymkIxPHD', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=7manymkIxPHD', 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439893682}
2015-08-18 13:28:02,492 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b7550>
2015-08-18 13:28:02,492 oic.oauth2.provider:DEBUG Request: 'state=XTsPWxKnTYHl0Kkw&response_type=code&client_id=7manymkIxPHD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&scope=openid+profile+email+address+phone&nonce=mxXdfA2o7CpeYKub'
2015-08-18 13:28:02,493 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3358>, <jwkest.jwk.RSAKey object at 0x1057c3208>, <jwkest.jwk.ECKey object at 0x1057c36a0>]
2015-08-18 13:28:02,494 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': '7manymkIxPHD', 'nonce': 'mxXdfA2o7CpeYKub', 'acr_values': 'SAML', 'state': 'XTsPWxKnTYHl0Kkw', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code'}
2015-08-18 13:28:02,496 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': '7manymkIxPHD', 'nonce': 'mxXdfA2o7CpeYKub', 'acr_values': 'SAML', 'state': 'XTsPWxKnTYHl0Kkw', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code'}
2015-08-18 13:28:02,498 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:28:02,498 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:28:02,498 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 13:28:02,499 oic.oauth2.provider:INFO No active authentication
2015-08-18 13:28:02,499 oic.utils.authn.user:INFO do_authentication argv: {'action': 'https://localhost:8092/verify', 'submit_text': 'Submit', 'login_title': 'Username', 'passwd_title': 'Password', 'acr': ['SAML'], 'logo_uri': '', 'title': 'User log in', 'login': '', 'query': 'state=XTsPWxKnTYHl0Kkw&response_type=code&client_id=7manymkIxPHD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&scope=openid+profile+email+address+phone&nonce=mxXdfA2o7CpeYKub', 'client_policy_title': 'Client Policy', 'policy_uri': '', 'tos_uri': '', 'password': ''}
2015-08-18 13:28:02,533 oicServer:INFO callback: <function css at 0x1055bf510>
2015-08-18 13:28:02,566 root:DEBUG unknown side: favicon.ico
2015-08-18 13:28:02,571 root:DEBUG unknown side: favicon.ico
2015-08-18 13:28:06,580 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10574a488>
2015-08-18 13:28:06,580 oic.utils.authn.user:DEBUG verify(query=state%3DXTsPWxKnTYHl0Kkw%26response_type%3Dcode%26client_id%3D7manymkIxPHD%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26acr_values%3DSAML%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26nonce%3DmxXdfA2o7CpeYKub&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 13:28:06,581 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['SAML']"], 'login': ['diana'], 'query': ['state=XTsPWxKnTYHl0Kkw&response_type=code&client_id=7manymkIxPHD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&scope=openid+profile+email+address+phone&nonce=mxXdfA2o7CpeYKub'], 'password': ['krall'], 'form.commit': ['Submit']}
2015-08-18 13:28:06,581 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-18 13:28:06,583 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'nonce': ['mxXdfA2o7CpeYKub'], 'acr_values': ['SAML'], 'response_type': ['code'], 'state': ['XTsPWxKnTYHl0Kkw'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone'], 'client_id': ['7manymkIxPHD']}
2015-08-18 13:28:06,606 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b7550>
2015-08-18 13:28:06,606 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&nonce=mxXdfA2o7CpeYKub&acr_values=SAML&response_type=code&state=XTsPWxKnTYHl0Kkw&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=7manymkIxPHD'
2015-08-18 13:28:06,607 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3358>, <jwkest.jwk.RSAKey object at 0x1057c3208>, <jwkest.jwk.ECKey object at 0x1057c36a0>]
2015-08-18 13:28:06,608 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'nonce': 'mxXdfA2o7CpeYKub', 'client_id': '7manymkIxPHD', 'acr_values': 'SAML', 'state': 'XTsPWxKnTYHl0Kkw', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code'}
2015-08-18 13:28:06,609 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'nonce': 'mxXdfA2o7CpeYKub', 'client_id': '7manymkIxPHD', 'acr_values': 'SAML', 'state': 'XTsPWxKnTYHl0Kkw', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code'}
2015-08-18 13:28:06,611 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:28:06,611 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:28:06,611 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 13:28:06,613 oic.oauth2.provider:INFO No active authentication
2015-08-18 13:28:06,613 oic.oic.provider:DEBUG - authenticated -
2015-08-18 13:28:06,613 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'client_id', 'acr_values', 'state', 'redirect_uri', 'response_type', 'scope', 'nonce']
2015-08-18 13:28:06,614 oic.utils.sdb:DEBUG uid2sid: {'diana': ['d10f34e84927172c41c3b48b0c7d907ce6122bacc00ca478a450b7d2']}
2015-08-18 13:28:06,615 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 13:28:06,615 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 13:28:06,618 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=7cMek10ncsG3amjK71ghBePDVsgKUcjWX8dGl4L5IN1XVppboptqWWQOk1y7AOc%2Be6t0jupmeJRVSS0N1x8A%2FzW6QCtzi643aKIV50iHlk4%3D&state=XTsPWxKnTYHl0Kkw&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 13:28:09,641 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055b75f8>
2015-08-18 13:32:33,532 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "kty": "RSA", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "kty": "RSA", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 13:32:33,532 root:INFO OC3 server keys: {"keys": [{"y": "kNW4eUBcwYQkOUXIzPpeAAnVJq5i3adzr881DA8j5GU", "kid": "op2", "kty": "EC", "x": "hRZY1kZXJ50F28YYBwLHo4ZeY-2FkIAjOXIZNKYp4OA", "crv": "P-256", "use": "sig"}]}
2015-08-18 13:32:33,533 root:INFO OC3 server keys: {"keys": [{"y": "wjzMJnhLfE-rbkwlZKFhEH7M9Rv23lZzGjhNZnIVBBQ", "kid": "op3", "kty": "EC", "x": "SNPcAeqGDSEEv_UhCZJXxyxYzISnNNUyoty8hBrn1hQ", "crv": "P-256", "use": "enc"}]}
2015-08-18 13:32:33,533 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 13:32:39,120 oicServer:INFO callback: <function webfinger at 0x1055ee6a8>
2015-08-18 13:32:39,139 oicServer:INFO callback: <function op_info at 0x1055ee2f0>
2015-08-18 13:32:39,139 root:INFO op_info
2015-08-18 13:32:48,935 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 13:32:48,936 oic.oic.provider:INFO provider_info_response: {'require_request_uri_registration': True, 'request_uri_parameter_supported': True, 'claims_parameter_supported': True, 'request_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['RS512', 'ES256', 'HS256', 'none', 'PS256', 'RS384', 'ES512', 'HS512', 'HS384', 'ES384', 'PS512', 'PS384', 'RS256'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'scopes_supported': ['phone', 'email', 'profile', 'openid', 'offline_access', 'address', 'openid'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_signing_alg_values_supported': ['RS512', 'ES256', 'HS256', 'none', 'PS256', 'RS384', 'ES512', 'HS512', 'HS384', 'ES384', 'PS512', 'PS384', 'RS256'], 'claims_supported': ['middle_name', 'email', 'phone_number', 'email_verified', 'name', 'family_name', 'birthdate', 'website', 'preferred_username', 'address', 'picture', 'nickname', 'profile', 'given_name', 'updated_at', 'gender', 'locale', 'zoneinfo', 'phone_number_verified', 'sub'], 'token_endpoint_auth_signing_alg_values_supported': ['RS512', 'ES256', 'HS256', 'PS256', 'RS384', 'ES512', 'HS512', 'HS384', 'ES384', 'PS512', 'PS384', 'RS256'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'version': '3.0', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint': 'https://localhost:8092/token', 'issuer': 'https://localhost:8092/', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['RS512', 'ES256', 'HS256', 'none', 'PS256', 'RS384', 'ES512', 'HS512', 'HS384', 'ES384', 'PS512', 'PS384', 'RS256'], 'subject_types_supported': ['public', 'pairwise'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'acr_values_supported': ['PASSWORD'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-18 13:32:49,004 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x1056438d0>
2015-08-18 13:32:51,756 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "response_types": ["code"], "contacts": ["ops@example.com"], "application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 13:32:51,757 oic.oic.provider:INFO registration_request:{'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 13:32:51,764 oic.oic.provider:DEBUG _cinfo: {'registration_client_uri': 'https://localhost:8092/registration?client_id=xBfuyYpcKTDv', 'client_secret_expires_at': 1439980371, 'registration_access_token': 'cto9cC8pPn8mc3SwbGadccxrKVffHnCy', 'client_id': 'xBfuyYpcKTDv', 'client_id_issued_at': 1439893971, 'client_secret': 'fdb95a0718e52019318f5e9e9375569c5db415dc1b550c31287289c4'}
2015-08-18 13:32:51,765 oic.utils.keyio:DEBUG loading keys for issuer: xBfuyYpcKTDv
2015-08-18 13:32:51,765 oic.utils.keyio:DEBUG pcr: {'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 13:32:51,766 oic.oic.provider:DEBUG keys for xBfuyYpcKTDv: []
2015-08-18 13:32:51,768 oic.oic.provider:INFO Client info: {'registration_client_uri': 'https://localhost:8092/registration?client_id=xBfuyYpcKTDv', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'application_type': 'web', 'client_secret_expires_at': 1439980371, 'response_types': ['code'], 'registration_access_token': 'cto9cC8pPn8mc3SwbGadccxrKVffHnCy', 'client_id': 'xBfuyYpcKTDv', 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439893971, 'client_secret': 'fdb95a0718e52019318f5e9e9375569c5db415dc1b550c31287289c4'}
2015-08-18 13:32:51,768 oic.oic.provider:DEBUG registration_response: {'registration_client_uri': 'https://localhost:8092/registration?client_id=xBfuyYpcKTDv', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'client_secret_expires_at': 1439980371, 'response_types': ['code'], 'registration_access_token': 'cto9cC8pPn8mc3SwbGadccxrKVffHnCy', 'client_id': 'xBfuyYpcKTDv', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_id_issued_at': 1439893971, 'client_secret': 'fdb95a0718e52019318f5e9e9375569c5db415dc1b550c31287289c4'}
2015-08-18 13:32:51,784 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf400>
2015-08-18 13:32:53,626 oic.oauth2.provider:DEBUG Request: 'response_type=code&nonce=ivQq5VbN1qYMrO81&client_id=xBfuyYpcKTDv&scope=openid+profile+email+address+phone&state=rzOQopuOExTfmYVP&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML'
2015-08-18 13:32:53,627 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x108a20ba8>, <jwkest.jwk.RSAKey object at 0x1057c20b8>, <jwkest.jwk.ECKey object at 0x1057c24e0>]
2015-08-18 13:32:53,628 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'rzOQopuOExTfmYVP', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xBfuyYpcKTDv', 'nonce': 'ivQq5VbN1qYMrO81', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 13:32:53,630 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'rzOQopuOExTfmYVP', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xBfuyYpcKTDv', 'nonce': 'ivQq5VbN1qYMrO81', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 13:32:53,632 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:32:53,632 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:32:53,632 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 13:32:53,633 oic.oauth2.provider:INFO No active authentication
2015-08-18 13:32:53,634 oic.utils.authn.user:INFO do_authentication argv: {'title': 'User log in', 'logo_uri': '', 'login_title': 'Username', 'passwd_title': 'Password', 'tos_uri': '', 'query': 'response_type=code&nonce=ivQq5VbN1qYMrO81&client_id=xBfuyYpcKTDv&scope=openid+profile+email+address+phone&state=rzOQopuOExTfmYVP&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML', 'client_policy_title': 'Client Policy', 'login': '', 'password': '', 'policy_uri': '', 'acr': ['SAML'], 'submit_text': 'Submit', 'action': 'https://localhost:8092/verify'}
2015-08-18 13:32:53,650 oicServer:INFO callback: <function css at 0x1055bd620>
2015-08-18 13:33:00,434 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105747598>
2015-08-18 13:33:00,434 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26nonce%3DivQq5VbN1qYMrO81%26client_id%3DxBfuyYpcKTDv%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3DrzOQopuOExTfmYVP%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26acr_values%3DSAML&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 13:33:00,435 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'password': ['krall'], 'form.commit': ['Submit'], 'acr_values': ["['SAML']"], 'query': ['response_type=code&nonce=ivQq5VbN1qYMrO81&client_id=xBfuyYpcKTDv&scope=openid+profile+email+address+phone&state=rzOQopuOExTfmYVP&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML']}
2015-08-18 13:33:00,435 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 13:33:00,437 oic.utils.authn.user:DEBUG kwargs: {'state': ['rzOQopuOExTfmYVP'], 'upm_answer': 'true', 'scope': ['openid profile email address phone'], 'response_type': ['code'], 'client_id': ['xBfuyYpcKTDv'], 'nonce': ['ivQq5VbN1qYMrO81'], 'acr_values': ['SAML'], 'redirect_uri': ['http://localhost:8666/authz_cb']}
2015-08-18 13:33:00,459 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf400>
2015-08-18 13:33:34,905 oic.oauth2.provider:DEBUG Request: 'state=rzOQopuOExTfmYVP&upm_answer=true&scope=openid+profile+email+address+phone&response_type=code&client_id=xBfuyYpcKTDv&nonce=ivQq5VbN1qYMrO81&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 13:33:34,906 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x108a20ba8>, <jwkest.jwk.RSAKey object at 0x1057c20b8>, <jwkest.jwk.ECKey object at 0x1057c24e0>]
2015-08-18 13:33:34,907 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'rzOQopuOExTfmYVP', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xBfuyYpcKTDv', 'nonce': 'ivQq5VbN1qYMrO81', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 13:33:34,909 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'rzOQopuOExTfmYVP', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xBfuyYpcKTDv', 'nonce': 'ivQq5VbN1qYMrO81', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 13:33:34,912 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:33:34,912 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:33:34,912 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 13:33:34,913 oic.oauth2.provider:INFO No active authentication
2015-08-18 13:33:34,914 oic.oic.provider:DEBUG - authenticated -
2015-08-18 13:33:34,914 oic.oic.provider:DEBUG AREQ keys: ['state', 'upm_answer', 'scope', 'response_type', 'client_id', 'nonce', 'acr_values', 'redirect_uri']
2015-08-18 13:33:34,915 oic.utils.sdb:DEBUG uid2sid: {'diana': ['b97196885614d73ed8e4f4c83fadb7a090017c1399a2b98e1a2b1967']}
2015-08-18 13:33:34,915 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 13:33:34,916 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 13:33:34,919 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=rzOQopuOExTfmYVP&code=hTYL%2FhrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go%2B26woeXR6R1qcHdQF7RYwhveh6pXXF8jvz1ESfDw49IPAKfrfRC28%2Bj5zo%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 13:34:00,419 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055bf4a8>
2015-08-18 13:34:51,939 oic.oic.provider:DEBUG - token -
2015-08-18 13:34:51,940 oic.oic.provider:INFO token_request: grant_type=authorization_code&code=hTYL%2FhrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go%2B26woeXR6R1qcHdQF7RYwhveh6pXXF8jvz1ESfDw49IPAKfrfRC28%2Bj5zo%3D&key=eyJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInVzZSI6ICJzaWcifQ%3D%3D&client_secret=fdb95a0718e52019318f5e9e9375569c5db415dc1b550c31287289c4&client_id=xBfuyYpcKTDv&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&token_type=pop
2015-08-18 13:34:51,941 oic.oic.provider:DEBUG AccessTokenRequest: {'key': 'eyJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInVzZSI6ICJzaWcifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'xBfuyYpcKTDv', 'code': 'hTYL/hrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go+26woeXR6R1qcHdQF7RYwhveh6pXXF8jvz1ESfDw49IPAKfrfRC28+j5zo=', 'token_type': 'pop', 'grant_type': 'authorization_code', 'client_secret': 'fdb95a0718e52019318f5e9e9375569c5db415dc1b550c31287289c4'}
2015-08-18 13:34:51,942 oic.utils.authn.client:DEBUG REQ: {'key': 'eyJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImUiOiAiQVFBQiIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInVzZSI6ICJzaWcifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'xBfuyYpcKTDv', 'code': 'hTYL/hrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go+26woeXR6R1qcHdQF7RYwhveh6pXXF8jvz1ESfDw49IPAKfrfRC28+j5zo=', 'token_type': 'pop', 'grant_type': 'authorization_code', 'client_secret': 'fdb95a0718e52019318f5e9e9375569c5db415dc1b550c31287289c4'}
2015-08-18 13:34:51,943 oic.utils.authn.client:DEBUG Verified Client ID: xBfuyYpcKTDv
2015-08-18 13:34:51,946 oic.oic.provider:DEBUG All checks OK
2015-08-18 13:34:51,948 oic.oic:DEBUG authzreq: {'state': 'rzOQopuOExTfmYVP', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xBfuyYpcKTDv', 'nonce': 'ivQq5VbN1qYMrO81', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 13:34:51,948 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 13:34:51,948 oic.oic:DEBUG authzreq: {'state': 'rzOQopuOExTfmYVP', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'response_type': 'code', 'client_id': 'xBfuyYpcKTDv', 'nonce': 'ivQq5VbN1qYMrO81', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 13:34:51,949 oic.oic.provider:DEBUG id_token: {'nonce': 'ivQq5VbN1qYMrO81', 'exp': 1439976891, 'iat': 1439897691, 'aud': ['xBfuyYpcKTDv'], 'auth_time': 1439897580, 'iss': 'https://localhost:8092/', 'sub': '4ab86cbf335b199e', 'acr': 'PASSWORD'}
2015-08-18 13:34:51,951 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "kty": "RSA", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "kty": "RSA", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 13:34:51,952 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "kNW4eUBcwYQkOUXIzPpeAAnVJq5i3adzr881DA8j5GU", "kid": "op2", "kty": "EC", "x": "hRZY1kZXJ50F28YYBwLHo4ZeY-2FkIAjOXIZNKYp4OA", "crv": "P-256", "use": "sig"}]}
2015-08-18 13:34:51,953 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "wjzMJnhLfE-rbkwlZKFhEH7M9Rv23lZzGjhNZnIVBBQ", "kid": "op3", "kty": "EC", "x": "SNPcAeqGDSEEv_UhCZJXxyxYzISnNNUyoty8hBrn1hQ", "crv": "P-256", "use": "enc"}]}
2015-08-18 13:34:51,953 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c20b8>]
2015-08-18 13:34:51,966 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 13:34:51,967 oic.oic.provider:DEBUG _tinfo: {'state': 'rzOQopuOExTfmYVP', 'permission': '', 'access_token_scope': '?', 'access_token': 'hTYL/hrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go+26woeXR6R1qcHdQ3pg1na6QQhM04knX2WmO2MMe9Csx2lVvj3q9HL6qtc=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'redirect_uri': 'http://localhost:8666/authz_cb', 'authzreq': '{"state": "rzOQopuOExTfmYVP", "upm_answer": "true", "scope": "openid profile email address phone", "response_type": "code", "client_id": "xBfuyYpcKTDv", "nonce": "ivQq5VbN1qYMrO81", "acr_values": "SAML", "redirect_uri": "http://localhost:8666/authz_cb"}', 'client_id': 'xBfuyYpcKTDv', 'revoked': False, 'token_type': 'Bearer', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x108a3df98>, 'token_expires_at': 1439897691, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJpdlFxNVZiTjFxWU1yTzgxIiwgImV4cCI6IDE0Mzk5NzY4OTEsICJpYXQiOiAxNDM5ODk3NjkxLCAiYXVkIjogWyJ4QmZ1eVlwY0tURHYiXSwgImF1dGhfdGltZSI6IDE0Mzk4OTc1ODAsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAic3ViIjogIjRhYjg2Y2JmMzM1YjE5OWUiLCAiYWNyIjogIlBBU1NXT1JEIn0.Vj1ZM_8GXzmskAZgLzFOeMplKf3KzxHUMdvg_ffeFAPxGWmqigsrPJ9MMhzw-yKfDgfsd5ECI6OLCcuNVErILe3bCvZ59Aj17xhNBWzv1-rpDXm6T_jEPag-jvQAEFJ7pBtuo-kQo8xhKOhXwJU6rLN8rq0a685mqGFzGMZPzdX-81bDWQTZj1cwGxlrXoacQYH4GdkyNsQL7cCbKdxvgAvgquJB3DdvCkM5P5tySNvCPcLyJNzMtaq2fXSdyBAq6F4iaLWKmeK2gYo8pXt_8gVF3PwrzOj_CujYHfnPQnGLThlw-AenkSXYl0wLKcIAreJwjyXBxcnJNk0w0WrPdA', 'expires_in': 3600, 'refresh_token': 'hTYL/hrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go+26woeXR6R1qcHdn+OYZm1J0xXEER3BGciigsYkaTEPSNUUUJASbB6A2hk=', 'code': 'hTYL/hrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go+26woeXR6R1qcHdQF7RYwhveh6pXXF8jvz1ESfDw49IPAKfrfRC28+j5zo=', 'code_used': True, 'nonce': 'ivQq5VbN1qYMrO81', 'sub': '4ab86cbf335b199e', 'oauth_state': 'token'}
2015-08-18 13:34:51,967 oic.oic.provider:DEBUG access_token_response: {'state': 'rzOQopuOExTfmYVP', 'expires_in': 3600, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJpdlFxNVZiTjFxWU1yTzgxIiwgImV4cCI6IDE0Mzk5NzY4OTEsICJpYXQiOiAxNDM5ODk3NjkxLCAiYXVkIjogWyJ4QmZ1eVlwY0tURHYiXSwgImF1dGhfdGltZSI6IDE0Mzk4OTc1ODAsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAic3ViIjogIjRhYjg2Y2JmMzM1YjE5OWUiLCAiYWNyIjogIlBBU1NXT1JEIn0.Vj1ZM_8GXzmskAZgLzFOeMplKf3KzxHUMdvg_ffeFAPxGWmqigsrPJ9MMhzw-yKfDgfsd5ECI6OLCcuNVErILe3bCvZ59Aj17xhNBWzv1-rpDXm6T_jEPag-jvQAEFJ7pBtuo-kQo8xhKOhXwJU6rLN8rq0a685mqGFzGMZPzdX-81bDWQTZj1cwGxlrXoacQYH4GdkyNsQL7cCbKdxvgAvgquJB3DdvCkM5P5tySNvCPcLyJNzMtaq2fXSdyBAq6F4iaLWKmeK2gYo8pXt_8gVF3PwrzOj_CujYHfnPQnGLThlw-AenkSXYl0wLKcIAreJwjyXBxcnJNk0w0WrPdA', 'access_token': 'hTYL/hrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go+26woeXR6R1qcHdQ3pg1na6QQhM04knX2WmO2MMe9Csx2lVvj3q9HL6qtc=', 'scope': 'openid profile email address phone', 'refresh_token': 'hTYL/hrmKt5rkMuEjMyS2G0Q3RV1uT8NMMmN9Yo2pwqykd5Go+26woeXR6R1qcHdn+OYZm1J0xXEER3BGciigsYkaTEPSNUUUJASbB6A2hk=', 'token_type': 'Bearer'}
2015-08-18 13:34:58,993 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 13:35:13,000 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 13:41:09,641 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 13:41:09,642 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kid": "op2", "crv": "P-256", "kty": "EC", "x": "-6CEy-yhUoGedMs3d8kKRdGsnCsQBOGP3gup6SxYLIo", "y": "k2h2Gvaadj7HU7q1D_jj-qolNY_AlK_XNRiLMbAYhIY"}]}
2015-08-18 13:41:09,642 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op3", "crv": "P-256", "kty": "EC", "x": "EYB-uMDmNa2WhMqZop3TVn02UEf3N5dnnlkK-JHNvMQ", "y": "aFZ6IdyMQiiwipOXDGbrDD-_DAcM_Ziv6gqnzAOu0E4"}]}
2015-08-18 13:41:09,642 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 13:42:38,309 oicServer:INFO callback: <function webfinger at 0x1054e46a8>
2015-08-18 13:42:38,328 oicServer:INFO callback: <function op_info at 0x1054e42f0>
2015-08-18 13:42:38,328 root:INFO op_info
2015-08-18 13:42:40,520 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 13:42:40,522 oic.oic.provider:INFO provider_info_response: {'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_signing_alg_values_supported': ['HS384', 'HS256', 'HS512', 'PS384', 'RS512', 'PS256', 'ES256', 'none', 'RS384', 'ES384', 'PS512', 'ES512', 'RS256'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'HS256', 'HS512', 'PS384', 'RS512', 'PS256', 'ES256', 'RS384', 'ES384', 'PS512', 'ES512', 'RS256'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_uri_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'claims_parameter_supported': True, 'scopes_supported': ['phone', 'openid', 'address', 'offline_access', 'profile', 'email', 'openid'], 'id_token_signing_alg_values_supported': ['HS384', 'HS256', 'HS512', 'PS384', 'RS512', 'PS256', 'ES256', 'none', 'RS384', 'ES384', 'PS512', 'ES512', 'RS256'], 'registration_endpoint': 'https://localhost:8092/registration', 'claims_supported': ['updated_at', 'email', 'gender', 'given_name', 'preferred_username', 'phone_number', 'name', 'middle_name', 'profile', 'family_name', 'birthdate', 'email_verified', 'sub', 'website', 'zoneinfo', 'picture', 'address', 'nickname', 'locale', 'phone_number_verified'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'subject_types_supported': ['public', 'pairwise'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'version': '3.0', 'userinfo_signing_alg_values_supported': ['HS384', 'HS256', 'HS512', 'PS384', 'RS512', 'PS256', 'ES256', 'none', 'RS384', 'ES384', 'PS512', 'ES512', 'RS256'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'acr_values_supported': ['PASSWORD'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_parameter_supported': True, 'require_request_uri_registration': True, 'token_endpoint': 'https://localhost:8092/token'}
2015-08-18 13:42:40,592 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105643908>
2015-08-18 13:42:41,038 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "response_types": ["code"], "redirect_uris": ["http://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 13:42:41,039 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'response_types': ['code']}
2015-08-18 13:42:41,045 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'URO5x5AyCOleM3YQ4nYiSPFlYzIVfLCk', 'client_id': 'JPqbhClLkbO4', 'client_secret': '0b936a2d42124e0ef6fd78a20c422b4355deecdd4135b6c518aa6822', 'client_id_issued_at': 1439894561, 'client_secret_expires_at': 1439980961, 'registration_client_uri': 'https://localhost:8092/registration?client_id=JPqbhClLkbO4'}
2015-08-18 13:42:41,047 oic.utils.keyio:DEBUG loading keys for issuer: JPqbhClLkbO4
2015-08-18 13:42:41,047 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'response_types': ['code']}
2015-08-18 13:42:41,048 oic.oic.provider:DEBUG keys for JPqbhClLkbO4: []
2015-08-18 13:42:41,051 oic.oic.provider:INFO Client info: {'registration_access_token': 'URO5x5AyCOleM3YQ4nYiSPFlYzIVfLCk', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_id': 'JPqbhClLkbO4', 'application_type': 'web', 'client_secret': '0b936a2d42124e0ef6fd78a20c422b4355deecdd4135b6c518aa6822', 'client_id_issued_at': 1439894561, 'client_secret_expires_at': 1439980961, 'registration_client_uri': 'https://localhost:8092/registration?client_id=JPqbhClLkbO4'}
2015-08-18 13:42:41,051 oic.oic.provider:DEBUG registration_response: {'registration_access_token': 'URO5x5AyCOleM3YQ4nYiSPFlYzIVfLCk', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=JPqbhClLkbO4', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'client_id': 'JPqbhClLkbO4', 'application_type': 'web', 'client_secret': '0b936a2d42124e0ef6fd78a20c422b4355deecdd4135b6c518aa6822', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_secret_expires_at': 1439980961, 'client_id_issued_at': 1439894561}
2015-08-18 13:42:41,068 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054b5438>
2015-08-18 13:42:41,494 oic.oauth2.provider:DEBUG Request: 'client_id=JPqbhClLkbO4&response_type=code&state=HkPTxksMwS3JvZbO&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Zi03XzBrWR8LxI0y&scope=openid+profile+email+address+phone'
2015-08-18 13:42:41,495 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x108a1f668>, <jwkest.jwk.RSAKey object at 0x1057c00f0>, <jwkest.jwk.ECKey object at 0x1057c04a8>]
2015-08-18 13:42:41,495 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'JPqbhClLkbO4', 'nonce': 'Zi03XzBrWR8LxI0y', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'state': 'HkPTxksMwS3JvZbO'}
2015-08-18 13:42:41,498 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'JPqbhClLkbO4', 'nonce': 'Zi03XzBrWR8LxI0y', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'state': 'HkPTxksMwS3JvZbO'}
2015-08-18 13:42:41,500 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:42:41,501 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:42:41,501 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 13:42:41,501 oic.oauth2.provider:INFO No active authentication
2015-08-18 13:42:41,502 oic.utils.authn.user:INFO do_authentication argv: {'acr': ['SAML'], 'passwd_title': 'Password', 'login': '', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'logo_uri': '', 'login_title': 'Username', 'submit_text': 'Submit', 'password': '', 'client_policy_title': 'Client Policy', 'tos_uri': '', 'policy_uri': '', 'query': 'client_id=JPqbhClLkbO4&response_type=code&state=HkPTxksMwS3JvZbO&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Zi03XzBrWR8LxI0y&scope=openid+profile+email+address+phone'}
2015-08-18 13:42:41,518 oicServer:INFO callback: <function css at 0x1054b3620>
2015-08-18 13:42:49,100 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105748598>
2015-08-18 13:42:49,100 oic.utils.authn.user:DEBUG verify(query=client_id%3DJPqbhClLkbO4%26response_type%3Dcode%26state%3DHkPTxksMwS3JvZbO%26acr_values%3DSAML%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3DZi03XzBrWR8LxI0y%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 13:42:49,101 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['SAML']"], 'form.commit': ['Submit'], 'login': ['diana'], 'password': ['krall'], 'query': ['client_id=JPqbhClLkbO4&response_type=code&state=HkPTxksMwS3JvZbO&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Zi03XzBrWR8LxI0y&scope=openid+profile+email+address+phone']}
2015-08-18 13:42:49,101 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-18 13:42:49,103 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'upm_answer': 'true', 'redirect_uri': ['http://localhost:8666/authz_cb'], 'client_id': ['JPqbhClLkbO4'], 'nonce': ['Zi03XzBrWR8LxI0y'], 'scope': ['openid profile email address phone'], 'response_type': ['code'], 'state': ['HkPTxksMwS3JvZbO']}
2015-08-18 13:42:49,126 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054b5438>
2015-08-18 13:42:49,127 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&upm_answer=true&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=JPqbhClLkbO4&nonce=Zi03XzBrWR8LxI0y&scope=openid+profile+email+address+phone&response_type=code&state=HkPTxksMwS3JvZbO'
2015-08-18 13:42:49,127 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x108a1f668>, <jwkest.jwk.RSAKey object at 0x1057c00f0>, <jwkest.jwk.ECKey object at 0x1057c04a8>]
2015-08-18 13:42:49,128 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'Zi03XzBrWR8LxI0y', 'scope': 'openid profile email address phone', 'client_id': 'JPqbhClLkbO4', 'state': 'HkPTxksMwS3JvZbO'}
2015-08-18 13:42:49,129 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'Zi03XzBrWR8LxI0y', 'scope': 'openid profile email address phone', 'client_id': 'JPqbhClLkbO4', 'state': 'HkPTxksMwS3JvZbO'}
2015-08-18 13:42:49,131 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:42:49,131 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 13:42:49,132 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 13:42:49,132 oic.oauth2.provider:INFO No active authentication
2015-08-18 13:42:49,133 oic.oic.provider:DEBUG - authenticated -
2015-08-18 13:42:49,133 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'upm_answer', 'client_id', 'redirect_uri', 'nonce', 'scope', 'response_type', 'state']
2015-08-18 13:42:49,134 oic.utils.sdb:DEBUG uid2sid: {'diana': ['c03919917f70ce88f4bfa34c04d8151f3084566f5558a99ccd7a9588']}
2015-08-18 13:42:49,134 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 13:42:49,134 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 13:42:49,137 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77%2BGfRl91bEnPyS3YN%2B%2FWYbRJpxdCx3WC%2FDV3qAp8EmB0ihgO%2FkboI6GepzHAsm%2FMiKXy2g%3D&scope=openid+profile+email+address+phone&state=HkPTxksMwS3JvZbO' (<class 'str'>)
2015-08-18 13:42:51,679 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054b54e0>
2015-08-18 13:42:52,873 oic.oic.provider:DEBUG - token -
2015-08-18 13:42:52,873 oic.oic.provider:INFO token_request: client_id=JPqbhClLkbO4&client_secret=0b936a2d42124e0ef6fd78a20c422b4355deecdd4135b6c518aa6822&code=DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77%2BGfRl91bEnPyS3YN%2B%2FWYbRJpxdCx3WC%2FDV3qAp8EmB0ihgO%2FkboI6GepzHAsm%2FMiKXy2g%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&key=eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&grant_type=authorization_code&token_type=pop
2015-08-18 13:42:52,875 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77+GfRl91bEnPyS3YN+/WYbRJpxdCx3WC/DV3qAp8EmB0ihgO/kboI6GepzHAsm/MiKXy2g=', 'key': 'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'client_id': 'JPqbhClLkbO4', 'grant_type': 'authorization_code', 'client_secret': '0b936a2d42124e0ef6fd78a20c422b4355deecdd4135b6c518aa6822', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_type': 'pop'}
2015-08-18 13:42:52,875 oic.utils.authn.client:DEBUG REQ: {'code': 'DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77+GfRl91bEnPyS3YN+/WYbRJpxdCx3WC/DV3qAp8EmB0ihgO/kboI6GepzHAsm/MiKXy2g=', 'key': 'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'client_id': 'JPqbhClLkbO4', 'grant_type': 'authorization_code', 'client_secret': '0b936a2d42124e0ef6fd78a20c422b4355deecdd4135b6c518aa6822', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_type': 'pop'}
2015-08-18 13:42:52,877 oic.utils.authn.client:DEBUG Verified Client ID: JPqbhClLkbO4
2015-08-18 13:42:52,880 oic.oic.provider:DEBUG All checks OK
2015-08-18 13:42:52,882 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'upm_answer': 'true', 'client_id': 'JPqbhClLkbO4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'Zi03XzBrWR8LxI0y', 'scope': 'openid profile email address phone', 'response_type': 'code', 'state': 'HkPTxksMwS3JvZbO'}
2015-08-18 13:42:52,883 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 13:42:52,883 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'upm_answer': 'true', 'client_id': 'JPqbhClLkbO4', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'Zi03XzBrWR8LxI0y', 'scope': 'openid profile email address phone', 'response_type': 'code', 'state': 'HkPTxksMwS3JvZbO'}
2015-08-18 13:42:52,884 oic.oic.provider:DEBUG id_token: {'acr': 'PASSWORD', 'sub': '-7d3056634afd48c5', 'iat': 1439898172, 'iss': 'https://localhost:8092/', 'nonce': 'Zi03XzBrWR8LxI0y', 'aud': ['JPqbhClLkbO4'], 'auth_time': 1439898169, 'exp': 1439977372}
2015-08-18 13:42:52,886 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 13:42:52,887 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "kid": "op2", "crv": "P-256", "kty": "EC", "x": "-6CEy-yhUoGedMs3d8kKRdGsnCsQBOGP3gup6SxYLIo", "y": "k2h2Gvaadj7HU7q1D_jj-qolNY_AlK_XNRiLMbAYhIY"}]}
2015-08-18 13:42:52,887 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "kid": "op3", "crv": "P-256", "kty": "EC", "x": "EYB-uMDmNa2WhMqZop3TVn02UEf3N5dnnlkK-JHNvMQ", "y": "aFZ6IdyMQiiwipOXDGbrDD-_DAcM_Ziv6gqnzAOu0E4"}]}
2015-08-18 13:42:52,888 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c00f0>]
2015-08-18 13:42:52,896 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 13:42:52,897 oic.oic.provider:DEBUG _tinfo: {'code': 'DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77+GfRl91bEnPyS3YN+/WYbRJpxdCx3WC/DV3qAp8EmB0ihgO/kboI6GepzHAsm/MiKXy2g=', 'sub': '-7d3056634afd48c5', 'revoked': False, 'code_used': True, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi03ZDMwNTY2MzRhZmQ0OGM1IiwgImlhdCI6IDE0Mzk4OTgxNzIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAibm9uY2UiOiAiWmkwM1h6QnJXUjhMeEkweSIsICJhdWQiOiBbIkpQcWJoQ2xMa2JPNCJdLCAiYXV0aF90aW1lIjogMTQzOTg5ODE2OSwgImV4cCI6IDE0Mzk5NzczNzJ9.zfpmHuaxc-QFHOJhcMKB6y2qowGKrb6a0nfiutvxsg1g_LT9h1AkNnP9YnrRo7mrAPKy5Xp150JK9K0oV4TAz5iW8mx45Iq8KMRnQU3_4WTBHCvHGL-nBMgh_g0XrGdH_qWfS4-BfAuIULhjrg5r36707OLHszszw9BTH8MMBKdBzaPBB-UcVhanCdpCrqWAE-LSwmQ5VUtGnGcaiOmnFRaIF9cpXUOghaPBbndwM02BYwTeEqMMjhXNxxNTcAtE4DEnBN2ZWmdYVA-7GaQJPVXZGx2u6OHYIKxRVoLMzHx0stodYB8Uh5YiB20ig2GoCi7oINix40MdL29wfyOwpg', 'expires_in': 3600, 'token_expires_at': 1439898172, 'token_type': 'Bearer', 'permission': '', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token_scope': '?', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057d7ef0>, 'state': 'HkPTxksMwS3JvZbO', 'authzreq': '{"acr_values": "SAML", "upm_answer": "true", "response_type": "code", "redirect_uri": "http://localhost:8666/authz_cb", "nonce": "Zi03XzBrWR8LxI0y", "scope": "openid profile email address phone", "client_id": "JPqbhClLkbO4", "state": "HkPTxksMwS3JvZbO"}', 'refresh_token': 'DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77+GfRl91bEnPyS3YN+/WYbRJpxdtGEM33DpbImlkwxet00qcMVBavmxM0OZ9emXSWINiQI=', 'oauth_state': 'token', 'access_token': 'DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77+GfRl91bEnPyS3YN+/WYbRJpxderJ0caDUJE72GdHpQNwQjaJ13s/wK3+fLRSGRI1CPv0=', 'client_id': 'JPqbhClLkbO4', 'nonce': 'Zi03XzBrWR8LxI0y', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 13:42:52,897 oic.oic.provider:DEBUG access_token_response: {'token_type': 'Bearer', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi03ZDMwNTY2MzRhZmQ0OGM1IiwgImlhdCI6IDE0Mzk4OTgxNzIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAibm9uY2UiOiAiWmkwM1h6QnJXUjhMeEkweSIsICJhdWQiOiBbIkpQcWJoQ2xMa2JPNCJdLCAiYXV0aF90aW1lIjogMTQzOTg5ODE2OSwgImV4cCI6IDE0Mzk5NzczNzJ9.zfpmHuaxc-QFHOJhcMKB6y2qowGKrb6a0nfiutvxsg1g_LT9h1AkNnP9YnrRo7mrAPKy5Xp150JK9K0oV4TAz5iW8mx45Iq8KMRnQU3_4WTBHCvHGL-nBMgh_g0XrGdH_qWfS4-BfAuIULhjrg5r36707OLHszszw9BTH8MMBKdBzaPBB-UcVhanCdpCrqWAE-LSwmQ5VUtGnGcaiOmnFRaIF9cpXUOghaPBbndwM02BYwTeEqMMjhXNxxNTcAtE4DEnBN2ZWmdYVA-7GaQJPVXZGx2u6OHYIKxRVoLMzHx0stodYB8Uh5YiB20ig2GoCi7oINix40MdL29wfyOwpg', 'expires_in': 3600, 'access_token': 'DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77+GfRl91bEnPyS3YN+/WYbRJpxderJ0caDUJE72GdHpQNwQjaJ13s/wK3+fLRSGRI1CPv0=', 'scope': 'openid profile email address phone', 'refresh_token': 'DS2DHYviMv0yTjRYACvXPISDQ2u2naXH6Q0N77+GfRl91bEnPyS3YN+/WYbRJpxdtGEM33DpbImlkwxet00qcMVBavmxM0OZ9emXSWINiQI=', 'state': 'HkPTxksMwS3JvZbO'}
2015-08-18 13:42:52,905 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 13:42:52,923 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:02:56,865 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kid": "op1", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 14:02:56,866 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "x": "oXpW1t7kzcm6bGhX369iz11PZUwiITW-7FQoXXzMzdY", "kty": "EC", "crv": "P-256", "use": "sig", "y": "LeAl0V_XJNn6pwnv8tGJNa5USPFJSf7NrSqTkW91QMQ"}]}
2015-08-18 14:02:56,866 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "x": "dN9Oh-KkgEBRPZRSU9LlKG9Jme2tilAbWnk-lknM38g", "kty": "EC", "crv": "P-256", "use": "enc", "y": "jRDNfn8gJE2zd1AZ0rvzIEzZtb0_WR2n5j99ocEwTrU"}]}
2015-08-18 14:02:56,867 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:03:00,394 oicServer:INFO callback: <function webfinger at 0x1054d46a8>
2015-08-18 14:03:00,413 oicServer:INFO callback: <function op_info at 0x1054d42f0>
2015-08-18 14:03:00,414 root:INFO op_info
2015-08-18 14:03:00,414 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:03:00,415 oic.oic.provider:INFO provider_info_response: {'request_object_signing_alg_values_supported': ['RS256', 'ES256', 'ES384', 'PS384', 'HS384', 'HS512', 'RS512', 'RS384', 'HS256', 'PS512', 'none', 'ES512', 'PS256'], 'request_uri_parameter_supported': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'claims_parameter_supported': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'token_endpoint': 'https://localhost:8092/token', 'require_request_uri_registration': True, 'claims_supported': ['nickname', 'picture', 'email_verified', 'phone_number', 'email', 'phone_number_verified', 'middle_name', 'website', 'name', 'locale', 'preferred_username', 'profile', 'zoneinfo', 'gender', 'birthdate', 'given_name', 'updated_at', 'family_name', 'address', 'sub'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'scopes_supported': ['phone', 'offline_access', 'email', 'address', 'openid', 'profile', 'openid'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'version': '3.0', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_signing_alg_values_supported': ['RS256', 'ES256', 'ES384', 'PS384', 'HS384', 'HS512', 'RS512', 'RS384', 'HS256', 'PS512', 'none', 'ES512', 'PS256'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['RS256', 'ES256', 'ES384', 'PS384', 'HS384', 'HS512', 'RS512', 'RS384', 'HS256', 'PS512', 'none', 'ES512', 'PS256'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'registration_endpoint': 'https://localhost:8092/registration', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['RS256', 'ES256', 'ES384', 'PS384', 'HS384', 'HS512', 'RS512', 'RS384', 'HS256', 'PS512', 'ES512', 'PS256'], 'response_modes_supported': ['query', 'fragment', 'form_post']}
2015-08-18 14:03:00,488 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105646908>
2015-08-18 14:03:00,489 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "response_types": ["code"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 14:03:00,490 oic.oic.provider:INFO registration_request:{'response_types': ['code'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:03:00,496 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'MS7w4eBPgIuKnWSK1GpdM183863ex2bs', 'registration_client_uri': 'https://localhost:8092/registration?client_id=LA6W7oW5PGsd', 'client_secret': '576b192cb2d164c731a7c2404785907607cbfdf0bdf5feaeb9a2727c', 'client_id_issued_at': 1439895780, 'client_secret_expires_at': 1439982180, 'client_id': 'LA6W7oW5PGsd'}
2015-08-18 14:03:00,497 oic.utils.keyio:DEBUG loading keys for issuer: LA6W7oW5PGsd
2015-08-18 14:03:00,498 oic.utils.keyio:DEBUG pcr: {'response_types': ['code'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:03:00,498 oic.oic.provider:DEBUG keys for LA6W7oW5PGsd: []
2015-08-18 14:03:00,500 oic.oic.provider:INFO Client info: {'response_types': ['code'], 'application_type': 'web', 'registration_access_token': 'MS7w4eBPgIuKnWSK1GpdM183863ex2bs', 'registration_client_uri': 'https://localhost:8092/registration?client_id=LA6W7oW5PGsd', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_secret': '576b192cb2d164c731a7c2404785907607cbfdf0bdf5feaeb9a2727c', 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439895780, 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_secret_expires_at': 1439982180, 'client_id': 'LA6W7oW5PGsd'}
2015-08-18 14:03:00,501 oic.oic.provider:DEBUG registration_response: {'response_types': ['code'], 'application_type': 'web', 'registration_access_token': 'MS7w4eBPgIuKnWSK1GpdM183863ex2bs', 'registration_client_uri': 'https://localhost:8092/registration?client_id=LA6W7oW5PGsd', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret': '576b192cb2d164c731a7c2404785907607cbfdf0bdf5feaeb9a2727c', 'contacts': ['ops@example.com'], 'client_id_issued_at': 1439895780, 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_secret_expires_at': 1439982180, 'client_id': 'LA6W7oW5PGsd'}
2015-08-18 14:03:00,517 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a5438>
2015-08-18 14:03:00,517 oic.oauth2.provider:DEBUG Request: 'response_type=code&acr_values=SAML&nonce=cQHTmtcVq4lG4lSe&client_id=LA6W7oW5PGsd&state=BVmsZGH2hpM3Ya6y&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 14:03:00,518 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f4240>, <jwkest.jwk.RSAKey object at 0x1057c20f0>, <jwkest.jwk.ECKey object at 0x1057c2588>]
2015-08-18 14:03:00,518 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'nonce': 'cQHTmtcVq4lG4lSe', 'state': 'BVmsZGH2hpM3Ya6y', 'response_type': 'code', 'client_id': 'LA6W7oW5PGsd', 'acr_values': 'SAML'}
2015-08-18 14:03:00,521 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'nonce': 'cQHTmtcVq4lG4lSe', 'state': 'BVmsZGH2hpM3Ya6y', 'response_type': 'code', 'client_id': 'LA6W7oW5PGsd', 'acr_values': 'SAML'}
2015-08-18 14:03:00,522 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:03:00,523 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:03:00,524 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:03:00,525 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:03:00,525 oic.utils.authn.user:INFO do_authentication argv: {'tos_uri': '', 'passwd_title': 'Password', 'logo_uri': '', 'query': 'response_type=code&acr_values=SAML&nonce=cQHTmtcVq4lG4lSe&client_id=LA6W7oW5PGsd&state=BVmsZGH2hpM3Ya6y&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'acr': ['SAML'], 'policy_uri': '', 'login_title': 'Username', 'submit_text': 'Submit', 'title': 'User log in', 'login': '', 'client_policy_title': 'Client Policy', 'password': '', 'action': 'https://localhost:8092/verify'}
2015-08-18 14:03:00,543 oicServer:INFO callback: <function css at 0x1054a3620>
2015-08-18 14:03:04,305 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105746598>
2015-08-18 14:03:04,305 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26acr_values%3DSAML%26nonce%3DcQHTmtcVq4lG4lSe%26client_id%3DLA6W7oW5PGsd%26state%3DBVmsZGH2hpM3Ya6y%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:03:04,306 oic.utils.authn.user:DEBUG dict: {'query': ['response_type=code&acr_values=SAML&nonce=cQHTmtcVq4lG4lSe&client_id=LA6W7oW5PGsd&state=BVmsZGH2hpM3Ya6y&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'], 'password': ['krall'], 'login': ['diana'], 'form.commit': ['Submit'], 'acr_values': ["['SAML']"]}
2015-08-18 14:03:04,306 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'babs': 'howes', 'diana': 'krall'}
2015-08-18 14:03:04,309 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'upm_answer': 'true', 'nonce': ['cQHTmtcVq4lG4lSe'], 'state': ['BVmsZGH2hpM3Ya6y'], 'response_type': ['code'], 'client_id': ['LA6W7oW5PGsd'], 'scope': ['openid profile email address phone']}
2015-08-18 14:03:04,328 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054a5438>
2015-08-18 14:03:04,328 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true&nonce=cQHTmtcVq4lG4lSe&state=BVmsZGH2hpM3Ya6y&response_type=code&client_id=LA6W7oW5PGsd&scope=openid+profile+email+address+phone'
2015-08-18 14:03:04,329 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f4240>, <jwkest.jwk.RSAKey object at 0x1057c20f0>, <jwkest.jwk.ECKey object at 0x1057c2588>]
2015-08-18 14:03:04,329 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'nonce': 'cQHTmtcVq4lG4lSe', 'state': 'BVmsZGH2hpM3Ya6y', 'response_type': 'code', 'client_id': 'LA6W7oW5PGsd', 'acr_values': 'SAML'}
2015-08-18 14:03:04,331 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'nonce': 'cQHTmtcVq4lG4lSe', 'state': 'BVmsZGH2hpM3Ya6y', 'response_type': 'code', 'client_id': 'LA6W7oW5PGsd', 'acr_values': 'SAML'}
2015-08-18 14:03:04,333 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:03:04,333 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:03:04,334 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:03:04,334 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:03:04,335 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:03:04,335 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'redirect_uri', 'upm_answer', 'nonce', 'state', 'response_type', 'client_id', 'scope']
2015-08-18 14:03:04,336 oic.utils.sdb:DEBUG uid2sid: {'diana': ['6f485391a3787af793aeb31af986e74ccf04f732e4fc3ef0eec88e59']}
2015-08-18 14:03:04,336 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:03:04,337 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:03:04,341 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=14SV1mCWkynoUdHV%2B3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqnLtnC0a7Rb8RNwyoX5D45COQMLl%2BAsz3122z6wsz%2FAM%3D&state=BVmsZGH2hpM3Ya6y&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 14:03:07,550 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054a54e0>
2015-08-18 14:03:10,415 oic.oic.provider:DEBUG - token -
2015-08-18 14:03:10,415 oic.oic.provider:INFO token_request: grant_type=authorization_code&key=eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ%3D%3D&client_secret=576b192cb2d164c731a7c2404785907607cbfdf0bdf5feaeb9a2727c&token_type=pop&code=14SV1mCWkynoUdHV%2B3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqnLtnC0a7Rb8RNwyoX5D45COQMLl%2BAsz3122z6wsz%2FAM%3D&client_id=LA6W7oW5PGsd&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-18 14:03:10,416 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'key': 'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'client_secret': '576b192cb2d164c731a7c2404785907607cbfdf0bdf5feaeb9a2727c', 'code': '14SV1mCWkynoUdHV+3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqnLtnC0a7Rb8RNwyoX5D45COQMLl+Asz3122z6wsz/AM=', 'client_id': 'LA6W7oW5PGsd', 'token_type': 'pop'}
2015-08-18 14:03:10,417 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'key': 'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'client_secret': '576b192cb2d164c731a7c2404785907607cbfdf0bdf5feaeb9a2727c', 'code': '14SV1mCWkynoUdHV+3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqnLtnC0a7Rb8RNwyoX5D45COQMLl+Asz3122z6wsz/AM=', 'client_id': 'LA6W7oW5PGsd', 'token_type': 'pop'}
2015-08-18 14:03:10,418 oic.utils.authn.client:DEBUG Verified Client ID: LA6W7oW5PGsd
2015-08-18 14:03:10,422 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:03:10,424 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'cQHTmtcVq4lG4lSe', 'state': 'BVmsZGH2hpM3Ya6y', 'response_type': 'code', 'client_id': 'LA6W7oW5PGsd', 'scope': 'openid profile email address phone'}
2015-08-18 14:03:10,424 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:03:10,425 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'cQHTmtcVq4lG4lSe', 'state': 'BVmsZGH2hpM3Ya6y', 'response_type': 'code', 'client_id': 'LA6W7oW5PGsd', 'scope': 'openid profile email address phone'}
2015-08-18 14:03:10,427 oic.oic.provider:DEBUG id_token: {'exp': 1439978590, 'iat': 1439899390, 'auth_time': 1439899384, 'aud': ['LA6W7oW5PGsd'], 'nonce': 'cQHTmtcVq4lG4lSe', 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/', 'sub': '65e8f9762ea46c24'}
2015-08-18 14:03:10,430 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kid": "op1", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 14:03:10,431 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op2", "x": "oXpW1t7kzcm6bGhX369iz11PZUwiITW-7FQoXXzMzdY", "kty": "EC", "crv": "P-256", "use": "sig", "y": "LeAl0V_XJNn6pwnv8tGJNa5USPFJSf7NrSqTkW91QMQ"}]}
2015-08-18 14:03:10,432 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op3", "x": "dN9Oh-KkgEBRPZRSU9LlKG9Jme2tilAbWnk-lknM38g", "kty": "EC", "crv": "P-256", "use": "enc", "y": "jRDNfn8gJE2zd1AZ0rvzIEzZtb0_WR2n5j99ocEwTrU"}]}
2015-08-18 14:03:10,433 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c20f0>]
2015-08-18 14:03:10,445 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:03:10,446 oic.oic.provider:DEBUG _tinfo: {'redirect_uri': 'http://localhost:8666/authz_cb', 'authzreq': '{"redirect_uri": "http://localhost:8666/authz_cb", "scope": "openid profile email address phone", "upm_answer": "true", "nonce": "cQHTmtcVq4lG4lSe", "state": "BVmsZGH2hpM3Ya6y", "response_type": "code", "client_id": "LA6W7oW5PGsd", "acr_values": "SAML"}', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f4f98>, 'refresh_token': '14SV1mCWkynoUdHV+3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqumXtM3aCP333KymBU2B1KzO0MfYq1te56gz+7fEqXsI=', 'nonce': 'cQHTmtcVq4lG4lSe', 'code': '14SV1mCWkynoUdHV+3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqnLtnC0a7Rb8RNwyoX5D45COQMLl+Asz3122z6wsz/AM=', 'client_id': 'LA6W7oW5PGsd', 'access_token_scope': '?', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'permission': '', 'token_expires_at': 1439899390, 'expires_in': 3600, 'oauth_state': 'token', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJleHAiOiAxNDM5OTc4NTkwLCAiaWF0IjogMTQzOTg5OTM5MCwgImF1dGhfdGltZSI6IDE0Mzk4OTkzODQsICJhdWQiOiBbIkxBNlc3b1c1UEdzZCJdLCAibm9uY2UiOiAiY1FIVG10Y1ZxNGxHNGxTZSIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICI2NWU4Zjk3NjJlYTQ2YzI0In0.uP5xVCCIAUg8lpAGfZ3bmoSQaRrZtfHW2CjdE6ywXPNAUvF_lFeeN3BnJNspCxV_68TjaCdjdtBaRVSRXBLyVi0Avp22L2k1QpNNGXCj5iaIW_1g3Hkrvy3WsnMnz5fdHTWTw5SFwjGwyx-HfK2VbA4-mxHq79srh-sPjwRx0kbKXUqqQnHsPMbujsAbFsq92F86913vqf26cMAMHj6rtCQp6K-zQdgi25JdgG752u19I6IUsyNZLPlYUxXJm43Y5hkpgTDB9qSXz8w31uFVLIXSIccqbxf_AawwoFakkhYjGJn5TNnAIdDn88vKUQ9URHEReHv4ICOseuMxKa2TJA', 'revoked': False, 'code_used': True, 'sub': '65e8f9762ea46c24', 'state': 'BVmsZGH2hpM3Ya6y', 'token_type': 'Bearer', 'access_token': '14SV1mCWkynoUdHV+3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqoNhUd2y8epZcSQGwgEIr0XAp8ccy8ONICOtu01Z61AM='}
2015-08-18 14:03:10,447 oic.oic.provider:DEBUG access_token_response: {'scope': 'openid profile email address phone', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJleHAiOiAxNDM5OTc4NTkwLCAiaWF0IjogMTQzOTg5OTM5MCwgImF1dGhfdGltZSI6IDE0Mzk4OTkzODQsICJhdWQiOiBbIkxBNlc3b1c1UEdzZCJdLCAibm9uY2UiOiAiY1FIVG10Y1ZxNGxHNGxTZSIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICI2NWU4Zjk3NjJlYTQ2YzI0In0.uP5xVCCIAUg8lpAGfZ3bmoSQaRrZtfHW2CjdE6ywXPNAUvF_lFeeN3BnJNspCxV_68TjaCdjdtBaRVSRXBLyVi0Avp22L2k1QpNNGXCj5iaIW_1g3Hkrvy3WsnMnz5fdHTWTw5SFwjGwyx-HfK2VbA4-mxHq79srh-sPjwRx0kbKXUqqQnHsPMbujsAbFsq92F86913vqf26cMAMHj6rtCQp6K-zQdgi25JdgG752u19I6IUsyNZLPlYUxXJm43Y5hkpgTDB9qSXz8w31uFVLIXSIccqbxf_AawwoFakkhYjGJn5TNnAIdDn88vKUQ9URHEReHv4ICOseuMxKa2TJA', 'refresh_token': '14SV1mCWkynoUdHV+3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqumXtM3aCP333KymBU2B1KzO0MfYq1te56gz+7fEqXsI=', 'expires_in': 3600, 'state': 'BVmsZGH2hpM3Ya6y', 'token_type': 'Bearer', 'access_token': '14SV1mCWkynoUdHV+3Xiw4hO0tTWi3pZmV4KQqDr5NTe2Hngz3D91uopDfEZ8ZqqoNhUd2y8epZcSQGwgEIr0XAp8ccy8ONICOtu01Z61AM='}
2015-08-18 14:03:10,456 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:03:10,476 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:07:02,331 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"use": "sig", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-18 14:07:02,332 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "rcbOZrDe3Qjvgms2Zn99qy8W7s3jkQgun3du9Mx9P_M", "kid": "op2", "kty": "EC", "y": "hdG5Uv5ML9qirBX-yA0TtzIucYrQZEHWyvdVSkk2Nm8", "crv": "P-256"}]}
2015-08-18 14:07:02,333 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "kVSCOgnNvSZhV9kIoVbcv7iYianzmb1fOlQjxENwupU", "kid": "op3", "kty": "EC", "y": "_AEeZkhrMQXcmDaAlm6Qq3q_NBEHBlzYun9bNpvoOEE", "crv": "P-256"}]}
2015-08-18 14:07:02,333 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:07:05,008 oicServer:INFO callback: <function webfinger at 0x1054ee6a8>
2015-08-18 14:07:05,029 oicServer:INFO callback: <function op_info at 0x1054ee2f0>
2015-08-18 14:07:05,029 root:INFO op_info
2015-08-18 14:07:05,030 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:07:05,031 oic.oic.provider:INFO provider_info_response: {'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD'], 'require_request_uri_registration': True, 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_parameter_supported': True, 'scopes_supported': ['profile', 'phone', 'address', 'openid', 'offline_access', 'email', 'openid'], 'id_token_signing_alg_values_supported': ['RS512', 'HS384', 'PS512', 'RS256', 'ES512', 'HS256', 'RS384', 'none', 'PS384', 'ES384', 'HS512', 'ES256', 'PS256'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_signing_alg_values_supported': ['RS512', 'HS384', 'PS512', 'RS256', 'ES512', 'HS256', 'RS384', 'none', 'PS384', 'ES384', 'HS512', 'ES256', 'PS256'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_signing_alg_values_supported': ['RS512', 'HS384', 'PS512', 'RS256', 'ES512', 'HS256', 'RS384', 'PS384', 'ES384', 'HS512', 'ES256', 'PS256'], 'claims_parameter_supported': True, 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'version': '3.0', 'request_object_signing_alg_values_supported': ['RS512', 'HS384', 'PS512', 'RS256', 'ES512', 'HS256', 'RS384', 'none', 'PS384', 'ES384', 'HS512', 'ES256', 'PS256'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'claims_supported': ['name', 'family_name', 'nickname', 'gender', 'birthdate', 'phone_number', 'sub', 'zoneinfo', 'email', 'address', 'email_verified', 'locale', 'profile', 'picture', 'updated_at', 'middle_name', 'website', 'phone_number_verified', 'preferred_username', 'given_name'], 'issuer': 'https://localhost:8092/', 'authorization_endpoint': 'https://localhost:8092/authorization', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'subject_types_supported': ['public', 'pairwise'], 'token_endpoint': 'https://localhost:8092/token', 'response_modes_supported': ['query', 'fragment', 'form_post']}
2015-08-18 14:07:05,101 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105544908>
2015-08-18 14:07:05,101 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "application_type": "web", "redirect_uris": ["http://localhost:8666/authz_cb"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"]}>>
2015-08-18 14:07:05,102 oic.oic.provider:INFO registration_request:{'response_types': ['code'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 14:07:05,108 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439896025, 'client_id': 'aGyiUl6Xfg7r', 'client_secret_expires_at': 1439982425, 'client_secret': '41781d170f621ef81d62ec21c2af470af2e3db8e4d536749acb8220a', 'registration_access_token': 'NZsjkG75ISBklL6Paku7Zf8N4pez484u', 'registration_client_uri': 'https://localhost:8092/registration?client_id=aGyiUl6Xfg7r'}
2015-08-18 14:07:05,110 oic.utils.keyio:DEBUG loading keys for issuer: aGyiUl6Xfg7r
2015-08-18 14:07:05,111 oic.utils.keyio:DEBUG pcr: {'response_types': ['code'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 14:07:05,111 oic.oic.provider:DEBUG keys for aGyiUl6Xfg7r: []
2015-08-18 14:07:05,113 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439896025, 'client_id': 'aGyiUl6Xfg7r', 'client_secret_expires_at': 1439982425, 'client_secret': '41781d170f621ef81d62ec21c2af470af2e3db8e4d536749acb8220a', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'registration_access_token': 'NZsjkG75ISBklL6Paku7Zf8N4pez484u', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=aGyiUl6Xfg7r', 'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)]}
2015-08-18 14:07:05,113 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439896025, 'client_id': 'aGyiUl6Xfg7r', 'client_secret_expires_at': 1439982425, 'client_secret': '41781d170f621ef81d62ec21c2af470af2e3db8e4d536749acb8220a', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'registration_access_token': 'NZsjkG75ISBklL6Paku7Zf8N4pez484u', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=aGyiUl6Xfg7r', 'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 14:07:05,134 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054c0438>
2015-08-18 14:07:05,135 oic.oauth2.provider:DEBUG Request: 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=ZDAguLxZBlYsNBD6&state=fP3tgB6M8yQads9O&acr_values=SAML&client_id=aGyiUl6Xfg7r&response_type=code&scope=openid+profile+email+address+phone'
2015-08-18 14:07:05,136 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056f3240>, <jwkest.jwk.RSAKey object at 0x1056c20f0>, <jwkest.jwk.ECKey object at 0x1056c24e0>]
2015-08-18 14:07:05,136 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'aGyiUl6Xfg7r', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'fP3tgB6M8yQads9O', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'ZDAguLxZBlYsNBD6'}
2015-08-18 14:07:05,139 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'aGyiUl6Xfg7r', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'fP3tgB6M8yQads9O', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'ZDAguLxZBlYsNBD6'}
2015-08-18 14:07:05,141 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:07:05,142 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:07:05,142 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:07:05,143 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:07:05,144 oic.utils.authn.user:INFO do_authentication argv: {'login_title': 'Username', 'login': '', 'client_policy_title': 'Client Policy', 'query': 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=ZDAguLxZBlYsNBD6&state=fP3tgB6M8yQads9O&acr_values=SAML&client_id=aGyiUl6Xfg7r&response_type=code&scope=openid+profile+email+address+phone', 'logo_uri': '', 'tos_uri': '', 'passwd_title': 'Password', 'acr': ['SAML'], 'submit_text': 'Submit', 'password': '', 'title': 'User log in', 'action': 'https://localhost:8092/verify', 'policy_uri': ''}
2015-08-18 14:07:05,158 oicServer:INFO callback: <function css at 0x1054be620>
2015-08-18 14:07:12,009 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105646598>
2015-08-18 14:07:12,010 oic.utils.authn.user:DEBUG verify(query=redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3DZDAguLxZBlYsNBD6%26state%3DfP3tgB6M8yQads9O%26acr_values%3DSAML%26client_id%3DaGyiUl6Xfg7r%26response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:07:12,010 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'query': ['redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=ZDAguLxZBlYsNBD6&state=fP3tgB6M8yQads9O&acr_values=SAML&client_id=aGyiUl6Xfg7r&response_type=code&scope=openid+profile+email+address+phone'], 'login': ['diana'], 'acr_values': ["['SAML']"], 'form.commit': ['Submit']}
2015-08-18 14:07:12,011 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 14:07:12,013 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'client_id': ['aGyiUl6Xfg7r'], 'scope': ['openid profile email address phone'], 'response_type': ['code'], 'acr_values': ['SAML'], 'state': ['fP3tgB6M8yQads9O'], 'nonce': ['ZDAguLxZBlYsNBD6'], 'redirect_uri': ['http://localhost:8666/authz_cb']}
2015-08-18 14:07:12,030 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054c0438>
2015-08-18 14:07:12,030 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&client_id=aGyiUl6Xfg7r&scope=openid+profile+email+address+phone&response_type=code&acr_values=SAML&state=fP3tgB6M8yQads9O&nonce=ZDAguLxZBlYsNBD6&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-18 14:07:12,031 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056f3240>, <jwkest.jwk.RSAKey object at 0x1056c20f0>, <jwkest.jwk.ECKey object at 0x1056c24e0>]
2015-08-18 14:07:12,032 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'client_id': 'aGyiUl6Xfg7r', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'fP3tgB6M8yQads9O', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'ZDAguLxZBlYsNBD6'}
2015-08-18 14:07:12,033 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'client_id': 'aGyiUl6Xfg7r', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'fP3tgB6M8yQads9O', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': 'ZDAguLxZBlYsNBD6'}
2015-08-18 14:07:12,038 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:07:12,039 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:07:12,039 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:07:12,040 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:07:12,040 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:07:12,041 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'client_id', 'scope', 'response_type', 'acr_values', 'state', 'nonce', 'redirect_uri']
2015-08-18 14:07:12,042 oic.utils.sdb:DEBUG uid2sid: {'diana': ['62851aefebc3a26a940cfad0da083785b1e5fad06fefdb6cf9ab1410']}
2015-08-18 14:07:12,042 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:07:12,042 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:07:12,045 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=e0z0Ds%2B%2FVUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt%2F31RYoyK3DP08i%2BkNj0HX8DRk6x5faXg68ERIcM2A%2Fhi1T4vlMkGOFE%3D&state=fP3tgB6M8yQads9O&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 14:07:16,029 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054c04e0>
2015-08-18 14:07:21,954 oic.oic.provider:DEBUG - token -
2015-08-18 14:07:21,955 oic.oic.provider:INFO token_request: token_type=pop&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&grant_type=authorization_code&client_secret=41781d170f621ef81d62ec21c2af470af2e3db8e4d536749acb8220a&code=e0z0Ds%2B%2FVUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt%2F31RYoyK3DP08i%2BkNj0HX8DRk6x5faXg68ERIcM2A%2Fhi1T4vlMkGOFE%3D&client_id=aGyiUl6Xfg7r&key=eyJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0ifQ%3D%3D
2015-08-18 14:07:21,956 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'e0z0Ds+/VUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt/31RYoyK3DP08i+kNj0HX8DRk6x5faXg68ERIcM2A/hi1T4vlMkGOFE=', 'client_id': 'aGyiUl6Xfg7r', 'client_secret': '41781d170f621ef81d62ec21c2af470af2e3db8e4d536749acb8220a', 'key': 'eyJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0ifQ==', 'token_type': 'pop', 'grant_type': 'authorization_code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:07:21,956 oic.utils.authn.client:DEBUG REQ: {'code': 'e0z0Ds+/VUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt/31RYoyK3DP08i+kNj0HX8DRk6x5faXg68ERIcM2A/hi1T4vlMkGOFE=', 'client_id': 'aGyiUl6Xfg7r', 'client_secret': '41781d170f621ef81d62ec21c2af470af2e3db8e4d536749acb8220a', 'key': 'eyJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0ifQ==', 'token_type': 'pop', 'grant_type': 'authorization_code', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:07:21,958 oic.utils.authn.client:DEBUG Verified Client ID: aGyiUl6Xfg7r
2015-08-18 14:07:21,971 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:07:21,973 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'client_id': 'aGyiUl6Xfg7r', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'fP3tgB6M8yQads9O', 'nonce': 'ZDAguLxZBlYsNBD6', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:07:21,974 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:07:21,974 oic.oic:DEBUG authzreq: {'upm_answer': 'true', 'client_id': 'aGyiUl6Xfg7r', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'fP3tgB6M8yQads9O', 'nonce': 'ZDAguLxZBlYsNBD6', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:07:21,975 oic.oic.provider:DEBUG id_token: {'acr': 'PASSWORD', 'sub': '141d5830f12930f7', 'iat': 1439899641, 'iss': 'https://localhost:8092/', 'exp': 1439978841, 'aud': ['aGyiUl6Xfg7r'], 'auth_time': 1439899632, 'nonce': 'ZDAguLxZBlYsNBD6'}
2015-08-18 14:07:21,978 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"use": "sig", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-18 14:07:21,978 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "x": "rcbOZrDe3Qjvgms2Zn99qy8W7s3jkQgun3du9Mx9P_M", "kid": "op2", "kty": "EC", "y": "hdG5Uv5ML9qirBX-yA0TtzIucYrQZEHWyvdVSkk2Nm8", "crv": "P-256"}]}
2015-08-18 14:07:21,979 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "x": "kVSCOgnNvSZhV9kIoVbcv7iYianzmb1fOlQjxENwupU", "kid": "op3", "kty": "EC", "y": "_AEeZkhrMQXcmDaAlm6Qq3q_NBEHBlzYun9bNpvoOEE", "crv": "P-256"}]}
2015-08-18 14:07:21,979 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1056c20f0>]
2015-08-18 14:07:21,987 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:07:21,988 oic.oic.provider:DEBUG _tinfo: {'revoked': False, 'expires_in': 3600, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1056f3f98>, 'authzreq': '{"upm_answer": "true", "client_id": "aGyiUl6Xfg7r", "scope": "openid profile email address phone", "response_type": "code", "acr_values": "SAML", "state": "fP3tgB6M8yQads9O", "redirect_uri": "http://localhost:8666/authz_cb", "nonce": "ZDAguLxZBlYsNBD6"}', 'access_token': 'e0z0Ds+/VUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt/31RYoyK3DP0F1yT4Ew7HakguBbdALO4NiBwahZa033VQmMhmHwUciQ=', 'code_used': True, 'refresh_token': 'e0z0Ds+/VUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt/31RYoyK3DP0UOJHmCXSBpZIZJFj2itiDQCOaSsNtP5W5uHNwDCoZq0=', 'nonce': 'ZDAguLxZBlYsNBD6', 'code': 'e0z0Ds+/VUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt/31RYoyK3DP08i+kNj0HX8DRk6x5faXg68ERIcM2A/hi1T4vlMkGOFE=', 'client_id': 'aGyiUl6Xfg7r', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'sub': '141d5830f12930f7', 'token_type': 'Bearer', 'token_expires_at': 1439899641, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIjE0MWQ1ODMwZjEyOTMwZjciLCAiaWF0IjogMTQzOTg5OTY0MSwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJleHAiOiAxNDM5OTc4ODQxLCAiYXVkIjogWyJhR3lpVWw2WGZnN3IiXSwgImF1dGhfdGltZSI6IDE0Mzk4OTk2MzIsICJub25jZSI6ICJaREFndUx4WkJsWXNOQkQ2In0.OMCEgPODI9AYgtHjdICG9ZITp4jYuKnHIR35mQCnpAt0gFDBcoxNgaOapoGU2h-E3Nm1u_6835xCpRv17uCe7T_faJihXTvciXWJ5OQe5PIPjyXG5g6ACRKbr10ipVTayxY1bPU9H_SvMVmtki1ALp3Sw2R_TK4OL2fz67S916Q6wjcEjxyHuGh_ymf-7Nm0jqyJdarwaGspFMXxQIlJnvSPUOt2ZnAuB_2TcqgRjvMuO1ZmQKSmwvK1cqKUnRunWSAawtUtoZGAFaonGNlK1bACZVN6CO1fI4uDTSRqZ43P_D3Zfz51J7hSnz2L1y2jjcpYKy8WonPOLAYdyNp2oQ', 'access_token_scope': '?', 'state': 'fP3tgB6M8yQads9O', 'permission': '', 'oauth_state': 'token', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:07:21,989 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'refresh_token': 'e0z0Ds+/VUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt/31RYoyK3DP0UOJHmCXSBpZIZJFj2itiDQCOaSsNtP5W5uHNwDCoZq0=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIjE0MWQ1ODMwZjEyOTMwZjciLCAiaWF0IjogMTQzOTg5OTY0MSwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJleHAiOiAxNDM5OTc4ODQxLCAiYXVkIjogWyJhR3lpVWw2WGZnN3IiXSwgImF1dGhfdGltZSI6IDE0Mzk4OTk2MzIsICJub25jZSI6ICJaREFndUx4WkJsWXNOQkQ2In0.OMCEgPODI9AYgtHjdICG9ZITp4jYuKnHIR35mQCnpAt0gFDBcoxNgaOapoGU2h-E3Nm1u_6835xCpRv17uCe7T_faJihXTvciXWJ5OQe5PIPjyXG5g6ACRKbr10ipVTayxY1bPU9H_SvMVmtki1ALp3Sw2R_TK4OL2fz67S916Q6wjcEjxyHuGh_ymf-7Nm0jqyJdarwaGspFMXxQIlJnvSPUOt2ZnAuB_2TcqgRjvMuO1ZmQKSmwvK1cqKUnRunWSAawtUtoZGAFaonGNlK1bACZVN6CO1fI4uDTSRqZ43P_D3Zfz51J7hSnz2L1y2jjcpYKy8WonPOLAYdyNp2oQ', 'access_token': 'e0z0Ds+/VUxU31TOQd5LrjBPfWTUXh4l6WBIQ7uUoZMHMfFU9VVt/31RYoyK3DP0F1yT4Ew7HakguBbdALO4NiBwahZa033VQmMhmHwUciQ=', 'state': 'fP3tgB6M8yQads9O', 'scope': 'openid profile email address phone', 'token_type': 'Bearer'}
2015-08-18 14:07:21,999 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:07:22,020 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:08:05,040 root:INFO OC3 server keys: {"keys": [{"use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op0"}, {"use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op1"}]}
2015-08-18 14:08:05,041 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "crv": "P-256", "x": "Jr27nBU-izZvOKx9eFtW8yaoDXeAOdphjo5J0QzPnc0", "y": "xXTBpiFtvS9-iGLjl2xHzuJ2Fij56pI31mgaxJZkXJ8", "kid": "op2"}]}
2015-08-18 14:08:05,041 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "crv": "P-256", "x": "_ln3ocH84MQxJTtPl-BfHeVc6b8R04g-gy3yoLfMQSA", "y": "0Y1u_rqNMSwKOoonsdagaVQFSdmOCree3c73pY8QkB4", "kid": "op3"}]}
2015-08-18 14:08:05,042 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:08:05,672 oicServer:INFO callback: <function webfinger at 0x1053bc6a8>
2015-08-18 14:08:05,693 oicServer:INFO callback: <function op_info at 0x1053bc2f0>
2015-08-18 14:08:05,694 root:INFO op_info
2015-08-18 14:08:05,695 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:08:05,695 oic.oic.provider:INFO provider_info_response: {'issuer': 'https://localhost:8092/', 'token_endpoint_auth_signing_alg_values_supported': ['ES384', 'HS256', 'HS512', 'PS256', 'PS512', 'HS384', 'RS256', 'RS512', 'ES512', 'RS384', 'PS384', 'ES256'], 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_uri_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_parameter_supported': True, 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['offline_access', 'profile', 'phone', 'email', 'openid', 'address', 'openid'], 'id_token_signing_alg_values_supported': ['ES384', 'HS256', 'HS512', 'PS256', 'PS512', 'HS384', 'none', 'RS256', 'RS512', 'ES512', 'RS384', 'PS384', 'ES256'], 'version': '3.0', 'subject_types_supported': ['public', 'pairwise'], 'claims_supported': ['given_name', 'middle_name', 'nickname', 'preferred_username', 'email', 'name', 'sub', 'address', 'email_verified', 'phone_number_verified', 'picture', 'gender', 'profile', 'website', 'zoneinfo', 'birthdate', 'family_name', 'locale', 'updated_at', 'phone_number'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_object_signing_alg_values_supported': ['ES384', 'HS256', 'HS512', 'PS256', 'PS512', 'HS384', 'none', 'RS256', 'RS512', 'ES512', 'RS384', 'PS384', 'ES256'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint': 'https://localhost:8092/token', 'registration_endpoint': 'https://localhost:8092/registration', 'require_request_uri_registration': True, 'userinfo_signing_alg_values_supported': ['ES384', 'HS256', 'HS512', 'PS256', 'PS512', 'HS384', 'none', 'RS256', 'RS512', 'ES512', 'RS384', 'PS384', 'ES256'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_parameter_supported': True}
2015-08-18 14:08:05,766 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105644908>
2015-08-18 14:08:05,767 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["http://localhost:8666/authz_cb"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "response_types": ["code"], "application_type": "web"}>>
2015-08-18 14:08:05,767 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:08:05,774 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439896085, 'client_id': '9HU18WXGF9Nh', 'registration_access_token': 'GvcC6EFG4zGKHe25AFp4DtBkVEB5kS7h', 'client_secret': '3e58b092a9db86faa70a03de3ba4f23dcb2dfb7f2046a5158181681a', 'client_secret_expires_at': 1439982485, 'registration_client_uri': 'https://localhost:8092/registration?client_id=9HU18WXGF9Nh'}
2015-08-18 14:08:05,775 oic.utils.keyio:DEBUG loading keys for issuer: 9HU18WXGF9Nh
2015-08-18 14:08:05,776 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:08:05,776 oic.oic.provider:DEBUG keys for 9HU18WXGF9Nh: []
2015-08-18 14:08:05,779 oic.oic.provider:INFO Client info: {'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'response_types': ['code'], 'client_id_issued_at': 1439896085, 'client_id': '9HU18WXGF9Nh', 'registration_access_token': 'GvcC6EFG4zGKHe25AFp4DtBkVEB5kS7h', 'application_type': 'web', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_secret': '3e58b092a9db86faa70a03de3ba4f23dcb2dfb7f2046a5158181681a', 'client_secret_expires_at': 1439982485, 'registration_client_uri': 'https://localhost:8092/registration?client_id=9HU18WXGF9Nh', 'contacts': ['ops@example.com']}
2015-08-18 14:08:05,779 oic.oic.provider:DEBUG registration_response: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'client_id_issued_at': 1439896085, 'client_id': '9HU18WXGF9Nh', 'registration_access_token': 'GvcC6EFG4zGKHe25AFp4DtBkVEB5kS7h', 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret': '3e58b092a9db86faa70a03de3ba4f23dcb2dfb7f2046a5158181681a', 'client_secret_expires_at': 1439982485, 'registration_client_uri': 'https://localhost:8092/registration?client_id=9HU18WXGF9Nh', 'contacts': ['ops@example.com']}
2015-08-18 14:08:05,798 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10538e438>
2015-08-18 14:08:05,798 oic.oauth2.provider:DEBUG Request: 'state=fzVVWsaGBs0AAV1o&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=9HU18WXGF9Nh&acr_values=SAML&scope=openid+profile+email+address+phone&nonce=fCySDx43iOVxi9pk'
2015-08-18 14:08:05,799 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3240>, <jwkest.jwk.RSAKey object at 0x1057c10f0>, <jwkest.jwk.ECKey object at 0x1057c1550>]
2015-08-18 14:08:05,800 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'fCySDx43iOVxi9pk', 'response_type': 'code', 'state': 'fzVVWsaGBs0AAV1o', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': '9HU18WXGF9Nh', 'scope': 'openid profile email address phone'}
2015-08-18 14:08:05,803 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'fCySDx43iOVxi9pk', 'response_type': 'code', 'state': 'fzVVWsaGBs0AAV1o', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': '9HU18WXGF9Nh', 'scope': 'openid profile email address phone'}
2015-08-18 14:08:05,805 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:08:05,805 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:08:05,806 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:08:05,807 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:08:05,807 oic.utils.authn.user:INFO do_authentication argv: {'login': '', 'login_title': 'Username', 'policy_uri': '', 'logo_uri': '', 'title': 'User log in', 'query': 'state=fzVVWsaGBs0AAV1o&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=9HU18WXGF9Nh&acr_values=SAML&scope=openid+profile+email+address+phone&nonce=fCySDx43iOVxi9pk', 'client_policy_title': 'Client Policy', 'tos_uri': '', 'passwd_title': 'Password', 'acr': ['SAML'], 'submit_text': 'Submit', 'action': 'https://localhost:8092/verify', 'password': ''}
2015-08-18 14:08:05,825 oicServer:INFO callback: <function css at 0x10538c620>
2015-08-18 14:08:13,795 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105745598>
2015-08-18 14:08:13,796 oic.utils.authn.user:DEBUG verify(query=state%3DfzVVWsaGBs0AAV1o%26response_type%3Dcode%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26client_id%3D9HU18WXGF9Nh%26acr_values%3DSAML%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26nonce%3DfCySDx43iOVxi9pk&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:08:13,796 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'acr_values': ["['SAML']"], 'query': ['state=fzVVWsaGBs0AAV1o&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=9HU18WXGF9Nh&acr_values=SAML&scope=openid+profile+email+address+phone&nonce=fCySDx43iOVxi9pk'], 'form.commit': ['Submit'], 'password': ['krall']}
2015-08-18 14:08:13,796 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-18 14:08:13,799 oic.utils.authn.user:DEBUG kwargs: {'scope': ['openid profile email address phone'], 'nonce': ['fCySDx43iOVxi9pk'], 'response_type': ['code'], 'state': ['fzVVWsaGBs0AAV1o'], 'upm_answer': 'true', 'redirect_uri': ['http://localhost:8666/authz_cb'], 'client_id': ['9HU18WXGF9Nh'], 'acr_values': ['SAML']}
2015-08-18 14:08:13,815 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10538e438>
2015-08-18 14:08:13,816 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&nonce=fCySDx43iOVxi9pk&response_type=code&state=fzVVWsaGBs0AAV1o&upm_answer=true&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=9HU18WXGF9Nh&acr_values=SAML'
2015-08-18 14:08:13,816 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f3240>, <jwkest.jwk.RSAKey object at 0x1057c10f0>, <jwkest.jwk.ECKey object at 0x1057c1550>]
2015-08-18 14:08:13,817 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'state': 'fzVVWsaGBs0AAV1o', 'upm_answer': 'true', 'nonce': 'fCySDx43iOVxi9pk', 'client_id': '9HU18WXGF9Nh', 'scope': 'openid profile email address phone'}
2015-08-18 14:08:13,818 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'state': 'fzVVWsaGBs0AAV1o', 'upm_answer': 'true', 'nonce': 'fCySDx43iOVxi9pk', 'client_id': '9HU18WXGF9Nh', 'scope': 'openid profile email address phone'}
2015-08-18 14:08:13,820 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:08:13,821 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:08:13,821 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:08:13,822 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:08:13,823 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:08:13,824 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'client_id', 'response_type', 'state', 'upm_answer', 'redirect_uri', 'scope', 'acr_values']
2015-08-18 14:08:13,825 oic.utils.sdb:DEBUG uid2sid: {'diana': ['0756a0f81db1eae93023c0601e24282a89277ba617e33f1ad4f61078']}
2015-08-18 14:08:13,825 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:08:13,826 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:08:13,829 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?state=fzVVWsaGBs0AAV1o&code=uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLenRRSxLa9oJ4VIZZvCmTflqmCBoSLN5OHcBLE5briYN8o%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 14:08:26,679 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10538e4e0>
2015-08-18 14:08:27,197 oic.oic.provider:DEBUG - token -
2015-08-18 14:08:27,198 oic.oic.provider:INFO token_request: redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=3e58b092a9db86faa70a03de3ba4f23dcb2dfb7f2046a5158181681a&client_id=9HU18WXGF9Nh&key=eyJ1c2UiOiAic2lnIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ%3D%3D&token_type=pop&grant_type=authorization_code&code=uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLenRRSxLa9oJ4VIZZvCmTflqmCBoSLN5OHcBLE5briYN8o%3D
2015-08-18 14:08:27,199 oic.oic.provider:DEBUG AccessTokenRequest: {'client_id': '9HU18WXGF9Nh', 'token_type': 'pop', 'grant_type': 'authorization_code', 'code': 'uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLenRRSxLa9oJ4VIZZvCmTflqmCBoSLN5OHcBLE5briYN8o=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '3e58b092a9db86faa70a03de3ba4f23dcb2dfb7f2046a5158181681a', 'key': 'eyJ1c2UiOiAic2lnIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ=='}
2015-08-18 14:08:27,199 oic.utils.authn.client:DEBUG REQ: {'client_id': '9HU18WXGF9Nh', 'token_type': 'pop', 'grant_type': 'authorization_code', 'code': 'uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLenRRSxLa9oJ4VIZZvCmTflqmCBoSLN5OHcBLE5briYN8o=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '3e58b092a9db86faa70a03de3ba4f23dcb2dfb7f2046a5158181681a', 'key': 'eyJ1c2UiOiAic2lnIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAia2lkIjogImEwIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ=='}
2015-08-18 14:08:27,201 oic.utils.authn.client:DEBUG Verified Client ID: 9HU18WXGF9Nh
2015-08-18 14:08:27,206 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:08:27,208 oic.oic:DEBUG authzreq: {'nonce': 'fCySDx43iOVxi9pk', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'fzVVWsaGBs0AAV1o', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': '9HU18WXGF9Nh', 'scope': 'openid profile email address phone'}
2015-08-18 14:08:27,208 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:08:27,209 oic.oic:DEBUG authzreq: {'nonce': 'fCySDx43iOVxi9pk', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'fzVVWsaGBs0AAV1o', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': '9HU18WXGF9Nh', 'scope': 'openid profile email address phone'}
2015-08-18 14:08:27,210 oic.oic.provider:DEBUG id_token: {'auth_time': 1439899693, 'nonce': 'fCySDx43iOVxi9pk', 'acr': 'PASSWORD', 'sub': '-31e62e5454bfd22a', 'exp': 1439978907, 'iss': 'https://localhost:8092/', 'iat': 1439899707, 'aud': ['9HU18WXGF9Nh']}
2015-08-18 14:08:27,214 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op0"}, {"use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op1"}]}
2015-08-18 14:08:27,215 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "crv": "P-256", "x": "Jr27nBU-izZvOKx9eFtW8yaoDXeAOdphjo5J0QzPnc0", "y": "xXTBpiFtvS9-iGLjl2xHzuJ2Fij56pI31mgaxJZkXJ8", "kid": "op2"}]}
2015-08-18 14:08:27,218 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "crv": "P-256", "x": "_ln3ocH84MQxJTtPl-BfHeVc6b8R04g-gy3yoLfMQSA", "y": "0Y1u_rqNMSwKOoonsdagaVQFSdmOCree3c73pY8QkB4", "kid": "op3"}]}
2015-08-18 14:08:27,220 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c10f0>]
2015-08-18 14:08:27,256 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:08:27,257 oic.oic.provider:DEBUG _tinfo: {'access_token': 'uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLen7Je1bPBXYD9VvurjOOFZwV7FNDPaxTpNuX5hqjkr5Yc=', 'client_id': '9HU18WXGF9Nh', 'access_token_scope': '?', 'sub': '-31e62e5454bfd22a', 'revoked': False, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f3f98>, 'redirect_uri': 'http://localhost:8666/authz_cb', 'authzreq': '{"response_type": "code", "acr_values": "SAML", "redirect_uri": "http://localhost:8666/authz_cb", "state": "fzVVWsaGBs0AAV1o", "upm_answer": "true", "nonce": "fCySDx43iOVxi9pk", "client_id": "9HU18WXGF9Nh", "scope": "openid profile email address phone"}', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5ODk5NjkzLCAibm9uY2UiOiAiZkN5U0R4NDNpT1Z4aTlwayIsICJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi0zMWU2MmU1NDU0YmZkMjJhIiwgImV4cCI6IDE0Mzk5Nzg5MDcsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQzOTg5OTcwNywgImF1ZCI6IFsiOUhVMThXWEdGOU5oIl19.PtHFTq1dZPzSRi2QiF4lg1fF0cjylCW4BAtzAmmZV4OzUxmLlMn4sFH2XXObxcE1mRR15UR3GbvVPIUKdy8GK30PUyRKZwxb_Qyj05fHcwodgHxs1XEEFk4DFTigerUF4uWTXl23k-JYf0BSY5tzU4bCr963e37OpjyRm_QFYLpeLfGHYU4j2624POAu5qH_-sMEITIQBkGXXa7JlvyEOymFdAyuyw-_H8waxKyNMzl3nEKyVJVML8rWljEVAPKxG20k3SLW_H02nK5eT4IXgGxIGVvTTkEhCthegvxH3LaCU0BxzWFuYfNQi4ISTCYLyi8uEdm2kf3jZkzR_Hl_iA', 'code_used': True, 'oauth_state': 'token', 'refresh_token': 'uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLenMnAiTYwVGnyubKsLTNM6NcBfjWduWcJEf/OUh6qqfro=', 'token_type': 'Bearer', 'permission': '', 'nonce': 'fCySDx43iOVxi9pk', 'expires_in': 3600, 'code': 'uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLenRRSxLa9oJ4VIZZvCmTflqmCBoSLN5OHcBLE5briYN8o=', 'state': 'fzVVWsaGBs0AAV1o', 'token_expires_at': 1439899707}
2015-08-18 14:08:27,258 oic.oic.provider:DEBUG access_token_response: {'access_token': 'uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLen7Je1bPBXYD9VvurjOOFZwV7FNDPaxTpNuX5hqjkr5Yc=', 'state': 'fzVVWsaGBs0AAV1o', 'refresh_token': 'uo9Mtn2B7vmZzWM4PveyjDFRv3JocRX7rqO2S0WMiGjZaBUuUSZ9AWgxK4tcnLenMnAiTYwVGnyubKsLTNM6NcBfjWduWcJEf/OUh6qqfro=', 'token_type': 'Bearer', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDM5ODk5NjkzLCAibm9uY2UiOiAiZkN5U0R4NDNpT1Z4aTlwayIsICJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi0zMWU2MmU1NDU0YmZkMjJhIiwgImV4cCI6IDE0Mzk5Nzg5MDcsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQzOTg5OTcwNywgImF1ZCI6IFsiOUhVMThXWEdGOU5oIl19.PtHFTq1dZPzSRi2QiF4lg1fF0cjylCW4BAtzAmmZV4OzUxmLlMn4sFH2XXObxcE1mRR15UR3GbvVPIUKdy8GK30PUyRKZwxb_Qyj05fHcwodgHxs1XEEFk4DFTigerUF4uWTXl23k-JYf0BSY5tzU4bCr963e37OpjyRm_QFYLpeLfGHYU4j2624POAu5qH_-sMEITIQBkGXXa7JlvyEOymFdAyuyw-_H8waxKyNMzl3nEKyVJVML8rWljEVAPKxG20k3SLW_H02nK5eT4IXgGxIGVvTTkEhCthegvxH3LaCU0BxzWFuYfNQi4ISTCYLyi8uEdm2kf3jZkzR_Hl_iA'}
2015-08-18 14:08:27,274 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:08:27,331 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:10:50,936 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-18 14:10:50,936 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "sig", "kid": "op2", "kty": "EC", "y": "Xpn2JvlVaf4whHc2J3wNIDXh3WILpyWRKAUlyzrwLlM", "x": "wm4G4VcleI226LH520oOiHbsvD4M48E4YjllB8DtTLA"}]}
2015-08-18 14:10:50,937 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "enc", "kid": "op3", "kty": "EC", "y": "ZXPhbK7RXgUbnSlsJM16OWjRzb8h77XvgR0IRAe0OaA", "x": "a03P6XZUa5r3u-R_sAdq9a2smcOgvrZcJwqamOAfBGw"}]}
2015-08-18 14:10:50,937 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:10:59,219 oicServer:INFO callback: <function webfinger at 0x1055ec6a8>
2015-08-18 14:10:59,241 oicServer:INFO callback: <function op_info at 0x1055ec2f0>
2015-08-18 14:10:59,241 root:INFO op_info
2015-08-18 14:10:59,241 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:10:59,242 oic.oic.provider:INFO provider_info_response: {'version': '3.0', 'scopes_supported': ['address', 'phone', 'offline_access', 'profile', 'email', 'openid', 'openid'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'token_endpoint': 'https://localhost:8092/token', 'issuer': 'https://localhost:8092/', 'claims_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'id_token_signing_alg_values_supported': ['RS512', 'ES512', 'HS512', 'none', 'HS384', 'PS256', 'RS384', 'HS256', 'PS512', 'PS384', 'RS256', 'ES384', 'ES256'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'token_endpoint_auth_signing_alg_values_supported': ['RS512', 'ES512', 'HS512', 'HS384', 'PS256', 'RS384', 'HS256', 'PS512', 'PS384', 'RS256', 'ES384', 'ES256'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'require_request_uri_registration': True, 'userinfo_signing_alg_values_supported': ['RS512', 'ES512', 'HS512', 'none', 'HS384', 'PS256', 'RS384', 'HS256', 'PS512', 'PS384', 'RS256', 'ES384', 'ES256'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8092/registration', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['locale', 'name', 'email_verified', 'address', 'middle_name', 'gender', 'picture', 'profile', 'given_name', 'birthdate', 'nickname', 'website', 'preferred_username', 'phone_number_verified', 'email', 'zoneinfo', 'updated_at', 'sub', 'phone_number', 'family_name'], 'acr_values_supported': ['PASSWORD'], 'request_object_signing_alg_values_supported': ['RS512', 'ES512', 'HS512', 'none', 'HS384', 'PS256', 'RS384', 'HS256', 'PS512', 'PS384', 'RS256', 'ES384', 'ES256'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_uri_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'jwks_uri': 'https://localhost:8092/static/jwks.json'}
2015-08-18 14:10:59,313 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105644860>
2015-08-18 14:10:59,314 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "contacts": ["ops@example.com"]}>>
2015-08-18 14:10:59,315 oic.oic.provider:INFO registration_request:{'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 14:10:59,321 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'wDn0FPL6J5GDVfVEG9sEGUUDJfT5arC0', 'registration_client_uri': 'https://localhost:8092/registration?client_id=vtVcyNbW9vCx', 'client_secret_expires_at': 1439982659, 'client_id_issued_at': 1439896259, 'client_secret': '753fd02de029d134aa7b09048888541d1896a92f9c5020f16ffc0f98', 'client_id': 'vtVcyNbW9vCx'}
2015-08-18 14:10:59,323 oic.utils.keyio:DEBUG loading keys for issuer: vtVcyNbW9vCx
2015-08-18 14:10:59,323 oic.utils.keyio:DEBUG pcr: {'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 14:10:59,323 oic.oic.provider:DEBUG keys for vtVcyNbW9vCx: []
2015-08-18 14:10:59,325 oic.oic.provider:INFO Client info: {'response_types': ['code'], 'registration_access_token': 'wDn0FPL6J5GDVfVEG9sEGUUDJfT5arC0', 'registration_client_uri': 'https://localhost:8092/registration?client_id=vtVcyNbW9vCx', 'application_type': 'web', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_secret_expires_at': 1439982659, 'client_id_issued_at': 1439896259, 'client_secret': '753fd02de029d134aa7b09048888541d1896a92f9c5020f16ffc0f98', 'client_id': 'vtVcyNbW9vCx', 'contacts': ['ops@example.com'], 'redirect_uris': [('http://localhost:8666/authz_cb', None)]}
2015-08-18 14:10:59,326 oic.oic.provider:DEBUG registration_response: {'response_types': ['code'], 'registration_access_token': 'wDn0FPL6J5GDVfVEG9sEGUUDJfT5arC0', 'registration_client_uri': 'https://localhost:8092/registration?client_id=vtVcyNbW9vCx', 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_secret_expires_at': 1439982659, 'client_id_issued_at': 1439896259, 'client_secret': '753fd02de029d134aa7b09048888541d1896a92f9c5020f16ffc0f98', 'client_id': 'vtVcyNbW9vCx', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:10:59,343 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf390>
2015-08-18 14:10:59,343 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&client_id=vtVcyNbW9vCx&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&response_type=code&state=GIsGVw2uTZpbF45A&nonce=HL6xMZvFrxBA47Sh'
2015-08-18 14:10:59,344 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f2240>, <jwkest.jwk.RSAKey object at 0x1057c2048>, <jwkest.jwk.ECKey object at 0x1057c2470>]
2015-08-18 14:10:59,345 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'HL6xMZvFrxBA47Sh', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'client_id': 'vtVcyNbW9vCx', 'state': 'GIsGVw2uTZpbF45A'}
2015-08-18 14:10:59,347 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'HL6xMZvFrxBA47Sh', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'client_id': 'vtVcyNbW9vCx', 'state': 'GIsGVw2uTZpbF45A'}
2015-08-18 14:10:59,349 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:10:59,349 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:10:59,349 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:10:59,350 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:10:59,350 oic.utils.authn.user:INFO do_authentication argv: {'logo_uri': '', 'login_title': 'Username', 'passwd_title': 'Password', 'submit_text': 'Submit', 'policy_uri': '', 'title': 'User log in', 'acr': ['SAML'], 'login': '', 'action': 'https://localhost:8092/verify', 'tos_uri': '', 'query': 'acr_values=SAML&client_id=vtVcyNbW9vCx&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&response_type=code&state=GIsGVw2uTZpbF45A&nonce=HL6xMZvFrxBA47Sh', 'client_policy_title': 'Client Policy', 'password': ''}
2015-08-18 14:10:59,366 oicServer:INFO callback: <function css at 0x1055bd620>
2015-08-18 14:11:03,288 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105744598>
2015-08-18 14:11:03,289 oic.utils.authn.user:DEBUG verify(query=acr_values%3DSAML%26client_id%3DvtVcyNbW9vCx%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26state%3DGIsGVw2uTZpbF45A%26nonce%3DHL6xMZvFrxBA47Sh&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:11:03,289 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['SAML']"], 'query': ['acr_values=SAML&client_id=vtVcyNbW9vCx&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&response_type=code&state=GIsGVw2uTZpbF45A&nonce=HL6xMZvFrxBA47Sh'], 'form.commit': ['Submit'], 'login': ['diana'], 'password': ['krall']}
2015-08-18 14:11:03,290 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-18 14:11:03,292 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['HL6xMZvFrxBA47Sh'], 'upm_answer': 'true', 'redirect_uri': ['http://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone'], 'acr_values': ['SAML'], 'response_type': ['code'], 'client_id': ['vtVcyNbW9vCx'], 'state': ['GIsGVw2uTZpbF45A']}
2015-08-18 14:11:03,308 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055bf390>
2015-08-18 14:11:03,309 oic.oauth2.provider:DEBUG Request: 'nonce=HL6xMZvFrxBA47Sh&upm_answer=true&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&acr_values=SAML&response_type=code&client_id=vtVcyNbW9vCx&state=GIsGVw2uTZpbF45A'
2015-08-18 14:11:03,310 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f2240>, <jwkest.jwk.RSAKey object at 0x1057c2048>, <jwkest.jwk.ECKey object at 0x1057c2470>]
2015-08-18 14:11:03,310 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'HL6xMZvFrxBA47Sh', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'client_id': 'vtVcyNbW9vCx', 'state': 'GIsGVw2uTZpbF45A'}
2015-08-18 14:11:03,312 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'HL6xMZvFrxBA47Sh', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'response_type': 'code', 'acr_values': 'SAML', 'client_id': 'vtVcyNbW9vCx', 'state': 'GIsGVw2uTZpbF45A'}
2015-08-18 14:11:03,315 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:11:03,316 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:11:03,316 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:11:03,318 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:11:03,318 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:11:03,319 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'upm_answer', 'redirect_uri', 'scope', 'acr_values', 'response_type', 'client_id', 'state']
2015-08-18 14:11:03,320 oic.utils.sdb:DEBUG uid2sid: {'diana': ['9c300f27b364e9e2b888f705f8465bdef2e2e2a66211a8d06102a496']}
2015-08-18 14:11:03,320 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:11:03,321 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:11:03,325 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=GIsGVw2uTZpbF45A&code=scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09%2BLiST9rw66QqRenY%2BRYaOldAnTp1rR%2BoEjCit9lcjUOSDtKbuqJfxdCSVeLYlIp8X%2BlhmQ%3D' (<class 'str'>)
2015-08-18 14:11:05,803 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055bf438>
2015-08-18 14:11:06,455 oic.oic.provider:DEBUG - token -
2015-08-18 14:11:06,455 oic.oic.provider:INFO token_request: grant_type=authorization_code&client_id=vtVcyNbW9vCx&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&token_type=pop&code=scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09%2BLiST9rw66QqRenY%2BRYaOldAnTp1rR%2BoEjCit9lcjUOSDtKbuqJfxdCSVeLYlIp8X%2BlhmQ%3D&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgInVzZSI6ICJzaWciLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ%3D%3D&client_secret=753fd02de029d134aa7b09048888541d1896a92f9c5020f16ffc0f98
2015-08-18 14:11:06,456 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgInVzZSI6ICJzaWciLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'client_secret': '753fd02de029d134aa7b09048888541d1896a92f9c5020f16ffc0f98', 'client_id': 'vtVcyNbW9vCx', 'token_type': 'pop', 'code': 'scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09+LiST9rw66QqRenY+RYaOldAnTp1rR+oEjCit9lcjUOSDtKbuqJfxdCSVeLYlIp8X+lhmQ='}
2015-08-18 14:11:06,457 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgInVzZSI6ICJzaWciLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'client_secret': '753fd02de029d134aa7b09048888541d1896a92f9c5020f16ffc0f98', 'client_id': 'vtVcyNbW9vCx', 'token_type': 'pop', 'code': 'scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09+LiST9rw66QqRenY+RYaOldAnTp1rR+oEjCit9lcjUOSDtKbuqJfxdCSVeLYlIp8X+lhmQ='}
2015-08-18 14:11:06,458 oic.utils.authn.client:DEBUG Verified Client ID: vtVcyNbW9vCx
2015-08-18 14:11:06,462 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:11:06,463 oic.oic:DEBUG authzreq: {'nonce': 'HL6xMZvFrxBA47Sh', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'vtVcyNbW9vCx', 'state': 'GIsGVw2uTZpbF45A'}
2015-08-18 14:11:06,464 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:11:06,464 oic.oic:DEBUG authzreq: {'nonce': 'HL6xMZvFrxBA47Sh', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'vtVcyNbW9vCx', 'state': 'GIsGVw2uTZpbF45A'}
2015-08-18 14:11:06,465 oic.oic.provider:DEBUG id_token: {'exp': 1439979066, 'iat': 1439899866, 'nonce': 'HL6xMZvFrxBA47Sh', 'sub': '-182e10e460379eb6', 'aud': ['vtVcyNbW9vCx'], 'auth_time': 1439899863, 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/'}
2015-08-18 14:11:06,468 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-18 14:11:06,469 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "use": "sig", "kid": "op2", "kty": "EC", "y": "Xpn2JvlVaf4whHc2J3wNIDXh3WILpyWRKAUlyzrwLlM", "x": "wm4G4VcleI226LH520oOiHbsvD4M48E4YjllB8DtTLA"}]}
2015-08-18 14:11:06,470 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "use": "enc", "kid": "op3", "kty": "EC", "y": "ZXPhbK7RXgUbnSlsJM16OWjRzb8h77XvgR0IRAe0OaA", "x": "a03P6XZUa5r3u-R_sAdq9a2smcOgvrZcJwqamOAfBGw"}]}
2015-08-18 14:11:06,470 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c2048>]
2015-08-18 14:11:06,477 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:11:06,478 oic.oic.provider:DEBUG _tinfo: {'nonce': 'HL6xMZvFrxBA47Sh', 'expires_in': 3600, 'client_id': 'vtVcyNbW9vCx', 'revoked': False, 'access_token_scope': '?', 'token_expires_at': 1439899866, 'oauth_state': 'token', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJleHAiOiAxNDM5OTc5MDY2LCAiaWF0IjogMTQzOTg5OTg2NiwgIm5vbmNlIjogIkhMNnhNWnZGcnhCQTQ3U2giLCAic3ViIjogIi0xODJlMTBlNDYwMzc5ZWI2IiwgImF1ZCI6IFsidnRWY3lOYlc5dkN4Il0sICJhdXRoX3RpbWUiOiAxNDM5ODk5ODYzLCAiYWNyIjogIlBBU1NXT1JEIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyJ9.OnWoy9k5LRSAyqJkp45m-dL0hhaOACLh2LPFrqMXiLbj1g2nWt4E19_yxM66rmleUYIa8S122MdePnrFuxpL1Y0cTCirVX4pY9g6UKlGkGYys95sm71LOXWXjASaP3_TB-4qnnrp0PqtwqnXRSXEmQSuauyG-Uos6y-v01ffWzQ5buH0zt8zurVzgCXmxEra8C-e4DXRJrABjlhNhO2UyzxX1atcVcEJ6Gbs02ZKdh0psvBulH8ccfb2ZasEaLepi8PHyCbF_zNv6909-bO0k3P5yR2VpQ1Xv9hVjPWDuBDQM26N61pKRIPmMlBbx9B_9AFcx6Ra9R0R834voaHp-A', 'authzreq': '{"nonce": "HL6xMZvFrxBA47Sh", "upm_answer": "true", "redirect_uri": "http://localhost:8666/authz_cb", "scope": "openid profile email address phone", "response_type": "code", "acr_values": "SAML", "client_id": "vtVcyNbW9vCx", "state": "GIsGVw2uTZpbF45A"}', 'code_used': True, 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_type': 'Bearer', 'access_token': 'scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09+LiST9rw66QqRenY+RYaOldAnTpjzGIaomj+OUqoI/YFJHhmGgFIHVo+Q/CCaodkevausA=', 'refresh_token': 'scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09+LiST9rw66QqRenY+RYaOldAnTp/Uv8mzSCxkaUHOdRTg8MLgOImESDfiGyqptGY3ANdY4=', 'sub': '-182e10e460379eb6', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f2f98>, 'permission': '', 'state': 'GIsGVw2uTZpbF45A', 'code': 'scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09+LiST9rw66QqRenY+RYaOldAnTp1rR+oEjCit9lcjUOSDtKbuqJfxdCSVeLYlIp8X+lhmQ='}
2015-08-18 14:11:06,478 oic.oic.provider:DEBUG access_token_response: {'access_token': 'scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09+LiST9rw66QqRenY+RYaOldAnTpjzGIaomj+OUqoI/YFJHhmGgFIHVo+Q/CCaodkevausA=', 'scope': 'openid profile email address phone', 'expires_in': 3600, 'refresh_token': 'scE4sDhKYVfYfbo92Xij2oK4nJ4lMDBYoYn09+LiST9rw66QqRenY+RYaOldAnTp/Uv8mzSCxkaUHOdRTg8MLgOImESDfiGyqptGY3ANdY4=', 'state': 'GIsGVw2uTZpbF45A', 'token_type': 'Bearer', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJleHAiOiAxNDM5OTc5MDY2LCAiaWF0IjogMTQzOTg5OTg2NiwgIm5vbmNlIjogIkhMNnhNWnZGcnhCQTQ3U2giLCAic3ViIjogIi0xODJlMTBlNDYwMzc5ZWI2IiwgImF1ZCI6IFsidnRWY3lOYlc5dkN4Il0sICJhdXRoX3RpbWUiOiAxNDM5ODk5ODYzLCAiYWNyIjogIlBBU1NXT1JEIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyJ9.OnWoy9k5LRSAyqJkp45m-dL0hhaOACLh2LPFrqMXiLbj1g2nWt4E19_yxM66rmleUYIa8S122MdePnrFuxpL1Y0cTCirVX4pY9g6UKlGkGYys95sm71LOXWXjASaP3_TB-4qnnrp0PqtwqnXRSXEmQSuauyG-Uos6y-v01ffWzQ5buH0zt8zurVzgCXmxEra8C-e4DXRJrABjlhNhO2UyzxX1atcVcEJ6Gbs02ZKdh0psvBulH8ccfb2ZasEaLepi8PHyCbF_zNv6909-bO0k3P5yR2VpQ1Xv9hVjPWDuBDQM26N61pKRIPmMlBbx9B_9AFcx6Ra9R0R834voaHp-A'}
2015-08-18 14:11:06,486 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:11:06,506 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:11:16,035 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1056447b8>
2015-08-18 14:13:58,091 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-18 14:13:58,091 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op2", "kty": "EC", "y": "Jl2aRN1-_ngvGFRwCHFUFGTMLO-_aa_EtttS7maOvFM", "x": "jrOI346mI6agwv1D8NLpQtimPR7C5aJGubf6MGvUXEc", "use": "sig"}]}
2015-08-18 14:13:58,092 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op3", "kty": "EC", "y": "ZWr9AfqNRV5elxCyeB8h5jAjFLbBU-kbdnOOPGP17bw", "x": "01YSKvhk240U97_HUNgtZT9Z3s5F6IHssOy4pK6gf8U", "use": "enc"}]}
2015-08-18 14:13:58,092 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:14:08,469 oicServer:INFO callback: <function webfinger at 0x1053bd6a8>
2015-08-18 14:14:08,490 oicServer:INFO callback: <function op_info at 0x1053bd2f0>
2015-08-18 14:14:08,490 root:INFO op_info
2015-08-18 14:14:08,490 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:14:08,491 oic.oic.provider:INFO provider_info_response: {'version': '3.0', 'claims_supported': ['zoneinfo', 'phone_number_verified', 'profile', 'website', 'birthdate', 'address', 'middle_name', 'locale', 'email', 'family_name', 'given_name', 'gender', 'sub', 'name', 'preferred_username', 'nickname', 'updated_at', 'phone_number', 'email_verified', 'picture'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_signing_alg_values_supported': ['RS384', 'ES384', 'ES256', 'ES512', 'RS256', 'HS384', 'RS512', 'HS256', 'none', 'PS256', 'PS512', 'HS512', 'PS384'], 'request_uri_parameter_supported': True, 'id_token_signing_alg_values_supported': ['RS384', 'ES384', 'ES256', 'ES512', 'RS256', 'HS384', 'RS512', 'HS256', 'none', 'PS256', 'PS512', 'HS512', 'PS384'], 'request_object_signing_alg_values_supported': ['RS384', 'ES384', 'ES256', 'ES512', 'RS256', 'HS384', 'RS512', 'HS256', 'none', 'PS256', 'PS512', 'HS512', 'PS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'require_request_uri_registration': True, 'end_session_endpoint': 'https://localhost:8092/end_session', 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint': 'https://localhost:8092/token', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'scopes_supported': ['openid', 'profile', 'address', 'phone', 'email', 'offline_access', 'openid'], 'request_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'subject_types_supported': ['public', 'pairwise'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'authorization_endpoint': 'https://localhost:8092/authorization', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'ES384', 'ES256', 'ES512', 'RS256', 'HS384', 'RS512', 'HS256', 'PS256', 'PS512', 'HS512', 'PS384']}
2015-08-18 14:14:08,569 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105544940>
2015-08-18 14:14:08,570 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "response_types": ["code"], "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 14:14:08,570 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:14:08,580 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': '8Uau9lGoobiZncsgLmBSbrXZw4GUFFuD', 'registration_client_uri': 'https://localhost:8092/registration?client_id=FwdHyrtTDRP2', 'client_secret_expires_at': 1439982848, 'client_id': 'FwdHyrtTDRP2', 'client_secret': 'f074dfbc788fc52fe3da186922842f345ea4a0a54ae340d95e2319da', 'client_id_issued_at': 1439896448}
2015-08-18 14:14:08,582 oic.utils.keyio:DEBUG loading keys for issuer: FwdHyrtTDRP2
2015-08-18 14:14:08,582 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:14:08,583 oic.oic.provider:DEBUG keys for FwdHyrtTDRP2: []
2015-08-18 14:14:08,585 oic.oic.provider:INFO Client info: {'registration_access_token': '8Uau9lGoobiZncsgLmBSbrXZw4GUFFuD', 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=FwdHyrtTDRP2', 'client_secret_expires_at': 1439982848, 'client_id': 'FwdHyrtTDRP2', 'client_secret': 'f074dfbc788fc52fe3da186922842f345ea4a0a54ae340d95e2319da', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_id_issued_at': 1439896448, 'redirect_uris': [('http://localhost:8666/authz_cb', None)]}
2015-08-18 14:14:08,585 oic.oic.provider:DEBUG registration_response: {'registration_access_token': '8Uau9lGoobiZncsgLmBSbrXZw4GUFFuD', 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=FwdHyrtTDRP2', 'client_secret_expires_at': 1439982848, 'client_id': 'FwdHyrtTDRP2', 'client_secret': 'f074dfbc788fc52fe3da186922842f345ea4a0a54ae340d95e2319da', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_id_issued_at': 1439896448}
2015-08-18 14:14:08,602 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105389470>
2015-08-18 14:14:08,602 oic.oauth2.provider:DEBUG Request: 'nonce=oFExBJTgxAfkhtYs&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=FwdHyrtTDRP2&scope=openid+profile+email+address+phone&response_type=code&acr_values=SAML&state=4VTVMNHu4EazMOV6'
2015-08-18 14:14:08,603 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f4278>, <jwkest.jwk.RSAKey object at 0x1057c2128>, <jwkest.jwk.ECKey object at 0x1057c24a8>]
2015-08-18 14:14:08,603 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'nonce': 'oFExBJTgxAfkhtYs', 'scope': 'openid profile email address phone', 'state': '4VTVMNHu4EazMOV6', 'response_type': 'code'}
2015-08-18 14:14:08,606 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'nonce': 'oFExBJTgxAfkhtYs', 'scope': 'openid profile email address phone', 'state': '4VTVMNHu4EazMOV6', 'response_type': 'code'}
2015-08-18 14:14:08,608 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:14:08,608 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:14:08,608 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:14:08,609 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:14:08,610 oic.utils.authn.user:INFO do_authentication argv: {'acr': ['SAML'], 'login_title': 'Username', 'logo_uri': '', 'passwd_title': 'Password', 'password': '', 'login': '', 'query': 'nonce=oFExBJTgxAfkhtYs&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=FwdHyrtTDRP2&scope=openid+profile+email+address+phone&response_type=code&acr_values=SAML&state=4VTVMNHu4EazMOV6', 'action': 'https://localhost:8092/verify', 'tos_uri': '', 'submit_text': 'Submit', 'title': 'User log in', 'policy_uri': '', 'client_policy_title': 'Client Policy'}
2015-08-18 14:14:08,625 oicServer:INFO callback: <function css at 0x10538e620>
2015-08-18 14:14:12,151 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105746598>
2015-08-18 14:14:12,152 oic.utils.authn.user:DEBUG verify(query=nonce%3DoFExBJTgxAfkhtYs%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26client_id%3DFwdHyrtTDRP2%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26acr_values%3DSAML%26state%3D4VTVMNHu4EazMOV6&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:14:12,153 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'acr_values': ["['SAML']"], 'query': ['nonce=oFExBJTgxAfkhtYs&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=FwdHyrtTDRP2&scope=openid+profile+email+address+phone&response_type=code&acr_values=SAML&state=4VTVMNHu4EazMOV6'], 'form.commit': ['Submit'], 'password': ['krall']}
2015-08-18 14:14:12,153 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-18 14:14:12,156 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'client_id': ['FwdHyrtTDRP2'], 'nonce': ['oFExBJTgxAfkhtYs'], 'state': ['4VTVMNHu4EazMOV6'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true', 'response_type': ['code']}
2015-08-18 14:14:12,174 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x105389470>
2015-08-18 14:14:12,175 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=FwdHyrtTDRP2&nonce=oFExBJTgxAfkhtYs&state=4VTVMNHu4EazMOV6&scope=openid+profile+email+address+phone&upm_answer=true&response_type=code'
2015-08-18 14:14:12,175 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f4278>, <jwkest.jwk.RSAKey object at 0x1057c2128>, <jwkest.jwk.ECKey object at 0x1057c24a8>]
2015-08-18 14:14:12,176 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'nonce': 'oFExBJTgxAfkhtYs', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': '4VTVMNHu4EazMOV6', 'response_type': 'code'}
2015-08-18 14:14:12,178 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'nonce': 'oFExBJTgxAfkhtYs', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': '4VTVMNHu4EazMOV6', 'response_type': 'code'}
2015-08-18 14:14:12,179 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:14:12,180 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:14:12,180 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:14:12,182 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:14:12,183 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:14:12,184 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'redirect_uri', 'client_id', 'nonce', 'state', 'scope', 'upm_answer', 'response_type']
2015-08-18 14:14:12,186 oic.utils.sdb:DEBUG uid2sid: {'diana': ['c11419496ee614d1900a14fc02d75ba4cc52797a262ebac7a1712a9b']}
2015-08-18 14:14:12,187 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:14:12,187 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:14:12,190 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=HCEdnM3nXYsy%2F3YenZEdPFftfzjRxzWC%2FmHcM8UKSw0NzIsvb1myZ9JCc2l968bfpiU75MGianytIYVi3MD1FFpCn63xSckGTBrr8S4G8xw%3D&scope=openid+profile+email+address+phone&state=4VTVMNHu4EazMOV6' (<class 'str'>)
2015-08-18 14:14:15,544 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x105389518>
2015-08-18 14:14:16,686 oic.oic.provider:DEBUG - token -
2015-08-18 14:14:16,687 oic.oic.provider:INFO token_request: code=HCEdnM3nXYsy%2F3YenZEdPFftfzjRxzWC%2FmHcM8UKSw0NzIsvb1myZ9JCc2l968bfpiU75MGianytIYVi3MD1FFpCn63xSckGTBrr8S4G8xw%3D&client_id=FwdHyrtTDRP2&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=f074dfbc788fc52fe3da186922842f345ea4a0a54ae340d95e2319da&token_type=pop&key=eyJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0ifQ%3D%3D&grant_type=authorization_code
2015-08-18 14:14:16,687 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'token_type': 'pop', 'key': 'eyJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0ifQ==', 'grant_type': 'authorization_code', 'client_secret': 'f074dfbc788fc52fe3da186922842f345ea4a0a54ae340d95e2319da', 'code': 'HCEdnM3nXYsy/3YenZEdPFftfzjRxzWC/mHcM8UKSw0NzIsvb1myZ9JCc2l968bfpiU75MGianytIYVi3MD1FFpCn63xSckGTBrr8S4G8xw='}
2015-08-18 14:14:16,688 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'token_type': 'pop', 'key': 'eyJrdHkiOiAiUlNBIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIiLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJraWQiOiAiYTAiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0ifQ==', 'grant_type': 'authorization_code', 'client_secret': 'f074dfbc788fc52fe3da186922842f345ea4a0a54ae340d95e2319da', 'code': 'HCEdnM3nXYsy/3YenZEdPFftfzjRxzWC/mHcM8UKSw0NzIsvb1myZ9JCc2l968bfpiU75MGianytIYVi3MD1FFpCn63xSckGTBrr8S4G8xw='}
2015-08-18 14:14:16,689 oic.utils.authn.client:DEBUG Verified Client ID: FwdHyrtTDRP2
2015-08-18 14:14:16,693 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:14:16,695 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'nonce': 'oFExBJTgxAfkhtYs', 'state': '4VTVMNHu4EazMOV6', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'response_type': 'code'}
2015-08-18 14:14:16,695 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:14:16,696 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'FwdHyrtTDRP2', 'nonce': 'oFExBJTgxAfkhtYs', 'state': '4VTVMNHu4EazMOV6', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'response_type': 'code'}
2015-08-18 14:14:16,697 oic.oic.provider:DEBUG id_token: {'acr': 'PASSWORD', 'sub': '-5a3f308c9bc114ea', 'aud': ['FwdHyrtTDRP2'], 'exp': 1439979256, 'iss': 'https://localhost:8092/', 'iat': 1439900056, 'auth_time': 1439900052, 'nonce': 'oFExBJTgxAfkhtYs'}
2015-08-18 14:14:16,699 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-18 14:14:16,699 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op2", "kty": "EC", "y": "Jl2aRN1-_ngvGFRwCHFUFGTMLO-_aa_EtttS7maOvFM", "x": "jrOI346mI6agwv1D8NLpQtimPR7C5aJGubf6MGvUXEc", "use": "sig"}]}
2015-08-18 14:14:16,700 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op3", "kty": "EC", "y": "ZWr9AfqNRV5elxCyeB8h5jAjFLbBU-kbdnOOPGP17bw", "x": "01YSKvhk240U97_HUNgtZT9Z3s5F6IHssOy4pK6gf8U", "use": "enc"}]}
2015-08-18 14:14:16,700 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c2128>]
2015-08-18 14:14:16,709 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:14:16,710 oic.oic.provider:DEBUG _tinfo: {'authzreq': '{"acr_values": "SAML", "redirect_uri": "http://localhost:8666/authz_cb", "client_id": "FwdHyrtTDRP2", "nonce": "oFExBJTgxAfkhtYs", "upm_answer": "true", "scope": "openid profile email address phone", "state": "4VTVMNHu4EazMOV6", "response_type": "code"}', 'token_expires_at': 1439900056, 'permission': '', 'expires_in': 3600, 'refresh_token': 'HCEdnM3nXYsy/3YenZEdPFftfzjRxzWC/mHcM8UKSw0NzIsvb1myZ9JCc2l968bfr4inQzcDYC1upBdhs0KoNkNJ2tQOG06H3FhHxwoCNt8=', 'sub': '-5a3f308c9bc114ea', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi01YTNmMzA4YzliYzExNGVhIiwgImF1ZCI6IFsiRndkSHlydFREUlAyIl0sICJleHAiOiAxNDM5OTc5MjU2LCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0Mzk5MDAwNTYsICJhdXRoX3RpbWUiOiAxNDM5OTAwMDUyLCAibm9uY2UiOiAib0ZFeEJKVGd4QWZraHRZcyJ9.UJevNaCytJ0fZOFaaHRkh20lveqxOhQUZXblj1Z8R-mgsGF36fMwuXjqi-pbrSe7T7NwXnwNzZJVJtXcXejq_i5BEBcTVkd6TVRaJAcVXGvq8MTTu10eXNUTXMGwHlUwVW2YoG8tSFYdFN2LtzuQfr7ecAryupqgT8JbT5yPdtV0CfnkAx-0EUhnscPESvW8ECVJqVdQ3gKrSX4gjAQ4v_hFJIwcbVMimIDcGmKq7cgfQ-llnpNeAx5ATyA_Th4qKUm14VBY7Kbvp-VN0w3E-8-JkEGWKfncTSiRgfrOTpZ5-m7USP8XSqCEklcDI5jsSV6tLR2XFEUJMMxYeGHS7A', 'token_type': 'Bearer', 'state': '4VTVMNHu4EazMOV6', 'revoked': False, 'oauth_state': 'token', 'access_token': 'HCEdnM3nXYsy/3YenZEdPFftfzjRxzWC/mHcM8UKSw0NzIsvb1myZ9JCc2l968bfMkxHBf5G6dIJgrzMD8iDQB2lKhEX0ZYz4X95a/oXVA4=', 'code_used': True, 'client_id': 'FwdHyrtTDRP2', 'nonce': 'oFExBJTgxAfkhtYs', 'access_token_scope': '?', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code': 'HCEdnM3nXYsy/3YenZEdPFftfzjRxzWC/mHcM8UKSw0NzIsvb1myZ9JCc2l968bfpiU75MGianytIYVi3MD1FFpCn63xSckGTBrr8S4G8xw=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f4fd0>, 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:14:16,710 oic.oic.provider:DEBUG access_token_response: {'access_token': 'HCEdnM3nXYsy/3YenZEdPFftfzjRxzWC/mHcM8UKSw0NzIsvb1myZ9JCc2l968bfMkxHBf5G6dIJgrzMD8iDQB2lKhEX0ZYz4X95a/oXVA4=', 'refresh_token': 'HCEdnM3nXYsy/3YenZEdPFftfzjRxzWC/mHcM8UKSw0NzIsvb1myZ9JCc2l968bfr4inQzcDYC1upBdhs0KoNkNJ2tQOG06H3FhHxwoCNt8=', 'expires_in': 3600, 'token_type': 'Bearer', 'state': '4VTVMNHu4EazMOV6', 'scope': 'openid profile email address phone', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi01YTNmMzA4YzliYzExNGVhIiwgImF1ZCI6IFsiRndkSHlydFREUlAyIl0sICJleHAiOiAxNDM5OTc5MjU2LCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImlhdCI6IDE0Mzk5MDAwNTYsICJhdXRoX3RpbWUiOiAxNDM5OTAwMDUyLCAibm9uY2UiOiAib0ZFeEJKVGd4QWZraHRZcyJ9.UJevNaCytJ0fZOFaaHRkh20lveqxOhQUZXblj1Z8R-mgsGF36fMwuXjqi-pbrSe7T7NwXnwNzZJVJtXcXejq_i5BEBcTVkd6TVRaJAcVXGvq8MTTu10eXNUTXMGwHlUwVW2YoG8tSFYdFN2LtzuQfr7ecAryupqgT8JbT5yPdtV0CfnkAx-0EUhnscPESvW8ECVJqVdQ3gKrSX4gjAQ4v_hFJIwcbVMimIDcGmKq7cgfQ-llnpNeAx5ATyA_Th4qKUm14VBY7Kbvp-VN0w3E-8-JkEGWKfncTSiRgfrOTpZ5-m7USP8XSqCEklcDI5jsSV6tLR2XFEUJMMxYeGHS7A'}
2015-08-18 14:14:16,717 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:14:16,738 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:14:27,510 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x105544898>
2015-08-18 14:14:51,054 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 14:18:20,013 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 14:18:20,013 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "kid": "op2", "use": "sig", "y": "-0U2WWm1Sfw3BR6DH49mm3ANwIW8vOVkhPsJTvClMWE", "x": "lNwsIlIT3kfULxYp8Z6gMSglKyLY5abLYKJbPp9_85M", "crv": "P-256"}]}
2015-08-18 14:18:20,014 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "kid": "op3", "use": "enc", "y": "L66xbUrg6EKwpVufrt6zQJpLo8sOlrMcYVlyP29EAnE", "x": "-ewmqkr6JcTAjuaeYD6y9EIJKFXCvS2lsgeusvnRUd8", "crv": "P-256"}]}
2015-08-18 14:18:20,014 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:18:21,855 oicServer:INFO callback: <function webfinger at 0x1054d26a8>
2015-08-18 14:18:21,876 oicServer:INFO callback: <function op_info at 0x1054d22f0>
2015-08-18 14:18:21,876 root:INFO op_info
2015-08-18 14:18:21,876 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:18:21,877 oic.oic.provider:INFO provider_info_response: {'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'version': '3.0', 'claims_supported': ['gender', 'profile', 'family_name', 'nickname', 'locale', 'sub', 'updated_at', 'email', 'phone_number_verified', 'phone_number', 'address', 'website', 'middle_name', 'picture', 'preferred_username', 'birthdate', 'given_name', 'zoneinfo', 'name', 'email_verified'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'require_request_uri_registration': True, 'request_parameter_supported': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'acr_values_supported': ['PASSWORD'], 'userinfo_signing_alg_values_supported': ['PS512', 'ES512', 'RS256', 'HS256', 'none', 'HS512', 'PS256', 'ES256', 'RS384', 'RS512', 'ES384', 'HS384', 'PS384'], 'scopes_supported': ['profile', 'openid', 'email', 'offline_access', 'phone', 'address', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'request_uri_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'claims_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['PS512', 'ES512', 'RS256', 'HS256', 'none', 'HS512', 'PS256', 'ES256', 'RS384', 'RS512', 'ES384', 'HS384', 'PS384'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_signing_alg_values_supported': ['PS512', 'ES512', 'RS256', 'HS256', 'none', 'HS512', 'PS256', 'ES256', 'RS384', 'RS512', 'ES384', 'HS384', 'PS384'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['PS512', 'ES512', 'RS256', 'HS256', 'HS512', 'PS256', 'ES256', 'RS384', 'RS512', 'ES384', 'HS384', 'PS384'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'issuer': 'https://localhost:8092/'}
2015-08-18 14:18:21,950 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105527978>
2015-08-18 14:18:21,950 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "response_types": ["code"]}>>
2015-08-18 14:18:21,951 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:18:21,957 oic.oic.provider:DEBUG _cinfo: {'client_secret': '775a4ca2cc16941bada99ac2fd6009c1e73993d2bbda43f3905d0031', 'client_id': 'NnX1PmkgAhQZ', 'registration_client_uri': 'https://localhost:8092/registration?client_id=NnX1PmkgAhQZ', 'registration_access_token': 'IUxmFNFZnDpHimbgfyoh6CoishkdqfjD', 'client_id_issued_at': 1439896701, 'client_secret_expires_at': 1439983101}
2015-08-18 14:18:21,958 oic.utils.keyio:DEBUG loading keys for issuer: NnX1PmkgAhQZ
2015-08-18 14:18:21,959 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:18:21,959 oic.oic.provider:DEBUG keys for NnX1PmkgAhQZ: []
2015-08-18 14:18:21,961 oic.oic.provider:INFO Client info: {'client_secret': '775a4ca2cc16941bada99ac2fd6009c1e73993d2bbda43f3905d0031', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'client_id': 'NnX1PmkgAhQZ', 'contacts': ['ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=NnX1PmkgAhQZ', 'application_type': 'web', 'registration_access_token': 'IUxmFNFZnDpHimbgfyoh6CoishkdqfjD', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1439896701, 'client_secret_expires_at': 1439983101, 'response_types': ['code']}
2015-08-18 14:18:21,962 oic.oic.provider:DEBUG registration_response: {'client_secret': '775a4ca2cc16941bada99ac2fd6009c1e73993d2bbda43f3905d0031', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=NnX1PmkgAhQZ', 'application_type': 'web', 'registration_access_token': 'IUxmFNFZnDpHimbgfyoh6CoishkdqfjD', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_id': 'NnX1PmkgAhQZ', 'client_id_issued_at': 1439896701, 'client_secret_expires_at': 1439983101, 'response_types': ['code']}
2015-08-18 14:18:21,980 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10549d4a8>
2015-08-18 14:18:21,980 oic.oauth2.provider:DEBUG Request: 'nonce=jvswoTW7jNXSVYuo&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&client_id=NnX1PmkgAhQZ&state=YPpwwN4ZU7MC1hGh&scope=openid+profile+email+address+phone'
2015-08-18 14:18:21,982 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056d62b0>, <jwkest.jwk.RSAKey object at 0x1056a5160>, <jwkest.jwk.ECKey object at 0x1056a54e0>]
2015-08-18 14:18:21,982 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'NnX1PmkgAhQZ', 'response_type': 'code', 'nonce': 'jvswoTW7jNXSVYuo', 'state': 'YPpwwN4ZU7MC1hGh'}
2015-08-18 14:18:21,985 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'NnX1PmkgAhQZ', 'response_type': 'code', 'nonce': 'jvswoTW7jNXSVYuo', 'state': 'YPpwwN4ZU7MC1hGh'}
2015-08-18 14:18:21,987 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:18:21,987 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:18:21,987 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:18:21,988 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:18:21,989 oic.utils.authn.user:INFO do_authentication argv: {'query': 'nonce=jvswoTW7jNXSVYuo&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&client_id=NnX1PmkgAhQZ&state=YPpwwN4ZU7MC1hGh&scope=openid+profile+email+address+phone', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'client_policy_title': 'Client Policy', 'password': '', 'login': '', 'title': 'User log in', 'passwd_title': 'Password', 'logo_uri': '', 'submit_text': 'Submit', 'tos_uri': '', 'acr': ['SAML'], 'login_title': 'Username'}
2015-08-18 14:18:22,005 oicServer:INFO callback: <function css at 0x1054a2620>
2015-08-18 14:18:25,751 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10562d598>
2015-08-18 14:18:25,751 oic.utils.authn.user:DEBUG verify(query=nonce%3DjvswoTW7jNXSVYuo%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26acr_values%3DSAML%26response_type%3Dcode%26client_id%3DNnX1PmkgAhQZ%26state%3DYPpwwN4ZU7MC1hGh%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:18:25,752 oic.utils.authn.user:DEBUG dict: {'query': ['nonce=jvswoTW7jNXSVYuo&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&client_id=NnX1PmkgAhQZ&state=YPpwwN4ZU7MC1hGh&scope=openid+profile+email+address+phone'], 'acr_values': ["['SAML']"], 'form.commit': ['Submit'], 'password': ['krall'], 'login': ['diana']}
2015-08-18 14:18:25,752 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-18 14:18:25,754 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'response_type': ['code'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone'], 'client_id': ['NnX1PmkgAhQZ'], 'upm_answer': 'true', 'nonce': ['jvswoTW7jNXSVYuo'], 'state': ['YPpwwN4ZU7MC1hGh']}
2015-08-18 14:18:25,773 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10549d4a8>
2015-08-18 14:18:25,773 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=NnX1PmkgAhQZ&upm_answer=true&nonce=jvswoTW7jNXSVYuo&state=YPpwwN4ZU7MC1hGh'
2015-08-18 14:18:25,774 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056d62b0>, <jwkest.jwk.RSAKey object at 0x1056a5160>, <jwkest.jwk.ECKey object at 0x1056a54e0>]
2015-08-18 14:18:25,774 oic.oauth2.provider:DEBUG AuthzRequest: {'acr_values': 'SAML', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'NnX1PmkgAhQZ', 'response_type': 'code', 'nonce': 'jvswoTW7jNXSVYuo', 'state': 'YPpwwN4ZU7MC1hGh'}
2015-08-18 14:18:25,776 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'acr_values': 'SAML', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'NnX1PmkgAhQZ', 'response_type': 'code', 'nonce': 'jvswoTW7jNXSVYuo', 'state': 'YPpwwN4ZU7MC1hGh'}
2015-08-18 14:18:25,778 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:18:25,778 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:18:25,779 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:18:25,780 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:18:25,780 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:18:25,781 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'response_type', 'redirect_uri', 'scope', 'client_id', 'upm_answer', 'nonce', 'state']
2015-08-18 14:18:25,782 oic.utils.sdb:DEBUG uid2sid: {'diana': ['d91fc4611436744704c5ca465834fe4a55cb4cfc7e91336e7a96ccc6']}
2015-08-18 14:18:25,783 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:18:25,783 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:18:25,788 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=1zu9JX6Mm1X%2FpUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc%2FtAW0Y5iVuRbmSeGd%2BWqVCnf8CXPCJEGTKzyULfBm3%2FY%3D&state=YPpwwN4ZU7MC1hGh&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 14:18:28,220 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10549d550>
2015-08-18 14:18:29,193 oic.oic.provider:DEBUG - token -
2015-08-18 14:18:29,193 oic.oic.provider:INFO token_request: grant_type=authorization_code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=1zu9JX6Mm1X%2FpUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc%2FtAW0Y5iVuRbmSeGd%2BWqVCnf8CXPCJEGTKzyULfBm3%2FY%3D&token_type=pop&client_secret=775a4ca2cc16941bada99ac2fd6009c1e73993d2bbda43f3905d0031&key=eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ%3D%3D&client_id=NnX1PmkgAhQZ
2015-08-18 14:18:29,194 oic.oic.provider:DEBUG AccessTokenRequest: {'client_secret': '775a4ca2cc16941bada99ac2fd6009c1e73993d2bbda43f3905d0031', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code': '1zu9JX6Mm1X/pUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc/tAW0Y5iVuRbmSeGd+WqVCnf8CXPCJEGTKzyULfBm3/Y=', 'client_id': 'NnX1PmkgAhQZ', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'token_type': 'pop', 'grant_type': 'authorization_code'}
2015-08-18 14:18:29,194 oic.utils.authn.client:DEBUG REQ: {'client_secret': '775a4ca2cc16941bada99ac2fd6009c1e73993d2bbda43f3905d0031', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code': '1zu9JX6Mm1X/pUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc/tAW0Y5iVuRbmSeGd+WqVCnf8CXPCJEGTKzyULfBm3/Y=', 'client_id': 'NnX1PmkgAhQZ', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJ1c2UiOiAic2lnIiwgImtpZCI6ICJhMCIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'token_type': 'pop', 'grant_type': 'authorization_code'}
2015-08-18 14:18:29,196 oic.utils.authn.client:DEBUG Verified Client ID: NnX1PmkgAhQZ
2015-08-18 14:18:29,199 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:18:29,201 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'NnX1PmkgAhQZ', 'upm_answer': 'true', 'nonce': 'jvswoTW7jNXSVYuo', 'state': 'YPpwwN4ZU7MC1hGh'}
2015-08-18 14:18:29,201 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:18:29,201 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'NnX1PmkgAhQZ', 'upm_answer': 'true', 'nonce': 'jvswoTW7jNXSVYuo', 'state': 'YPpwwN4ZU7MC1hGh'}
2015-08-18 14:18:29,202 oic.oic.provider:DEBUG id_token: {'iat': 1439900309, 'exp': 1439979509, 'aud': ['NnX1PmkgAhQZ'], 'auth_time': 1439900305, 'nonce': 'jvswoTW7jNXSVYuo', 'sub': '-488c8d1e6b92bb38', 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/'}
2015-08-18 14:18:29,206 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 14:18:29,208 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "kid": "op2", "use": "sig", "y": "-0U2WWm1Sfw3BR6DH49mm3ANwIW8vOVkhPsJTvClMWE", "x": "lNwsIlIT3kfULxYp8Z6gMSglKyLY5abLYKJbPp9_85M", "crv": "P-256"}]}
2015-08-18 14:18:29,208 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "kid": "op3", "use": "enc", "y": "L66xbUrg6EKwpVufrt6zQJpLo8sOlrMcYVlyP29EAnE", "x": "-ewmqkr6JcTAjuaeYD6y9EIJKFXCvS2lsgeusvnRUd8", "crv": "P-256"}]}
2015-08-18 14:18:29,208 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1056a5160>]
2015-08-18 14:18:29,216 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:18:29,217 oic.oic.provider:DEBUG _tinfo: {'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1056d6ef0>, 'oauth_state': 'token', 'authzreq': '{"acr_values": "SAML", "upm_answer": "true", "redirect_uri": "http://localhost:8666/authz_cb", "scope": "openid profile email address phone", "client_id": "NnX1PmkgAhQZ", "response_type": "code", "nonce": "jvswoTW7jNXSVYuo", "state": "YPpwwN4ZU7MC1hGh"}', 'code': '1zu9JX6Mm1X/pUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc/tAW0Y5iVuRbmSeGd+WqVCnf8CXPCJEGTKzyULfBm3/Y=', 'sub': '-488c8d1e6b92bb38', 'code_used': True, 'revoked': False, 'access_token': '1zu9JX6Mm1X/pUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc/2HZ3jXKn2lb2UD88JPNe8yKwDtVKzrl5EoeinYxumxA=', 'token_type': 'Bearer', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5OTAwMzA5LCAiZXhwIjogMTQzOTk3OTUwOSwgImF1ZCI6IFsiTm5YMVBta2dBaFFaIl0sICJhdXRoX3RpbWUiOiAxNDM5OTAwMzA1LCAibm9uY2UiOiAianZzd29UVzdqTlhTVll1byIsICJzdWIiOiAiLTQ4OGM4ZDFlNmI5MmJiMzgiLCAiYWNyIjogIlBBU1NXT1JEIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyJ9.FlC1jefh_26EX5YLDN2XBqG6LtMFZJwCLXnixTxkcx8uVSSXR9LxHx7eoxfJEu5dPMrSkVqTTKHfhLO7hjJDOWlahrPZvN0J_fN55LFT1TGBNKiRcwSHSwfxEVzw_VxM-obPjud-Vn0lf0zZtaqWsymql8_l6ZkCLXSYiiLC36pJ0iSFSxSpslk80R0fMsuJp_3iD6acKqgjbg-IFbvbnM1cD58yHEsZCLSOECoSjxZpcQ8htPiowzqArgx-vU0Vz1dMpBD9YNeDjDpXmkVvIP6BOonzTWursZd8zZy-0uf0OMtgm7Ylu46u3TPdcquCyvnsLTxoirPfJmdO7_h-IQ', 'access_token_scope': '?', 'refresh_token': '1zu9JX6Mm1X/pUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc/mlcr3cfAAyHPveZRdK3wV7T6uXl3xd3nCx1QcmrbBUs=', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'client_id': 'NnX1PmkgAhQZ', 'token_expires_at': 1439900309, 'expires_in': 3600, 'nonce': 'jvswoTW7jNXSVYuo', 'state': 'YPpwwN4ZU7MC1hGh', 'permission': ''}
2015-08-18 14:18:29,217 oic.oic.provider:DEBUG access_token_response: {'access_token': '1zu9JX6Mm1X/pUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc/2HZ3jXKn2lb2UD88JPNe8yKwDtVKzrl5EoeinYxumxA=', 'refresh_token': '1zu9JX6Mm1X/pUChs0VIbCMqshOVdDGNTzYiTDwj3yiwLfaL7aRF9S8wWbmyxzc/mlcr3cfAAyHPveZRdK3wV7T6uXl3xd3nCx1QcmrbBUs=', 'scope': 'openid profile email address phone', 'expires_in': 3600, 'token_type': 'Bearer', 'state': 'YPpwwN4ZU7MC1hGh', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5OTAwMzA5LCAiZXhwIjogMTQzOTk3OTUwOSwgImF1ZCI6IFsiTm5YMVBta2dBaFFaIl0sICJhdXRoX3RpbWUiOiAxNDM5OTAwMzA1LCAibm9uY2UiOiAianZzd29UVzdqTlhTVll1byIsICJzdWIiOiAiLTQ4OGM4ZDFlNmI5MmJiMzgiLCAiYWNyIjogIlBBU1NXT1JEIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyJ9.FlC1jefh_26EX5YLDN2XBqG6LtMFZJwCLXnixTxkcx8uVSSXR9LxHx7eoxfJEu5dPMrSkVqTTKHfhLO7hjJDOWlahrPZvN0J_fN55LFT1TGBNKiRcwSHSwfxEVzw_VxM-obPjud-Vn0lf0zZtaqWsymql8_l6ZkCLXSYiiLC36pJ0iSFSxSpslk80R0fMsuJp_3iD6acKqgjbg-IFbvbnM1cD58yHEsZCLSOECoSjxZpcQ8htPiowzqArgx-vU0Vz1dMpBD9YNeDjDpXmkVvIP6BOonzTWursZd8zZy-0uf0OMtgm7Ylu46u3TPdcquCyvnsLTxoirPfJmdO7_h-IQ'}
2015-08-18 14:18:29,226 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:18:29,248 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:18:33,036 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1055278d0>
2015-08-18 14:19:07,700 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 14:30:03,552 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA"}]}
2015-08-18 14:30:03,552 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kid": "op2", "y": "ENH5hWrePYolef_SuVKfMq_zlcTXmS4mIZTHSixrvsE", "x": "gIgVC7ZotFNVsV6OWyhK0KGf1V-lBbXQhv0rwlIuFqg", "kty": "EC"}]}
2015-08-18 14:30:03,553 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kid": "op3", "y": "lE81EneuEWm6cRpFzRt32jH6gWK8qTE_nLTg6d4pLck", "x": "m4PLoP-9A41T-od91ZMVY6nUeNceGsNIl1XLyDTvMwA", "kty": "EC"}]}
2015-08-18 14:30:03,553 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:30:08,195 oicServer:INFO callback: <function webfinger at 0x1055d36a8>
2015-08-18 14:30:08,215 oicServer:INFO callback: <function op_info at 0x1055d32f0>
2015-08-18 14:30:08,215 root:INFO op_info
2015-08-18 14:30:08,216 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:30:08,217 oic.oic.provider:INFO provider_info_response: {'authorization_endpoint': 'https://localhost:8092/authorization', 'request_parameter_supported': True, 'version': '3.0', 'token_endpoint': 'https://localhost:8092/token', 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'ES256', 'HS256', 'HS512', 'RS256', 'RS384', 'PS512', 'ES512', 'RS512', 'PS256', 'PS384', 'ES384'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_signing_alg_values_supported': ['HS384', 'ES256', 'HS256', 'HS512', 'RS256', 'RS384', 'PS512', 'ES512', 'RS512', 'none', 'PS256', 'PS384', 'ES384'], 'userinfo_signing_alg_values_supported': ['HS384', 'ES256', 'HS256', 'HS512', 'RS256', 'RS384', 'PS512', 'ES512', 'RS512', 'none', 'PS256', 'PS384', 'ES384'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'registration_endpoint': 'https://localhost:8092/registration', 'acr_values_supported': ['PASSWORD'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'id_token_signing_alg_values_supported': ['HS384', 'ES256', 'HS256', 'HS512', 'RS256', 'RS384', 'PS512', 'ES512', 'RS512', 'none', 'PS256', 'PS384', 'ES384'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['picture', 'nickname', 'website', 'zoneinfo', 'locale', 'middle_name', 'email', 'updated_at', 'birthdate', 'given_name', 'email_verified', 'gender', 'name', 'family_name', 'profile', 'preferred_username', 'address', 'sub', 'phone_number', 'phone_number_verified'], 'scopes_supported': ['profile', 'address', 'email', 'openid', 'offline_access', 'phone', 'openid'], 'request_uri_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'issuer': 'https://localhost:8092/'}
2015-08-18 14:30:08,287 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105628978>
2015-08-18 14:30:08,288 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "application_type": "web", "response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 14:30:08,289 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:30:08,295 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'e67ce45e4631f7c6c4f23b93074276dc0fecf61afc54a723569071e3', 'registration_access_token': 'wVECaB8IWnFpFJ0RvjSHKPBnBacnjZR2', 'client_secret_expires_at': 1439983808, 'client_id': 'IUbc1Nn7qOx1', 'client_id_issued_at': 1439897408, 'registration_client_uri': 'https://localhost:8092/registration?client_id=IUbc1Nn7qOx1'}
2015-08-18 14:30:08,297 oic.utils.keyio:DEBUG loading keys for issuer: IUbc1Nn7qOx1
2015-08-18 14:30:08,297 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:30:08,297 oic.oic.provider:DEBUG keys for IUbc1Nn7qOx1: []
2015-08-18 14:30:08,299 oic.oic.provider:INFO Client info: {'client_secret': 'e67ce45e4631f7c6c4f23b93074276dc0fecf61afc54a723569071e3', 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'registration_access_token': 'wVECaB8IWnFpFJ0RvjSHKPBnBacnjZR2', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439983808, 'client_id': 'IUbc1Nn7qOx1', 'client_id_issued_at': 1439897408, 'registration_client_uri': 'https://localhost:8092/registration?client_id=IUbc1Nn7qOx1'}
2015-08-18 14:30:08,300 oic.oic.provider:DEBUG registration_response: {'client_secret': 'e67ce45e4631f7c6c4f23b93074276dc0fecf61afc54a723569071e3', 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'registration_access_token': 'wVECaB8IWnFpFJ0RvjSHKPBnBacnjZR2', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1439983808, 'client_id': 'IUbc1Nn7qOx1', 'client_id_issued_at': 1439897408, 'registration_client_uri': 'https://localhost:8092/registration?client_id=IUbc1Nn7qOx1'}
2015-08-18 14:30:08,316 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10559e4a8>
2015-08-18 14:30:08,316 oic.oauth2.provider:DEBUG Request: 'response_type=code&nonce=mw2BsRdf8R1GKGjZ&client_id=IUbc1Nn7qOx1&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&acr_values=SAML&state=6CaApiuIXlAB5HX3'
2015-08-18 14:30:08,317 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057d62b0>, <jwkest.jwk.RSAKey object at 0x1057a6160>, <jwkest.jwk.ECKey object at 0x1057a65c0>]
2015-08-18 14:30:08,317 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'mw2BsRdf8R1GKGjZ', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'IUbc1Nn7qOx1', 'scope': 'openid profile email address phone', 'state': '6CaApiuIXlAB5HX3'}
2015-08-18 14:30:08,320 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'mw2BsRdf8R1GKGjZ', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'IUbc1Nn7qOx1', 'scope': 'openid profile email address phone', 'state': '6CaApiuIXlAB5HX3'}
2015-08-18 14:30:08,322 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:30:08,322 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:30:08,322 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:30:08,323 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:30:08,324 oic.utils.authn.user:INFO do_authentication argv: {'passwd_title': 'Password', 'login': '', 'tos_uri': '', 'policy_uri': '', 'submit_text': 'Submit', 'query': 'response_type=code&nonce=mw2BsRdf8R1GKGjZ&client_id=IUbc1Nn7qOx1&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&acr_values=SAML&state=6CaApiuIXlAB5HX3', 'client_policy_title': 'Client Policy', 'acr': ['SAML'], 'password': '', 'action': 'https://localhost:8092/verify', 'login_title': 'Username', 'title': 'User log in', 'logo_uri': ''}
2015-08-18 14:30:08,339 oicServer:INFO callback: <function css at 0x1055a3620>
2015-08-18 14:30:12,734 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10572d598>
2015-08-18 14:30:12,735 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26nonce%3Dmw2BsRdf8R1GKGjZ%26client_id%3DIUbc1Nn7qOx1%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DSAML%26state%3D6CaApiuIXlAB5HX3&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:30:12,736 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'acr_values': ["['SAML']"], 'password': ['krall'], 'query': ['response_type=code&nonce=mw2BsRdf8R1GKGjZ&client_id=IUbc1Nn7qOx1&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&acr_values=SAML&state=6CaApiuIXlAB5HX3'], 'form.commit': ['Submit']}
2015-08-18 14:30:12,736 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-18 14:30:12,740 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['mw2BsRdf8R1GKGjZ'], 'acr_values': ['SAML'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone'], 'client_id': ['IUbc1Nn7qOx1'], 'upm_answer': 'true', 'response_type': ['code'], 'state': ['6CaApiuIXlAB5HX3']}
2015-08-18 14:30:12,760 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x10559e4a8>
2015-08-18 14:30:12,760 oic.oauth2.provider:DEBUG Request: 'nonce=mw2BsRdf8R1GKGjZ&acr_values=SAML&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&client_id=IUbc1Nn7qOx1&upm_answer=true&response_type=code&state=6CaApiuIXlAB5HX3'
2015-08-18 14:30:12,761 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057d62b0>, <jwkest.jwk.RSAKey object at 0x1057a6160>, <jwkest.jwk.ECKey object at 0x1057a65c0>]
2015-08-18 14:30:12,763 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'mw2BsRdf8R1GKGjZ', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'IUbc1Nn7qOx1', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': '6CaApiuIXlAB5HX3'}
2015-08-18 14:30:12,764 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'mw2BsRdf8R1GKGjZ', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'IUbc1Nn7qOx1', 'upm_answer': 'true', 'scope': 'openid profile email address phone', 'state': '6CaApiuIXlAB5HX3'}
2015-08-18 14:30:12,766 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:30:12,766 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:30:12,767 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:30:12,768 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:30:12,768 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:30:12,768 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'acr_values', 'redirect_uri', 'scope', 'client_id', 'upm_answer', 'response_type', 'state']
2015-08-18 14:30:12,769 oic.utils.sdb:DEBUG uid2sid: {'diana': ['51121e67287a0e601346cd5d47fb836a116fc30918dc7c8b610c457f']}
2015-08-18 14:30:12,769 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:30:12,770 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:30:12,772 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?code=B5UKXpxF3SasEas3MrYTbhoeVl%2BjESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VDyqd8WR3Wim4v9Ix5SieLsmd8uEq3uAvi8UOzTSNN%2BQ%3D&state=6CaApiuIXlAB5HX3&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-18 14:30:17,898 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x10559e550>
2015-08-18 14:30:22,111 oic.oic.provider:DEBUG - token -
2015-08-18 14:30:22,111 oic.oic.provider:INFO token_request: key=eyJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ%3D%3D&client_id=IUbc1Nn7qOx1&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=e67ce45e4631f7c6c4f23b93074276dc0fecf61afc54a723569071e3&code=B5UKXpxF3SasEas3MrYTbhoeVl%2BjESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VDyqd8WR3Wim4v9Ix5SieLsmd8uEq3uAvi8UOzTSNN%2BQ%3D&token_type=pop&grant_type=authorization_code
2015-08-18 14:30:22,112 oic.oic.provider:DEBUG AccessTokenRequest: {'client_secret': 'e67ce45e4631f7c6c4f23b93074276dc0fecf61afc54a723569071e3', 'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'key': 'eyJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ==', 'code': 'B5UKXpxF3SasEas3MrYTbhoeVl+jESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VDyqd8WR3Wim4v9Ix5SieLsmd8uEq3uAvi8UOzTSNN+Q=', 'client_id': 'IUbc1Nn7qOx1', 'token_type': 'pop'}
2015-08-18 14:30:22,113 oic.utils.authn.client:DEBUG REQ: {'client_secret': 'e67ce45e4631f7c6c4f23b93074276dc0fecf61afc54a723569071e3', 'redirect_uri': 'http://localhost:8666/authz_cb', 'grant_type': 'authorization_code', 'key': 'eyJ1c2UiOiAic2lnIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ==', 'code': 'B5UKXpxF3SasEas3MrYTbhoeVl+jESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VDyqd8WR3Wim4v9Ix5SieLsmd8uEq3uAvi8UOzTSNN+Q=', 'client_id': 'IUbc1Nn7qOx1', 'token_type': 'pop'}
2015-08-18 14:30:22,114 oic.utils.authn.client:DEBUG Verified Client ID: IUbc1Nn7qOx1
2015-08-18 14:30:22,120 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:30:22,122 oic.oic:DEBUG authzreq: {'nonce': 'mw2BsRdf8R1GKGjZ', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'IUbc1Nn7qOx1', 'upm_answer': 'true', 'response_type': 'code', 'state': '6CaApiuIXlAB5HX3'}
2015-08-18 14:30:22,122 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:30:22,123 oic.oic:DEBUG authzreq: {'nonce': 'mw2BsRdf8R1GKGjZ', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'client_id': 'IUbc1Nn7qOx1', 'upm_answer': 'true', 'response_type': 'code', 'state': '6CaApiuIXlAB5HX3'}
2015-08-18 14:30:22,123 oic.oic.provider:DEBUG id_token: {'nonce': 'mw2BsRdf8R1GKGjZ', 'acr': 'PASSWORD', 'sub': '-1a6a277ac80a8a7a', 'iss': 'https://localhost:8092/', 'aud': ['IUbc1Nn7qOx1'], 'exp': 1439980222, 'iat': 1439901022, 'auth_time': 1439901012}
2015-08-18 14:30:22,125 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA"}]}
2015-08-18 14:30:22,126 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kid": "op2", "y": "ENH5hWrePYolef_SuVKfMq_zlcTXmS4mIZTHSixrvsE", "x": "gIgVC7ZotFNVsV6OWyhK0KGf1V-lBbXQhv0rwlIuFqg", "kty": "EC"}]}
2015-08-18 14:30:22,126 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kid": "op3", "y": "lE81EneuEWm6cRpFzRt32jH6gWK8qTE_nLTg6d4pLck", "x": "m4PLoP-9A41T-od91ZMVY6nUeNceGsNIl1XLyDTvMwA", "kty": "EC"}]}
2015-08-18 14:30:22,127 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057a6160>]
2015-08-18 14:30:22,135 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:30:22,135 oic.oic.provider:DEBUG _tinfo: {'permission': '', 'authzreq': '{"nonce": "mw2BsRdf8R1GKGjZ", "acr_values": "SAML", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "client_id": "IUbc1Nn7qOx1", "upm_answer": "true", "scope": "openid profile email address phone", "state": "6CaApiuIXlAB5HX3"}', 'access_token_scope': '?', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057d6ef0>, 'client_id': 'IUbc1Nn7qOx1', 'expires_in': 3600, 'access_token': 'B5UKXpxF3SasEas3MrYTbhoeVl+jESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VmZ6HLaagGWuAXSwz0FTxXTah+3BZ7I5KGNQK0WRw9YE=', 'refresh_token': 'B5UKXpxF3SasEas3MrYTbhoeVl+jESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VxJTzD31CxCK0O5jjRn8sxRsn/pWiJ7qI+ffxeIJlKWA=', 'revoked': False, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJtdzJCc1JkZjhSMUdLR2paIiwgImFjciI6ICJQQVNTV09SRCIsICJzdWIiOiAiLTFhNmEyNzdhYzgwYThhN2EiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImF1ZCI6IFsiSVViYzFObjdxT3gxIl0sICJleHAiOiAxNDM5OTgwMjIyLCAiaWF0IjogMTQzOTkwMTAyMiwgImF1dGhfdGltZSI6IDE0Mzk5MDEwMTJ9.Mffvl1dPKs9OiphQeJxm4i2n-50fHYRq7JWFlEj8klgDYQE_1S7Y83i7tZxWF1LQ4oDMKlh2qr8nWKHdmahzlMrviDvcWKu4jXLs7aP_iFKDD0jl7AomeezP_oKvDxiWtE4z1QsN9ywTE2lAVvHiSJ-OKINeJCUKLabz2W5LzO4Ahe6c3u9_vtMNr0pKr6gVwH_7XiSMcpacuTbOk9P9Herg8LJ6CFNX-mun6G1kpX-THpMwzSKMzCi8yNPH4oPONXxp4gP6Suru_odiNOLv060fzoLrWK3ujRN5YTUPABfeXziEJbHI_9W-LR8flDX4waaCBO-PC-1HrStVZGu8gw', 'nonce': 'mw2BsRdf8R1GKGjZ', 'redirect_uri': 'http://localhost:8666/authz_cb', 'code_used': True, 'token_type': 'Bearer', 'code': 'B5UKXpxF3SasEas3MrYTbhoeVl+jESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VDyqd8WR3Wim4v9Ix5SieLsmd8uEq3uAvi8UOzTSNN+Q=', 'state': '6CaApiuIXlAB5HX3', 'oauth_state': 'token', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_expires_at': 1439901022, 'sub': '-1a6a277ac80a8a7a'}
2015-08-18 14:30:22,136 oic.oic.provider:DEBUG access_token_response: {'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJub25jZSI6ICJtdzJCc1JkZjhSMUdLR2paIiwgImFjciI6ICJQQVNTV09SRCIsICJzdWIiOiAiLTFhNmEyNzdhYzgwYThhN2EiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImF1ZCI6IFsiSVViYzFObjdxT3gxIl0sICJleHAiOiAxNDM5OTgwMjIyLCAiaWF0IjogMTQzOTkwMTAyMiwgImF1dGhfdGltZSI6IDE0Mzk5MDEwMTJ9.Mffvl1dPKs9OiphQeJxm4i2n-50fHYRq7JWFlEj8klgDYQE_1S7Y83i7tZxWF1LQ4oDMKlh2qr8nWKHdmahzlMrviDvcWKu4jXLs7aP_iFKDD0jl7AomeezP_oKvDxiWtE4z1QsN9ywTE2lAVvHiSJ-OKINeJCUKLabz2W5LzO4Ahe6c3u9_vtMNr0pKr6gVwH_7XiSMcpacuTbOk9P9Herg8LJ6CFNX-mun6G1kpX-THpMwzSKMzCi8yNPH4oPONXxp4gP6Suru_odiNOLv060fzoLrWK3ujRN5YTUPABfeXziEJbHI_9W-LR8flDX4waaCBO-PC-1HrStVZGu8gw', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'access_token': 'B5UKXpxF3SasEas3MrYTbhoeVl+jESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VmZ6HLaagGWuAXSwz0FTxXTah+3BZ7I5KGNQK0WRw9YE=', 'state': '6CaApiuIXlAB5HX3', 'token_type': 'Bearer', 'refresh_token': 'B5UKXpxF3SasEas3MrYTbhoeVl+jESf7ZNSdbdHrZz6VUA4SWBMXjmO3IFWPUg9VxJTzD31CxCK0O5jjRn8sxRsn/pWiJ7qI+ffxeIJlKWA='}
2015-08-18 14:30:22,143 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:30:35,093 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:30:55,273 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "e": "AQAB", "kty": "RSA"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "e": "AQAB", "kty": "RSA"}]}
2015-08-18 14:30:55,273 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "6SHs3vlg06B1-WAy9sAthRfglrpUtNRF9WSTrrkSERI", "crv": "P-256", "kid": "op2", "y": "HHn-c9GF0ZdEDoJK-1V-RaUJGU6yN--jTKzvBRvUlUA", "kty": "EC"}]}
2015-08-18 14:30:55,274 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "ZmhXA9LQwBXizMcLWLNAS9h1sTka0QOwBClk1oKoO6U", "crv": "P-256", "kid": "op3", "y": "yLegOWjY9HwLbEWf2K1GtkISUtD9EDSHbwKlABaHo4c", "kty": "EC"}]}
2015-08-18 14:30:55,274 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:30:56,805 oicServer:INFO callback: <function webfinger at 0x1054ee6a8>
2015-08-18 14:30:56,824 oicServer:INFO callback: <function op_info at 0x1054ee2f0>
2015-08-18 14:30:56,824 root:INFO op_info
2015-08-18 14:30:56,825 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:30:56,826 oic.oic.provider:INFO provider_info_response: {'claims_supported': ['given_name', 'birthdate', 'zoneinfo', 'phone_number_verified', 'locale', 'updated_at', 'preferred_username', 'email_verified', 'sub', 'address', 'picture', 'email', 'profile', 'name', 'middle_name', 'family_name', 'phone_number', 'nickname', 'website', 'gender'], 'userinfo_signing_alg_values_supported': ['HS256', 'PS256', 'RS384', 'ES512', 'PS384', 'HS512', 'HS384', 'PS512', 'ES384', 'RS256', 'none', 'RS512', 'ES256'], 'require_request_uri_registration': True, 'version': '3.0', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'scopes_supported': ['phone', 'profile', 'offline_access', 'openid', 'address', 'email', 'openid'], 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'PS256', 'RS384', 'ES512', 'PS384', 'HS512', 'HS384', 'PS512', 'ES384', 'RS256', 'RS512', 'ES256'], 'request_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_signing_alg_values_supported': ['HS256', 'PS256', 'RS384', 'ES512', 'PS384', 'HS512', 'HS384', 'PS512', 'ES384', 'RS256', 'none', 'RS512', 'ES256'], 'claims_parameter_supported': True, 'id_token_signing_alg_values_supported': ['HS256', 'PS256', 'RS384', 'ES512', 'PS384', 'HS512', 'HS384', 'PS512', 'ES384', 'RS256', 'none', 'RS512', 'ES256'], 'request_uri_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'acr_values_supported': ['PASSWORD'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token']}
2015-08-18 14:30:56,908 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105543978>
2015-08-18 14:30:56,909 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-18 14:30:56,909 oic.oic.provider:INFO registration_request:{'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-18 14:30:56,916 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439897456, 'client_secret_expires_at': 1439983856, 'registration_access_token': 'Pm1g6jOT3lwZZQwaszO1dY1Dl2Xd9CMs', 'client_secret': '17ef282fad47b5873c1f854dd6c074b5b6ff1d21e9ee1943cabe5d25', 'client_id': 'ksug0TUI14lg', 'registration_client_uri': 'https://localhost:8092/registration?client_id=ksug0TUI14lg'}
2015-08-18 14:30:56,918 oic.utils.keyio:DEBUG loading keys for issuer: ksug0TUI14lg
2015-08-18 14:30:56,918 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-18 14:30:56,918 oic.oic.provider:DEBUG keys for ksug0TUI14lg: []
2015-08-18 14:30:56,921 oic.oic.provider:INFO Client info: {'application_type': 'web', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_id_issued_at': 1439897456, 'client_secret_expires_at': 1439983856, 'registration_access_token': 'Pm1g6jOT3lwZZQwaszO1dY1Dl2Xd9CMs', 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_secret': '17ef282fad47b5873c1f854dd6c074b5b6ff1d21e9ee1943cabe5d25', 'client_id': 'ksug0TUI14lg', 'registration_client_uri': 'https://localhost:8092/registration?client_id=ksug0TUI14lg'}
2015-08-18 14:30:56,921 oic.oic.provider:DEBUG registration_response: {'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'response_types': ['code'], 'client_id_issued_at': 1439897456, 'client_secret_expires_at': 1439983856, 'registration_access_token': 'Pm1g6jOT3lwZZQwaszO1dY1Dl2Xd9CMs', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret': '17ef282fad47b5873c1f854dd6c074b5b6ff1d21e9ee1943cabe5d25', 'client_id': 'ksug0TUI14lg', 'registration_client_uri': 'https://localhost:8092/registration?client_id=ksug0TUI14lg'}
2015-08-18 14:30:56,936 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054b94a8>
2015-08-18 14:30:56,937 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&state=MqRIefI23iZRCLJF&acr_values=SAML&response_type=code&nonce=hg58SnWMj03g6wXf&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=ksug0TUI14lg'
2015-08-18 14:30:56,938 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056f02b0>, <jwkest.jwk.RSAKey object at 0x1056c0160>, <jwkest.jwk.ECKey object at 0x1056c05f8>]
2015-08-18 14:30:56,938 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'nonce': 'hg58SnWMj03g6wXf', 'client_id': 'ksug0TUI14lg', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'state': 'MqRIefI23iZRCLJF'}
2015-08-18 14:30:56,940 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'nonce': 'hg58SnWMj03g6wXf', 'client_id': 'ksug0TUI14lg', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'state': 'MqRIefI23iZRCLJF'}
2015-08-18 14:30:56,943 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:30:56,943 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:30:56,943 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:30:56,944 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:30:56,944 oic.utils.authn.user:INFO do_authentication argv: {'login_title': 'Username', 'client_policy_title': 'Client Policy', 'query': 'scope=openid+profile+email+address+phone&state=MqRIefI23iZRCLJF&acr_values=SAML&response_type=code&nonce=hg58SnWMj03g6wXf&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=ksug0TUI14lg', 'action': 'https://localhost:8092/verify', 'password': '', 'submit_text': 'Submit', 'acr': ['SAML'], 'login': '', 'passwd_title': 'Password', 'policy_uri': '', 'title': 'User log in', 'logo_uri': '', 'tos_uri': ''}
2015-08-18 14:30:56,959 oicServer:INFO callback: <function css at 0x1054be620>
2015-08-18 14:31:03,145 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105648598>
2015-08-18 14:31:03,145 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3DMqRIefI23iZRCLJF%26acr_values%3DSAML%26response_type%3Dcode%26nonce%3Dhg58SnWMj03g6wXf%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26client_id%3Dksug0TUI14lg&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:31:03,146 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'acr_values': ["['SAML']"], 'query': ['scope=openid+profile+email+address+phone&state=MqRIefI23iZRCLJF&acr_values=SAML&response_type=code&nonce=hg58SnWMj03g6wXf&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=ksug0TUI14lg'], 'form.commit': ['Submit'], 'password': ['krall']}
2015-08-18 14:31:03,146 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-18 14:31:03,148 oic.utils.authn.user:DEBUG kwargs: {'scope': ['openid profile email address phone'], 'acr_values': ['SAML'], 'nonce': ['hg58SnWMj03g6wXf'], 'upm_answer': 'true', 'redirect_uri': ['http://localhost:8666/authz_cb'], 'client_id': ['ksug0TUI14lg'], 'response_type': ['code'], 'state': ['MqRIefI23iZRCLJF']}
2015-08-18 14:31:03,165 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1054b94a8>
2015-08-18 14:31:03,165 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&acr_values=SAML&nonce=hg58SnWMj03g6wXf&upm_answer=true&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=ksug0TUI14lg&response_type=code&state=MqRIefI23iZRCLJF'
2015-08-18 14:31:03,166 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1056f02b0>, <jwkest.jwk.RSAKey object at 0x1056c0160>, <jwkest.jwk.ECKey object at 0x1056c05f8>]
2015-08-18 14:31:03,167 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'nonce': 'hg58SnWMj03g6wXf', 'upm_answer': 'true', 'client_id': 'ksug0TUI14lg', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'state': 'MqRIefI23iZRCLJF'}
2015-08-18 14:31:03,169 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'nonce': 'hg58SnWMj03g6wXf', 'upm_answer': 'true', 'client_id': 'ksug0TUI14lg', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'state': 'MqRIefI23iZRCLJF'}
2015-08-18 14:31:03,173 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:31:03,174 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:31:03,175 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:31:03,176 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:31:03,177 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:31:03,177 oic.oic.provider:DEBUG AREQ keys: ['scope', 'acr_values', 'nonce', 'upm_answer', 'redirect_uri', 'client_id', 'response_type', 'state']
2015-08-18 14:31:03,178 oic.utils.sdb:DEBUG uid2sid: {'diana': ['b0c111ac38ecf34529ef81c5422948b2a21b642feb3f8dc90983e1c0']}
2015-08-18 14:31:03,178 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:31:03,179 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:31:03,182 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv%2FBJRWWDlHVNam4ob%2F3vhONIugh3PKGpsHMbDIIlWA%2ByxYkHAhCdboVggmbSCacdj44%3D&state=MqRIefI23iZRCLJF' (<class 'str'>)
2015-08-18 14:31:08,368 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1054b9550>
2015-08-18 14:31:08,369 oic.oic.provider:DEBUG - token -
2015-08-18 14:31:08,370 oic.oic.provider:INFO token_request: client_secret=17ef282fad47b5873c1f854dd6c074b5b6ff1d21e9ee1943cabe5d25&code=4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv%2FBJRWWDlHVNam4ob%2F3vhONIugh3PKGpsHMbDIIlWA%2ByxYkHAhCdboVggmbSCacdj44%3D&token_type=pop&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&grant_type=authorization_code&key=eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWciLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&client_id=ksug0TUI14lg
2015-08-18 14:31:08,370 oic.oic.provider:DEBUG AccessTokenRequest: {'key': 'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWciLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'token_type': 'pop', 'code': '4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv/BJRWWDlHVNam4ob/3vhONIugh3PKGpsHMbDIIlWA+yxYkHAhCdboVggmbSCacdj44=', 'client_secret': '17ef282fad47b5873c1f854dd6c074b5b6ff1d21e9ee1943cabe5d25', 'grant_type': 'authorization_code', 'client_id': 'ksug0TUI14lg', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:31:08,371 oic.utils.authn.client:DEBUG REQ: {'key': 'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWciLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'token_type': 'pop', 'code': '4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv/BJRWWDlHVNam4ob/3vhONIugh3PKGpsHMbDIIlWA+yxYkHAhCdboVggmbSCacdj44=', 'client_secret': '17ef282fad47b5873c1f854dd6c074b5b6ff1d21e9ee1943cabe5d25', 'grant_type': 'authorization_code', 'client_id': 'ksug0TUI14lg', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:31:08,372 oic.utils.authn.client:DEBUG Verified Client ID: ksug0TUI14lg
2015-08-18 14:31:08,375 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:31:08,377 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'nonce': 'hg58SnWMj03g6wXf', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'ksug0TUI14lg', 'response_type': 'code', 'state': 'MqRIefI23iZRCLJF'}
2015-08-18 14:31:08,377 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:31:08,378 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'acr_values': 'SAML', 'nonce': 'hg58SnWMj03g6wXf', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_id': 'ksug0TUI14lg', 'response_type': 'code', 'state': 'MqRIefI23iZRCLJF'}
2015-08-18 14:31:08,378 oic.oic.provider:DEBUG id_token: {'acr': 'PASSWORD', 'iat': 1439901068, 'aud': ['ksug0TUI14lg'], 'auth_time': 1439901063, 'sub': '23b8877a3f2002de', 'exp': 1439980268, 'iss': 'https://localhost:8092/', 'nonce': 'hg58SnWMj03g6wXf'}
2015-08-18 14:31:08,381 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "e": "AQAB", "kty": "RSA"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "e": "AQAB", "kty": "RSA"}]}
2015-08-18 14:31:08,381 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "x": "6SHs3vlg06B1-WAy9sAthRfglrpUtNRF9WSTrrkSERI", "crv": "P-256", "kid": "op2", "y": "HHn-c9GF0ZdEDoJK-1V-RaUJGU6yN--jTKzvBRvUlUA", "kty": "EC"}]}
2015-08-18 14:31:08,382 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "x": "ZmhXA9LQwBXizMcLWLNAS9h1sTka0QOwBClk1oKoO6U", "crv": "P-256", "kid": "op3", "y": "yLegOWjY9HwLbEWf2K1GtkISUtD9EDSHbwKlABaHo4c", "kty": "EC"}]}
2015-08-18 14:31:08,382 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1056c0160>]
2015-08-18 14:31:08,390 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:31:08,391 oic.oic.provider:DEBUG _tinfo: {'expires_in': 3600, 'code_used': True, 'refresh_token': '4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv/BJRWWDlHVNam4ob/3vhONIan5OIAex93v3RdJUms+qVUGW2EdRYfv1/1ZiUmahXao=', 'access_token_scope': '?', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAiaWF0IjogMTQzOTkwMTA2OCwgImF1ZCI6IFsia3N1ZzBUVUkxNGxnIl0sICJhdXRoX3RpbWUiOiAxNDM5OTAxMDYzLCAic3ViIjogIjIzYjg4NzdhM2YyMDAyZGUiLCAiZXhwIjogMTQzOTk4MDI2OCwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJub25jZSI6ICJoZzU4U25XTWowM2c2d1hmIn0.P0Mal58xS4jKoYCmDzk_prAIW4r6u-ax_xyY5afTAbM5MNGW4hhpnms6bbnHbKiJxRMnBCZpswi2m9ObHTlLv9TAG_zDwFe5Dv-bMHO3H3RoubMhY4-ksC1YPsg-1OcyvAQ1UxLzY5MIIgAJfM6Zpu3AIWS67sy4mSfkLTTOvAX9yqHi7es2mM4lmG5R75T_0QajadozNfpVdnlwxmx_KjoICepIXSA8aLTTcSazosqr7VkVIel2qquc8c7E-ihUKj0dNIlCMPbsRdvLIVKIWEzhalq1YTa-_C1jEEGymAKSvPpDLetJAENMEWF_W8QAzVmw7umpZ-W2ddgN2rsDhg', 'authzreq': '{"scope": "openid profile email address phone", "acr_values": "SAML", "nonce": "hg58SnWMj03g6wXf", "upm_answer": "true", "client_id": "ksug0TUI14lg", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "state": "MqRIefI23iZRCLJF"}', 'sub': '23b8877a3f2002de', 'client_id': 'ksug0TUI14lg', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_expires_at': 1439901068, 'revoked': False, 'access_token': '4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv/BJRWWDlHVNam4ob/3vhONIHjeRW+oiIntmGcnVFjsJ8v7W4D2TW689qsCTun94AGU=', 'permission': '', 'nonce': 'hg58SnWMj03g6wXf', 'code': '4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv/BJRWWDlHVNam4ob/3vhONIugh3PKGpsHMbDIIlWA+yxYkHAhCdboVggmbSCacdj44=', 'token_type': 'Bearer', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1056f0eb8>, 'redirect_uri': 'http://localhost:8666/authz_cb', 'oauth_state': 'token', 'state': 'MqRIefI23iZRCLJF'}
2015-08-18 14:31:08,392 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAiaWF0IjogMTQzOTkwMTA2OCwgImF1ZCI6IFsia3N1ZzBUVUkxNGxnIl0sICJhdXRoX3RpbWUiOiAxNDM5OTAxMDYzLCAic3ViIjogIjIzYjg4NzdhM2YyMDAyZGUiLCAiZXhwIjogMTQzOTk4MDI2OCwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJub25jZSI6ICJoZzU4U25XTWowM2c2d1hmIn0.P0Mal58xS4jKoYCmDzk_prAIW4r6u-ax_xyY5afTAbM5MNGW4hhpnms6bbnHbKiJxRMnBCZpswi2m9ObHTlLv9TAG_zDwFe5Dv-bMHO3H3RoubMhY4-ksC1YPsg-1OcyvAQ1UxLzY5MIIgAJfM6Zpu3AIWS67sy4mSfkLTTOvAX9yqHi7es2mM4lmG5R75T_0QajadozNfpVdnlwxmx_KjoICepIXSA8aLTTcSazosqr7VkVIel2qquc8c7E-ihUKj0dNIlCMPbsRdvLIVKIWEzhalq1YTa-_C1jEEGymAKSvPpDLetJAENMEWF_W8QAzVmw7umpZ-W2ddgN2rsDhg', 'access_token': '4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv/BJRWWDlHVNam4ob/3vhONIHjeRW+oiIntmGcnVFjsJ8v7W4D2TW689qsCTun94AGU=', 'token_type': 'Bearer', 'state': 'MqRIefI23iZRCLJF', 'refresh_token': '4SVyPOaPET2K8dF9wdOBakD30hbjFRqS96q7CAWcv/BJRWWDlHVNam4ob/3vhONIan5OIAex93v3RdJUms+qVUGW2EdRYfv1/1ZiUmahXao=', 'scope': 'openid profile email address phone'}
2015-08-18 14:31:08,401 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:31:08,421 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:34:14,343 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB"}]}
2015-08-18 14:34:14,343 root:INFO OC3 server keys: {"keys": [{"x": "XG7cZ_3IFdzR4Eaza8BWvEJ5gLQtx38aUtje1JINIrE", "use": "sig", "crv": "P-256", "kty": "EC", "y": "I6d2og74szE-KBu8MWk6U5fgkuF1YB9O_w0k8Ev1aJQ", "kid": "op2"}]}
2015-08-18 14:34:14,344 root:INFO OC3 server keys: {"keys": [{"x": "_0uNDKqFqlfsKLEJNvohKsxoExkW8V3an49LXX-rZDw", "use": "enc", "crv": "P-256", "kty": "EC", "y": "G2116wNwCf2T2d3HDx26bbjsp-bqupxe0pjzh4DP11o", "kid": "op3"}]}
2015-08-18 14:34:14,344 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:34:16,167 oicServer:INFO callback: <function webfinger at 0x1055e46a8>
2015-08-18 14:34:16,187 oicServer:INFO callback: <function op_info at 0x1055e42f0>
2015-08-18 14:34:16,188 root:INFO op_info
2015-08-18 14:34:16,188 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:34:16,189 oic.oic.provider:INFO provider_info_response: {'request_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_signing_alg_values_supported': ['none', 'HS384', 'PS256', 'RS384', 'HS256', 'PS384', 'ES384', 'ES256', 'HS512', 'RS512', 'PS512', 'RS256', 'ES512'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'subject_types_supported': ['public', 'pairwise'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_signing_alg_values_supported': ['none', 'HS384', 'PS256', 'RS384', 'HS256', 'PS384', 'ES384', 'ES256', 'HS512', 'RS512', 'PS512', 'RS256', 'ES512'], 'token_endpoint': 'https://localhost:8092/token', 'require_request_uri_registration': True, 'claims_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'PS256', 'RS384', 'HS256', 'PS384', 'ES384', 'ES256', 'HS512', 'RS512', 'PS512', 'RS256', 'ES512'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'version': '3.0', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['none', 'HS384', 'PS256', 'RS384', 'HS256', 'PS384', 'ES384', 'ES256', 'HS512', 'RS512', 'PS512', 'RS256', 'ES512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_uri_parameter_supported': True, 'acr_values_supported': ['PASSWORD'], 'scopes_supported': ['phone', 'openid', 'profile', 'email', 'address', 'offline_access', 'openid'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'registration_endpoint': 'https://localhost:8092/registration', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'claims_supported': ['sub', 'picture', 'phone_number', 'name', 'nickname', 'gender', 'website', 'profile', 'family_name', 'address', 'middle_name', 'preferred_username', 'given_name', 'zoneinfo', 'birthdate', 'phone_number_verified', 'locale', 'email_verified', 'updated_at', 'email']}
2015-08-18 14:34:16,256 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105639978>
2015-08-18 14:34:16,256 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "response_types": ["code"], "redirect_uris": ["http://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 14:34:16,257 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-18 14:34:16,264 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'lgvyxiZXCoNREcGE4PUvBnCsSJtFIEvy', 'client_secret_expires_at': 1439984056, 'client_secret': '0f33ef7267d787b7df987d11d91a8dc1c171499f49224741689f5d07', 'client_id_issued_at': 1439897656, 'registration_client_uri': 'https://localhost:8092/registration?client_id=LRZZ2rX7BWua', 'client_id': 'LRZZ2rX7BWua'}
2015-08-18 14:34:16,265 oic.utils.keyio:DEBUG loading keys for issuer: LRZZ2rX7BWua
2015-08-18 14:34:16,266 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'application_type': 'web', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-18 14:34:16,266 oic.oic.provider:DEBUG keys for LRZZ2rX7BWua: []
2015-08-18 14:34:16,268 oic.oic.provider:INFO Client info: {'registration_access_token': 'lgvyxiZXCoNREcGE4PUvBnCsSJtFIEvy', 'client_secret_expires_at': 1439984056, 'application_type': 'web', 'client_secret': '0f33ef7267d787b7df987d11d91a8dc1c171499f49224741689f5d07', 'client_id_issued_at': 1439897656, 'response_types': ['code'], 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=LRZZ2rX7BWua', 'contacts': ['ops@example.com'], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id': 'LRZZ2rX7BWua'}
2015-08-18 14:34:16,269 oic.oic.provider:DEBUG registration_response: {'registration_access_token': 'lgvyxiZXCoNREcGE4PUvBnCsSJtFIEvy', 'client_secret_expires_at': 1439984056, 'application_type': 'web', 'client_secret': '0f33ef7267d787b7df987d11d91a8dc1c171499f49224741689f5d07', 'client_id_issued_at': 1439897656, 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=LRZZ2rX7BWua', 'contacts': ['ops@example.com'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_id': 'LRZZ2rX7BWua'}
2015-08-18 14:34:16,284 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055af4a8>
2015-08-18 14:34:16,285 oic.oauth2.provider:DEBUG Request: 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RAl3JIVygO1kz8pN&client_id=LRZZ2rX7BWua&scope=openid+profile+email+address+phone&acr_values=SAML&nonce=TZggL6e8zmqRKzv4&response_type=code'
2015-08-18 14:34:16,286 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e72b0>, <jwkest.jwk.RSAKey object at 0x1057b7160>, <jwkest.jwk.ECKey object at 0x1057b7518>]
2015-08-18 14:34:16,286 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'LRZZ2rX7BWua', 'nonce': 'TZggL6e8zmqRKzv4', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:16,288 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'LRZZ2rX7BWua', 'nonce': 'TZggL6e8zmqRKzv4', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:16,290 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:34:16,290 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:34:16,291 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:34:16,292 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:34:16,292 oic.utils.authn.user:INFO do_authentication argv: {'login_title': 'Username', 'submit_text': 'Submit', 'logo_uri': '', 'action': 'https://localhost:8092/verify', 'passwd_title': 'Password', 'client_policy_title': 'Client Policy', 'query': 'redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RAl3JIVygO1kz8pN&client_id=LRZZ2rX7BWua&scope=openid+profile+email+address+phone&acr_values=SAML&nonce=TZggL6e8zmqRKzv4&response_type=code', 'acr': ['SAML'], 'login': '', 'policy_uri': '', 'title': 'User log in', 'tos_uri': '', 'password': ''}
2015-08-18 14:34:16,313 oicServer:INFO callback: <function css at 0x1055b4620>
2015-08-18 14:34:20,727 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x10573e598>
2015-08-18 14:34:20,728 oic.utils.authn.user:DEBUG verify(query=redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26state%3DRAl3JIVygO1kz8pN%26client_id%3DLRZZ2rX7BWua%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DSAML%26nonce%3DTZggL6e8zmqRKzv4%26response_type%3Dcode&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:34:20,728 oic.utils.authn.user:DEBUG dict: {'query': ['redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RAl3JIVygO1kz8pN&client_id=LRZZ2rX7BWua&scope=openid+profile+email+address+phone&acr_values=SAML&nonce=TZggL6e8zmqRKzv4&response_type=code'], 'login': ['diana'], 'password': ['krall'], 'acr_values': ["['SAML']"], 'form.commit': ['Submit']}
2015-08-18 14:34:20,729 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-18 14:34:20,731 oic.utils.authn.user:DEBUG kwargs: {'acr_values': ['SAML'], 'upm_answer': 'true', 'nonce': ['TZggL6e8zmqRKzv4'], 'scope': ['openid profile email address phone'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'response_type': ['code'], 'client_id': ['LRZZ2rX7BWua'], 'state': ['RAl3JIVygO1kz8pN']}
2015-08-18 14:34:20,749 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055af4a8>
2015-08-18 14:34:20,749 oic.oauth2.provider:DEBUG Request: 'acr_values=SAML&upm_answer=true&nonce=TZggL6e8zmqRKzv4&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&client_id=LRZZ2rX7BWua&state=RAl3JIVygO1kz8pN'
2015-08-18 14:34:20,750 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057e72b0>, <jwkest.jwk.RSAKey object at 0x1057b7160>, <jwkest.jwk.ECKey object at 0x1057b7518>]
2015-08-18 14:34:20,750 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'LRZZ2rX7BWua', 'upm_answer': 'true', 'nonce': 'TZggL6e8zmqRKzv4', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:20,752 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'LRZZ2rX7BWua', 'upm_answer': 'true', 'nonce': 'TZggL6e8zmqRKzv4', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'acr_values': 'SAML', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:20,754 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:34:20,754 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:34:20,755 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-18 14:34:20,756 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:34:20,757 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:34:20,757 oic.oic.provider:DEBUG AREQ keys: ['acr_values', 'upm_answer', 'nonce', 'scope', 'redirect_uri', 'response_type', 'client_id', 'state']
2015-08-18 14:34:20,759 oic.utils.sdb:DEBUG uid2sid: {'diana': ['6661c8cd0b5a24941d364727239a832bff323af6792ca58eb2bcde9d']}
2015-08-18 14:34:20,759 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:34:20,760 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:34:20,763 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=x9y16Yc99K76xB9jsKnoP1khWIafdk7%2B154sU%2BEIQagTmdnalFQdrTGXyit39sAKzieDZk9QvxSGV8q1biYDJ7lbUjHrTqG7rJzMK9k62ks%3D&state=RAl3JIVygO1kz8pN' (<class 'str'>)
2015-08-18 14:34:25,829 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055af550>
2015-08-18 14:34:25,830 oic.oic.provider:DEBUG - token -
2015-08-18 14:34:25,831 oic.oic.provider:INFO token_request: code=x9y16Yc99K76xB9jsKnoP1khWIafdk7%2B154sU%2BEIQagTmdnalFQdrTGXyit39sAKzieDZk9QvxSGV8q1biYDJ7lbUjHrTqG7rJzMK9k62ks%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&key=eyJ1c2UiOiAic2lnIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImt0eSI6ICJSU0EiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJraWQiOiAiYTAifQ%3D%3D&client_id=LRZZ2rX7BWua&grant_type=authorization_code&token_type=pop&client_secret=0f33ef7267d787b7df987d11d91a8dc1c171499f49224741689f5d07
2015-08-18 14:34:25,832 oic.oic.provider:DEBUG AccessTokenRequest: {'token_type': 'pop', 'grant_type': 'authorization_code', 'key': 'eyJ1c2UiOiAic2lnIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImt0eSI6ICJSU0EiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJraWQiOiAiYTAifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '0f33ef7267d787b7df987d11d91a8dc1c171499f49224741689f5d07', 'client_id': 'LRZZ2rX7BWua', 'code': 'x9y16Yc99K76xB9jsKnoP1khWIafdk7+154sU+EIQagTmdnalFQdrTGXyit39sAKzieDZk9QvxSGV8q1biYDJ7lbUjHrTqG7rJzMK9k62ks='}
2015-08-18 14:34:25,833 oic.utils.authn.client:DEBUG REQ: {'token_type': 'pop', 'grant_type': 'authorization_code', 'key': 'eyJ1c2UiOiAic2lnIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImt0eSI6ICJSU0EiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJraWQiOiAiYTAifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '0f33ef7267d787b7df987d11d91a8dc1c171499f49224741689f5d07', 'client_id': 'LRZZ2rX7BWua', 'code': 'x9y16Yc99K76xB9jsKnoP1khWIafdk7+154sU+EIQagTmdnalFQdrTGXyit39sAKzieDZk9QvxSGV8q1biYDJ7lbUjHrTqG7rJzMK9k62ks='}
2015-08-18 14:34:25,834 oic.utils.authn.client:DEBUG Verified Client ID: LRZZ2rX7BWua
2015-08-18 14:34:25,839 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:34:25,841 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'TZggL6e8zmqRKzv4', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'LRZZ2rX7BWua', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:25,842 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:34:25,842 oic.oic:DEBUG authzreq: {'acr_values': 'SAML', 'upm_answer': 'true', 'nonce': 'TZggL6e8zmqRKzv4', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'LRZZ2rX7BWua', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:25,843 oic.oic.provider:DEBUG id_token: {'acr': 'PASSWORD', 'sub': '3c31a5da7b3cfee8', 'exp': 1439980465, 'nonce': 'TZggL6e8zmqRKzv4', 'iss': 'https://localhost:8092/', 'aud': ['LRZZ2rX7BWua'], 'auth_time': 1439901260, 'iat': 1439901265}
2015-08-18 14:34:25,845 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB"}]}
2015-08-18 14:34:25,846 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "XG7cZ_3IFdzR4Eaza8BWvEJ5gLQtx38aUtje1JINIrE", "use": "sig", "crv": "P-256", "kty": "EC", "y": "I6d2og74szE-KBu8MWk6U5fgkuF1YB9O_w0k8Ev1aJQ", "kid": "op2"}]}
2015-08-18 14:34:25,846 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "_0uNDKqFqlfsKLEJNvohKsxoExkW8V3an49LXX-rZDw", "use": "enc", "crv": "P-256", "kty": "EC", "y": "G2116wNwCf2T2d3HDx26bbjsp-bqupxe0pjzh4DP11o", "kid": "op3"}]}
2015-08-18 14:34:25,847 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057b7160>]
2015-08-18 14:34:25,854 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:34:25,855 oic.oic.provider:DEBUG _tinfo: {'sub': '3c31a5da7b3cfee8', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIjNjMzFhNWRhN2IzY2ZlZTgiLCAiZXhwIjogMTQzOTk4MDQ2NSwgIm5vbmNlIjogIlRaZ2dMNmU4em1xUkt6djQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImF1ZCI6IFsiTFJaWjJyWDdCV3VhIl0sICJhdXRoX3RpbWUiOiAxNDM5OTAxMjYwLCAiaWF0IjogMTQzOTkwMTI2NX0.hobYXNy1HajVJRF9tTRxQ-GgRL4NGTUv2Mmw0XsJnrvy2fs940-2LRoxwVtfniOrmIUtw-s2d5I0yQhTsQvNDmay1GCzuv5mkRSou5ssjaCzh_GtKDQ7dNgKaZHM08m-Ck9hsartelK_2_wrjV1TrW4MdQQBAhargsaewvzfniOGl0aKu8tOqBNwvnP4_D12-4MDt8QDNPDWDy1eKzRGNlDVq_5afjFdPvxCKefYYIppvikAGyDQNDqqdCKNubqEm0KHAHk4Gsuqd_K65dgP-LSjgUmNt82qqTwMJwmPsyCmbMOcMEuBFYhnBbeyBqkrSUTBzrE_AjBe8GTLifvdAw', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'redirect_uri': 'http://localhost:8666/authz_cb', 'revoked': False, 'access_token_scope': '?', 'oauth_state': 'token', 'code': 'x9y16Yc99K76xB9jsKnoP1khWIafdk7+154sU+EIQagTmdnalFQdrTGXyit39sAKzieDZk9QvxSGV8q1biYDJ7lbUjHrTqG7rJzMK9k62ks=', 'token_type': 'Bearer', 'expires_in': 3600, 'token_expires_at': 1439901265, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057e7eb8>, 'permission': '', 'refresh_token': 'x9y16Yc99K76xB9jsKnoP1khWIafdk7+154sU+EIQagTmdnalFQdrTGXyit39sAKHWinI0iVufFKz1P32UOxRsMLnCCT0KOB5+2mDpyYnU0=', 'nonce': 'TZggL6e8zmqRKzv4', 'authzreq': '{"client_id": "LRZZ2rX7BWua", "upm_answer": "true", "nonce": "TZggL6e8zmqRKzv4", "scope": "openid profile email address phone", "redirect_uri": "http://localhost:8666/authz_cb", "response_type": "code", "acr_values": "SAML", "state": "RAl3JIVygO1kz8pN"}', 'code_used': True, 'access_token': 'x9y16Yc99K76xB9jsKnoP1khWIafdk7+154sU+EIQagTmdnalFQdrTGXyit39sAK7s6myuFoNhSQ5u39EjMDN3IZWBHBRuklc3hcrvEcmA4=', 'client_id': 'LRZZ2rX7BWua', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:25,856 oic.oic.provider:DEBUG access_token_response: {'token_type': 'Bearer', 'expires_in': 3600, 'refresh_token': 'x9y16Yc99K76xB9jsKnoP1khWIafdk7+154sU+EIQagTmdnalFQdrTGXyit39sAKHWinI0iVufFKz1P32UOxRsMLnCCT0KOB5+2mDpyYnU0=', 'scope': 'openid profile email address phone', 'access_token': 'x9y16Yc99K76xB9jsKnoP1khWIafdk7+154sU+EIQagTmdnalFQdrTGXyit39sAK7s6myuFoNhSQ5u39EjMDN3IZWBHBRuklc3hcrvEcmA4=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIjNjMzFhNWRhN2IzY2ZlZTgiLCAiZXhwIjogMTQzOTk4MDQ2NSwgIm5vbmNlIjogIlRaZ2dMNmU4em1xUkt6djQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImF1ZCI6IFsiTFJaWjJyWDdCV3VhIl0sICJhdXRoX3RpbWUiOiAxNDM5OTAxMjYwLCAiaWF0IjogMTQzOTkwMTI2NX0.hobYXNy1HajVJRF9tTRxQ-GgRL4NGTUv2Mmw0XsJnrvy2fs940-2LRoxwVtfniOrmIUtw-s2d5I0yQhTsQvNDmay1GCzuv5mkRSou5ssjaCzh_GtKDQ7dNgKaZHM08m-Ck9hsartelK_2_wrjV1TrW4MdQQBAhargsaewvzfniOGl0aKu8tOqBNwvnP4_D12-4MDt8QDNPDWDy1eKzRGNlDVq_5afjFdPvxCKefYYIppvikAGyDQNDqqdCKNubqEm0KHAHk4Gsuqd_K65dgP-LSjgUmNt82qqTwMJwmPsyCmbMOcMEuBFYhnBbeyBqkrSUTBzrE_AjBe8GTLifvdAw', 'state': 'RAl3JIVygO1kz8pN'}
2015-08-18 14:34:25,865 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:34:25,891 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:37:41,284 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"e": "AQAB", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 14:37:41,284 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "y": "vUb3RVM9RFtQ8KmWpfUrgOZJYDsHV7Km6mV9pyUVmKY", "kty": "EC", "kid": "op2", "x": "uQX8aNxblRn4QtQwc7mv7J-8dotAxif-fGD8AXq1MfE"}]}
2015-08-18 14:37:41,285 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "y": "KC121geL9DmkvmriUj0cUJrlLfklq-gy-bLpVe4K2bQ", "kty": "EC", "kid": "op3", "x": "hagKiOw7yKAeQOB-0_naqmrnmjfJkRkY-BzsdKDHXYw"}]}
2015-08-18 14:37:41,285 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:37:43,047 oicServer:INFO callback: <function webfinger at 0x1055ee6a8>
2015-08-18 14:37:43,068 oicServer:INFO callback: <function op_info at 0x1055ee2f0>
2015-08-18 14:37:43,069 root:INFO op_info
2015-08-18 14:37:43,070 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:37:43,071 oic.oic.provider:INFO provider_info_response: {'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'request_parameter_supported': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_parameter_supported': True, 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'HS512', 'HS256', 'PS256', 'ES256', 'PS512', 'RS256', 'RS512', 'RS384', 'ES384', 'HS384', 'PS384'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES512', 'none', 'HS512', 'HS256', 'PS256', 'ES256', 'PS512', 'RS256', 'RS512', 'RS384', 'ES384', 'HS384', 'PS384'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'scopes_supported': ['offline_access', 'phone', 'openid', 'profile', 'email', 'address', 'openid'], 'request_object_signing_alg_values_supported': ['ES512', 'none', 'HS512', 'HS256', 'PS256', 'ES256', 'PS512', 'RS256', 'RS512', 'RS384', 'ES384', 'HS384', 'PS384'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'end_session_endpoint': 'https://localhost:8092/end_session', 'version': '3.0', 'token_endpoint': 'https://localhost:8092/token', 'require_request_uri_registration': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_supported': ['preferred_username', 'phone_number', 'middle_name', 'nickname', 'sub', 'locale', 'name', 'birthdate', 'email', 'picture', 'zoneinfo', 'updated_at', 'website', 'family_name', 'given_name', 'gender', 'email_verified', 'phone_number_verified', 'profile', 'address'], 'issuer': 'https://localhost:8092/', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_signing_alg_values_supported': ['ES512', 'none', 'HS512', 'HS256', 'PS256', 'ES256', 'PS512', 'RS256', 'RS512', 'RS384', 'ES384', 'HS384', 'PS384']}
2015-08-18 14:37:43,144 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105645940>
2015-08-18 14:37:43,145 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "response_types": ["code"], "redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "post_logout_redirect_uris": ["http://localhost:8666/logout_success"]}>>
2015-08-18 14:37:43,146 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'response_types': ['code'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:37:43,152 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1439897863, 'client_secret': '86b83cafe91e287e30ea71283e72f407e59d0e05f8c8915f8d5d85a9', 'client_secret_expires_at': 1439984263, 'client_id': 'dp3DaSZGzyss', 'registration_access_token': 'F7N74ydczMMxWJWlBqYopeiGq5Uu5JiZ', 'registration_client_uri': 'https://localhost:8092/registration?client_id=dp3DaSZGzyss'}
2015-08-18 14:37:43,153 oic.utils.keyio:DEBUG loading keys for issuer: dp3DaSZGzyss
2015-08-18 14:37:43,154 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'response_types': ['code'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb']}
2015-08-18 14:37:43,154 oic.oic.provider:DEBUG keys for dp3DaSZGzyss: []
2015-08-18 14:37:43,156 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1439897863, 'response_types': ['code'], 'client_secret': '86b83cafe91e287e30ea71283e72f407e59d0e05f8c8915f8d5d85a9', 'application_type': 'web', 'client_secret_expires_at': 1439984263, 'client_id': 'dp3DaSZGzyss', 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'contacts': ['ops@example.com'], 'registration_access_token': 'F7N74ydczMMxWJWlBqYopeiGq5Uu5JiZ', 'registration_client_uri': 'https://localhost:8092/registration?client_id=dp3DaSZGzyss'}
2015-08-18 14:37:43,157 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1439897863, 'client_secret': '86b83cafe91e287e30ea71283e72f407e59d0e05f8c8915f8d5d85a9', 'application_type': 'web', 'contacts': ['ops@example.com'], 'client_id': 'dp3DaSZGzyss', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'client_secret_expires_at': 1439984263, 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=dp3DaSZGzyss', 'registration_access_token': 'F7N74ydczMMxWJWlBqYopeiGq5Uu5JiZ'}
2015-08-18 14:37:43,172 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055ba470>
2015-08-18 14:37:43,172 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&acr_values=SAML&state=je8T9NdaBNMWlCcu&nonce=z2flimKpumLaGnv1&client_id=dp3DaSZGzyss&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'
2015-08-18 14:37:43,173 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f1278>, <jwkest.jwk.RSAKey object at 0x1057c1128>, <jwkest.jwk.ECKey object at 0x1057c1588>]
2015-08-18 14:37:43,174 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'z2flimKpumLaGnv1', 'client_id': 'dp3DaSZGzyss', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'je8T9NdaBNMWlCcu'}
2015-08-18 14:37:43,176 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'z2flimKpumLaGnv1', 'client_id': 'dp3DaSZGzyss', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'je8T9NdaBNMWlCcu'}
2015-08-18 14:37:43,178 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:37:43,178 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:37:43,179 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:37:43,179 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:37:43,180 oic.utils.authn.user:INFO do_authentication argv: {'password': '', 'action': 'https://localhost:8092/verify', 'passwd_title': 'Password', 'policy_uri': '', 'submit_text': 'Submit', 'logo_uri': '', 'tos_uri': '', 'query': 'scope=openid+profile+email+address+phone&acr_values=SAML&state=je8T9NdaBNMWlCcu&nonce=z2flimKpumLaGnv1&client_id=dp3DaSZGzyss&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code', 'client_policy_title': 'Client Policy', 'acr': ['SAML'], 'title': 'User log in', 'login_title': 'Username', 'login': ''}
2015-08-18 14:37:43,196 oicServer:INFO callback: <function css at 0x1055be620>
2015-08-18 14:37:47,101 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105747598>
2015-08-18 14:37:47,101 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DSAML%26state%3Dje8T9NdaBNMWlCcu%26nonce%3Dz2flimKpumLaGnv1%26client_id%3Ddp3DaSZGzyss%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:37:47,102 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'query': ['scope=openid+profile+email+address+phone&acr_values=SAML&state=je8T9NdaBNMWlCcu&nonce=z2flimKpumLaGnv1&client_id=dp3DaSZGzyss&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'], 'acr_values': ["['SAML']"], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-18 14:37:47,102 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-18 14:37:47,105 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['z2flimKpumLaGnv1'], 'upm_answer': 'true', 'client_id': ['dp3DaSZGzyss'], 'scope': ['openid profile email address phone'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'acr_values': ['SAML'], 'response_type': ['code'], 'state': ['je8T9NdaBNMWlCcu']}
2015-08-18 14:37:47,122 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055ba470>
2015-08-18 14:37:47,122 oic.oauth2.provider:DEBUG Request: 'nonce=z2flimKpumLaGnv1&upm_answer=true&client_id=dp3DaSZGzyss&scope=openid+profile+email+address+phone&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&acr_values=SAML&response_type=code&state=je8T9NdaBNMWlCcu'
2015-08-18 14:37:47,123 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f1278>, <jwkest.jwk.RSAKey object at 0x1057c1128>, <jwkest.jwk.ECKey object at 0x1057c1588>]
2015-08-18 14:37:47,124 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'z2flimKpumLaGnv1', 'upm_answer': 'true', 'client_id': 'dp3DaSZGzyss', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'je8T9NdaBNMWlCcu'}
2015-08-18 14:37:47,126 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'z2flimKpumLaGnv1', 'upm_answer': 'true', 'client_id': 'dp3DaSZGzyss', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'je8T9NdaBNMWlCcu'}
2015-08-18 14:37:47,128 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:37:47,129 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:37:47,129 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:37:47,130 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:37:47,130 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:37:47,131 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'upm_answer', 'client_id', 'scope', 'redirect_uri', 'acr_values', 'response_type', 'state']
2015-08-18 14:37:47,131 oic.utils.sdb:DEBUG uid2sid: {'diana': ['c61e5ff77c43cc82b76deeaca51f90e7a961bc2df1ea16261a573d61']}
2015-08-18 14:37:47,132 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:37:47,132 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:37:47,135 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=Pr0IiMOX%2FxL%2BVyp2eaX0cdkND5Lw4u3cvx1cnqro%2BXHNuY6ymKgD4XnC08aobdBSF%2B3Yj5niHGIguunffUEXuiq2Cf%2B7WwsGCo%2FXJ8nLZTo%3D&state=je8T9NdaBNMWlCcu' (<class 'str'>)
2015-08-18 14:37:49,591 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055ba518>
2015-08-18 14:37:49,592 oic.oic.provider:DEBUG - token -
2015-08-18 14:37:49,592 oic.oic.provider:INFO token_request: client_id=dp3DaSZGzyss&key=eyJlIjogIkFRQUIiLCAia3R5IjogIlJTQSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJ1c2UiOiAic2lnIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ%3D%3D&code=Pr0IiMOX%2FxL%2BVyp2eaX0cdkND5Lw4u3cvx1cnqro%2BXHNuY6ymKgD4XnC08aobdBSF%2B3Yj5niHGIguunffUEXuiq2Cf%2B7WwsGCo%2FXJ8nLZTo%3D&client_secret=86b83cafe91e287e30ea71283e72f407e59d0e05f8c8915f8d5d85a9&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&token_type=pop&grant_type=authorization_code
2015-08-18 14:37:49,593 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'Pr0IiMOX/xL+Vyp2eaX0cdkND5Lw4u3cvx1cnqro+XHNuY6ymKgD4XnC08aobdBSF+3Yj5niHGIguunffUEXuiq2Cf+7WwsGCo/XJ8nLZTo=', 'grant_type': 'authorization_code', 'client_secret': '86b83cafe91e287e30ea71283e72f407e59d0e05f8c8915f8d5d85a9', 'token_type': 'pop', 'client_id': 'dp3DaSZGzyss', 'key': 'eyJlIjogIkFRQUIiLCAia3R5IjogIlJTQSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJ1c2UiOiAic2lnIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:37:49,593 oic.utils.authn.client:DEBUG REQ: {'code': 'Pr0IiMOX/xL+Vyp2eaX0cdkND5Lw4u3cvx1cnqro+XHNuY6ymKgD4XnC08aobdBSF+3Yj5niHGIguunffUEXuiq2Cf+7WwsGCo/XJ8nLZTo=', 'grant_type': 'authorization_code', 'client_secret': '86b83cafe91e287e30ea71283e72f407e59d0e05f8c8915f8d5d85a9', 'token_type': 'pop', 'client_id': 'dp3DaSZGzyss', 'key': 'eyJlIjogIkFRQUIiLCAia3R5IjogIlJTQSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImtpZCI6ICJhMCIsICJ1c2UiOiAic2lnIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUifQ==', 'redirect_uri': 'http://localhost:8666/authz_cb'}
2015-08-18 14:37:49,594 oic.utils.authn.client:DEBUG Verified Client ID: dp3DaSZGzyss
2015-08-18 14:37:49,598 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:37:49,600 oic.oic:DEBUG authzreq: {'nonce': 'z2flimKpumLaGnv1', 'upm_answer': 'true', 'client_id': 'dp3DaSZGzyss', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'je8T9NdaBNMWlCcu'}
2015-08-18 14:37:49,600 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:37:49,601 oic.oic:DEBUG authzreq: {'nonce': 'z2flimKpumLaGnv1', 'upm_answer': 'true', 'client_id': 'dp3DaSZGzyss', 'scope': 'openid profile email address phone', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'state': 'je8T9NdaBNMWlCcu'}
2015-08-18 14:37:49,602 oic.oic.provider:DEBUG id_token: {'iss': 'https://localhost:8092/', 'iat': 1439901469, 'nonce': 'z2flimKpumLaGnv1', 'acr': 'PASSWORD', 'sub': '1b5adb25286dd67', 'aud': ['dp3DaSZGzyss'], 'exp': 1439980669, 'auth_time': 1439901467}
2015-08-18 14:37:49,604 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"e": "AQAB", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"e": "AQAB", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-18 14:37:49,604 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "y": "vUb3RVM9RFtQ8KmWpfUrgOZJYDsHV7Km6mV9pyUVmKY", "kty": "EC", "kid": "op2", "x": "uQX8aNxblRn4QtQwc7mv7J-8dotAxif-fGD8AXq1MfE"}]}
2015-08-18 14:37:49,605 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "y": "KC121geL9DmkvmriUj0cUJrlLfklq-gy-bLpVe4K2bQ", "kty": "EC", "kid": "op3", "x": "hagKiOw7yKAeQOB-0_naqmrnmjfJkRkY-BzsdKDHXYw"}]}
2015-08-18 14:37:49,605 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c1128>]
2015-08-18 14:37:49,613 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:37:49,614 oic.oic.provider:DEBUG _tinfo: {'access_token': 'Pr0IiMOX/xL+Vyp2eaX0cdkND5Lw4u3cvx1cnqro+XHNuY6ymKgD4XnC08aobdBSDuuCrHgAHgBK4BeTxM6NyEJUvkl775Ypw7L+4RI0Ips=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQzOTkwMTQ2OSwgIm5vbmNlIjogInoyZmxpbUtwdW1MYUdudjEiLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICIxYjVhZGIyNTI4NmRkNjciLCAiYXVkIjogWyJkcDNEYVNaR3p5c3MiXSwgImV4cCI6IDE0Mzk5ODA2NjksICJhdXRoX3RpbWUiOiAxNDM5OTAxNDY3fQ.wH11rZSnVn_5bk_xUeN6aarcnb_qfbWB6VbtwjBHZArPM0rIc_n0aPGAM1Quo1CW71kBYV8wH4YLIh-4A0MrYz9NKWobRCQbcWny3izuCR9S2PV9KNrkSiA1da0WLfhSA-R6ZVZr-NEfhIT0NNNlRq7IzCDjmnCYn8hA4fanktW_Ki8UEjjmKZVh6DzLXSwkiskZDRlYuNLI_tg9AB4rlwHndWCv8WApS7-B7iz-OFerZBIOFrDQDtTk2d80Dr_sV1aBcSu1damb_cZ1NzuzqOzM7d--lUHn0W_sNzQ5ZcABg5ghl0QpTWQs-nUd2vlHuDKEmeG2NUzRp941OfZO7Q', 'code_used': True, 'permission': '', 'sub': '1b5adb25286dd67', 'authzreq': '{"nonce": "z2flimKpumLaGnv1", "upm_answer": "true", "client_id": "dp3DaSZGzyss", "scope": "openid profile email address phone", "redirect_uri": "http://localhost:8666/authz_cb", "acr_values": "SAML", "response_type": "code", "state": "je8T9NdaBNMWlCcu"}', 'client_id': 'dp3DaSZGzyss', 'expires_in': 3600, 'revoked': False, 'refresh_token': 'Pr0IiMOX/xL+Vyp2eaX0cdkND5Lw4u3cvx1cnqro+XHNuY6ymKgD4XnC08aobdBSpsIg4+KSWvWPRH1Pdo+FeXFFGGd226P+grCuuJ6dmxU=', 'state': 'je8T9NdaBNMWlCcu', 'code': 'Pr0IiMOX/xL+Vyp2eaX0cdkND5Lw4u3cvx1cnqro+XHNuY6ymKgD4XnC08aobdBSF+3Yj5niHGIguunffUEXuiq2Cf+7WwsGCo/XJ8nLZTo=', 'nonce': 'z2flimKpumLaGnv1', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f1fd0>, 'token_type': 'Bearer', 'oauth_state': 'token', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_expires_at': 1439901469, 'access_token_scope': '?'}
2015-08-18 14:37:49,614 oic.oic.provider:DEBUG access_token_response: {'access_token': 'Pr0IiMOX/xL+Vyp2eaX0cdkND5Lw4u3cvx1cnqro+XHNuY6ymKgD4XnC08aobdBSDuuCrHgAHgBK4BeTxM6NyEJUvkl775Ypw7L+4RI0Ips=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQzOTkwMTQ2OSwgIm5vbmNlIjogInoyZmxpbUtwdW1MYUdudjEiLCAiYWNyIjogIlBBU1NXT1JEIiwgInN1YiI6ICIxYjVhZGIyNTI4NmRkNjciLCAiYXVkIjogWyJkcDNEYVNaR3p5c3MiXSwgImV4cCI6IDE0Mzk5ODA2NjksICJhdXRoX3RpbWUiOiAxNDM5OTAxNDY3fQ.wH11rZSnVn_5bk_xUeN6aarcnb_qfbWB6VbtwjBHZArPM0rIc_n0aPGAM1Quo1CW71kBYV8wH4YLIh-4A0MrYz9NKWobRCQbcWny3izuCR9S2PV9KNrkSiA1da0WLfhSA-R6ZVZr-NEfhIT0NNNlRq7IzCDjmnCYn8hA4fanktW_Ki8UEjjmKZVh6DzLXSwkiskZDRlYuNLI_tg9AB4rlwHndWCv8WApS7-B7iz-OFerZBIOFrDQDtTk2d80Dr_sV1aBcSu1damb_cZ1NzuzqOzM7d--lUHn0W_sNzQ5ZcABg5ghl0QpTWQs-nUd2vlHuDKEmeG2NUzRp941OfZO7Q', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'refresh_token': 'Pr0IiMOX/xL+Vyp2eaX0cdkND5Lw4u3cvx1cnqro+XHNuY6ymKgD4XnC08aobdBSpsIg4+KSWvWPRH1Pdo+FeXFFGGd226P+grCuuJ6dmxU=', 'state': 'je8T9NdaBNMWlCcu', 'token_type': 'Bearer'}
2015-08-18 14:37:49,622 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:37:49,641 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:37:54,672 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x105645898>
2015-08-18 14:43:43,683 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 14:43:43,684 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "Hee-CvAKBNOMw3g4HKs1_4eFDGn4_enXgnHnaXBQ-EM", "x": "1OIrPwL5JwYtFMlVdq-Nw3NAnMyKGcRMVYos95_oXX8", "kid": "op2", "use": "sig", "crv": "P-256"}]}
2015-08-18 14:43:43,684 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "pyMHKrf33iDKzDC-vYZmdSe0eMx0Bc6Cd12f5pMaWBE", "x": "hbdMF9t62-hIDGfjuaRBmj1HKi3ru1pna3G74FcdxQQ", "kid": "op3", "use": "enc", "crv": "P-256"}]}
2015-08-18 14:43:43,685 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-18 14:43:48,635 oicServer:INFO callback: <function webfinger at 0x1055ed6a8>
2015-08-18 14:43:48,654 oicServer:INFO callback: <function op_info at 0x1055ed2f0>
2015-08-18 14:43:48,654 root:INFO op_info
2015-08-18 14:43:48,655 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-18 14:43:48,655 oic.oic.provider:INFO provider_info_response: {'id_token_signing_alg_values_supported': ['HS512', 'PS256', 'PS384', 'RS256', 'HS384', 'none', 'ES256', 'HS256', 'ES384', 'RS512', 'PS512', 'ES512', 'RS384'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'scopes_supported': ['email', 'phone', 'offline_access', 'address', 'profile', 'openid', 'openid'], 'token_endpoint': 'https://localhost:8092/token', 'request_object_signing_alg_values_supported': ['HS512', 'PS256', 'PS384', 'RS256', 'HS384', 'none', 'ES256', 'HS256', 'ES384', 'RS512', 'PS512', 'ES512', 'RS384'], 'userinfo_signing_alg_values_supported': ['HS512', 'PS256', 'PS384', 'RS256', 'HS384', 'none', 'ES256', 'HS256', 'ES384', 'RS512', 'PS512', 'ES512', 'RS384'], 'claims_supported': ['website', 'email', 'phone_number_verified', 'given_name', 'middle_name', 'zoneinfo', 'preferred_username', 'nickname', 'name', 'family_name', 'birthdate', 'locale', 'updated_at', 'sub', 'gender', 'email_verified', 'picture', 'profile', 'phone_number', 'address'], 'require_request_uri_registration': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'claims_parameter_supported': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8092/registration', 'subject_types_supported': ['public', 'pairwise'], 'acr_values_supported': ['PASSWORD'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_parameter_supported': True, 'version': '3.0', 'request_uri_parameter_supported': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint_auth_signing_alg_values_supported': ['HS512', 'PS256', 'PS384', 'RS256', 'HS384', 'ES256', 'HS256', 'ES384', 'RS512', 'PS512', 'ES512', 'RS384'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW']}
2015-08-18 14:43:48,725 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x105643978>
2015-08-18 14:43:48,725 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "application_type": "web", "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"]}>>
2015-08-18 14:43:48,726 oic.oic.provider:INFO registration_request:{'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 14:43:48,732 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': '5sGbzrcpmQVRXglJnt0Jl6cuB0C4Cj25', 'client_secret_expires_at': 1439984628, 'client_id': 'PRVAmBOldZUj', 'client_id_issued_at': 1439898228, 'client_secret': '3a3a0fdc22977571eac7274f0cc1d16df0fc476a9cb00cfc13c7145a', 'registration_client_uri': 'https://localhost:8092/registration?client_id=PRVAmBOldZUj'}
2015-08-18 14:43:48,734 oic.utils.keyio:DEBUG loading keys for issuer: PRVAmBOldZUj
2015-08-18 14:43:48,734 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success']}
2015-08-18 14:43:48,734 oic.oic.provider:DEBUG keys for PRVAmBOldZUj: []
2015-08-18 14:43:48,736 oic.oic.provider:INFO Client info: {'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'registration_access_token': '5sGbzrcpmQVRXglJnt0Jl6cuB0C4Cj25', 'client_secret_expires_at': 1439984628, 'client_id': 'PRVAmBOldZUj', 'client_id_issued_at': 1439898228, 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'contacts': ['ops@example.com'], 'application_type': 'web', 'client_secret': '3a3a0fdc22977571eac7274f0cc1d16df0fc476a9cb00cfc13c7145a', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=PRVAmBOldZUj'}
2015-08-18 14:43:48,737 oic.oic.provider:DEBUG registration_response: {'redirect_uris': ['http://localhost:8666/authz_cb'], 'registration_access_token': '5sGbzrcpmQVRXglJnt0Jl6cuB0C4Cj25', 'client_secret_expires_at': 1439984628, 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_id_issued_at': 1439898228, 'registration_client_uri': 'https://localhost:8092/registration?client_id=PRVAmBOldZUj', 'contacts': ['ops@example.com'], 'application_type': 'web', 'client_secret': '3a3a0fdc22977571eac7274f0cc1d16df0fc476a9cb00cfc13c7145a', 'response_types': ['code'], 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:43:48,751 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b94a8>
2015-08-18 14:43:48,752 oic.oauth2.provider:DEBUG Request: 'state=SM5qEbZCSBLzOmWD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&acr_values=SAML&client_id=PRVAmBOldZUj&response_type=code&nonce=fc6T3Zq6iyaywG0K'
2015-08-18 14:43:48,753 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f12b0>, <jwkest.jwk.RSAKey object at 0x1057c1160>, <jwkest.jwk.ECKey object at 0x1057c15f8>]
2015-08-18 14:43:48,754 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'nonce': 'fc6T3Zq6iyaywG0K', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:43:48,756 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'nonce': 'fc6T3Zq6iyaywG0K', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:43:48,758 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:43:48,759 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:43:48,759 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:43:48,759 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:43:48,760 oic.utils.authn.user:INFO do_authentication argv: {'acr': ['SAML'], 'login_title': 'Username', 'password': '', 'client_policy_title': 'Client Policy', 'login': '', 'tos_uri': '', 'policy_uri': '', 'submit_text': 'Submit', 'logo_uri': '', 'action': 'https://localhost:8092/verify', 'passwd_title': 'Password', 'query': 'state=SM5qEbZCSBLzOmWD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&acr_values=SAML&client_id=PRVAmBOldZUj&response_type=code&nonce=fc6T3Zq6iyaywG0K', 'title': 'User log in'}
2015-08-18 14:43:48,780 oicServer:INFO callback: <function css at 0x1055be620>
2015-08-18 14:43:52,633 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x105745598>
2015-08-18 14:43:52,633 oic.utils.authn.user:DEBUG verify(query=state%3DSM5qEbZCSBLzOmWD%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26acr_values%3DSAML%26client_id%3DPRVAmBOldZUj%26response_type%3Dcode%26nonce%3Dfc6T3Zq6iyaywG0K&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-18 14:43:52,634 oic.utils.authn.user:DEBUG dict: {'acr_values': ["['SAML']"], 'password': ['krall'], 'query': ['state=SM5qEbZCSBLzOmWD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&acr_values=SAML&client_id=PRVAmBOldZUj&response_type=code&nonce=fc6T3Zq6iyaywG0K'], 'form.commit': ['Submit'], 'login': ['diana']}
2015-08-18 14:43:52,634 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'babs': 'howes', 'diana': 'krall'}
2015-08-18 14:43:52,636 oic.utils.authn.user:DEBUG kwargs: {'scope': ['openid profile email address phone'], 'state': ['SM5qEbZCSBLzOmWD'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'upm_answer': 'true', 'nonce': ['fc6T3Zq6iyaywG0K'], 'acr_values': ['SAML'], 'response_type': ['code'], 'client_id': ['PRVAmBOldZUj']}
2015-08-18 14:43:52,653 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x1055b94a8>
2015-08-18 14:43:52,654 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&state=SM5qEbZCSBLzOmWD&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true&nonce=fc6T3Zq6iyaywG0K&acr_values=SAML&response_type=code&client_id=PRVAmBOldZUj'
2015-08-18 14:43:52,655 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1057f12b0>, <jwkest.jwk.RSAKey object at 0x1057c1160>, <jwkest.jwk.ECKey object at 0x1057c15f8>]
2015-08-18 14:43:52,656 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'nonce': 'fc6T3Zq6iyaywG0K', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:43:52,657 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'nonce': 'fc6T3Zq6iyaywG0K', 'upm_answer': 'true', 'redirect_uri': 'http://localhost:8666/authz_cb', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:43:52,660 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:43:52,660 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-18 14:43:52,660 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-18 14:43:52,661 oic.oauth2.provider:INFO No active authentication
2015-08-18 14:43:52,661 oic.oic.provider:DEBUG - authenticated -
2015-08-18 14:43:52,662 oic.oic.provider:DEBUG AREQ keys: ['scope', 'state', 'redirect_uri', 'upm_answer', 'nonce', 'acr_values', 'response_type', 'client_id']
2015-08-18 14:43:52,663 oic.utils.sdb:DEBUG uid2sid: {'diana': ['365f330b5eeeb6a1c330cd23f572b905ed0b6fd73807659984535041']}
2015-08-18 14:43:52,663 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-18 14:43:52,663 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-18 14:43:52,666 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=TpNemzuhkmb3xw87MBWgdoIZSQuq3%2Bu6xqLOGcWT0B6fE%2BsYpMuftwkDzOITbAFKlj3XiEB2hY2D%2B7DqAsZbr7B5qO3N9rP8Rj1TLThvZuQ%3D&state=SM5qEbZCSBLzOmWD' (<class 'str'>)
2015-08-18 14:43:57,918 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x1055b9550>
2015-08-18 14:43:57,919 oic.oic.provider:DEBUG - token -
2015-08-18 14:43:57,920 oic.oic.provider:INFO token_request: redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=TpNemzuhkmb3xw87MBWgdoIZSQuq3%2Bu6xqLOGcWT0B6fE%2BsYpMuftwkDzOITbAFKlj3XiEB2hY2D%2B7DqAsZbr7B5qO3N9rP8Rj1TLThvZuQ%3D&token_type=pop&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ%3D%3D&client_secret=3a3a0fdc22977571eac7274f0cc1d16df0fc476a9cb00cfc13c7145a&client_id=PRVAmBOldZUj&grant_type=authorization_code
2015-08-18 14:43:57,921 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKlj3XiEB2hY2D+7DqAsZbr7B5qO3N9rP8Rj1TLThvZuQ=', 'client_id': 'PRVAmBOldZUj', 'grant_type': 'authorization_code', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '3a3a0fdc22977571eac7274f0cc1d16df0fc476a9cb00cfc13c7145a', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ=='}
2015-08-18 14:43:57,921 oic.utils.authn.client:DEBUG REQ: {'code': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKlj3XiEB2hY2D+7DqAsZbr7B5qO3N9rP8Rj1TLThvZuQ=', 'client_id': 'PRVAmBOldZUj', 'grant_type': 'authorization_code', 'token_type': 'pop', 'redirect_uri': 'http://localhost:8666/authz_cb', 'client_secret': '3a3a0fdc22977571eac7274f0cc1d16df0fc476a9cb00cfc13c7145a', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJraWQiOiAiYTAifQ=='}
2015-08-18 14:43:57,922 oic.utils.authn.client:DEBUG Verified Client ID: PRVAmBOldZUj
2015-08-18 14:43:57,925 oic.oic.provider:DEBUG All checks OK
2015-08-18 14:43:57,927 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'fc6T3Zq6iyaywG0K', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:43:57,927 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-18 14:43:57,928 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'fc6T3Zq6iyaywG0K', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:43:57,928 oic.oic.provider:DEBUG id_token: {'acr': 'PASSWORD', 'sub': '-324335603015e4d7', 'iss': 'https://localhost:8092/', 'exp': 1439981037, 'aud': ['PRVAmBOldZUj'], 'nonce': 'fc6T3Zq6iyaywG0K', 'auth_time': 1439901832, 'iat': 1439901837}
2015-08-18 14:43:57,930 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-18 14:43:57,931 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "y": "Hee-CvAKBNOMw3g4HKs1_4eFDGn4_enXgnHnaXBQ-EM", "x": "1OIrPwL5JwYtFMlVdq-Nw3NAnMyKGcRMVYos95_oXX8", "kid": "op2", "use": "sig", "crv": "P-256"}]}
2015-08-18 14:43:57,932 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "y": "pyMHKrf33iDKzDC-vYZmdSe0eMx0Bc6Cd12f5pMaWBE", "x": "hbdMF9t62-hIDGfjuaRBmj1HKi3ru1pna3G74FcdxQQ", "kid": "op3", "use": "enc", "crv": "P-256"}]}
2015-08-18 14:43:57,932 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1057c1160>]
2015-08-18 14:43:57,941 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:43:57,942 oic.oic.provider:DEBUG _tinfo: {'authzreq': '{"scope": "openid profile email address phone", "state": "SM5qEbZCSBLzOmWD", "nonce": "fc6T3Zq6iyaywG0K", "upm_answer": "true", "redirect_uri": "http://localhost:8666/authz_cb", "acr_values": "SAML", "response_type": "code", "client_id": "PRVAmBOldZUj"}', 'state': 'SM5qEbZCSBLzOmWD', 'token_type': 'Bearer', 'nonce': 'fc6T3Zq6iyaywG0K', 'permission': '', 'code': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKlj3XiEB2hY2D+7DqAsZbr7B5qO3N9rP8Rj1TLThvZuQ=', 'access_token': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKDwLi0gGQzn+BnP1z4CBeOVI+7/nKKnjZSYEbh+8OlE8=', 'oauth_state': 'token', 'expires_in': 3600, 'sub': '-324335603015e4d7', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f1a20>, 'client_id': 'PRVAmBOldZUj', 'code_used': True, 'access_token_scope': '?', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi0zMjQzMzU2MDMwMTVlNGQ3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJleHAiOiAxNDM5OTgxMDM3LCAiYXVkIjogWyJQUlZBbUJPbGRaVWoiXSwgIm5vbmNlIjogImZjNlQzWnE2aXlheXdHMEsiLCAiYXV0aF90aW1lIjogMTQzOTkwMTgzMiwgImlhdCI6IDE0Mzk5MDE4Mzd9.Gh53Z3OQ3Q8geGK5kbu4n4GsslVCBA9PlfciIjQlrgoOVaI4pS90uZsipSQV22lacZ3EZNAWDPZMnUt6D1TmTUO0ZMu_vlDISijRkXJ56akbDBanmpFmZWIrUQHVlRW9yFRvMFMJRTBK78SYSMPbS_TcxQfyGp3etg4I0KFmDjq-ysWAOSv92bq27dv2q1iNCl1xkaHrc1yuBkouX5CwisX_qyewRfShzMYi4pjoyWI6hF2yFSGDTd1BjIONhoP1yademd_ArpyG8D8rd6IJHckEohJk30mLjGg2Pn4IRp_eBo_Rz2IEghsEStwyx0BRQaTQ5JYNsHSOeIwS9OZqZA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_expires_at': 1439901837, 'refresh_token': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKYNu7Rt6vUvfUlDF5PlTsiaZifYbxIHBov/7veiweUW0=', 'revoked': False}
2015-08-18 14:43:57,942 oic.oic.provider:DEBUG access_token_response: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'token_type': 'Bearer', 'expires_in': 3600, 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi0zMjQzMzU2MDMwMTVlNGQ3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJleHAiOiAxNDM5OTgxMDM3LCAiYXVkIjogWyJQUlZBbUJPbGRaVWoiXSwgIm5vbmNlIjogImZjNlQzWnE2aXlheXdHMEsiLCAiYXV0aF90aW1lIjogMTQzOTkwMTgzMiwgImlhdCI6IDE0Mzk5MDE4Mzd9.Gh53Z3OQ3Q8geGK5kbu4n4GsslVCBA9PlfciIjQlrgoOVaI4pS90uZsipSQV22lacZ3EZNAWDPZMnUt6D1TmTUO0ZMu_vlDISijRkXJ56akbDBanmpFmZWIrUQHVlRW9yFRvMFMJRTBK78SYSMPbS_TcxQfyGp3etg4I0KFmDjq-ysWAOSv92bq27dv2q1iNCl1xkaHrc1yuBkouX5CwisX_qyewRfShzMYi4pjoyWI6hF2yFSGDTd1BjIONhoP1yademd_ArpyG8D8rd6IJHckEohJk30mLjGg2Pn4IRp_eBo_Rz2IEghsEStwyx0BRQaTQ5JYNsHSOeIwS9OZqZA', 'refresh_token': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKYNu7Rt6vUvfUlDF5PlTsiaZifYbxIHBov/7veiweUW0=', 'access_token': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKDwLi0gGQzn+BnP1z4CBeOVI+7/nKKnjZSYEbh+8OlE8='}
2015-08-18 14:43:57,951 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-18 14:43:57,977 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-18 14:44:51,033 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x1056438d0>
2015-08-18 14:45:06,195 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-18 14:45:23,159 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-18 14:45:24,609 oic.oic.provider:DEBUG access_token type: 'T'
2015-08-18 14:45:24,610 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'state': 'SM5qEbZCSBLzOmWD', 'redirect_uri': 'http://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'fc6T3Zq6iyaywG0K', 'acr_values': 'SAML', 'response_type': 'code', 'client_id': 'PRVAmBOldZUj'}
2015-08-18 14:45:24,611 oic.oic.provider:DEBUG userinfo_claim: {'website': None, 'email': None, 'phone_number_verified': None, 'given_name': None, 'middle_name': None, 'zoneinfo': None, 'updated_at': None, 'preferred_username': None, 'nickname': None, 'name': None, 'family_name': None, 'birthdate': None, 'sub': None, 'gender': None, 'locale': None, 'email_verified': None, 'picture': None, 'profile': None, 'phone_number': None, 'address': None}
2015-08-18 14:45:24,611 oic.oic.provider:DEBUG Session info: {'authzreq': '{"scope": "openid profile email address phone", "state": "SM5qEbZCSBLzOmWD", "nonce": "fc6T3Zq6iyaywG0K", "upm_answer": "true", "redirect_uri": "http://localhost:8666/authz_cb", "acr_values": "SAML", "response_type": "code", "client_id": "PRVAmBOldZUj"}', 'state': 'SM5qEbZCSBLzOmWD', 'token_type': 'Bearer', 'nonce': 'fc6T3Zq6iyaywG0K', 'permission': '', 'code': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKlj3XiEB2hY2D+7DqAsZbr7B5qO3N9rP8Rj1TLThvZuQ=', 'access_token': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKDwLi0gGQzn+BnP1z4CBeOVI+7/nKKnjZSYEbh+8OlE8=', 'oauth_state': 'token', 'expires_in': 3600, 'sub': '-324335603015e4d7', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1057f1a20>, 'client_id': 'PRVAmBOldZUj', 'code_used': True, 'access_token_scope': '?', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJhY3IiOiAiUEFTU1dPUkQiLCAic3ViIjogIi0zMjQzMzU2MDMwMTVlNGQ3IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJleHAiOiAxNDM5OTgxMDM3LCAiYXVkIjogWyJQUlZBbUJPbGRaVWoiXSwgIm5vbmNlIjogImZjNlQzWnE2aXlheXdHMEsiLCAiYXV0aF90aW1lIjogMTQzOTkwMTgzMiwgImlhdCI6IDE0Mzk5MDE4Mzd9.Gh53Z3OQ3Q8geGK5kbu4n4GsslVCBA9PlfciIjQlrgoOVaI4pS90uZsipSQV22lacZ3EZNAWDPZMnUt6D1TmTUO0ZMu_vlDISijRkXJ56akbDBanmpFmZWIrUQHVlRW9yFRvMFMJRTBK78SYSMPbS_TcxQfyGp3etg4I0KFmDjq-ysWAOSv92bq27dv2q1iNCl1xkaHrc1yuBkouX5CwisX_qyewRfShzMYi4pjoyWI6hF2yFSGDTd1BjIONhoP1yademd_ArpyG8D8rd6IJHckEohJk30mLjGg2Pn4IRp_eBo_Rz2IEghsEStwyx0BRQaTQ5JYNsHSOeIwS9OZqZA', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_expires_at': 1439901837, 'refresh_token': 'TpNemzuhkmb3xw87MBWgdoIZSQuq3+u6xqLOGcWT0B6fE+sYpMuftwkDzOITbAFKYNu7Rt6vUvfUlDF5PlTsiaZifYbxIHBov/7veiweUW0=', 'revoked': False}
2015-08-18 14:45:24,612 oic.oic.provider:DEBUG user_info_response: {'family_name': 'Krall', 'email': 'diana@example.org', 'sub': '-324335603015e4d7', 'given_name': 'Diana', 'email_verified': False, 'nickname': 'Dina', 'name': 'Diana Krall', 'phone_number': '+46 90 7865000', 'address': {'postal_code': 'SE-90187', 'locality': 'Ume', 'country': 'Sweden', 'street_address': 'Ume Universitet'}}
2015-08-19 08:51:18,975 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "use": "enc", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "kty": "RSA", "use": "sig", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-19 08:51:18,976 root:INFO OC3 server keys: {"keys": [{"y": "Wy-1SDzqjhDnymkTgXjY-M1T61_uPZMKH5BOkcTvTnw", "kid": "op2", "kty": "EC", "use": "sig", "x": "zp-XZa26cuBZ8IxjKheV0bQGHw-HOBd9BUkkeiAXqW0", "crv": "P-256"}]}
2015-08-19 08:51:18,976 root:INFO OC3 server keys: {"keys": [{"y": "P4eIahfFOrNId4Rs5nsr0q5y69l3aZkGZ0s3acD2JPc", "kid": "op3", "kty": "EC", "use": "enc", "x": "bn8e6oHbxHE-CXCdJWZayn30pU_Fo6O_sOtTekGaPfg", "crv": "P-256"}]}
2015-08-19 08:51:18,976 root:INFO OC server starting listening on port:8092 using HTTPS
2015-08-19 08:53:07,328 oicServer:INFO callback: <function webfinger at 0x103b359d8>
2015-08-19 08:53:07,337 oicServer:INFO callback: <function op_info at 0x103b35620>
2015-08-19 08:53:07,337 root:INFO op_info
2015-08-19 08:53:07,337 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-19 08:53:07,337 oic.oic.provider:INFO provider_info_response: {'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'HS384', 'RS256', 'PS512', 'ES256', 'PS384', 'RS512', 'ES512', 'PS256', 'HS512', 'ES384', 'HS256'], 'claims_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint': 'https://localhost:8092/token', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'require_request_uri_registration': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_supported': ['email', 'address', 'sub', 'name', 'middle_name', 'zoneinfo', 'updated_at', 'gender', 'locale', 'email_verified', 'phone_number', 'family_name', 'profile', 'preferred_username', 'website', 'phone_number_verified', 'given_name', 'birthdate', 'picture', 'nickname'], 'subject_types_supported': ['public', 'pairwise'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_signing_alg_values_supported': ['RS384', 'HS384', 'RS256', 'PS512', 'ES256', 'PS384', 'RS512', 'ES512', 'PS256', 'HS512', 'none', 'ES384', 'HS256'], 'issuer': 'https://localhost:8092/', 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'userinfo_signing_alg_values_supported': ['RS384', 'HS384', 'RS256', 'PS512', 'ES256', 'PS384', 'RS512', 'ES512', 'PS256', 'HS512', 'none', 'ES384', 'HS256'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'id_token_signing_alg_values_supported': ['RS384', 'HS384', 'RS256', 'PS512', 'ES256', 'PS384', 'RS512', 'ES512', 'PS256', 'HS512', 'none', 'ES384', 'HS256'], 'version': '3.0', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'acr_values_supported': ['PASSWORD'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'scopes_supported': ['email', 'address', 'openid', 'phone', 'profile', 'offline_access', 'openid'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-19 08:53:07,365 oicServer:INFO callback: <oic.oic.provider.RegistrationEndpoint object at 0x103b303c8>
2015-08-19 08:53:07,365 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "post_logout_redirect_uris": ["http://localhost:8666/logout_success"], "redirect_uris": ["http://localhost:8666/authz_cb"], "application_type": "web", "contacts": ["ops@example.com"]}>>
2015-08-19 08:53:07,365 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com']}
2015-08-19 08:53:07,373 oic.oic.provider:DEBUG _cinfo: {'client_id': 'UdjLMJTeFQaS', 'registration_access_token': 'TkmdNwPYrpWbsYodZhNvguT5h6t5EzHi', 'registration_client_uri': 'https://localhost:8092/registration?client_id=UdjLMJTeFQaS', 'client_secret': '76a3103f51e7b73727b8c43dc6f79404b137cb1dba5bde77c3d3d2a1', 'client_secret_expires_at': 1440049987, 'client_id_issued_at': 1439963587}
2015-08-19 08:53:07,373 oic.utils.keyio:DEBUG loading keys for issuer: UdjLMJTeFQaS
2015-08-19 08:53:07,373 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'response_types': ['code'], 'redirect_uris': ['http://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'contacts': ['ops@example.com']}
2015-08-19 08:53:07,373 oic.oic.provider:DEBUG keys for UdjLMJTeFQaS: []
2015-08-19 08:53:07,375 oic.oic.provider:INFO Client info: {'client_id': 'UdjLMJTeFQaS', 'response_types': ['code'], 'application_type': 'web', 'registration_access_token': 'TkmdNwPYrpWbsYodZhNvguT5h6t5EzHi', 'registration_client_uri': 'https://localhost:8092/registration?client_id=UdjLMJTeFQaS', 'client_secret': '76a3103f51e7b73727b8c43dc6f79404b137cb1dba5bde77c3d3d2a1', 'client_secret_expires_at': 1440049987, 'post_logout_redirect_uris': [('http://localhost:8666/logout_success', None)], 'redirect_uris': [('http://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1439963587, 'contacts': ['ops@example.com']}
2015-08-19 08:53:07,375 oic.oic.provider:DEBUG registration_response: {'client_id': 'UdjLMJTeFQaS', 'response_types': ['code'], 'registration_access_token': 'TkmdNwPYrpWbsYodZhNvguT5h6t5EzHi', 'registration_client_uri': 'https://localhost:8092/registration?client_id=UdjLMJTeFQaS', 'client_secret': '76a3103f51e7b73727b8c43dc6f79404b137cb1dba5bde77c3d3d2a1', 'redirect_uris': ['http://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['http://localhost:8666/logout_success'], 'client_secret_expires_at': 1440049987, 'client_id_issued_at': 1439963587, 'contacts': ['ops@example.com']}
2015-08-19 08:53:07,387 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x103a92da0>
2015-08-19 08:53:07,388 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&response_type=code&state=5t2vZBujwcOPrbf0&client_id=UdjLMJTeFQaS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=0mn8P22GDQszyYiJ&acr_values=SAML'
2015-08-19 08:53:07,388 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x104012cf8>, <jwkest.jwk.RSAKey object at 0x103fef128>, <jwkest.jwk.ECKey object at 0x103fef4e0>]
2015-08-19 08:53:07,388 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'client_id': 'UdjLMJTeFQaS', 'state': '5t2vZBujwcOPrbf0', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:07,390 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'client_id': 'UdjLMJTeFQaS', 'state': '5t2vZBujwcOPrbf0', 'acr_values': 'SAML', 'redirect_uri': 'http://localhost:8666/authz_cb', 'response_type': 'code', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:07,391 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-19 08:53:07,391 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-19 08:53:07,391 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-19 08:53:07,391 oic.oauth2.provider:INFO No active authentication
2015-08-19 08:53:07,392 oic.utils.authn.user:INFO do_authentication argv: {'passwd_title': 'Password', 'login': '', 'logo_uri': '', 'acr': ['SAML'], 'client_policy_title': 'Client Policy', 'login_title': 'Username', 'submit_text': 'Submit', 'action': 'https://localhost:8092/verify', 'password': '', 'query': 'scope=openid+profile+email+address+phone&response_type=code&state=5t2vZBujwcOPrbf0&client_id=UdjLMJTeFQaS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=0mn8P22GDQszyYiJ&acr_values=SAML', 'policy_uri': '', 'title': 'User log in', 'tos_uri': ''}
2015-08-19 08:53:07,406 oicServer:INFO callback: <function css at 0x103aa10d0>
2015-08-19 08:53:11,409 oicServer:INFO callback: <function make_auth_verify.<locals>.auth_verify at 0x103f7b0d0>
2015-08-19 08:53:11,409 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26state%3D5t2vZBujwcOPrbf0%26client_id%3DUdjLMJTeFQaS%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3D0mn8P22GDQszyYiJ%26acr_values%3DSAML&acr_values=%5B%27SAML%27%5D&login=diana&password=krall&form.commit=Submit)
2015-08-19 08:53:11,409 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'acr_values': ["['SAML']"], 'form.commit': ['Submit'], 'login': ['diana'], 'query': ['scope=openid+profile+email+address+phone&response_type=code&state=5t2vZBujwcOPrbf0&client_id=UdjLMJTeFQaS&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=0mn8P22GDQszyYiJ&acr_values=SAML']}
2015-08-19 08:53:11,410 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-19 08:53:11,410 oic.utils.authn.user:DEBUG kwargs: {'scope': ['openid profile email address phone'], 'client_id': ['UdjLMJTeFQaS'], 'state': ['5t2vZBujwcOPrbf0'], 'acr_values': ['SAML'], 'upm_answer': 'true', 'response_type': ['code'], 'redirect_uri': ['http://localhost:8666/authz_cb'], 'nonce': ['0mn8P22GDQszyYiJ']}
2015-08-19 08:53:11,434 oicServer:INFO callback: <oic.oic.provider.AuthorizationEndpoint object at 0x103a92da0>
2015-08-19 08:53:11,434 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&client_id=UdjLMJTeFQaS&state=5t2vZBujwcOPrbf0&acr_values=SAML&upm_answer=true&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=0mn8P22GDQszyYiJ'
2015-08-19 08:53:11,435 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x104012cf8>, <jwkest.jwk.RSAKey object at 0x103fef128>, <jwkest.jwk.ECKey object at 0x103fef4e0>]
2015-08-19 08:53:11,435 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'client_id': 'UdjLMJTeFQaS', 'state': '5t2vZBujwcOPrbf0', 'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:11,436 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'client_id': 'UdjLMJTeFQaS', 'state': '5t2vZBujwcOPrbf0', 'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:11,438 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-19 08:53:11,438 oic.oic.provider:DEBUG Picked AuthN broker for ACR SAML: []
2015-08-19 08:53:11,438 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-19 08:53:11,438 oic.oauth2.provider:INFO No active authentication
2015-08-19 08:53:11,438 oic.oic.provider:DEBUG - authenticated -
2015-08-19 08:53:11,438 oic.oic.provider:DEBUG AREQ keys: ['scope', 'client_id', 'state', 'acr_values', 'upm_answer', 'response_type', 'redirect_uri', 'nonce']
2015-08-19 08:53:11,438 oic.utils.sdb:DEBUG uid2sid: {'diana': ['2037d35f1718987969417f6f0bb7c7c27dca0a51b38674436deb6e07']}
2015-08-19 08:53:11,438 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-19 08:53:11,439 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-19 08:53:11,440 oic.oic.provider:DEBUG Redirected to: 'http://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&state=5t2vZBujwcOPrbf0&code=DQYvEBirfp9%2Bh6szv5pW%2B4Pk8aZlW2WMRjKIBNqp%2BZYxpfKB%2BeFLBO0Ibch66ruPuHXy5J2iRC6T1%2FlCLoDW1CD8MfSdqISLkkzS%2BZ38sYw%3D' (<class 'str'>)
2015-08-19 08:53:11,448 oicServer:INFO callback: <oic.oic.provider.TokenEndpoint object at 0x103b30358>
2015-08-19 08:53:11,449 oic.oic.provider:DEBUG - token -
2015-08-19 08:53:11,449 oic.oic.provider:INFO token_request: grant_type=authorization_code&key=eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJlIjogIkFRQUIiLCAidXNlIjogInNpZyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAia2lkIjogImEwIiwgImt0eSI6ICJSU0EifQ%3D%3D&token_type=pop&redirect_uri=http%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=UdjLMJTeFQaS&code=DQYvEBirfp9%2Bh6szv5pW%2B4Pk8aZlW2WMRjKIBNqp%2BZYxpfKB%2BeFLBO0Ibch66ruPuHXy5J2iRC6T1%2FlCLoDW1CD8MfSdqISLkkzS%2BZ38sYw%3D&client_secret=76a3103f51e7b73727b8c43dc6f79404b137cb1dba5bde77c3d3d2a1
2015-08-19 08:53:11,449 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJlIjogIkFRQUIiLCAidXNlIjogInNpZyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAia2lkIjogImEwIiwgImt0eSI6ICJSU0EifQ==', 'code': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPuHXy5J2iRC6T1/lCLoDW1CD8MfSdqISLkkzS+Z38sYw=', 'client_id': 'UdjLMJTeFQaS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_type': 'pop', 'client_secret': '76a3103f51e7b73727b8c43dc6f79404b137cb1dba5bde77c3d3d2a1'}
2015-08-19 08:53:11,449 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'key': 'eyJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJlIjogIkFRQUIiLCAidXNlIjogInNpZyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAia2lkIjogImEwIiwgImt0eSI6ICJSU0EifQ==', 'code': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPuHXy5J2iRC6T1/lCLoDW1CD8MfSdqISLkkzS+Z38sYw=', 'client_id': 'UdjLMJTeFQaS', 'redirect_uri': 'http://localhost:8666/authz_cb', 'token_type': 'pop', 'client_secret': '76a3103f51e7b73727b8c43dc6f79404b137cb1dba5bde77c3d3d2a1'}
2015-08-19 08:53:11,451 oic.utils.authn.client:DEBUG Verified Client ID: UdjLMJTeFQaS
2015-08-19 08:53:11,456 oic.oic.provider:DEBUG All checks OK
2015-08-19 08:53:11,457 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'UdjLMJTeFQaS', 'state': '5t2vZBujwcOPrbf0', 'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:11,457 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-19 08:53:11,457 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'UdjLMJTeFQaS', 'state': '5t2vZBujwcOPrbf0', 'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:11,457 oic.oic.provider:DEBUG id_token: {'iat': 1439967191, 'aud': ['UdjLMJTeFQaS'], 'sub': '-17f035b51273ea78', 'acr': 'PASSWORD', 'exp': 1440046391, 'auth_time': 1439967191, 'iss': 'https://localhost:8092/', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:11,458 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "use": "enc", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "kty": "RSA", "use": "sig", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-19 08:53:11,459 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "Wy-1SDzqjhDnymkTgXjY-M1T61_uPZMKH5BOkcTvTnw", "kid": "op2", "kty": "EC", "use": "sig", "x": "zp-XZa26cuBZ8IxjKheV0bQGHw-HOBd9BUkkeiAXqW0", "crv": "P-256"}]}
2015-08-19 08:53:11,459 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "P4eIahfFOrNId4Rs5nsr0q5y69l3aZkGZ0s3acD2JPc", "kid": "op3", "kty": "EC", "use": "enc", "x": "bn8e6oHbxHE-CXCdJWZayn30pU_Fo6O_sOtTekGaPfg", "crv": "P-256"}]}
2015-08-19 08:53:11,459 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x103fef128>]
2015-08-19 08:53:11,470 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-19 08:53:11,471 oic.oic.provider:DEBUG _tinfo: {'refresh_token': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPXemPT60kbXGMzvXUCufdnQSHVcD5GPdnowM8KAP3GD0=', 'permission': '', 'state': '5t2vZBujwcOPrbf0', 'sub': '-17f035b51273ea78', 'code': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPuHXy5J2iRC6T1/lCLoDW1CD8MfSdqISLkkzS+Z38sYw=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5OTY3MTkxLCAiYXVkIjogWyJVZGpMTUpUZUZRYVMiXSwgInN1YiI6ICItMTdmMDM1YjUxMjczZWE3OCIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQ0MDA0NjM5MSwgImF1dGhfdGltZSI6IDE0Mzk5NjcxOTEsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAibm9uY2UiOiAiMG1uOFAyMkdEUXN6eVlpSiJ9.V4yFZsYE9ulHWCFRsImgA_7AZUdR97Hs9WcnZ5X_pS5I2GKz827loOjSGMEJ3SFDHFYHGZsInhLVysMWgE01kbLGAuXXVXl4WiDL0vqHpawOalOUscqPaq-qLbQew_tZlCyyr7KASub_U9JucgOuLTrLyDRCCrbJDsAethmOQ4OqkT-AghEHTQwCafo8bjhGlUf7Sq--yfAt5_qZ4xTDdXl-RCc_cOHeBG7n3MFouBzM_0XV4s_LZ4TsBvm_qOgW98Zd5bZZCuPODqYWKuuYzU2-t8KYwnpVpHN5aaK63JWpQuvnxD8tMpBLw82elqPRHbsYZgicEo89e9AScCLphw', 'token_type': 'Bearer', 'code_used': True, 'expires_in': 3600, 'nonce': '0mn8P22GDQszyYiJ', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'client_id': 'UdjLMJTeFQaS', 'oauth_state': 'token', 'access_token_scope': '?', 'revoked': False, 'redirect_uri': 'http://localhost:8666/authz_cb', 'access_token': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPMJKvOWgFShv7RbHjg9yle7/ogfU5CDu1AB+aqf7Yok8=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x104036b70>, 'authzreq': '{"scope": "openid profile email address phone", "client_id": "UdjLMJTeFQaS", "state": "5t2vZBujwcOPrbf0", "acr_values": "SAML", "upm_answer": "true", "response_type": "code", "redirect_uri": "http://localhost:8666/authz_cb", "nonce": "0mn8P22GDQszyYiJ"}', 'token_expires_at': 1439967191}
2015-08-19 08:53:11,471 oic.oic.provider:DEBUG access_token_response: {'refresh_token': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPXemPT60kbXGMzvXUCufdnQSHVcD5GPdnowM8KAP3GD0=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5OTY3MTkxLCAiYXVkIjogWyJVZGpMTUpUZUZRYVMiXSwgInN1YiI6ICItMTdmMDM1YjUxMjczZWE3OCIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQ0MDA0NjM5MSwgImF1dGhfdGltZSI6IDE0Mzk5NjcxOTEsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAibm9uY2UiOiAiMG1uOFAyMkdEUXN6eVlpSiJ9.V4yFZsYE9ulHWCFRsImgA_7AZUdR97Hs9WcnZ5X_pS5I2GKz827loOjSGMEJ3SFDHFYHGZsInhLVysMWgE01kbLGAuXXVXl4WiDL0vqHpawOalOUscqPaq-qLbQew_tZlCyyr7KASub_U9JucgOuLTrLyDRCCrbJDsAethmOQ4OqkT-AghEHTQwCafo8bjhGlUf7Sq--yfAt5_qZ4xTDdXl-RCc_cOHeBG7n3MFouBzM_0XV4s_LZ4TsBvm_qOgW98Zd5bZZCuPODqYWKuuYzU2-t8KYwnpVpHN5aaK63JWpQuvnxD8tMpBLw82elqPRHbsYZgicEo89e9AScCLphw', 'state': '5t2vZBujwcOPrbf0', 'access_token': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPMJKvOWgFShv7RbHjg9yle7/ogfU5CDu1AB+aqf7Yok8=', 'token_type': 'Bearer', 'expires_in': 3600, 'scope': 'openid profile email address phone'}
2015-08-19 08:53:11,477 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-19 08:53:11,486 oic.utils.http_util:INFO [static]sending: static/jwks.json
2015-08-19 08:53:11,500 oicServer:INFO callback: <oic.oic.provider.UserinfoEndpoint object at 0x103b30390>
2015-08-19 08:53:11,502 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-19 08:53:11,503 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-19 08:53:11,504 oic.oic.provider:DEBUG access_token type: 'T'
2015-08-19 08:53:11,504 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'UdjLMJTeFQaS', 'state': '5t2vZBujwcOPrbf0', 'acr_values': 'SAML', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'http://localhost:8666/authz_cb', 'nonce': '0mn8P22GDQszyYiJ'}
2015-08-19 08:53:11,504 oic.oic.provider:DEBUG userinfo_claim: {'email': None, 'address': None, 'middle_name': None, 'updated_at': None, 'zoneinfo': None, 'family_name': None, 'gender': None, 'locale': None, 'email_verified': None, 'profile': None, 'preferred_username': None, 'website': None, 'phone_number_verified': None, 'name': None, 'given_name': None, 'picture': None, 'nickname': None, 'birthdate': None, 'sub': None, 'phone_number': None}
2015-08-19 08:53:11,504 oic.oic.provider:DEBUG Session info: {'refresh_token': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPXemPT60kbXGMzvXUCufdnQSHVcD5GPdnowM8KAP3GD0=', 'permission': '', 'state': '5t2vZBujwcOPrbf0', 'sub': '-17f035b51273ea78', 'code': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPuHXy5J2iRC6T1/lCLoDW1CD8MfSdqISLkkzS+Z38sYw=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDM5OTY3MTkxLCAiYXVkIjogWyJVZGpMTUpUZUZRYVMiXSwgInN1YiI6ICItMTdmMDM1YjUxMjczZWE3OCIsICJhY3IiOiAiUEFTU1dPUkQiLCAiZXhwIjogMTQ0MDA0NjM5MSwgImF1dGhfdGltZSI6IDE0Mzk5NjcxOTEsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAibm9uY2UiOiAiMG1uOFAyMkdEUXN6eVlpSiJ9.V4yFZsYE9ulHWCFRsImgA_7AZUdR97Hs9WcnZ5X_pS5I2GKz827loOjSGMEJ3SFDHFYHGZsInhLVysMWgE01kbLGAuXXVXl4WiDL0vqHpawOalOUscqPaq-qLbQew_tZlCyyr7KASub_U9JucgOuLTrLyDRCCrbJDsAethmOQ4OqkT-AghEHTQwCafo8bjhGlUf7Sq--yfAt5_qZ4xTDdXl-RCc_cOHeBG7n3MFouBzM_0XV4s_LZ4TsBvm_qOgW98Zd5bZZCuPODqYWKuuYzU2-t8KYwnpVpHN5aaK63JWpQuvnxD8tMpBLw82elqPRHbsYZgicEo89e9AScCLphw', 'token_type': 'Bearer', 'code_used': True, 'expires_in': 3600, 'nonce': '0mn8P22GDQszyYiJ', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'client_id': 'UdjLMJTeFQaS', 'oauth_state': 'token', 'access_token_scope': '?', 'revoked': False, 'redirect_uri': 'http://localhost:8666/authz_cb', 'access_token': 'DQYvEBirfp9+h6szv5pW+4Pk8aZlW2WMRjKIBNqp+ZYxpfKB+eFLBO0Ibch66ruPMJKvOWgFShv7RbHjg9yle7/ogfU5CDu1AB+aqf7Yok8=', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x104036b70>, 'authzreq': '{"scope": "openid profile email address phone", "client_id": "UdjLMJTeFQaS", "state": "5t2vZBujwcOPrbf0", "acr_values": "SAML", "upm_answer": "true", "response_type": "code", "redirect_uri": "http://localhost:8666/authz_cb", "nonce": "0mn8P22GDQszyYiJ"}', 'token_expires_at': 1439967191}
2015-08-19 08:53:11,505 oic.oic.provider:DEBUG user_info_response: {'email': 'diana@example.org', 'address': {'postal_code': 'SE-90187', 'locality': 'Ume', 'street_address': 'Ume Universitet', 'country': 'Sweden'}, 'sub': '-17f035b51273ea78', 'name': 'Diana Krall', 'given_name': 'Diana', 'family_name': 'Krall', 'nickname': 'Dina', 'email_verified': False, 'phone_number': '+46 90 7865000'}
2015-08-20 15:49:57,041 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1"}]}
2015-08-20 15:49:57,042 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "use": "sig", "y": "d03OQ1-prPIi7UV6pwV8A656GscNw5NshUwnhNz4N9c", "x": "qtD7vgBBFs56Tqe64Qved-fgVmt1zlYK1tbjHkdjOPU", "kid": "op2"}]}
2015-08-20 15:49:57,042 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "use": "enc", "y": "4Q5XI2VEXabPhLxOKOGkS9O2cPbKoraW7QQ2pXU3PbM", "x": "AyqbC9blrZVJbrfi9vidGhtDqgsV77lIYZ6NeikKIQI", "kid": "op3"}]}
2015-08-20 15:49:57,067 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:49:57,071 werkzeug:INFO  * Restarting with stat
2015-08-20 15:50:15,133 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "use": "enc", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "use": "sig", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-20 15:50:15,133 root:INFO OC3 server keys: {"keys": [{"x": "odGV8A18e6VHL_q_XRfpLTZOw0zv-DfnS8UNtb6fBy4", "y": "bcKoDkxjqTAS6FlMoz0g6adZ8l50TCrQyjOMK_BlVuI", "crv": "P-256", "kty": "EC", "kid": "op2", "use": "sig"}]}
2015-08-20 15:50:15,134 root:INFO OC3 server keys: {"keys": [{"x": "b4YrE93VBPVSW2i1BwTOLLjYogPYlFiK-gojF2gFaug", "y": "SUYIFHVDW7PjPhOLjkmSRHwt0IrhNulDzaBYzRH6y98", "crv": "P-256", "kty": "EC", "kid": "op3", "use": "enc"}]}
2015-08-20 15:51:00,068 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/pop_op/server.py', reloading
2015-08-20 15:51:00,162 werkzeug:INFO  * Restarting with stat
2015-08-20 15:51:07,263 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 15:51:07,264 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "y": "5UUM1bvh8F0lpRm2aIeI6ClP21dyWL0WzE8jCFDxVy0", "x": "3Vxv5RynojgsNU46nDxHREMUHlWZekN0iBXSJxpEplE", "use": "sig", "crv": "P-256"}]}
2015-08-20 15:51:07,264 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "y": "zWhn0cHzg6HTmTaW5AZxrmDkctmpX9tsNzDOyykenEQ", "x": "wddSNEPCwFu9SH-OB4xgspxyGqlGopp1VBO_-0T32jg", "use": "enc", "crv": "P-256"}]}
2015-08-20 15:51:07,288 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:51:07,292 werkzeug:INFO  * Restarting with stat
2015-08-20 15:51:12,251 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "kty": "RSA", "e": "AQAB", "kid": "op0"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "kty": "RSA", "e": "AQAB", "kid": "op1"}]}
2015-08-20 15:51:12,252 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "juVjVfYXACUkx4Ce6ozxETkMGb_fDEGDTVybDl7CK58", "y": "S_vtNaPrDOELoagsAVXGs9eYamDNkuX60BIKFnBi3rk", "use": "sig", "kty": "EC", "kid": "op2"}]}
2015-08-20 15:51:12,252 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "MXwivdF58B0NcPGOfYt7S8ZHC30jvMYs2vKQ0cmc4b0", "y": "QbY7x_NWpbr68TiYFqJKSlYmqtjUV9EGNIhkoOl8TmU", "use": "enc", "kty": "EC", "kid": "op3"}]}
2015-08-20 15:51:33,708 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/pop_op/server.py', reloading
2015-08-20 15:51:33,827 werkzeug:INFO  * Restarting with stat
2015-08-20 15:51:43,172 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 15:51:43,172 root:INFO OC3 server keys: {"keys": [{"use": "sig", "y": "RFmAzOT8l3SscRBlmW3ErZ-KVW77O3Wilcls6HYvcmI", "x": "WLbnhXXvYimSgHCpYW8Vy2apiBZ-ZhaSoXc-HMF4pNM", "crv": "P-256", "kty": "EC", "kid": "op2"}]}
2015-08-20 15:51:43,173 root:INFO OC3 server keys: {"keys": [{"use": "enc", "y": "fpe5hNUjBPj7O7TmmtuRKyzl8RyQM3-0kvEUb83HblE", "x": "dgMSoaloX6XZHOqA9B1Ox16vawrASD8brFciYxys0vQ", "crv": "P-256", "kty": "EC", "kid": "op3"}]}
2015-08-20 15:51:43,196 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:51:43,200 werkzeug:INFO  * Restarting with stat
2015-08-20 15:52:13,778 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 15:52:13,778 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "oJQGkU2IbBltSjsHi0fxuOfXhKaWzxiwZjScZEjwB98", "use": "sig", "kid": "op2", "crv": "P-256", "x": "kWuCBVeCe_MUllnjP95-HnuaiAq7VgOKmKpaRd4AITM"}]}
2015-08-20 15:52:13,779 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "9d0kTkcy7rOa65gSbGZjrBCgD_ZrxKjdkBUQhSyEtYg", "use": "enc", "kid": "op3", "crv": "P-256", "x": "Mam-lTLYn_WDPBiaZMugy0FPiEJquFXeEafG-2UXySw"}]}
2015-08-20 15:52:37,474 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:52:37] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 500 -
2015-08-20 15:53:58,737 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "e": "AQAB", "kty": "RSA", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "e": "AQAB", "kty": "RSA", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 15:53:58,737 root:INFO OC3 server keys: {"keys": [{"y": "EQic-TA0iDg6t_QwPxiSrSp-OjGDEFXd9Updif5jWeY", "use": "sig", "x": "Hs1TCAAe-g5xwjfoKmVSbZmXYGcP7sb-fTmUX8ENqss", "kty": "EC", "kid": "op2", "crv": "P-256"}]}
2015-08-20 15:53:58,738 root:INFO OC3 server keys: {"keys": [{"y": "bUKD5ZeekxBV6UIqktXlAEKne8nMy5CuaRAwDUJ_OoM", "use": "enc", "x": "EBSg8XPqHUGplojhZt0Pvxh8lqd2diiPEeUj66wSBNA", "kty": "EC", "kid": "op3", "crv": "P-256"}]}
2015-08-20 15:53:58,761 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:53:58,765 werkzeug:INFO  * Restarting with stat
2015-08-20 15:54:00,406 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1"}]}
2015-08-20 15:54:00,407 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "Vu-Uf-xzutPOGEOq6SMyJacdqTYS-5LwzM-3HKQ0AJA", "kty": "EC", "y": "-6TLChIDcl5i-FGRATmGvjDlJ1YG_8SWLgyohEGudiY", "crv": "P-256", "kid": "op2"}]}
2015-08-20 15:54:00,407 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "KiozhJd-QNmgm_aC2mmqIEHyjBc25FJnzCKv8NBHGEA", "kty": "EC", "y": "51fcqkOcuejXQAKQ_afjgzXdMEf3VkXVR0tDc3jw0tY", "crv": "P-256", "kid": "op3"}]}
2015-08-20 15:54:59,603 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 15:54:59,697 werkzeug:INFO  * Restarting with stat
2015-08-20 15:55:01,886 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"use": "sig", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 15:55:01,887 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "sig", "x": "ClOHwqaWA5O7R9a1IfUWhx2-SCmfdPRgKDUYmz1QbQE", "y": "k_twHoAVkB1Ob1irU5oay0zHx44wpVCnsalgBa1eU9Y", "kty": "EC", "kid": "op2"}]}
2015-08-20 15:55:01,888 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "enc", "x": "LEwfkbNA229_hTedNm86iVRGsNGH-U559CcjN_w7SLY", "y": "n4VsiVgodj3RZjFyHdiPsimqmQW4OZZ3jwR5rrjbKRg", "kty": "EC", "kid": "op3"}]}
2015-08-20 15:55:13,129 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "enc"}, {"kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "sig"}]}
2015-08-20 15:55:13,130 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op2", "kty": "EC", "x": "Ho_HcsjfrcN2Xs_pWryHz5cJ84zUEB_KAO7zKo2NFVk", "use": "sig", "y": "VQTG9nyDHmN0i8p17CNS_UJVCIbjYVUrBDaUbk4e6G0"}]}
2015-08-20 15:55:13,130 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op3", "kty": "EC", "x": "0Q82zdebGPIm4mY_mALTYbm2qRgJDv7ifGPpi0p8298", "use": "enc", "y": "8Op_-vsMGs0BWG9Sa6ia7K3aoXp4JVPI2x3I_82fuGk"}]}
2015-08-20 15:55:13,155 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:55:13,159 werkzeug:INFO  * Restarting with stat
2015-08-20 15:55:15,041 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "enc", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "use": "sig", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 15:55:15,041 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "y": "sNobS4pruvGW65ny_TOBtt1_J8IVgwsuuhDEnubBO1A", "use": "sig", "crv": "P-256", "kty": "EC", "x": "rTJ8AuIzvAbUmn8cOxVcEpUQJFrv9YADoZI7F9nrKWg"}]}
2015-08-20 15:55:15,042 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "y": "DhgMKVWPvNymrpgNN-0FXxbHFkqRPBiOK5wIoDCRXDY", "use": "enc", "crv": "P-256", "kty": "EC", "x": "YBaHmX1r9QVq3k3_ibb1LhndwQfTlcGmRZlOzr_pdFc"}]}
2015-08-20 15:55:33,992 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:55:33] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 15:55:34,008 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 15:55:34,008 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 15:55:34,009 oic.oic.provider:INFO provider_info_response: {'require_request_uri_registration': True, 'request_uri_parameter_supported': True, 'request_parameter_supported': True, 'claims_supported': ['profile', 'family_name', 'nickname', 'preferred_username', 'birthdate', 'updated_at', 'middle_name', 'zoneinfo', 'given_name', 'address', 'phone_number', 'sub', 'picture', 'phone_number_verified', 'name', 'locale', 'website', 'email', 'gender', 'email_verified'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'registration_endpoint': 'https://localhost:8092/registration', 'claims_parameter_supported': True, 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'version': '3.0', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'userinfo_signing_alg_values_supported': ['HS256', 'PS256', 'HS384', 'ES384', 'PS384', 'PS512', 'RS512', 'none', 'ES256', 'RS384', 'HS512', 'ES512', 'RS256'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'scopes_supported': ['profile', 'offline_access', 'phone', 'openid', 'email', 'address', 'openid'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'PS256', 'HS384', 'ES384', 'PS384', 'PS512', 'RS512', 'ES256', 'RS384', 'HS512', 'ES512', 'RS256'], 'subject_types_supported': ['public', 'pairwise'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['HS256', 'PS256', 'HS384', 'ES384', 'PS384', 'PS512', 'RS512', 'none', 'ES256', 'RS384', 'HS512', 'ES512', 'RS256'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8092/token', 'request_object_signing_alg_values_supported': ['HS256', 'PS256', 'HS384', 'ES384', 'PS384', 'PS512', 'RS512', 'none', 'ES256', 'RS384', 'HS512', 'ES512', 'RS256'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'authorization_endpoint': 'https://localhost:8092/authorization'}
2015-08-20 15:55:34,011 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:55:34] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 15:55:34,051 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:55:34] "POST /registration HTTP/1.1" 405 -
2015-08-20 15:56:07,335 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "use": "enc", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"kty": "RSA", "use": "sig", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-20 15:56:07,336 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "y": "-XiRdWRq3Qv8n80IOryhApb93rjd1BrwQVXzGurCAEU", "x": "2zbpcP0wITKxwFz0HFtqm_-zfJv-AcogbkfMNZPIAmo", "kid": "op2", "crv": "P-256"}]}
2015-08-20 15:56:07,336 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "y": "q9187xUelqbKlKFhM8l0Wq85ZrqxvTcWC5hCLS1fQ_E", "x": "On4vUT6OlT66bYvmU3zz6Uu8b65E7eVNIUMBos5g8BE", "kid": "op3", "crv": "P-256"}]}
2015-08-20 15:56:07,359 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:56:07,364 werkzeug:INFO  * Restarting with stat
2015-08-20 15:56:09,079 root:INFO OC3 server keys: {"keys": [{"use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 15:56:09,080 root:INFO OC3 server keys: {"keys": [{"use": "sig", "y": "mHbVJFPvQui_2mBKM_WRR4Pr99S0bgr-ck2S7iOe4HE", "kty": "EC", "kid": "op2", "x": "i8f_CWx-bK4p0CWwpXMVG_W4v5Fda4ZoAwSGmpYtfCE", "crv": "P-256"}]}
2015-08-20 15:56:09,080 root:INFO OC3 server keys: {"keys": [{"use": "enc", "y": "iOCBeKFx79D6E64wfIm6cP8w4GEMmKUA3bbpp2cTRYU", "kty": "EC", "kid": "op3", "x": "oI87qWn5yIM6WiSDnbgOg1VqZNZY8jgxOO_JE7Z-Opc", "crv": "P-256"}]}
2015-08-20 15:56:20,485 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:56:20] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 15:56:20,495 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 15:56:20,496 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 15:56:20,496 oic.oic.provider:INFO provider_info_response: {'require_request_uri_registration': True, 'subject_types_supported': ['public', 'pairwise'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'version': '3.0', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'claims_supported': ['preferred_username', 'address', 'gender', 'nickname', 'sub', 'given_name', 'family_name', 'picture', 'locale', 'website', 'profile', 'birthdate', 'updated_at', 'name', 'phone_number', 'phone_number_verified', 'email_verified', 'zoneinfo', 'email', 'middle_name'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_signing_alg_values_supported': ['PS512', 'none', 'RS384', 'HS256', 'RS512', 'HS384', 'ES384', 'HS512', 'PS384', 'ES256', 'PS256', 'RS256', 'ES512'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['address', 'openid', 'profile', 'phone', 'offline_access', 'email', 'openid'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'token_endpoint_auth_signing_alg_values_supported': ['PS512', 'RS384', 'HS256', 'RS512', 'HS384', 'ES384', 'HS512', 'PS384', 'ES256', 'PS256', 'RS256', 'ES512'], 'userinfo_signing_alg_values_supported': ['PS512', 'none', 'RS384', 'HS256', 'RS512', 'HS384', 'ES384', 'HS512', 'PS384', 'ES256', 'PS256', 'RS256', 'ES512'], 'request_object_signing_alg_values_supported': ['PS512', 'none', 'RS384', 'HS256', 'RS512', 'HS384', 'ES384', 'HS512', 'PS384', 'ES256', 'PS256', 'RS256', 'ES512'], 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'claims_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint': 'https://localhost:8092/token', 'acr_values_supported': ['PASSWORD']}
2015-08-20 15:56:20,498 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:56:20] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 15:56:20,528 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:56:20] "POST /registration HTTP/1.1" 405 -
2015-08-20 15:56:47,641 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "e": "AQAB", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "e": "AQAB", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 15:56:47,642 root:INFO OC3 server keys: {"keys": [{"x": "B8xEpGV8M8QbevwiwEfHTWGE36mYgxKDMYDP9u_qtnk", "use": "sig", "crv": "P-256", "kid": "op2", "y": "ztCQj0PzwDitqv_dkXkSo1hyPZXiFR5FfgoNchQW9I8", "kty": "EC"}]}
2015-08-20 15:56:47,642 root:INFO OC3 server keys: {"keys": [{"x": "1cPlSNRLgixHPog4zmFjZc5vNHGMFlRaSMUWuU5Ayak", "use": "enc", "crv": "P-256", "kid": "op3", "y": "O0yHg35DBayUjzQWW8c8opVeHsKzpqzNj-qDIS4tFRI", "kty": "EC"}]}
2015-08-20 15:56:47,666 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:56:47,672 werkzeug:INFO  * Restarting with stat
2015-08-20 15:56:49,420 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 15:56:49,421 root:INFO OC3 server keys: {"keys": [{"x": "9VnZ1dT1tIfC3T7UcKAgksa5xRNXyhf7lRYqqvUE9o8", "crv": "P-256", "kid": "op2", "kty": "EC", "y": "NXWZ_J3mahYikYDPg1jLyC2LHmPgXo6EWfmh3LbybhA", "use": "sig"}]}
2015-08-20 15:56:49,422 root:INFO OC3 server keys: {"keys": [{"x": "tF9e6H7dH7T2uxCNQn7L8-lXKWcbFS12vu6RAxO7Se4", "crv": "P-256", "kid": "op3", "kty": "EC", "y": "dAI-UU_VEVZmD-0kLRmDkSyDCd28I8EeJ5JKHDrCfuc", "use": "enc"}]}
2015-08-20 15:57:10,755 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:57:10] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 15:57:10,772 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 15:57:10,773 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 15:57:10,774 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['PS384', 'RS256', 'ES256', 'HS256', 'none', 'RS384', 'HS512', 'ES512', 'PS256', 'PS512', 'HS384', 'ES384', 'RS512'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'acr_values_supported': ['PASSWORD'], 'request_object_signing_alg_values_supported': ['PS384', 'RS256', 'ES256', 'HS256', 'none', 'RS384', 'HS512', 'ES512', 'PS256', 'PS512', 'HS384', 'ES384', 'RS512'], 'require_request_uri_registration': True, 'registration_endpoint': 'https://localhost:8092/registration', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'issuer': 'https://localhost:8092/', 'claims_supported': ['picture', 'sub', 'updated_at', 'phone_number', 'given_name', 'birthdate', 'middle_name', 'phone_number_verified', 'address', 'locale', 'nickname', 'preferred_username', 'email_verified', 'profile', 'website', 'name', 'email', 'family_name', 'gender', 'zoneinfo'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'scopes_supported': ['profile', 'email', 'offline_access', 'address', 'openid', 'phone', 'openid'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'version': '3.0', 'id_token_signing_alg_values_supported': ['PS384', 'RS256', 'ES256', 'HS256', 'none', 'RS384', 'HS512', 'ES512', 'PS256', 'PS512', 'HS384', 'ES384', 'RS512'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'token_endpoint': 'https://localhost:8092/token', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint_auth_signing_alg_values_supported': ['PS384', 'RS256', 'ES256', 'HS256', 'RS384', 'HS512', 'ES512', 'PS256', 'PS512', 'HS384', 'ES384', 'RS512']}
2015-08-20 15:57:10,775 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:57:10] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 15:57:26,475 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:57:26] "POST /registration HTTP/1.1" 405 -
2015-08-20 15:58:17,987 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "e": "AQAB"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "e": "AQAB"}]}
2015-08-20 15:58:17,987 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "x": "gHOmKGAi2frPgIXsZ61yKakJYbTo4TJYKDvhcZKbB7M", "crv": "P-256", "kid": "op2", "y": "FOszLcBouxNAYGdgYCoj1WSSS6hM4Km8xEwK39me9q8"}]}
2015-08-20 15:58:17,988 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "x": "ViULZ7WFQeJMgBjesDAYKv3_zMV2zAW1WGhzovRXYrU", "crv": "P-256", "kid": "op3", "y": "jUEr243TXogcwIzqQ7_bE8QhkFOjD4GzGPM75LiwJvw"}]}
2015-08-20 15:58:18,012 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:58:18,016 werkzeug:INFO  * Restarting with stat
2015-08-20 15:58:19,660 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0"}, {"use": "sig", "e": "AQAB", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1"}]}
2015-08-20 15:58:19,661 root:INFO OC3 server keys: {"keys": [{"use": "sig", "y": "6sxpmyHIAWOCfPM_AviDreb_aBHLSl_PSjXQiY1VWeY", "crv": "P-256", "kty": "EC", "x": "i1areeYoZkv_0Nel3dAqJTV996Eorok05cqs6jOVPKg", "kid": "op2"}]}
2015-08-20 15:58:19,662 root:INFO OC3 server keys: {"keys": [{"use": "enc", "y": "b8HJZua4DNMJAxbCcslud_RY_44OFLhTuZAeAlMrhTA", "crv": "P-256", "kty": "EC", "x": "7BF-QqqO8ybaKCa_kpjROe4lZBZlxRDnJWg_XStfcWA", "kid": "op3"}]}
2015-08-20 15:58:28,154 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:58:28] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 15:58:31,922 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 15:58:38,097 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 15:58:39,783 oic.oic.provider:INFO provider_info_response: {'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_uri_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'claims_supported': ['nickname', 'birthdate', 'zoneinfo', 'locale', 'given_name', 'name', 'website', 'sub', 'gender', 'middle_name', 'family_name', 'phone_number', 'profile', 'email', 'phone_number_verified', 'preferred_username', 'email_verified', 'address', 'picture', 'updated_at'], 'userinfo_signing_alg_values_supported': ['HS512', 'ES384', 'ES256', 'none', 'RS384', 'PS384', 'HS256', 'PS256', 'PS512', 'RS256', 'HS384', 'ES512', 'RS512'], 'token_endpoint': 'https://localhost:8092/token', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'issuer': 'https://localhost:8092/', 'scopes_supported': ['openid', 'profile', 'phone', 'offline_access', 'email', 'address', 'openid'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'token_endpoint_auth_signing_alg_values_supported': ['HS512', 'ES384', 'ES256', 'RS384', 'PS384', 'HS256', 'PS256', 'PS512', 'RS256', 'HS384', 'ES512', 'RS512'], 'id_token_signing_alg_values_supported': ['HS512', 'ES384', 'ES256', 'none', 'RS384', 'PS384', 'HS256', 'PS256', 'PS512', 'RS256', 'HS384', 'ES512', 'RS512'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_signing_alg_values_supported': ['HS512', 'ES384', 'ES256', 'none', 'RS384', 'PS384', 'HS256', 'PS256', 'PS512', 'RS256', 'HS384', 'ES512', 'RS512'], 'request_parameter_supported': True, 'end_session_endpoint': 'https://localhost:8092/end_session', 'acr_values_supported': ['PASSWORD'], 'userinfo_endpoint': 'https://localhost:8092/userinfo'}
2015-08-20 15:58:53,969 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:58:53] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 15:58:56,469 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:58:56] "POST /registration HTTP/1.1" 405 -
2015-08-20 15:59:42,337 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"use": "sig", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 15:59:42,337 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "4vZF8SCWzh-hPxb0PIIPHQnBwOrVTTGrf6NHw9tYaBU", "kty": "EC", "y": "f-w4IoWBcBZFeXzVkkkLSI_p2XswbE5ztMT6E87iDPU", "kid": "op2", "crv": "P-256"}]}
2015-08-20 15:59:42,338 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "Pzi8t-efy5s7Zw4S17QbhnM2oHlpmhkEFqQd0xPM5Hg", "kty": "EC", "y": "Nop5Adimh5AZKTrPY5De59IH4OIYd3CRO1QFPdUTUfg", "kid": "op3", "crv": "P-256"}]}
2015-08-20 15:59:42,363 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 15:59:42,368 werkzeug:INFO  * Restarting with stat
2015-08-20 15:59:44,433 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-20 15:59:44,433 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "fFVdBVOgzTXwbIPbql7YFG3KQj9xc55sGlaUqrXbuIo", "y": "dekZ2-fNVDzxNBYRUzWzimICv8hZbdZgd8-sOGCXOKk", "crv": "P-256", "kid": "op2", "kty": "EC"}]}
2015-08-20 15:59:44,434 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "XkxebJGo4o1HdnC7ZB2c2R7k5Io-QDDe_GOleS7j8IE", "y": "UfNVHumiV8aMQPtOhgD0J9Y280U2UEPv-p3A9Q4w-_0", "crv": "P-256", "kid": "op3", "kty": "EC"}]}
2015-08-20 15:59:50,580 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:59:50] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 15:59:51,829 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 15:59:51,830 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 15:59:51,831 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['ES384', 'ES256', 'PS256', 'RS384', 'RS512', 'RS256', 'ES512', 'PS512', 'PS384', 'none', 'HS256', 'HS512', 'HS384'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['ES384', 'ES256', 'PS256', 'RS384', 'RS512', 'RS256', 'ES512', 'PS512', 'PS384', 'HS256', 'HS512', 'HS384'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_parameter_supported': True, 'require_request_uri_registration': True, 'scopes_supported': ['email', 'address', 'profile', 'phone', 'openid', 'offline_access', 'openid'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_parameter_supported': True, 'request_object_signing_alg_values_supported': ['ES384', 'ES256', 'PS256', 'RS384', 'RS512', 'RS256', 'ES512', 'PS512', 'PS384', 'none', 'HS256', 'HS512', 'HS384'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'id_token_signing_alg_values_supported': ['ES384', 'ES256', 'PS256', 'RS384', 'RS512', 'RS256', 'ES512', 'PS512', 'PS384', 'none', 'HS256', 'HS512', 'HS384'], 'claims_supported': ['email_verified', 'preferred_username', 'address', 'sub', 'picture', 'given_name', 'name', 'family_name', 'middle_name', 'zoneinfo', 'website', 'locale', 'updated_at', 'email', 'birthdate', 'profile', 'phone_number', 'nickname', 'phone_number_verified', 'gender'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_uri_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'version': '3.0', 'registration_endpoint': 'https://localhost:8092/registration', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint': 'https://localhost:8092/token', 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt']}
2015-08-20 15:59:51,832 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 15:59:51] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:00:27,307 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:00:27,425 werkzeug:INFO  * Restarting with stat
2015-08-20 16:00:29,276 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "e": "AQAB", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "kty": "RSA", "e": "AQAB", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:00:29,277 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "crv": "P-256", "y": "XwUf0szzAuzU8jTpbrWdxM7zpbKe8FZwYhV5sNQxLf0", "use": "sig", "x": "PBWoY3XBJtd3oNmy6Qilf3EODNagKEc7SOZWsVk6HtI"}]}
2015-08-20 16:00:29,277 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "crv": "P-256", "y": "ttJpGAL2SGmkz0fRMJNmcvc3Sv5YpnueiWq5Kg9Z8-k", "use": "enc", "x": "-IIB4HRcX62i-vsq1gGaJgyJhgC9Jm2lW2PmIB_wO-o"}]}
2015-08-20 16:00:49,604 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:00:49,604 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "use": "sig", "x": "AveZHOB4KGF108-yUFbbWYJTf9Sz5ItPbdXeXFP6c4I", "crv": "P-256", "y": "xBQYrEGZsrtjkjloc78t6KkSm0ePfBj_aCNp1MYop0E", "kty": "EC"}]}
2015-08-20 16:00:49,605 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "use": "enc", "x": "LjgYmBfSt_G56ZFIO5m2N5VhwlKjIFOrOz57XB5N-5g", "crv": "P-256", "y": "u0yofVz7OP-20T8fTYA6cUQUfhvlN6M7apVcdtaFZCY", "kty": "EC"}]}
2015-08-20 16:00:49,629 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:00:49,634 werkzeug:INFO  * Restarting with stat
2015-08-20 16:00:51,286 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:00:51,287 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "x": "TUdEXzGC0uUbuQutXj_m4ddS2biKBSnRPRUH4K6gxB0", "use": "sig", "y": "yQaSRXKThOqQiyqMB8JEcFxGi41MXZpVu7t17WQ0CCw", "kid": "op2"}]}
2015-08-20 16:00:51,287 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "x": "KR24wKQ9fA0g7yYuyeUhJYwDaC9PyFPIXL7iXh7J3IA", "use": "enc", "y": "-jjj16nLyVBfJTyiYuqRidtHpkr-tjjmMxHmgp0cxh4", "kid": "op3"}]}
2015-08-20 16:01:09,478 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:01:09] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:01:11,525 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:01:11,526 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:01:11,527 oic.oic.provider:INFO provider_info_response: {'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'subject_types_supported': ['public', 'pairwise'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['email', 'profile', 'phone', 'address', 'offline_access', 'openid', 'openid'], 'claims_supported': ['locale', 'zoneinfo', 'gender', 'email', 'updated_at', 'profile', 'given_name', 'birthdate', 'website', 'sub', 'name', 'phone_number', 'preferred_username', 'phone_number_verified', 'middle_name', 'address', 'email_verified', 'nickname', 'picture', 'family_name'], 'issuer': 'https://localhost:8092/', 'token_endpoint_auth_signing_alg_values_supported': ['PS256', 'HS256', 'HS512', 'RS256', 'HS384', 'ES256', 'RS512', 'PS512', 'PS384', 'ES384', 'RS384', 'ES512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'registration_endpoint': 'https://localhost:8092/registration', 'version': '3.0', 'id_token_signing_alg_values_supported': ['PS256', 'HS256', 'HS512', 'RS256', 'HS384', 'none', 'ES256', 'RS512', 'PS512', 'PS384', 'ES384', 'RS384', 'ES512'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'userinfo_signing_alg_values_supported': ['PS256', 'HS256', 'HS512', 'RS256', 'HS384', 'none', 'ES256', 'RS512', 'PS512', 'PS384', 'ES384', 'RS384', 'ES512'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_signing_alg_values_supported': ['PS256', 'HS256', 'HS512', 'RS256', 'HS384', 'none', 'ES256', 'RS512', 'PS512', 'PS384', 'ES384', 'RS384', 'ES512'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'request_uri_parameter_supported': True, 'claims_parameter_supported': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'require_request_uri_registration': True, 'acr_values_supported': ['PASSWORD'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'token_endpoint': 'https://localhost:8092/token', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-20 16:01:11,528 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:01:11] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:01:27,352 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:01:27] "POST /registration HTTP/1.1" 405 -
2015-08-20 16:02:19,506 root:INFO OC3 server keys: {"keys": [{"use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op0"}, {"use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op1"}]}
2015-08-20 16:02:19,507 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "hJrJ_Hf78qupLATmjKMonDy3USitO7bLceN3IkXSqWg", "y": "usKDpSiNwUzJ0dVDWkb8XebTa1c8msZQI_iyy51941M", "kty": "EC", "crv": "P-256", "kid": "op2"}]}
2015-08-20 16:02:19,507 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "Us0PyJnFTHe5dGbhHCMjIOgDso149N7oAwbxtyS_-hI", "y": "R7_iHctolRZR9co1cgK8PBmvtg4kC9sxGVVnuZETK8Q", "kty": "EC", "crv": "P-256", "kid": "op3"}]}
2015-08-20 16:02:19,533 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:02:19,538 werkzeug:INFO  * Restarting with stat
2015-08-20 16:02:21,884 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "kid": "op0", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "kid": "op1", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 16:02:21,889 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kid": "op2", "x": "l4JMsKbfhWi5o_pEsGiDIgnkeY6t8NFMNrogcv5vfw", "kty": "EC", "crv": "P-256", "y": "QzBVabjozmv2NM-2GCdHI2W2o9b4hbqcgfX9uoN3EeU"}]}
2015-08-20 16:02:21,892 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op3", "x": "VYnTolSp0bjbIDAN9SyVb_DoLXAw_Z09PQww_YQ84xI", "kty": "EC", "crv": "P-256", "y": "pwFJ_jKVmU9KkuInJX-B3h5h3GEkl9XLlpoi5gLpp1Q"}]}
2015-08-20 16:02:30,905 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:02:30] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:02:31,781 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:02:31,782 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:02:31,783 oic.oic.provider:INFO provider_info_response: {'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'PS512', 'RS512', 'HS384', 'ES256', 'HS512', 'PS384', 'ES384', 'PS256', 'RS256', 'RS384', 'HS256'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'require_request_uri_registration': True, 'claims_parameter_supported': True, 'request_object_signing_alg_values_supported': ['ES512', 'PS512', 'RS512', 'none', 'HS384', 'ES256', 'HS512', 'PS384', 'ES384', 'PS256', 'RS256', 'RS384', 'HS256'], 'request_uri_parameter_supported': True, 'id_token_signing_alg_values_supported': ['ES512', 'PS512', 'RS512', 'none', 'HS384', 'ES256', 'HS512', 'PS384', 'ES384', 'PS256', 'RS256', 'RS384', 'HS256'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_parameter_supported': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'registration_endpoint': 'https://localhost:8092/registration', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'token_endpoint': 'https://localhost:8092/token', 'version': '3.0', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['middle_name', 'family_name', 'email', 'nickname', 'updated_at', 'email_verified', 'name', 'birthdate', 'preferred_username', 'phone_number', 'picture', 'website', 'profile', 'gender', 'phone_number_verified', 'given_name', 'address', 'zoneinfo', 'sub', 'locale'], 'issuer': 'https://localhost:8092/', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_signing_alg_values_supported': ['ES512', 'PS512', 'RS512', 'none', 'HS384', 'ES256', 'HS512', 'PS384', 'ES384', 'PS256', 'RS256', 'RS384', 'HS256'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'scopes_supported': ['email', 'profile', 'offline_access', 'phone', 'openid', 'address', 'openid']}
2015-08-20 16:02:31,789 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:02:31] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:03:53,425 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:03:53] "POST /registration HTTP/1.1" 405 -
2015-08-20 16:09:20,277 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "enc"}, {"kid": "op1", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "sig"}]}
2015-08-20 16:09:20,277 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "y": "vezL1eJOiIGb94M5-5xdUHgj3Dd2fda3t1V39GeFbXc", "use": "sig", "crv": "P-256", "x": "-YvEbnTYWJ5dtCUlwFwztecBPGr_U6JjTzH6bNewY78"}]}
2015-08-20 16:09:20,278 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "y": "LUiDgN6cnl6JmRGKrLcFRI1BZdncpiHSAPuxXFTWYMY", "use": "enc", "crv": "P-256", "x": "TzfF156bcWKs65BlargwppPZR2CBpnHUc4Wy68MbwWM"}]}
2015-08-20 16:09:20,302 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:09:20,306 werkzeug:INFO  * Restarting with stat
2015-08-20 16:09:22,090 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kid": "op0", "kty": "RSA", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "kid": "op1", "kty": "RSA", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 16:09:22,090 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "JRX4PhueSNgesWmtLWPiwAfFOFHl10qA1cuKBy9O8UA", "kid": "op2", "kty": "EC", "use": "sig", "y": "mu2qqbkpU3gYn4bCljdYK8QhVKMX4Q3eMYpEYFAeYdM"}]}
2015-08-20 16:09:22,091 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "wfQMvBA0VQH2YWW7yicPvVefeDjcmjWd8BBR_PCS9iQ", "kid": "op3", "kty": "EC", "use": "enc", "y": "LbR7GLP416pYfWlGBv7Rsl4P3mzkTH8xx7cdg1SDPvg"}]}
2015-08-20 16:09:34,230 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:09:34] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:09:34,907 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:09:34,908 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:09:34,910 oic.oic.provider:INFO provider_info_response: {'id_token_signing_alg_values_supported': ['PS512', 'HS384', 'ES384', 'PS256', 'RS512', 'HS512', 'HS256', 'RS384', 'RS256', 'ES256', 'none', 'ES512', 'PS384'], 'claims_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'subject_types_supported': ['public', 'pairwise'], 'request_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['PS512', 'HS384', 'ES384', 'PS256', 'RS512', 'HS512', 'HS256', 'RS384', 'RS256', 'ES256', 'ES512', 'PS384'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['offline_access', 'openid', 'address', 'profile', 'email', 'phone', 'openid'], 'version': '3.0', 'request_object_signing_alg_values_supported': ['PS512', 'HS384', 'ES384', 'PS256', 'RS512', 'HS512', 'HS256', 'RS384', 'RS256', 'ES256', 'none', 'ES512', 'PS384'], 'userinfo_signing_alg_values_supported': ['PS512', 'HS384', 'ES384', 'PS256', 'RS512', 'HS512', 'HS256', 'RS384', 'RS256', 'ES256', 'none', 'ES512', 'PS384'], 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'request_uri_parameter_supported': True, 'require_request_uri_registration': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'token_endpoint': 'https://localhost:8092/token', 'issuer': 'https://localhost:8092/', 'acr_values_supported': ['PASSWORD'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'authorization_endpoint': 'https://localhost:8092/authorization', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'claims_supported': ['gender', 'preferred_username', 'phone_number_verified', 'family_name', 'picture', 'email', 'given_name', 'birthdate', 'locale', 'email_verified', 'zoneinfo', 'sub', 'name', 'updated_at', 'website', 'address', 'profile', 'phone_number', 'nickname', 'middle_name']}
2015-08-20 16:09:34,911 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:09:34] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:10:05,151 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["https://localhost:8666/authz_cb"], "application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-20 16:10:06,544 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'application_type': 'web', 'response_types': ['code']}
2015-08-20 16:10:06,555 oic.oic.provider:DEBUG _cinfo: {'client_secret': '174c3b7aa4dd4aba0be978d7f0f71e117461c615ff5851cec06e170c', 'client_id_issued_at': 1440076206, 'client_id': 'SNzsISjdNLx9', 'client_secret_expires_at': 1440162606, 'registration_client_uri': 'https://localhost:8092/registration?client_id=SNzsISjdNLx9', 'registration_access_token': '6wgla2DdzGtNRF3NxzTIiha4d9u7d6jd'}
2015-08-20 16:10:06,557 oic.utils.keyio:DEBUG loading keys for issuer: SNzsISjdNLx9
2015-08-20 16:10:06,557 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'application_type': 'web', 'response_types': ['code']}
2015-08-20 16:10:06,558 oic.oic.provider:DEBUG keys for SNzsISjdNLx9: []
2015-08-20 16:10:06,560 oic.oic.provider:INFO Client info: {'client_secret': '174c3b7aa4dd4aba0be978d7f0f71e117461c615ff5851cec06e170c', 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_id_issued_at': 1440076206, 'client_id': 'SNzsISjdNLx9', 'client_secret_expires_at': 1440162606, 'registration_client_uri': 'https://localhost:8092/registration?client_id=SNzsISjdNLx9', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'registration_access_token': '6wgla2DdzGtNRF3NxzTIiha4d9u7d6jd', 'application_type': 'web'}
2015-08-20 16:10:06,561 oic.oic.provider:DEBUG registration_response: {'client_secret': '174c3b7aa4dd4aba0be978d7f0f71e117461c615ff5851cec06e170c', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'client_id_issued_at': 1440076206, 'client_id': 'SNzsISjdNLx9', 'client_secret_expires_at': 1440162606, 'registration_client_uri': 'https://localhost:8092/registration?client_id=SNzsISjdNLx9', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'registration_access_token': '6wgla2DdzGtNRF3NxzTIiha4d9u7d6jd', 'application_type': 'web'}
2015-08-20 16:10:06,562 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:10:06] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:10:10,107 oic.oauth2.provider:DEBUG Request: 'response_type=code&scope=openid+profile+email+address+phone&client_id=SNzsISjdNLx9&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=AZxxk1aHrubyIZFM&nonce=Xcord2f16HacdZoY'
2015-08-20 16:10:10,109 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105aa8a58>, <jwkest.jwk.RSAKey object at 0x1055280f0>, <jwkest.jwk.ECKey object at 0x105528550>]
2015-08-20 16:10:10,110 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'AZxxk1aHrubyIZFM', 'scope': 'openid profile email address phone', 'client_id': 'SNzsISjdNLx9', 'redirect_uri': 'https://localhost:8666/authz_cb', 'nonce': 'Xcord2f16HacdZoY', 'response_type': 'code'}
2015-08-20 16:10:10,112 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'AZxxk1aHrubyIZFM', 'scope': 'openid profile email address phone', 'client_id': 'SNzsISjdNLx9', 'redirect_uri': 'https://localhost:8666/authz_cb', 'nonce': 'Xcord2f16HacdZoY', 'response_type': 'code'}
2015-08-20 16:10:10,115 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:10:10,115 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:10:10,116 oic.utils.authn.user:INFO do_authentication argv: {'tos_uri': '', 'login': '', 'submit_text': 'Submit', 'title': 'User log in', 'query': 'response_type=code&scope=openid+profile+email+address+phone&client_id=SNzsISjdNLx9&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=AZxxk1aHrubyIZFM&nonce=Xcord2f16HacdZoY', 'login_title': 'Username', 'passwd_title': 'Password', 'action': 'https://localhost:8092/verify', 'logo_uri': '', 'acr': '', 'policy_uri': '', 'client_policy_title': 'Client Policy', 'password': ''}
2015-08-20 16:10:10,123 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:10:10] "GET /authorization?response_type=code&scope=openid+profile+email+address+phone&client_id=SNzsISjdNLx9&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=AZxxk1aHrubyIZFM&nonce=Xcord2f16HacdZoY HTTP/1.1" 200 -
2015-08-20 16:10:10,143 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:10:10] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:10:18,005 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:10:18] "POST /verify HTTP/1.1" 405 -
2015-08-20 16:10:38,745 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:10:38,861 werkzeug:INFO  * Restarting with stat
2015-08-20 16:10:40,673 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "kty": "RSA", "kid": "op0", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"e": "AQAB", "kty": "RSA", "kid": "op1", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 16:10:40,673 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "kid": "op2", "use": "sig", "y": "02U6rbNa-rd9w7b2jrAd2lO87arbX_0wGNZZ7X0MpFg", "crv": "P-256", "x": "tDhb9cM6E1PhvZ2u2doV1Gg5lvSWNQjG8NV9Xg2P8Yo"}]}
2015-08-20 16:10:40,674 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "kid": "op3", "use": "enc", "y": "FXuoGOquUAYZfJkWKvaIISUZBloZKGeVwQsvMth042c", "crv": "P-256", "x": "ToJMZB9e12IYQE9vp6DfQix27yIGLk0gpRG_Jp7gQuA"}]}
2015-08-20 16:10:44,810 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:10:44,890 werkzeug:INFO  * Restarting with stat
2015-08-20 16:10:46,519 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "kty": "RSA", "e": "AQAB"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "kty": "RSA", "e": "AQAB"}]}
2015-08-20 16:10:46,519 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "sig", "kid": "op2", "kty": "EC", "x": "WGZTU9zbTmFCGQ_x6SWR6dinkhdlzOMNpCkRVEHDEiU", "y": "JlCh88RKIkytkjMRMBSTDVGniQi7Y26EAHE6uygTJ1E"}]}
2015-08-20 16:10:46,520 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "enc", "kid": "op3", "kty": "EC", "x": "aamT2S9UG_5ZIMeVxEQEESGQTtFpZANK7MI_KqyltII", "y": "6kP-nzz3q7jqkWjw4twv61w9-IN_TAy80pheo-fp9KM"}]}
2015-08-20 16:12:54,494 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:12:54,582 werkzeug:INFO  * Restarting with stat
2015-08-20 16:12:56,222 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1"}]}
2015-08-20 16:12:56,223 root:INFO OC3 server keys: {"keys": [{"y": "3qLKsaZqbBF74bNWyrTZMJdyGl2jHYJ2zAp-B78IONA", "x": "Wkxhd1zKiLgilWI0hVRFEmHVhajgl0QA2PdZkt8F2Qs", "use": "sig", "crv": "P-256", "kty": "EC", "kid": "op2"}]}
2015-08-20 16:12:56,223 root:INFO OC3 server keys: {"keys": [{"y": "Q6nooSzXmbjbWJJkF3OUkKbjRf4o_uktRAIkPDFSShU", "x": "-KBxIHeij7A9OqnWZZypIHkD1NHal6cUBrVujHeJc3o", "use": "enc", "crv": "P-256", "kty": "EC", "kid": "op3"}]}
2015-08-20 16:12:59,698 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "e": "AQAB", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "e": "AQAB", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA"}]}
2015-08-20 16:12:59,699 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "ODZTABYk8CKHOn5wRwLMHmEetlU-Ga-P7RNqwY4jRDA", "crv": "P-256", "kid": "op2", "kty": "EC", "y": "1_WVzQvufJLhnst1WNPF9podX5kAb1ujQfFZXzSidvc"}]}
2015-08-20 16:12:59,699 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "rLrrQslwDRJMDm-0sURbxxmagf1Nh2iCGCin7K96O0U", "crv": "P-256", "kid": "op3", "kty": "EC", "y": "BBrI4mp-ykdkTwZMFZZ49setYA4S1EL72uqRyQ3xbSE"}]}
2015-08-20 16:12:59,730 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:12:59,734 werkzeug:INFO  * Restarting with stat
2015-08-20 16:13:01,450 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-20 16:13:01,451 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "eusD7xFj6pNdEQfLcchV5n1aLo2zpNbcSoD7p3J2l5k", "kty": "EC", "y": "mSCCmG5vJVEnzQVuE7o2IceSub4Cx6EL3h1wFhO9QP0", "use": "sig", "kid": "op2"}]}
2015-08-20 16:13:01,451 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "x": "_DFf_WXjFayghxp9UbUSjLCPbAiJ-TP0Zn8lxl6dDTo", "kty": "EC", "y": "ivzZHf_4m3p3mIoqcNdgEA9l31ug_ySwiQEozakqtug", "use": "enc", "kid": "op3"}]}
2015-08-20 16:13:28,034 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:13:28,132 werkzeug:INFO  * Restarting with stat
2015-08-20 16:13:30,042 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0"}, {"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1"}]}
2015-08-20 16:13:30,042 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "kty": "EC", "x": "GWmAeElK7ubkxplrsyTPk3z-UrQ96ArIHKXWkA9rPgw", "kid": "op2", "y": "okmlYtVvZ6amXKvIz88ULoOlmy0Qoh4kbg0E-TlJejc"}]}
2015-08-20 16:13:30,043 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "kty": "EC", "x": "dLNA0vmvvqVO-3vI0YMFFzDP6Ufj_lYabVX4CrpkWms", "kid": "op3", "y": "OUd8PcRp7Fl-GLXuvIPQHzpFSNCsRxD6ebAvJMzSlGc"}]}
2015-08-20 16:13:32,453 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA"}, {"e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA"}]}
2015-08-20 16:13:32,454 root:INFO OC3 server keys: {"keys": [{"y": "PPxYxpJHe5GeayDyNTlsdjW3wKnbzqgaptXCUTipRcY", "crv": "P-256", "kid": "op2", "use": "sig", "x": "7_V1D_6ZIJwLiDBOR1K1LlOokDsxRQC-JNGsJ8RFe7A", "kty": "EC"}]}
2015-08-20 16:13:32,454 root:INFO OC3 server keys: {"keys": [{"y": "VxujTzsf9R2dwpKLwUOBr5M0QLGadIvOS1M8Eijf29M", "crv": "P-256", "kid": "op3", "use": "enc", "x": "OaDp21BLpn_aj1CHqOfEwCkBC-GbzHaD7Qam44FxuRo", "kty": "EC"}]}
2015-08-20 16:13:32,505 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:13:32,510 werkzeug:INFO  * Restarting with stat
2015-08-20 16:13:34,845 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "kid": "op0"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "kid": "op1"}]}
2015-08-20 16:13:34,846 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "crv": "P-256", "y": "G_R54NOR0TJkch3X-4W-DHGCJa22mNe03BTBY40A36A", "x": "JYAiQmCfNMn1LIbiB4sngeWH0XbW3aEkJWi89yFtfHs", "kid": "op2"}]}
2015-08-20 16:13:34,846 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "crv": "P-256", "y": "JBE4feifK663aNm3PW5tBVsxWcBorp6nBvPLpuxlHFE", "x": "E_ldtTWHJ2BUJ6-Th7IgijbEar-BfpHpGc_Iwc3-KB4", "kid": "op3"}]}
2015-08-20 16:13:45,490 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:13:45] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:13:46,901 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:13:46,901 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:13:46,903 oic.oic.provider:INFO provider_info_response: {'id_token_signing_alg_values_supported': ['HS384', 'ES256', 'PS384', 'PS512', 'HS256', 'none', 'RS256', 'RS512', 'ES384', 'ES512', 'RS384', 'HS512', 'PS256'], 'claims_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'claims_supported': ['middle_name', 'website', 'family_name', 'name', 'address', 'phone_number_verified', 'locale', 'email_verified', 'gender', 'given_name', 'profile', 'email', 'updated_at', 'birthdate', 'nickname', 'phone_number', 'preferred_username', 'picture', 'zoneinfo', 'sub'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_parameter_supported': True, 'acr_values_supported': ['PASSWORD'], 'version': '3.0', 'request_uri_parameter_supported': True, 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'scopes_supported': ['profile', 'email', 'address', 'openid', 'offline_access', 'phone', 'openid'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_signing_alg_values_supported': ['HS384', 'ES256', 'PS384', 'PS512', 'HS256', 'none', 'RS256', 'RS512', 'ES384', 'ES512', 'RS384', 'HS512', 'PS256'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'ES256', 'PS384', 'PS512', 'HS256', 'RS256', 'RS512', 'ES384', 'ES512', 'RS384', 'HS512', 'PS256'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_signing_alg_values_supported': ['HS384', 'ES256', 'PS384', 'PS512', 'HS256', 'none', 'RS256', 'RS512', 'ES384', 'ES512', 'RS384', 'HS512', 'PS256'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint': 'https://localhost:8092/token', 'require_request_uri_registration': True, 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'registration_endpoint': 'https://localhost:8092/registration', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'authorization_endpoint': 'https://localhost:8092/authorization'}
2015-08-20 16:13:46,904 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:13:46] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:13:49,675 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "response_types": ["code"], "redirect_uris": ["https://localhost:8666/authz_cb"], "application_type": "web"}>>
2015-08-20 16:13:50,627 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-20 16:13:50,634 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'cCuQoMhEI3I4yZtK6ZKM8Qhlyc7whVbR', 'client_secret_expires_at': 1440162830, 'client_id': 'ohnuHDDwPH55', 'client_id_issued_at': 1440076430, 'client_secret': 'eb087b7295ad738cf1af4fb6b349a16869dd966059c41c234b3ad824', 'registration_client_uri': 'https://localhost:8092/registration?client_id=ohnuHDDwPH55'}
2015-08-20 16:13:50,636 oic.utils.keyio:DEBUG loading keys for issuer: ohnuHDDwPH55
2015-08-20 16:13:50,636 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code']}
2015-08-20 16:13:50,636 oic.oic.provider:DEBUG keys for ohnuHDDwPH55: []
2015-08-20 16:13:50,639 oic.oic.provider:INFO Client info: {'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'registration_access_token': 'cCuQoMhEI3I4yZtK6ZKM8Qhlyc7whVbR', 'client_secret_expires_at': 1440162830, 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_id': 'ohnuHDDwPH55', 'client_id_issued_at': 1440076430, 'client_secret': 'eb087b7295ad738cf1af4fb6b349a16869dd966059c41c234b3ad824', 'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=ohnuHDDwPH55'}
2015-08-20 16:13:50,639 oic.oic.provider:DEBUG registration_response: {'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_secret_expires_at': 1440162830, 'client_secret': 'eb087b7295ad738cf1af4fb6b349a16869dd966059c41c234b3ad824', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'client_id': 'ohnuHDDwPH55', 'registration_access_token': 'cCuQoMhEI3I4yZtK6ZKM8Qhlyc7whVbR', 'contacts': ['ops@example.com'], 'client_id_issued_at': 1440076430, 'application_type': 'web', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=ohnuHDDwPH55'}
2015-08-20 16:13:50,640 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:13:50] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:13:54,126 oic.oauth2.provider:DEBUG Request: 'nonce=X1mQwvqD9pL3z7zp&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=3n93920NIFIgNLyI&scope=openid+profile+email+address+phone&client_id=ohnuHDDwPH55&response_type=code'
2015-08-20 16:13:54,127 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105ab4160>, <jwkest.jwk.RSAKey object at 0x105528278>, <jwkest.jwk.ECKey object at 0x105528668>]
2015-08-20 16:13:54,128 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'X1mQwvqD9pL3z7zp', 'scope': 'openid profile email address phone', 'state': '3n93920NIFIgNLyI', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'ohnuHDDwPH55'}
2015-08-20 16:13:54,129 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'X1mQwvqD9pL3z7zp', 'scope': 'openid profile email address phone', 'state': '3n93920NIFIgNLyI', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'ohnuHDDwPH55'}
2015-08-20 16:13:54,131 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:13:54,132 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:13:54,132 oic.utils.authn.user:INFO do_authentication argv: {'login': '', 'passwd_title': 'Password', 'client_policy_title': 'Client Policy', 'tos_uri': '', 'submit_text': 'Submit', 'title': 'User log in', 'query': 'nonce=X1mQwvqD9pL3z7zp&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=3n93920NIFIgNLyI&scope=openid+profile+email+address+phone&client_id=ohnuHDDwPH55&response_type=code', 'action': 'https://localhost:8092/verify', 'login_title': 'Username', 'acr': '', 'logo_uri': '', 'password': '', 'policy_uri': ''}
2015-08-20 16:13:54,138 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:13:54] "GET /authorization?nonce=X1mQwvqD9pL3z7zp&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=3n93920NIFIgNLyI&scope=openid+profile+email+address+phone&client_id=ohnuHDDwPH55&response_type=code HTTP/1.1" 200 -
2015-08-20 16:13:54,152 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:13:54] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:14:00,840 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "POST /verify HTTP/1.1" 500 -
2015-08-20 16:14:00,867 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "GET /verify?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
2015-08-20 16:14:00,872 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "GET /verify?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1" 200 -
2015-08-20 16:14:00,880 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "GET /verify?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
2015-08-20 16:14:00,913 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "GET /verify?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1" 200 -
2015-08-20 16:14:00,928 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "GET /verify?__debugger__=yes&cmd=resource&f=source.png HTTP/1.1" 200 -
2015-08-20 16:14:00,933 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "GET /verify?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
2015-08-20 16:14:00,949 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:14:00] "GET /verify?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
2015-08-20 16:15:19,976 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:15:20,117 werkzeug:INFO  * Restarting with stat
2015-08-20 16:15:22,126 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0"}, {"kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1"}]}
2015-08-20 16:15:22,127 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "crv": "P-256", "x": "yOyoL0l7B9C8hPPvTI5r56qMJlq3IvTtCHFOS6m4aU8", "y": "NemPahA5S0eHUVu_zR_ddZGG5Axp5hZH06ct2m4TAo8", "kid": "op2"}]}
2015-08-20 16:15:22,127 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "crv": "P-256", "x": "Pdmtaie6SpzZCOw0C3Y2RGGh_EYkMs0msXTQPrARZyI", "y": "TEF_a7DZ9w3eGflofSdPZ3S6nT5Zd-UNyIR9lBzGTy8", "kid": "op3"}]}
2015-08-20 16:15:30,459 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "e": "AQAB", "use": "enc", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kty": "RSA", "e": "AQAB", "use": "sig", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:15:30,460 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "use": "sig", "kid": "op2", "x": "ozIVPT2qHXFxu4m9eaGb1S-xbVUNpGMG7iXizAXnOoo", "y": "dVDRX7vJEXGeVLSB0oASLlQ1_wNB3yNQ1fC1reQWENU"}]}
2015-08-20 16:15:30,461 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "use": "enc", "kid": "op3", "x": "ehaQOkQLzSFC45hVovzXw9dKpvUr3r-hS_py2ZvBf6U", "y": "f2QlyJcKO3Lg2zMZfrYdHDhqPUO1_qbTJurPwqdYBXk"}]}
2015-08-20 16:15:30,495 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:15:30,503 werkzeug:INFO  * Restarting with stat
2015-08-20 16:15:32,629 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"use": "sig", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-20 16:15:32,630 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "x": "D-pnj-Q8GjrnH78VUBj2f_9ZtshZCfoAL6PI3ROTq6o", "crv": "P-256", "kid": "op2", "y": "TO7fcUdLezIj25C65UncYpOW-CE1ZMWEzxtYakveKPs"}]}
2015-08-20 16:15:32,631 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "x": "Lts-NMzhPVh0haVvNkOg6r4pUrOPCiSFec9mCEyQRw8", "crv": "P-256", "kid": "op3", "y": "HXzuQnSnV3S89pR5WTmsuX5quDX-1nQwqptLXBzYjYQ"}]}
2015-08-20 16:15:44,939 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:15:44] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:15:45,571 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:15:45,572 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:15:45,573 oic.oic.provider:INFO provider_info_response: {'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'version': '3.0', 'end_session_endpoint': 'https://localhost:8092/end_session', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_signing_alg_values_supported': ['none', 'HS384', 'RS256', 'ES512', 'PS512', 'HS256', 'RS384', 'HS512', 'ES384', 'PS384', 'RS512', 'ES256', 'PS256'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_signing_alg_values_supported': ['none', 'HS384', 'RS256', 'ES512', 'PS512', 'HS256', 'RS384', 'HS512', 'ES384', 'PS384', 'RS512', 'ES256', 'PS256'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access', 'address', 'phone', 'openid'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint': 'https://localhost:8092/token', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'userinfo_signing_alg_values_supported': ['none', 'HS384', 'RS256', 'ES512', 'PS512', 'HS256', 'RS384', 'HS512', 'ES384', 'PS384', 'RS512', 'ES256', 'PS256'], 'subject_types_supported': ['public', 'pairwise'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_parameter_supported': True, 'claims_supported': ['email_verified', 'phone_number', 'phone_number_verified', 'updated_at', 'profile', 'locale', 'address', 'given_name', 'sub', 'middle_name', 'gender', 'birthdate', 'email', 'preferred_username', 'name', 'family_name', 'nickname', 'picture', 'zoneinfo', 'website'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'RS256', 'ES512', 'PS512', 'HS256', 'RS384', 'HS512', 'ES384', 'PS384', 'RS512', 'ES256', 'PS256'], 'request_uri_parameter_supported': True, 'acr_values_supported': ['PASSWORD'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'require_request_uri_registration': True}
2015-08-20 16:15:45,575 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:15:45] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:15:47,894 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "response_types": ["code"], "application_type": "web", "redirect_uris": ["https://localhost:8666/authz_cb"]}>>
2015-08-20 16:15:48,589 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:15:48,596 oic.oic.provider:DEBUG _cinfo: {'client_secret_expires_at': 1440162948, 'registration_access_token': 'zci9dtC6o4yWjLPAUA656QWJTBhdsT9X', 'registration_client_uri': 'https://localhost:8092/registration?client_id=KM28noVNd0D0', 'client_secret': 'e46944da00f10d00f67c42851a00b42c775d8f3c86e58f81d50a6eed', 'client_id_issued_at': 1440076548, 'client_id': 'KM28noVNd0D0'}
2015-08-20 16:15:48,598 oic.utils.keyio:DEBUG loading keys for issuer: KM28noVNd0D0
2015-08-20 16:15:48,599 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:15:48,599 oic.oic.provider:DEBUG keys for KM28noVNd0D0: []
2015-08-20 16:15:48,601 oic.oic.provider:INFO Client info: {'application_type': 'web', 'client_secret_expires_at': 1440162948, 'registration_access_token': 'zci9dtC6o4yWjLPAUA656QWJTBhdsT9X', 'registration_client_uri': 'https://localhost:8092/registration?client_id=KM28noVNd0D0', 'response_types': ['code'], 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_secret': 'e46944da00f10d00f67c42851a00b42c775d8f3c86e58f81d50a6eed', 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1440076548, 'contacts': ['ops@example.com'], 'client_id': 'KM28noVNd0D0'}
2015-08-20 16:15:48,602 oic.oic.provider:DEBUG registration_response: {'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'client_secret_expires_at': 1440162948, 'registration_access_token': 'zci9dtC6o4yWjLPAUA656QWJTBhdsT9X', 'registration_client_uri': 'https://localhost:8092/registration?client_id=KM28noVNd0D0', 'response_types': ['code'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_secret': 'e46944da00f10d00f67c42851a00b42c775d8f3c86e58f81d50a6eed', 'client_id_issued_at': 1440076548, 'contacts': ['ops@example.com'], 'client_id': 'KM28noVNd0D0'}
2015-08-20 16:15:48,603 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:15:48] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:15:49,962 oic.oauth2.provider:DEBUG Request: 'nonce=Ras1IA2GlzQVIUGU&scope=openid+profile+email+address+phone&response_type=code&state=hweXGxC1Rvx0jR1z&client_id=KM28noVNd0D0&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-20 16:15:49,964 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105ab6080>, <jwkest.jwk.RSAKey object at 0x105528208>, <jwkest.jwk.ECKey object at 0x1055285c0>]
2015-08-20 16:15:49,964 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'hweXGxC1Rvx0jR1z', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'nonce': 'Ras1IA2GlzQVIUGU', 'scope': 'openid profile email address phone', 'client_id': 'KM28noVNd0D0'}
2015-08-20 16:15:49,967 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'hweXGxC1Rvx0jR1z', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'nonce': 'Ras1IA2GlzQVIUGU', 'scope': 'openid profile email address phone', 'client_id': 'KM28noVNd0D0'}
2015-08-20 16:15:49,969 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:15:49,970 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:15:49,970 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'policy_uri': '', 'password': '', 'client_policy_title': 'Client Policy', 'action': 'https://localhost:8092/verify', 'login_title': 'Username', 'acr': '', 'logo_uri': '', 'query': 'nonce=Ras1IA2GlzQVIUGU&scope=openid+profile+email+address+phone&response_type=code&state=hweXGxC1Rvx0jR1z&client_id=KM28noVNd0D0&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'login': '', 'tos_uri': '', 'title': 'User log in', 'passwd_title': 'Password'}
2015-08-20 16:15:49,975 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:15:49] "GET /authorization?nonce=Ras1IA2GlzQVIUGU&scope=openid+profile+email+address+phone&response_type=code&state=hweXGxC1Rvx0jR1z&client_id=KM28noVNd0D0&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 200 -
2015-08-20 16:15:49,995 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:15:49] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:15:55,400 oic.utils.authn.user:DEBUG verify(query=nonce%3DRas1IA2GlzQVIUGU%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26state%3DhweXGxC1Rvx0jR1z%26client_id%3DKM28noVNd0D0%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:15:55,400 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'query': ['nonce=Ras1IA2GlzQVIUGU&scope=openid+profile+email+address+phone&response_type=code&state=hweXGxC1Rvx0jR1z&client_id=KM28noVNd0D0&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-20 16:15:55,401 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-20 16:15:55,404 oic.utils.authn.user:DEBUG kwargs: {'upm_answer': 'true', 'state': ['hweXGxC1Rvx0jR1z'], 'response_type': ['code'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'nonce': ['Ras1IA2GlzQVIUGU'], 'scope': ['openid profile email address phone'], 'client_id': ['KM28noVNd0D0']}
2015-08-20 16:15:55,407 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:15:55] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:16:00,988 oic.oauth2.provider:DEBUG Request: 'upm_answer=true&state=hweXGxC1Rvx0jR1z&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Ras1IA2GlzQVIUGU&scope=openid+profile+email+address+phone&client_id=KM28noVNd0D0'
2015-08-20 16:16:00,989 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105ab6080>, <jwkest.jwk.RSAKey object at 0x105528208>, <jwkest.jwk.ECKey object at 0x1055285c0>]
2015-08-20 16:16:00,990 oic.oauth2.provider:DEBUG AuthzRequest: {'upm_answer': 'true', 'state': 'hweXGxC1Rvx0jR1z', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'nonce': 'Ras1IA2GlzQVIUGU', 'scope': 'openid profile email address phone', 'client_id': 'KM28noVNd0D0'}
2015-08-20 16:16:00,992 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'upm_answer': 'true', 'state': 'hweXGxC1Rvx0jR1z', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'nonce': 'Ras1IA2GlzQVIUGU', 'scope': 'openid profile email address phone', 'client_id': 'KM28noVNd0D0'}
2015-08-20 16:16:00,995 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:16:00,997 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:16:00,997 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:16:00,998 oic.oic.provider:DEBUG AREQ keys: ['upm_answer', 'state', 'response_type', 'redirect_uri', 'nonce', 'scope', 'client_id']
2015-08-20 16:16:00,999 oic.utils.sdb:DEBUG uid2sid: {'diana': ['0b850c9b67bc8502f5d60f3c851cf744ca9afaf0f2014744550935ae']}
2015-08-20 16:16:01,000 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:16:01,000 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:16:01,003 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=hweXGxC1Rvx0jR1z&code=sZ9ceVMgqb35m7QzpQfEDnaHiGRCYXEExW9jXuKjak0cqouijgfs3lYBsqA3ETEpAty0YaeSU5xAusXCsXm3ZoY3RyuGWtjjSPH1NWvj3KQ%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:16:01,006 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:16:01] "GET /authorization?upm_answer=true&state=hweXGxC1Rvx0jR1z&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=Ras1IA2GlzQVIUGU&scope=openid+profile+email+address+phone&client_id=KM28noVNd0D0 HTTP/1.1" 302 -
2015-08-20 16:16:01,037 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:16:01] "POST /token HTTP/1.1" 405 -
2015-08-20 16:17:23,752 oic.oic.provider:DEBUG - token -
2015-08-20 16:17:23,752 oic.oic.provider:INFO token_request: 
2015-08-20 16:17:23,753 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code'}
2015-08-20 16:17:23,753 oic.oic.provider:ERROR Failed to verify client due to: Missing client authentication.
2015-08-20 16:17:23,754 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:17:23] "GET /token HTTP/1.1" 401 -
2015-08-20 16:17:33,645 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}]}
2015-08-20 16:17:33,645 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "y": "RT_PYIXJUSiJ9VyI3stK-ShtvcgL-kbyLwKzt-Z2B3g", "use": "sig", "kty": "EC", "x": "BxfYRqDY0gPJPpkNGhTTpGkwek87wLgtjRCmjRfg6MM", "crv": "P-256"}]}
2015-08-20 16:17:33,646 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "y": "iW1zuc_mmKTCSg-hzq5EcBYl2vp-lH6P6v0wkdVjVjs", "use": "enc", "kty": "EC", "x": "JO0c2H3aQRLPW98YwC9HuSgDPLXuTM1f0kRtXft236M", "crv": "P-256"}]}
2015-08-20 16:17:33,670 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:17:33,676 werkzeug:INFO  * Restarting with stat
2015-08-20 16:17:35,689 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op0", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"use": "sig", "kid": "op1", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:17:35,689 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kid": "op2", "crv": "P-256", "y": "JSavQT3RS10zTdegGqfS1mTW6ALiHsqBgIur56NYKVw", "x": "Wj84tHI7XVTATby52-bJd16d6E78A26Wf_1_GNybrDI", "kty": "EC"}]}
2015-08-20 16:17:35,690 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op3", "crv": "P-256", "y": "1dw0yzeUZzSiG-Vy0E6e2xl1udgxTR4zl8mm67DsiAM", "x": "XKZ7Y9mxHO_EGJQTdzeGo7fBTFaIhlJrQ_6ux7Pp_BY", "kty": "EC"}]}
2015-08-20 16:18:13,052 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:13] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:18:13,369 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:18:13,370 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:18:13,371 oic.oic.provider:INFO provider_info_response: {'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_signing_alg_values_supported': ['ES256', 'RS512', 'ES384', 'HS512', 'HS384', 'none', 'RS256', 'HS256', 'RS384', 'PS384', 'ES512', 'PS256', 'PS512'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_signing_alg_values_supported': ['ES256', 'RS512', 'ES384', 'HS512', 'HS384', 'none', 'RS256', 'HS256', 'RS384', 'PS384', 'ES512', 'PS256', 'PS512'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'require_request_uri_registration': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'issuer': 'https://localhost:8092/', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'request_parameter_supported': True, 'claims_supported': ['family_name', 'middle_name', 'phone_number', 'phone_number_verified', 'locale', 'nickname', 'picture', 'updated_at', 'website', 'preferred_username', 'sub', 'gender', 'zoneinfo', 'email_verified', 'address', 'profile', 'email', 'name', 'birthdate', 'given_name'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'id_token_signing_alg_values_supported': ['ES256', 'RS512', 'ES384', 'HS512', 'HS384', 'none', 'RS256', 'HS256', 'RS384', 'PS384', 'ES512', 'PS256', 'PS512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'token_endpoint': 'https://localhost:8092/token', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['profile', 'openid', 'phone', 'offline_access', 'email', 'address', 'openid'], 'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint_auth_signing_alg_values_supported': ['ES256', 'RS512', 'ES384', 'HS512', 'HS384', 'RS256', 'HS256', 'RS384', 'PS384', 'ES512', 'PS256', 'PS512'], 'claims_parameter_supported': True, 'acr_values_supported': ['PASSWORD'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'end_session_endpoint': 'https://localhost:8092/end_session'}
2015-08-20 16:18:13,372 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:13] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:18:14,229 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "application_type": "web", "contacts": ["ops@example.com"], "response_types": ["code"], "redirect_uris": ["https://localhost:8666/authz_cb"]}>>
2015-08-20 16:18:14,500 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:18:14,507 oic.oic.provider:DEBUG _cinfo: {'registration_client_uri': 'https://localhost:8092/registration?client_id=uNlN9AcVz30B', 'client_id_issued_at': 1440076694, 'client_id': 'uNlN9AcVz30B', 'registration_access_token': 'wKBY2Srg1tZIg1bQNRDSjGhdP0OBFkyM', 'client_secret': 'bba0c94222aedd2f0ecfbf956f51168844b9ad054a5c20afad8f854e', 'client_secret_expires_at': 1440163094}
2015-08-20 16:18:14,509 oic.utils.keyio:DEBUG loading keys for issuer: uNlN9AcVz30B
2015-08-20 16:18:14,510 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'contacts': ['ops@example.com'], 'response_types': ['code'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:18:14,511 oic.oic.provider:DEBUG keys for uNlN9AcVz30B: []
2015-08-20 16:18:14,514 oic.oic.provider:INFO Client info: {'registration_client_uri': 'https://localhost:8092/registration?client_id=uNlN9AcVz30B', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_id_issued_at': 1440076694, 'response_types': ['code'], 'client_id': 'uNlN9AcVz30B', 'registration_access_token': 'wKBY2Srg1tZIg1bQNRDSjGhdP0OBFkyM', 'application_type': 'web', 'contacts': ['ops@example.com'], 'client_secret': 'bba0c94222aedd2f0ecfbf956f51168844b9ad054a5c20afad8f854e', 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'client_secret_expires_at': 1440163094}
2015-08-20 16:18:14,515 oic.oic.provider:DEBUG registration_response: {'registration_client_uri': 'https://localhost:8092/registration?client_id=uNlN9AcVz30B', 'client_id_issued_at': 1440076694, 'response_types': ['code'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'client_id': 'uNlN9AcVz30B', 'application_type': 'web', 'contacts': ['ops@example.com'], 'registration_access_token': 'wKBY2Srg1tZIg1bQNRDSjGhdP0OBFkyM', 'client_secret': 'bba0c94222aedd2f0ecfbf956f51168844b9ad054a5c20afad8f854e', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_secret_expires_at': 1440163094}
2015-08-20 16:18:14,516 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:14] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:18:17,654 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&response_type=code&nonce=l5C3cXOvouqAW3hY&state=WQ18hBBXqfLqrEDM&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=uNlN9AcVz30B'
2015-08-20 16:18:17,656 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105aa8a90>, <jwkest.jwk.RSAKey object at 0x105528208>, <jwkest.jwk.ECKey object at 0x1055285f8>]
2015-08-20 16:18:17,656 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'state': 'WQ18hBBXqfLqrEDM', 'client_id': 'uNlN9AcVz30B', 'scope': 'openid profile email address phone', 'nonce': 'l5C3cXOvouqAW3hY', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:18:17,658 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'state': 'WQ18hBBXqfLqrEDM', 'client_id': 'uNlN9AcVz30B', 'scope': 'openid profile email address phone', 'nonce': 'l5C3cXOvouqAW3hY', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:18:17,666 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:18:17,667 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:18:17,667 oic.utils.authn.user:INFO do_authentication argv: {'acr': '', 'login_title': 'Username', 'policy_uri': '', 'tos_uri': '', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'password': '', 'logo_uri': '', 'submit_text': 'Submit', 'query': 'scope=openid+profile+email+address+phone&response_type=code&nonce=l5C3cXOvouqAW3hY&state=WQ18hBBXqfLqrEDM&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=uNlN9AcVz30B', 'login': '', 'action': 'https://localhost:8092/verify', 'title': 'User log in'}
2015-08-20 16:18:17,673 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:17] "GET /authorization?scope=openid+profile+email+address+phone&response_type=code&nonce=l5C3cXOvouqAW3hY&state=WQ18hBBXqfLqrEDM&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=uNlN9AcVz30B HTTP/1.1" 200 -
2015-08-20 16:18:17,700 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:17] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:18:22,765 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26nonce%3Dl5C3cXOvouqAW3hY%26state%3DWQ18hBBXqfLqrEDM%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26client_id%3DuNlN9AcVz30B&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:18:22,766 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'query': ['scope=openid+profile+email+address+phone&response_type=code&nonce=l5C3cXOvouqAW3hY&state=WQ18hBBXqfLqrEDM&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=uNlN9AcVz30B'], 'login': ['diana'], 'password': ['krall']}
2015-08-20 16:18:22,766 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-20 16:18:22,768 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'state': ['WQ18hBBXqfLqrEDM'], 'client_id': ['uNlN9AcVz30B'], 'scope': ['openid profile email address phone'], 'nonce': ['l5C3cXOvouqAW3hY'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'upm_answer': 'true'}
2015-08-20 16:18:22,771 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:22] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:18:25,630 oic.oauth2.provider:DEBUG Request: 'response_type=code&state=WQ18hBBXqfLqrEDM&client_id=uNlN9AcVz30B&scope=openid+profile+email+address+phone&nonce=l5C3cXOvouqAW3hY&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true'
2015-08-20 16:18:25,631 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105aa8a90>, <jwkest.jwk.RSAKey object at 0x105528208>, <jwkest.jwk.ECKey object at 0x1055285f8>]
2015-08-20 16:18:25,632 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'state': 'WQ18hBBXqfLqrEDM', 'client_id': 'uNlN9AcVz30B', 'scope': 'openid profile email address phone', 'nonce': 'l5C3cXOvouqAW3hY', 'redirect_uri': 'https://localhost:8666/authz_cb', 'upm_answer': 'true'}
2015-08-20 16:18:25,633 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'state': 'WQ18hBBXqfLqrEDM', 'client_id': 'uNlN9AcVz30B', 'scope': 'openid profile email address phone', 'nonce': 'l5C3cXOvouqAW3hY', 'redirect_uri': 'https://localhost:8666/authz_cb', 'upm_answer': 'true'}
2015-08-20 16:18:25,635 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:18:25,636 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:18:25,637 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:18:25,637 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'state', 'client_id', 'scope', 'nonce', 'redirect_uri', 'upm_answer']
2015-08-20 16:18:25,638 oic.utils.sdb:DEBUG uid2sid: {'diana': ['d4fcfe8c6769422f5bd77cd7b7f459abec2c8bebd5c0ecfd7abd31a2']}
2015-08-20 16:18:25,638 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:18:25,639 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:18:25,641 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=WQ18hBBXqfLqrEDM&code=tnpPkac6FxML61GuRlKkSwvplHSyUutvbJ8Xa0Snu9Ft5T4%2BxJdZIHWiSrTVOQusuEHQ9eLEy3yGymSaH6QSkLRnTHRS1yrC3iwGI5yFVBk%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:18:25,646 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:25] "GET /authorization?response_type=code&state=WQ18hBBXqfLqrEDM&client_id=uNlN9AcVz30B&scope=openid+profile+email+address+phone&nonce=l5C3cXOvouqAW3hY&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true HTTP/1.1" 302 -
2015-08-20 16:18:25,670 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:18:25] "POST /token HTTP/1.1" 405 -
2015-08-20 16:19:05,485 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig"}]}
2015-08-20 16:19:05,485 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "y": "JDSTboAI-T6kYLtKAqm9nE5Pt4-4fRWY7IqwWxiNI6s", "kid": "op2", "use": "sig", "x": "zL3IWuV_WBL_-Uwev2qYK_g40QqDNAKNEhl7O-24ZTY"}]}
2015-08-20 16:19:05,486 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "y": "N62F_4w93QpmKoGiCvpj9nWptdPLI-kiFgHbcfuSbhE", "kid": "op3", "use": "enc", "x": "lJ3kQkJB58M0vrKIDlmZRnZeP-5souGAKswVnTsa6Pg"}]}
2015-08-20 16:19:05,509 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:19:05,513 werkzeug:INFO  * Restarting with stat
2015-08-20 16:19:07,491 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-20 16:19:07,492 root:INFO OC3 server keys: {"keys": [{"y": "Za5jzjvIavfg-SWP-jLstStM6ePjp1sCuKZRrfJsk7w", "x": "1MkR2OV-5ugSERsM8G4bwAMk5uRXkJTp8HQHTXD1WEE", "use": "sig", "kid": "op2", "crv": "P-256", "kty": "EC"}]}
2015-08-20 16:19:07,492 root:INFO OC3 server keys: {"keys": [{"y": "IuiXXA6tZUZoU9zgDIGG9_j2E3bdmDicX_WDc4kTN_A", "x": "Au8mrVhTKKXODuUlJu8XRMH7XAnjwUY1msmrmn7AISY", "use": "enc", "kid": "op3", "crv": "P-256", "kty": "EC"}]}
2015-08-20 16:19:18,481 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:19:18] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:19:18,869 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:19:18,870 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:19:18,871 oic.oic.provider:INFO provider_info_response: {'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'require_request_uri_registration': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_signing_alg_values_supported': ['HS256', 'ES384', 'none', 'ES512', 'HS384', 'HS512', 'RS256', 'RS384', 'PS384', 'RS512', 'PS256', 'ES256', 'PS512'], 'claims_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'issuer': 'https://localhost:8092/', 'acr_values_supported': ['PASSWORD'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'registration_endpoint': 'https://localhost:8092/registration', 'end_session_endpoint': 'https://localhost:8092/end_session', 'token_endpoint': 'https://localhost:8092/token', 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'request_parameter_supported': True, 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'ES384', 'ES512', 'HS384', 'HS512', 'RS256', 'RS384', 'PS384', 'RS512', 'PS256', 'ES256', 'PS512'], 'request_object_signing_alg_values_supported': ['HS256', 'ES384', 'none', 'ES512', 'HS384', 'HS512', 'RS256', 'RS384', 'PS384', 'RS512', 'PS256', 'ES256', 'PS512'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'version': '3.0', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_supported': ['picture', 'locale', 'sub', 'updated_at', 'address', 'phone_number', 'preferred_username', 'website', 'email_verified', 'nickname', 'zoneinfo', 'profile', 'gender', 'birthdate', 'email', 'phone_number_verified', 'middle_name', 'family_name', 'name', 'given_name'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'subject_types_supported': ['public', 'pairwise'], 'scopes_supported': ['profile', 'email', 'openid', 'address', 'offline_access', 'phone', 'openid'], 'userinfo_signing_alg_values_supported': ['HS256', 'ES384', 'none', 'ES512', 'HS384', 'HS512', 'RS256', 'RS384', 'PS384', 'RS512', 'PS256', 'ES256', 'PS512'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'authorization_endpoint': 'https://localhost:8092/authorization'}
2015-08-20 16:19:18,872 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:19:18] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:19:20,112 oic.oic.provider:DEBUG @registration_endpoint: <<{"redirect_uris": ["https://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "application_type": "web", "response_types": ["code"]}>>
2015-08-20 16:19:20,580 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/authz_cb'], 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'contacts': ['ops@example.com']}
2015-08-20 16:19:20,588 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'e1dab0d5dd4aee295885a276b2a7b6ea1921688bcffcb6d733a7711c', 'registration_client_uri': 'https://localhost:8092/registration?client_id=40xzdsWkhE21', 'client_id': '40xzdsWkhE21', 'registration_access_token': 'Siuj7WqBSjuUBIZ0JFGwOwR9qKjhrQZf', 'client_secret_expires_at': 1440163160, 'client_id_issued_at': 1440076760}
2015-08-20 16:19:20,590 oic.utils.keyio:DEBUG loading keys for issuer: 40xzdsWkhE21
2015-08-20 16:19:20,591 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/authz_cb'], 'application_type': 'web', 'response_types': ['code'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'contacts': ['ops@example.com']}
2015-08-20 16:19:20,591 oic.oic.provider:DEBUG keys for 40xzdsWkhE21: []
2015-08-20 16:19:20,593 oic.oic.provider:INFO Client info: {'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'application_type': 'web', 'response_types': ['code'], 'client_secret': 'e1dab0d5dd4aee295885a276b2a7b6ea1921688bcffcb6d733a7711c', 'registration_client_uri': 'https://localhost:8092/registration?client_id=40xzdsWkhE21', 'client_id': '40xzdsWkhE21', 'registration_access_token': 'Siuj7WqBSjuUBIZ0JFGwOwR9qKjhrQZf', 'client_secret_expires_at': 1440163160, 'client_id_issued_at': 1440076760, 'contacts': ['ops@example.com']}
2015-08-20 16:19:20,594 oic.oic.provider:DEBUG registration_response: {'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'application_type': 'web', 'response_types': ['code'], 'client_secret': 'e1dab0d5dd4aee295885a276b2a7b6ea1921688bcffcb6d733a7711c', 'registration_client_uri': 'https://localhost:8092/registration?client_id=40xzdsWkhE21', 'client_id': '40xzdsWkhE21', 'registration_access_token': 'Siuj7WqBSjuUBIZ0JFGwOwR9qKjhrQZf', 'client_secret_expires_at': 1440163160, 'client_id_issued_at': 1440076760, 'contacts': ['ops@example.com']}
2015-08-20 16:19:20,596 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:19:20] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:19:21,354 oic.oauth2.provider:DEBUG Request: 'state=jHF0rpNdNIeH0shv&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&nonce=qDqF7ORIyMOqhLja&client_id=40xzdsWkhE21'
2015-08-20 16:19:21,357 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105aa8ba8>, <jwkest.jwk.RSAKey object at 0x105527240>, <jwkest.jwk.ECKey object at 0x1055275f8>]
2015-08-20 16:19:21,358 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'jHF0rpNdNIeH0shv', 'client_id': '40xzdsWkhE21', 'nonce': 'qDqF7ORIyMOqhLja', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:19:21,360 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'scope': 'openid profile email address phone', 'state': 'jHF0rpNdNIeH0shv', 'client_id': '40xzdsWkhE21', 'nonce': 'qDqF7ORIyMOqhLja', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:19:21,362 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:19:21,363 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:19:21,363 oic.utils.authn.user:INFO do_authentication argv: {'logo_uri': '', 'query': 'state=jHF0rpNdNIeH0shv&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&nonce=qDqF7ORIyMOqhLja&client_id=40xzdsWkhE21', 'tos_uri': '', 'action': 'https://localhost:8092/verify', 'policy_uri': '', 'acr': '', 'title': 'User log in', 'login': '', 'client_policy_title': 'Client Policy', 'login_title': 'Username', 'submit_text': 'Submit', 'password': '', 'passwd_title': 'Password'}
2015-08-20 16:19:21,368 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:19:21] "GET /authorization?state=jHF0rpNdNIeH0shv&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&nonce=qDqF7ORIyMOqhLja&client_id=40xzdsWkhE21 HTTP/1.1" 200 -
2015-08-20 16:19:21,387 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:19:21] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:19:27,975 oic.utils.authn.user:DEBUG verify(query=state%3DjHF0rpNdNIeH0shv%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26nonce%3DqDqF7ORIyMOqhLja%26client_id%3D40xzdsWkhE21&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:19:27,975 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'query': ['state=jHF0rpNdNIeH0shv&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&nonce=qDqF7ORIyMOqhLja&client_id=40xzdsWkhE21'], 'login': ['diana'], 'password': ['krall']}
2015-08-20 16:19:27,976 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'babs': 'howes', 'diana': 'krall'}
2015-08-20 16:19:27,978 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true', 'state': ['jHF0rpNdNIeH0shv'], 'client_id': ['40xzdsWkhE21'], 'nonce': ['qDqF7ORIyMOqhLja'], 'redirect_uri': ['https://localhost:8666/authz_cb']}
2015-08-20 16:19:27,982 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:19:27] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:19:31,164 oic.oauth2.provider:DEBUG Request: 'response_type=code&scope=openid+profile+email+address+phone&upm_answer=true&state=jHF0rpNdNIeH0shv&client_id=40xzdsWkhE21&nonce=qDqF7ORIyMOqhLja&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-20 16:19:31,165 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105aa8ba8>, <jwkest.jwk.RSAKey object at 0x105527240>, <jwkest.jwk.ECKey object at 0x1055275f8>]
2015-08-20 16:19:31,165 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'state': 'jHF0rpNdNIeH0shv', 'client_id': '40xzdsWkhE21', 'nonce': 'qDqF7ORIyMOqhLja', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:19:31,167 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'state': 'jHF0rpNdNIeH0shv', 'client_id': '40xzdsWkhE21', 'nonce': 'qDqF7ORIyMOqhLja', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:19:31,169 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:19:31,170 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:19:31,170 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:19:31,171 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'scope', 'upm_answer', 'state', 'client_id', 'nonce', 'redirect_uri']
2015-08-20 16:19:31,172 oic.utils.sdb:DEBUG uid2sid: {'diana': ['a2fec1b12a5e2f6b44672ae959fc82b265dc355accfbac42d7284e73']}
2015-08-20 16:19:31,172 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:19:31,172 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:19:31,175 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=jHF0rpNdNIeH0shv&code=gl6Z6zygMt3fpqzSwTvx1PuLhyiU3tTIPfmKEQ8FYI%2FaxCTPo3wcNC6aHTqbBGAzrtyk4OvQ5JaL9dQjgFr51YexBBxnc9aYUMcU5AqJGjk%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:19:31,178 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:19:31] "GET /authorization?response_type=code&scope=openid+profile+email+address+phone&upm_answer=true&state=jHF0rpNdNIeH0shv&client_id=40xzdsWkhE21&nonce=qDqF7ORIyMOqhLja&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 302 -
2015-08-20 16:20:52,583 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:20:52,696 werkzeug:INFO  * Restarting with stat
2015-08-20 16:20:54,751 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}, {"kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}]}
2015-08-20 16:20:54,752 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "y": "QNu-HVkp6n2zPTbNA7UFMrQxZNYdslhVSDLakNIskW8", "crv": "P-256", "kid": "op2", "x": "8oRh77Sf-sA8E1BAWHi9klAyRQjZBJXSsnVKF8WSnOg"}]}
2015-08-20 16:20:54,752 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "y": "mH32QP2rbGpAVggMzv2oZasfmkPVnuYgEM8TwATu1hI", "crv": "P-256", "kid": "op3", "x": "GlnJyzLVVm9WF2MuTn901hUn8-u6MkBU1C-sNhHCt5Q"}]}
2015-08-20 16:21:03,965 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:21:04,093 werkzeug:INFO  * Restarting with stat
2015-08-20 16:21:05,975 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:21:05,976 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "ybhmbON_TjG3xOYvsc3Lxc2IlX6CZRi_KEBFpO-WEXs", "crv": "P-256", "kid": "op2", "kty": "EC", "y": "jDECuXCdX8UUVT72GP0Wzdrmlz7EO5Bi8AhcaJs4Elw"}]}
2015-08-20 16:21:05,977 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "HMpkAxAkQddypq6UOyYPvtjAKcKrBBLN34NelbLThYw", "crv": "P-256", "kid": "op3", "kty": "EC", "y": "Q6sFKs8_J-Kdvp_3No2YWQvO4ILpWdZnMX2u8D7iY80"}]}
2015-08-20 16:21:09,168 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB"}]}
2015-08-20 16:21:09,168 root:INFO OC3 server keys: {"keys": [{"y": "jQU0jLASqvk8YPcEuLxKOVi5hwwCi0DCnDHL7v6gw4E", "use": "sig", "kty": "EC", "x": "_zT8TIjp2W79lGPYVsFKbhigDx9Cn4ZYxu82SKpJsX4", "kid": "op2", "crv": "P-256"}]}
2015-08-20 16:21:09,169 root:INFO OC3 server keys: {"keys": [{"y": "Ad4x07U9GR2YIL-g2N0i8hL864gsNApyEjNc6NfKM4U", "use": "enc", "kty": "EC", "x": "jyK5J1v8jWcYHUbZ3HVi8q3mwbBBUljbXFeH-fYabDw", "kid": "op3", "crv": "P-256"}]}
2015-08-20 16:21:09,191 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:21:09,196 werkzeug:INFO  * Restarting with stat
2015-08-20 16:21:11,598 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1"}]}
2015-08-20 16:21:11,599 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "euXZL_b0FOKQAB0bM9wbCOsePKZxqTB05AXFcM7u9ns", "kty": "EC", "crv": "P-256", "kid": "op2", "y": "SULgYKUrIPgStIOFKi5wI0g2kcW2vFj-Bdk-AxULdFY"}]}
2015-08-20 16:21:11,600 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "6Zoyfw3gdxqH3ypor-RS7A_8PmHG4TwvDThPTe3MV4Y", "kty": "EC", "crv": "P-256", "kid": "op3", "y": "mgpEEVgzoyPWA-2yiDxOPb-Lt0p1_PnPyOsq1Tcoivw"}]}
2015-08-20 16:21:18,222 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:18] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:21:18,829 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:21:18,830 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:21:18,831 oic.oic.provider:INFO provider_info_response: {'token_endpoint': 'https://localhost:8092/token', 'issuer': 'https://localhost:8092/', 'request_object_signing_alg_values_supported': ['ES384', 'PS256', 'ES256', 'PS384', 'ES512', 'PS512', 'RS384', 'RS512', 'HS384', 'HS256', 'RS256', 'none', 'HS512'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_signing_alg_values_supported': ['ES384', 'PS256', 'ES256', 'PS384', 'ES512', 'PS512', 'RS384', 'RS512', 'HS384', 'HS256', 'RS256', 'none', 'HS512'], 'request_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'registration_endpoint': 'https://localhost:8092/registration', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'subject_types_supported': ['public', 'pairwise'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'token_endpoint_auth_signing_alg_values_supported': ['ES384', 'PS256', 'ES256', 'PS384', 'ES512', 'PS512', 'RS384', 'RS512', 'HS384', 'HS256', 'RS256', 'HS512'], 'claims_parameter_supported': True, 'scopes_supported': ['phone', 'profile', 'openid', 'offline_access', 'email', 'address', 'openid'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['ES384', 'PS256', 'ES256', 'PS384', 'ES512', 'PS512', 'RS384', 'RS512', 'HS384', 'HS256', 'RS256', 'none', 'HS512'], 'require_request_uri_registration': True, 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'acr_values_supported': ['PASSWORD'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'claims_supported': ['address', 'birthdate', 'profile', 'sub', 'given_name', 'updated_at', 'family_name', 'name', 'email_verified', 'locale', 'picture', 'preferred_username', 'phone_number', 'phone_number_verified', 'middle_name', 'nickname', 'gender', 'zoneinfo', 'website', 'email'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'version': '3.0', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_uri_parameter_supported': True}
2015-08-20 16:21:18,832 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:18] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:21:20,699 oic.oic.provider:DEBUG @registration_endpoint: <<{"response_types": ["code"], "application_type": "web", "redirect_uris": ["https://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/logout_success"]}>>
2015-08-20 16:21:21,213 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:21:21,220 oic.oic.provider:DEBUG _cinfo: {'registration_client_uri': 'https://localhost:8092/registration?client_id=uQAntOX5jfgi', 'client_secret_expires_at': 1440163281, 'client_secret': 'dd7948a11a4c1f281bc0143e8a3d39f6b2a8ade89d38f2e9f8d2ec23', 'registration_access_token': 'TMeVKLoimrK7NK1wLLW7DdDwuGR9wm6C', 'client_id_issued_at': 1440076881, 'client_id': 'uQAntOX5jfgi'}
2015-08-20 16:21:21,222 oic.utils.keyio:DEBUG loading keys for issuer: uQAntOX5jfgi
2015-08-20 16:21:21,223 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:21:21,223 oic.oic.provider:DEBUG keys for uQAntOX5jfgi: []
2015-08-20 16:21:21,226 oic.oic.provider:INFO Client info: {'registration_client_uri': 'https://localhost:8092/registration?client_id=uQAntOX5jfgi', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_secret_expires_at': 1440163281, 'application_type': 'web', 'client_secret': 'dd7948a11a4c1f281bc0143e8a3d39f6b2a8ade89d38f2e9f8d2ec23', 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'registration_access_token': 'TMeVKLoimrK7NK1wLLW7DdDwuGR9wm6C', 'client_id_issued_at': 1440076881, 'response_types': ['code'], 'client_id': 'uQAntOX5jfgi', 'contacts': ['ops@example.com']}
2015-08-20 16:21:21,227 oic.oic.provider:DEBUG registration_response: {'registration_client_uri': 'https://localhost:8092/registration?client_id=uQAntOX5jfgi', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'client_secret_expires_at': 1440163281, 'application_type': 'web', 'client_secret': 'dd7948a11a4c1f281bc0143e8a3d39f6b2a8ade89d38f2e9f8d2ec23', 'contacts': ['ops@example.com'], 'registration_access_token': 'TMeVKLoimrK7NK1wLLW7DdDwuGR9wm6C', 'client_id_issued_at': 1440076881, 'response_types': ['code'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_id': 'uQAntOX5jfgi'}
2015-08-20 16:21:21,228 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:21] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:21:22,483 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&client_id=uQAntOX5jfgi&response_type=code&nonce=B5KPL45wnaG3GHLo&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RQExq8cI7SqsyUTp'
2015-08-20 16:21:22,485 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105ab5198>, <jwkest.jwk.RSAKey object at 0x105527240>, <jwkest.jwk.ECKey object at 0x105527630>]
2015-08-20 16:21:22,485 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'nonce': 'B5KPL45wnaG3GHLo', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'RQExq8cI7SqsyUTp', 'client_id': 'uQAntOX5jfgi', 'scope': 'openid profile email address phone'}
2015-08-20 16:21:22,488 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'nonce': 'B5KPL45wnaG3GHLo', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'RQExq8cI7SqsyUTp', 'client_id': 'uQAntOX5jfgi', 'scope': 'openid profile email address phone'}
2015-08-20 16:21:22,490 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:21:22,491 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:21:22,491 oic.utils.authn.user:INFO do_authentication argv: {'policy_uri': '', 'title': 'User log in', 'login_title': 'Username', 'query': 'scope=openid+profile+email+address+phone&client_id=uQAntOX5jfgi&response_type=code&nonce=B5KPL45wnaG3GHLo&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RQExq8cI7SqsyUTp', 'passwd_title': 'Password', 'client_policy_title': 'Client Policy', 'submit_text': 'Submit', 'tos_uri': '', 'action': 'https://localhost:8092/verify', 'login': '', 'logo_uri': '', 'password': '', 'acr': ''}
2015-08-20 16:21:22,496 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:22] "GET /authorization?scope=openid+profile+email+address+phone&client_id=uQAntOX5jfgi&response_type=code&nonce=B5KPL45wnaG3GHLo&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RQExq8cI7SqsyUTp HTTP/1.1" 200 -
2015-08-20 16:21:22,515 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:22] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:21:28,806 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DuQAntOX5jfgi%26response_type%3Dcode%26nonce%3DB5KPL45wnaG3GHLo%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26state%3DRQExq8cI7SqsyUTp&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:21:28,807 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'password': ['krall'], 'query': ['scope=openid+profile+email+address+phone&client_id=uQAntOX5jfgi&response_type=code&nonce=B5KPL45wnaG3GHLo&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RQExq8cI7SqsyUTp'], 'login': ['diana']}
2015-08-20 16:21:28,807 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-20 16:21:28,809 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'nonce': ['B5KPL45wnaG3GHLo'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'state': ['RQExq8cI7SqsyUTp'], 'client_id': ['uQAntOX5jfgi'], 'upm_answer': 'true', 'scope': ['openid profile email address phone']}
2015-08-20 16:21:28,812 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:28] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:21:32,110 oic.oauth2.provider:DEBUG Request: 'response_type=code&nonce=B5KPL45wnaG3GHLo&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RQExq8cI7SqsyUTp&client_id=uQAntOX5jfgi&upm_answer=true&scope=openid+profile+email+address+phone'
2015-08-20 16:21:32,111 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105ab5198>, <jwkest.jwk.RSAKey object at 0x105527240>, <jwkest.jwk.ECKey object at 0x105527630>]
2015-08-20 16:21:32,112 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'nonce': 'B5KPL45wnaG3GHLo', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'RQExq8cI7SqsyUTp', 'client_id': 'uQAntOX5jfgi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-20 16:21:32,113 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'nonce': 'B5KPL45wnaG3GHLo', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'RQExq8cI7SqsyUTp', 'client_id': 'uQAntOX5jfgi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-20 16:21:32,115 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:21:32,116 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:21:32,117 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:21:32,117 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'nonce', 'redirect_uri', 'state', 'client_id', 'upm_answer', 'scope']
2015-08-20 16:21:32,118 oic.utils.sdb:DEBUG uid2sid: {'diana': ['5b58b16d5796eb8fb4d2f5cedf8e1a24d03d6e984aea577949ebdc27']}
2015-08-20 16:21:32,118 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:21:32,119 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:21:32,122 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=RQExq8cI7SqsyUTp&code=wBPLZ0I5rVB%2B2WFeQs2lnDNiVzK%2BYSuYLtJ%2BJefQDbwI3%2BVbNIXS6VRM01vLgXK2oL8m7eoXfAEWCwf5mZMoblS2XRkevoA8Rv6xGzdvlho%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:21:32,124 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:32] "GET /authorization?response_type=code&nonce=B5KPL45wnaG3GHLo&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=RQExq8cI7SqsyUTp&client_id=uQAntOX5jfgi&upm_answer=true&scope=openid+profile+email+address+phone HTTP/1.1" 302 -
2015-08-20 16:21:37,499 oic.oic.provider:DEBUG - token -
2015-08-20 16:21:37,500 oic.oic.provider:INFO token_request: client_id=uQAntOX5jfgi&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInVzZSI6ICJzaWciLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ%3D%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&token_type=pop&grant_type=authorization_code&client_secret=dd7948a11a4c1f281bc0143e8a3d39f6b2a8ade89d38f2e9f8d2ec23&code=wBPLZ0I5rVB%2B2WFeQs2lnDNiVzK%2BYSuYLtJ%2BJefQDbwI3%2BVbNIXS6VRM01vLgXK2oL8m7eoXfAEWCwf5mZMoblS2XRkevoA8Rv6xGzdvlho%3D
2015-08-20 16:21:37,500 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'client_secret': 'dd7948a11a4c1f281bc0143e8a3d39f6b2a8ade89d38f2e9f8d2ec23', 'redirect_uri': 'https://localhost:8666/authz_cb', 'code': 'wBPLZ0I5rVB+2WFeQs2lnDNiVzK+YSuYLtJ+JefQDbwI3+VbNIXS6VRM01vLgXK2oL8m7eoXfAEWCwf5mZMoblS2XRkevoA8Rv6xGzdvlho=', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInVzZSI6ICJzaWciLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'client_id': 'uQAntOX5jfgi', 'token_type': 'pop'}
2015-08-20 16:21:37,501 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'client_secret': 'dd7948a11a4c1f281bc0143e8a3d39f6b2a8ade89d38f2e9f8d2ec23', 'redirect_uri': 'https://localhost:8666/authz_cb', 'code': 'wBPLZ0I5rVB+2WFeQs2lnDNiVzK+YSuYLtJ+JefQDbwI3+VbNIXS6VRM01vLgXK2oL8m7eoXfAEWCwf5mZMoblS2XRkevoA8Rv6xGzdvlho=', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInVzZSI6ICJzaWciLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia3R5IjogIlJTQSIsICJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ==', 'client_id': 'uQAntOX5jfgi', 'token_type': 'pop'}
2015-08-20 16:21:37,502 oic.utils.authn.client:DEBUG Verified Client ID: uQAntOX5jfgi
2015-08-20 16:21:37,506 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:21:39,297 oic.oic:DEBUG authzreq: {'response_type': 'code', 'nonce': 'B5KPL45wnaG3GHLo', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'RQExq8cI7SqsyUTp', 'client_id': 'uQAntOX5jfgi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-20 16:21:39,298 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:21:40,167 oic.oic:DEBUG authzreq: {'response_type': 'code', 'nonce': 'B5KPL45wnaG3GHLo', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'RQExq8cI7SqsyUTp', 'client_id': 'uQAntOX5jfgi', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-20 16:21:40,168 oic.oic.provider:DEBUG id_token: {'exp': 1440159700, 'iss': 'https://localhost:8092/', 'aud': ['uQAntOX5jfgi'], 'sub': '-4d448ee6e99b7ca2', 'nonce': 'B5KPL45wnaG3GHLo', 'iat': 1440080500, 'acr': 'PASSWORD', 'auth_time': 1440080488}
2015-08-20 16:21:40,171 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1"}]}
2015-08-20 16:21:40,171 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "x": "euXZL_b0FOKQAB0bM9wbCOsePKZxqTB05AXFcM7u9ns", "kty": "EC", "crv": "P-256", "kid": "op2", "y": "SULgYKUrIPgStIOFKi5wI0g2kcW2vFj-Bdk-AxULdFY"}]}
2015-08-20 16:21:40,172 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "x": "6Zoyfw3gdxqH3ypor-RS7A_8PmHG4TwvDThPTe3MV4Y", "kty": "EC", "crv": "P-256", "kid": "op3", "y": "mgpEEVgzoyPWA-2yiDxOPb-Lt0p1_PnPyOsq1Tcoivw"}]}
2015-08-20 16:21:40,172 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x105527240>]
2015-08-20 16:21:40,180 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:21:40,181 oic.oic.provider:DEBUG _tinfo: {'code_used': True, 'nonce': 'B5KPL45wnaG3GHLo', 'oauth_state': 'token', 'refresh_token': 'wBPLZ0I5rVB+2WFeQs2lnDNiVzK+YSuYLtJ+JefQDbwI3+VbNIXS6VRM01vLgXK2j697maFXrK6GiaYWI603U4MX69M+EBrfdxjbrCpiG1Q=', 'redirect_uri': 'https://localhost:8666/authz_cb', 'permission': '', 'token_expires_at': 1440080497, 'revoked': False, 'client_id': 'uQAntOX5jfgi', 'token_type': 'Bearer', 'expires_in': 3600, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105ad30f0>, 'access_token_scope': '?', 'authzreq': '{"response_type": "code", "nonce": "B5KPL45wnaG3GHLo", "redirect_uri": "https://localhost:8666/authz_cb", "state": "RQExq8cI7SqsyUTp", "client_id": "uQAntOX5jfgi", "upm_answer": "true", "scope": "openid profile email address phone"}', 'code': 'wBPLZ0I5rVB+2WFeQs2lnDNiVzK+YSuYLtJ+JefQDbwI3+VbNIXS6VRM01vLgXK2oL8m7eoXfAEWCwf5mZMoblS2XRkevoA8Rv6xGzdvlho=', 'state': 'RQExq8cI7SqsyUTp', 'sub': '-4d448ee6e99b7ca2', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJleHAiOiAxNDQwMTU5NzAwLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImF1ZCI6IFsidVFBbnRPWDVqZmdpIl0sICJzdWIiOiAiLTRkNDQ4ZWU2ZTk5YjdjYTIiLCAibm9uY2UiOiAiQjVLUEw0NXduYUczR0hMbyIsICJpYXQiOiAxNDQwMDgwNTAwLCAiYWNyIjogIlBBU1NXT1JEIiwgImF1dGhfdGltZSI6IDE0NDAwODA0ODh9.cYAMisNmObJwe2fODIrvyI-Q-oBXFHwCsy0mlAYjuojkRSqNGvi9I2BICM4LAu4QlFsEuj9h4iiUXNw5i4sa8QXAaLRTyFUYGOGfxiMh7vioMvOW2gZlMsEaSa5T7AAQF22ctUltURgsHYCq6658ShnKksZq42reGKUFgIlvDnHVmOLF1sRG6DunNC55fZC-2nraTzp7O8DSED4HA-ROfbSEET5F2krS0WIN0LytbaqtlvfmKPmBM1jhuO-nYuy2abX92VpeXSovMpkz0jaKAQLPD-VGe0n521mbNeOwA0za7V9gVf1ZdP2dp9jHjdxqPIj4GN8rcvivGDZeFvPUiA', 'access_token': 'wBPLZ0I5rVB+2WFeQs2lnDNiVzK+YSuYLtJ+JefQDbwI3+VbNIXS6VRM01vLgXK2PjF8CRmpeyqaGiNJuz3+nHG50gYeZO5B+eLUHSvac7U=', 'scope': ['openid', 'profile', 'email', 'address', 'phone']}
2015-08-20 16:21:40,181 oic.oic.provider:DEBUG access_token_response: {'scope': 'openid profile email address phone', 'token_type': 'Bearer', 'state': 'RQExq8cI7SqsyUTp', 'refresh_token': 'wBPLZ0I5rVB+2WFeQs2lnDNiVzK+YSuYLtJ+JefQDbwI3+VbNIXS6VRM01vLgXK2j697maFXrK6GiaYWI603U4MX69M+EBrfdxjbrCpiG1Q=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJleHAiOiAxNDQwMTU5NzAwLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgImF1ZCI6IFsidVFBbnRPWDVqZmdpIl0sICJzdWIiOiAiLTRkNDQ4ZWU2ZTk5YjdjYTIiLCAibm9uY2UiOiAiQjVLUEw0NXduYUczR0hMbyIsICJpYXQiOiAxNDQwMDgwNTAwLCAiYWNyIjogIlBBU1NXT1JEIiwgImF1dGhfdGltZSI6IDE0NDAwODA0ODh9.cYAMisNmObJwe2fODIrvyI-Q-oBXFHwCsy0mlAYjuojkRSqNGvi9I2BICM4LAu4QlFsEuj9h4iiUXNw5i4sa8QXAaLRTyFUYGOGfxiMh7vioMvOW2gZlMsEaSa5T7AAQF22ctUltURgsHYCq6658ShnKksZq42reGKUFgIlvDnHVmOLF1sRG6DunNC55fZC-2nraTzp7O8DSED4HA-ROfbSEET5F2krS0WIN0LytbaqtlvfmKPmBM1jhuO-nYuy2abX92VpeXSovMpkz0jaKAQLPD-VGe0n521mbNeOwA0za7V9gVf1ZdP2dp9jHjdxqPIj4GN8rcvivGDZeFvPUiA', 'access_token': 'wBPLZ0I5rVB+2WFeQs2lnDNiVzK+YSuYLtJ+JefQDbwI3+VbNIXS6VRM01vLgXK2PjF8CRmpeyqaGiNJuz3+nHG50gYeZO5B+eLUHSvac7U=', 'expires_in': 3600}
2015-08-20 16:21:41,104 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:21:41,105 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:41] "POST /token HTTP/1.1" 200 -
2015-08-20 16:21:43,170 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:43] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:21:44,716 oic.oic.provider:DEBUG - token -
2015-08-20 16:21:44,717 oic.oic.provider:INFO token_request: http_signature=eyJraWQiOiJhMCIsImFsZyI6IlJTMjU2In0.eyJ1IjogImxvY2FsaG9zdDo4MDkyIiwgInAiOiAiL3VzZXJpbmZvIiwgIm0iOiAiUE9TVCIsICJoIjogW1siQ29udGVudC1UeXBlIiwgIkF1dGhvcml6YXRpb24iXSwgIjNIRkVZZ0ZYdV9Oa2w2U2lSS1ZqcE9UQVhtalE1VUo3TlhyZng3WGJLb3M9Il19.IvFSaLfcAl3jGvKh6PJxZdE_lMZkEjgTYkFINOeIJwLBTfrrdQh1kU5EVEeHRn4QMx9sX5yXjAugbEIClBklOJ1c7CRNudkErc9H9UBxoJLWQDA_u2ExEbU2LRsblkwa7yfQydf9aW6qj0t-RleKxZL7d83B-GNixhjRVJB1P7U
2015-08-20 16:21:44,718 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'http_signature': 'eyJraWQiOiJhMCIsImFsZyI6IlJTMjU2In0.eyJ1IjogImxvY2FsaG9zdDo4MDkyIiwgInAiOiAiL3VzZXJpbmZvIiwgIm0iOiAiUE9TVCIsICJoIjogW1siQ29udGVudC1UeXBlIiwgIkF1dGhvcml6YXRpb24iXSwgIjNIRkVZZ0ZYdV9Oa2w2U2lSS1ZqcE9UQVhtalE1VUo3TlhyZng3WGJLb3M9Il19.IvFSaLfcAl3jGvKh6PJxZdE_lMZkEjgTYkFINOeIJwLBTfrrdQh1kU5EVEeHRn4QMx9sX5yXjAugbEIClBklOJ1c7CRNudkErc9H9UBxoJLWQDA_u2ExEbU2LRsblkwa7yfQydf9aW6qj0t-RleKxZL7d83B-GNixhjRVJB1P7U'}
2015-08-20 16:21:44,718 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'http_signature': 'eyJraWQiOiJhMCIsImFsZyI6IlJTMjU2In0.eyJ1IjogImxvY2FsaG9zdDo4MDkyIiwgInAiOiAiL3VzZXJpbmZvIiwgIm0iOiAiUE9TVCIsICJoIjogW1siQ29udGVudC1UeXBlIiwgIkF1dGhvcml6YXRpb24iXSwgIjNIRkVZZ0ZYdV9Oa2w2U2lSS1ZqcE9UQVhtalE1VUo3TlhyZng3WGJLb3M9Il19.IvFSaLfcAl3jGvKh6PJxZdE_lMZkEjgTYkFINOeIJwLBTfrrdQh1kU5EVEeHRn4QMx9sX5yXjAugbEIClBklOJ1c7CRNudkErc9H9UBxoJLWQDA_u2ExEbU2LRsblkwa7yfQydf9aW6qj0t-RleKxZL7d83B-GNixhjRVJB1P7U'}
2015-08-20 16:21:44,718 oic.oic.provider:ERROR Failed to verify client due to: AuthZ type I don't know
2015-08-20 16:21:44,719 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:21:44] "POST /userinfo HTTP/1.1" 401 -
2015-08-20 16:23:05,621 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:23:05,697 werkzeug:INFO  * Restarting with stat
2015-08-20 16:23:07,948 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op0"}, {"kty": "RSA", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kid": "op1"}]}
2015-08-20 16:23:07,949 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "crv": "P-256", "y": "CuYTLLlQDekQLi15iDAqAsNP9Po1ohtKIaJedq6DE-c", "kid": "op2", "x": "6qR9LvtEKOc7VZ48YiuiRXdHiPBNP_1aTV3noMFNOQU"}]}
2015-08-20 16:23:07,950 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "crv": "P-256", "y": "GrZ8v_53x8rQDXosH5nTCbxI0x9SN65ZWr1I7P3Bmrs", "kid": "op3", "x": "4z2XVSU5SgxxtiNCYa4BkkhRoHdQiYhV0x94lWDMC0A"}]}
2015-08-20 16:23:28,007 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-20 16:23:28,008 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op2", "use": "sig", "y": "38lvhmWbfXMHTkpxuPEmANrbxFLJaXsxqY-3LSMnaWg", "kty": "EC", "x": "M5uPTl-QI4Y0BQQTV9Qs2Fhdin2mUgThD75z-8hopqE"}]}
2015-08-20 16:23:28,008 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op3", "use": "enc", "y": "EWsooWOxxdgGYFUSwJSl3bG0NfqJyeRtRrAIA0QowTk", "kty": "EC", "x": "978X8eIe61C_vwtUNCJHTKMrAZRWIdtaqYNt0SGmNRU"}]}
2015-08-20 16:23:28,032 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:23:28,036 werkzeug:INFO  * Restarting with stat
2015-08-20 16:23:29,607 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "e": "AQAB", "kid": "op0"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "e": "AQAB", "kid": "op1"}]}
2015-08-20 16:23:29,607 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "y": "A1WLwtQU8CYH2R8pZ4jeBGFlPvVTX7AlTtmQeirResY", "use": "sig", "x": "W2kvVmx0Z1QT398jfmhYQOSjdzPQPTvWxmHDPpZ3Vag", "kid": "op2"}]}
2015-08-20 16:23:29,608 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "y": "IFO9RX5k84psuRf2MoBxtHEAQzh7wSFjGaeWjjmWQDQ", "use": "enc", "x": "inSy-B3X7BS6tcrqzY3VxBq2MG0_fh5tVMevU9OZqCQ", "kid": "op3"}]}
2015-08-20 16:23:42,786 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:23:42] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:23:43,438 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:23:43,439 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:23:43,440 oic.oic.provider:INFO provider_info_response: {'request_uri_parameter_supported': True, 'request_object_signing_alg_values_supported': ['ES256', 'ES512', 'PS384', 'HS256', 'HS384', 'ES384', 'PS512', 'RS512', 'RS256', 'none', 'HS512', 'PS256', 'RS384'], 'id_token_signing_alg_values_supported': ['ES256', 'ES512', 'PS384', 'HS256', 'HS384', 'ES384', 'PS512', 'RS512', 'RS256', 'none', 'HS512', 'PS256', 'RS384'], 'request_parameter_supported': True, 'claims_parameter_supported': True, 'acr_values_supported': ['PASSWORD'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'require_request_uri_registration': True, 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'claims_supported': ['phone_number_verified', 'address', 'family_name', 'name', 'gender', 'nickname', 'zoneinfo', 'middle_name', 'birthdate', 'preferred_username', 'updated_at', 'picture', 'email_verified', 'locale', 'email', 'given_name', 'sub', 'profile', 'phone_number', 'website'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'version': '3.0', 'token_endpoint_auth_signing_alg_values_supported': ['ES256', 'ES512', 'PS384', 'HS256', 'HS384', 'ES384', 'PS512', 'RS512', 'RS256', 'HS512', 'PS256', 'RS384'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'token_endpoint': 'https://localhost:8092/token', 'issuer': 'https://localhost:8092/', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'scopes_supported': ['openid', 'address', 'email', 'profile', 'phone', 'offline_access', 'openid'], 'userinfo_signing_alg_values_supported': ['ES256', 'ES512', 'PS384', 'HS256', 'HS384', 'ES384', 'PS512', 'RS512', 'RS256', 'none', 'HS512', 'PS256', 'RS384'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW']}
2015-08-20 16:23:43,441 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:23:43] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:23:46,411 oic.oic.provider:DEBUG @registration_endpoint: <<{"application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "contacts": ["ops@example.com"], "redirect_uris": ["https://localhost:8666/authz_cb"], "response_types": ["code"]}>>
2015-08-20 16:23:47,034 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-20 16:23:47,042 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'c13fa8a06be465dbe08bedd9f20eb8e4104536b6a5c5c6442d61ff55', 'client_id': 'BmUDFCBMqfRi', 'registration_access_token': 'av5tVOSm9mOW2aCVi6LJWQp14CeMglUD', 'client_secret_expires_at': 1440163427, 'registration_client_uri': 'https://localhost:8092/registration?client_id=BmUDFCBMqfRi', 'client_id_issued_at': 1440077027}
2015-08-20 16:23:47,043 oic.utils.keyio:DEBUG loading keys for issuer: BmUDFCBMqfRi
2015-08-20 16:23:47,044 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-20 16:23:47,044 oic.oic.provider:DEBUG keys for BmUDFCBMqfRi: []
2015-08-20 16:23:47,046 oic.oic.provider:INFO Client info: {'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'client_secret': 'c13fa8a06be465dbe08bedd9f20eb8e4104536b6a5c5c6442d61ff55', 'client_id': 'BmUDFCBMqfRi', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'contacts': ['ops@example.com'], 'application_type': 'web', 'registration_access_token': 'av5tVOSm9mOW2aCVi6LJWQp14CeMglUD', 'client_secret_expires_at': 1440163427, 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=BmUDFCBMqfRi', 'client_id_issued_at': 1440077027}
2015-08-20 16:23:47,047 oic.oic.provider:DEBUG registration_response: {'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_secret': 'c13fa8a06be465dbe08bedd9f20eb8e4104536b6a5c5c6442d61ff55', 'client_id': 'BmUDFCBMqfRi', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'response_types': ['code'], 'client_secret_expires_at': 1440163427, 'registration_client_uri': 'https://localhost:8092/registration?client_id=BmUDFCBMqfRi', 'client_id_issued_at': 1440077027, 'registration_access_token': 'av5tVOSm9mOW2aCVi6LJWQp14CeMglUD'}
2015-08-20 16:23:47,048 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:23:47] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:23:47,811 oic.oauth2.provider:DEBUG Request: 'nonce=lGz36NwJgi7p4LAO&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&client_id=BmUDFCBMqfRi&state=eUSgTT1dhrTPObAV'
2015-08-20 16:23:47,813 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105bb6128>, <jwkest.jwk.RSAKey object at 0x105628240>, <jwkest.jwk.ECKey object at 0x1056286a0>]
2015-08-20 16:23:47,813 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'BmUDFCBMqfRi', 'response_type': 'code', 'nonce': 'lGz36NwJgi7p4LAO', 'state': 'eUSgTT1dhrTPObAV', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:47,816 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'BmUDFCBMqfRi', 'response_type': 'code', 'nonce': 'lGz36NwJgi7p4LAO', 'state': 'eUSgTT1dhrTPObAV', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:47,818 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:23:47,819 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:23:47,819 oic.utils.authn.user:INFO do_authentication argv: {'query': 'nonce=lGz36NwJgi7p4LAO&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&client_id=BmUDFCBMqfRi&state=eUSgTT1dhrTPObAV', 'client_policy_title': 'Client Policy', 'logo_uri': '', 'login': '', 'submit_text': 'Submit', 'tos_uri': '', 'acr': '', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'passwd_title': 'Password', 'login_title': 'Username', 'title': 'User log in', 'password': ''}
2015-08-20 16:23:47,825 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:23:47] "GET /authorization?nonce=lGz36NwJgi7p4LAO&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&client_id=BmUDFCBMqfRi&state=eUSgTT1dhrTPObAV HTTP/1.1" 200 -
2015-08-20 16:23:47,839 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:23:47] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:23:54,231 oic.utils.authn.user:DEBUG verify(query=nonce%3DlGz36NwJgi7p4LAO%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DBmUDFCBMqfRi%26state%3DeUSgTT1dhrTPObAV&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:23:54,232 oic.utils.authn.user:DEBUG dict: {'query': ['nonce=lGz36NwJgi7p4LAO&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&client_id=BmUDFCBMqfRi&state=eUSgTT1dhrTPObAV'], 'password': ['krall'], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-20 16:23:54,232 oic.utils.authn.user:DEBUG passwd: {'upper': 'crust', 'diana': 'krall', 'babs': 'howes'}
2015-08-20 16:23:54,235 oic.utils.authn.user:DEBUG kwargs: {'client_id': ['BmUDFCBMqfRi'], 'response_type': ['code'], 'nonce': ['lGz36NwJgi7p4LAO'], 'upm_answer': 'true', 'state': ['eUSgTT1dhrTPObAV'], 'scope': ['openid profile email address phone'], 'redirect_uri': ['https://localhost:8666/authz_cb']}
2015-08-20 16:23:54,238 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:23:54] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:23:54,257 oic.oauth2.provider:DEBUG Request: 'client_id=BmUDFCBMqfRi&response_type=code&nonce=lGz36NwJgi7p4LAO&upm_answer=true&state=eUSgTT1dhrTPObAV&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-20 16:23:54,258 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105bb6128>, <jwkest.jwk.RSAKey object at 0x105628240>, <jwkest.jwk.ECKey object at 0x1056286a0>]
2015-08-20 16:23:54,259 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': 'BmUDFCBMqfRi', 'response_type': 'code', 'nonce': 'lGz36NwJgi7p4LAO', 'upm_answer': 'true', 'state': 'eUSgTT1dhrTPObAV', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:54,260 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': 'BmUDFCBMqfRi', 'response_type': 'code', 'nonce': 'lGz36NwJgi7p4LAO', 'upm_answer': 'true', 'state': 'eUSgTT1dhrTPObAV', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:54,262 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:23:54,263 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:23:54,264 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:23:54,264 oic.oic.provider:DEBUG AREQ keys: ['client_id', 'response_type', 'nonce', 'upm_answer', 'state', 'scope', 'redirect_uri']
2015-08-20 16:23:54,265 oic.utils.sdb:DEBUG uid2sid: {'diana': ['96c2809b8be4c3644c5f34849bae695a72f712bb4bd3dd83463270ec']}
2015-08-20 16:23:54,265 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:23:54,266 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:23:54,271 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?code=HKLDdoBNp8FG4CyA4fohTYg6j1%2BvtM5ypEGFT6J7DwuUE3yK%2BHDXMmOGHm5nVrHp99McxkfndAocDBB7HgKrPmyyqA%2F3wJhL%2BEWHTbkF%2F4c%3D&state=eUSgTT1dhrTPObAV&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:23:54,274 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:23:54] "GET /authorization?client_id=BmUDFCBMqfRi&response_type=code&nonce=lGz36NwJgi7p4LAO&upm_answer=true&state=eUSgTT1dhrTPObAV&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 302 -
2015-08-20 16:23:57,778 oic.oic.provider:DEBUG - token -
2015-08-20 16:23:57,779 oic.oic.provider:INFO token_request: redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&key=eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgInVzZSI6ICJzaWciLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIifQ%3D%3D&code=HKLDdoBNp8FG4CyA4fohTYg6j1%2BvtM5ypEGFT6J7DwuUE3yK%2BHDXMmOGHm5nVrHp99McxkfndAocDBB7HgKrPmyyqA%2F3wJhL%2BEWHTbkF%2F4c%3D&client_id=BmUDFCBMqfRi&client_secret=c13fa8a06be465dbe08bedd9f20eb8e4104536b6a5c5c6442d61ff55&grant_type=authorization_code&token_type=pop
2015-08-20 16:23:57,780 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'HKLDdoBNp8FG4CyA4fohTYg6j1+vtM5ypEGFT6J7DwuUE3yK+HDXMmOGHm5nVrHp99McxkfndAocDBB7HgKrPmyyqA/3wJhL+EWHTbkF/4c=', 'client_secret': 'c13fa8a06be465dbe08bedd9f20eb8e4104536b6a5c5c6442d61ff55', 'token_type': 'pop', 'client_id': 'BmUDFCBMqfRi', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgInVzZSI6ICJzaWciLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIifQ==', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:57,781 oic.utils.authn.client:DEBUG REQ: {'code': 'HKLDdoBNp8FG4CyA4fohTYg6j1+vtM5ypEGFT6J7DwuUE3yK+HDXMmOGHm5nVrHp99McxkfndAocDBB7HgKrPmyyqA/3wJhL+EWHTbkF/4c=', 'client_secret': 'c13fa8a06be465dbe08bedd9f20eb8e4104536b6a5c5c6442d61ff55', 'token_type': 'pop', 'client_id': 'BmUDFCBMqfRi', 'key': 'eyJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgInVzZSI6ICJzaWciLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIifQ==', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:57,783 oic.utils.authn.client:DEBUG Verified Client ID: BmUDFCBMqfRi
2015-08-20 16:23:57,790 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:23:58,713 oic.oic:DEBUG authzreq: {'client_id': 'BmUDFCBMqfRi', 'response_type': 'code', 'nonce': 'lGz36NwJgi7p4LAO', 'upm_answer': 'true', 'state': 'eUSgTT1dhrTPObAV', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:58,714 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:23:59,364 oic.oic:DEBUG authzreq: {'client_id': 'BmUDFCBMqfRi', 'response_type': 'code', 'nonce': 'lGz36NwJgi7p4LAO', 'upm_answer': 'true', 'state': 'eUSgTT1dhrTPObAV', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:59,365 oic.oic.provider:DEBUG id_token: {'exp': 1440159839, 'aud': ['BmUDFCBMqfRi'], 'auth_time': 1440080634, 'nonce': 'lGz36NwJgi7p4LAO', 'sub': '7564413e9b3d3139', 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'iat': 1440080639}
2015-08-20 16:23:59,367 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "e": "AQAB", "kid": "op0"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "e": "AQAB", "kid": "op1"}]}
2015-08-20 16:23:59,368 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "y": "A1WLwtQU8CYH2R8pZ4jeBGFlPvVTX7AlTtmQeirResY", "use": "sig", "x": "W2kvVmx0Z1QT398jfmhYQOSjdzPQPTvWxmHDPpZ3Vag", "kid": "op2"}]}
2015-08-20 16:23:59,368 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "y": "IFO9RX5k84psuRf2MoBxtHEAQzh7wSFjGaeWjjmWQDQ", "use": "enc", "x": "inSy-B3X7BS6tcrqzY3VxBq2MG0_fh5tVMevU9OZqCQ", "kid": "op3"}]}
2015-08-20 16:23:59,369 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x105628240>]
2015-08-20 16:23:59,378 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:23:59,379 oic.oic.provider:DEBUG _tinfo: {'code': 'HKLDdoBNp8FG4CyA4fohTYg6j1+vtM5ypEGFT6J7DwuUE3yK+HDXMmOGHm5nVrHp99McxkfndAocDBB7HgKrPmyyqA/3wJhL+EWHTbkF/4c=', 'expires_in': 3600, 'token_expires_at': 1440080637, 'client_id': 'BmUDFCBMqfRi', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJleHAiOiAxNDQwMTU5ODM5LCAiYXVkIjogWyJCbVVERkNCTXFmUmkiXSwgImF1dGhfdGltZSI6IDE0NDAwODA2MzQsICJub25jZSI6ICJsR3ozNk53SmdpN3A0TEFPIiwgInN1YiI6ICI3NTY0NDEzZTliM2QzMTM5IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaWF0IjogMTQ0MDA4MDYzOX0.MHGtsXyiZWui1pLbL9pMPnyOJMaaVcY15-38nIt7v26OnavNg8qRTNpA7iuJec30DaSwoPFUME5eOhhTpkyVAMLb6QoPXy_ROyPjN3tsCFOLWFOgnAmrrVT7Vafe2Jka7JQtJp-7JsJZA5q5YkBZ3c1HDZFU-LBhOUevH7dCZfQihxCK6_qwfREpjPovPD4L5QT3hYkXbe1FREvl7AI6VQ--lwS3bV4JXeIwsu4dM9zohNHspkq5Y5E0lvbMlAjRUDDCosYhU5gTCoaUQWW7Kh6oNwVZ66Z-ehEhJF15h7-q72-cgoc9Vr1ywQUEC0AU1gkyyBJ7-UXOz731UzCGWQ', 'permission': '', 'access_token_scope': '?', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105bb6860>, 'nonce': 'lGz36NwJgi7p4LAO', 'refresh_token': 'HKLDdoBNp8FG4CyA4fohTYg6j1+vtM5ypEGFT6J7DwuUE3yK+HDXMmOGHm5nVrHpV9WfWVCy+RY413M/l6wirPwG4J5kJeFbh4qBsgTm+uQ=', 'state': 'eUSgTT1dhrTPObAV', 'code_used': True, 'token_type': 'Bearer', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'authzreq': '{"client_id": "BmUDFCBMqfRi", "response_type": "code", "nonce": "lGz36NwJgi7p4LAO", "upm_answer": "true", "state": "eUSgTT1dhrTPObAV", "scope": "openid profile email address phone", "redirect_uri": "https://localhost:8666/authz_cb"}', 'access_token': 'HKLDdoBNp8FG4CyA4fohTYg6j1+vtM5ypEGFT6J7DwuUE3yK+HDXMmOGHm5nVrHpZ3+eexX8q4x4NOjuP4BQDuhSNiUDQPPvouYuVPUZFt4=', 'sub': '7564413e9b3d3139', 'revoked': False, 'oauth_state': 'token', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:23:59,380 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'token_type': 'Bearer', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJleHAiOiAxNDQwMTU5ODM5LCAiYXVkIjogWyJCbVVERkNCTXFmUmkiXSwgImF1dGhfdGltZSI6IDE0NDAwODA2MzQsICJub25jZSI6ICJsR3ozNk53SmdpN3A0TEFPIiwgInN1YiI6ICI3NTY0NDEzZTliM2QzMTM5IiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaWF0IjogMTQ0MDA4MDYzOX0.MHGtsXyiZWui1pLbL9pMPnyOJMaaVcY15-38nIt7v26OnavNg8qRTNpA7iuJec30DaSwoPFUME5eOhhTpkyVAMLb6QoPXy_ROyPjN3tsCFOLWFOgnAmrrVT7Vafe2Jka7JQtJp-7JsJZA5q5YkBZ3c1HDZFU-LBhOUevH7dCZfQihxCK6_qwfREpjPovPD4L5QT3hYkXbe1FREvl7AI6VQ--lwS3bV4JXeIwsu4dM9zohNHspkq5Y5E0lvbMlAjRUDDCosYhU5gTCoaUQWW7Kh6oNwVZ66Z-ehEhJF15h7-q72-cgoc9Vr1ywQUEC0AU1gkyyBJ7-UXOz731UzCGWQ', 'refresh_token': 'HKLDdoBNp8FG4CyA4fohTYg6j1+vtM5ypEGFT6J7DwuUE3yK+HDXMmOGHm5nVrHpV9WfWVCy+RY413M/l6wirPwG4J5kJeFbh4qBsgTm+uQ=', 'access_token': 'HKLDdoBNp8FG4CyA4fohTYg6j1+vtM5ypEGFT6J7DwuUE3yK+HDXMmOGHm5nVrHpZ3+eexX8q4x4NOjuP4BQDuhSNiUDQPPvouYuVPUZFt4=', 'state': 'eUSgTT1dhrTPObAV', 'scope': 'openid profile email address phone'}
2015-08-20 16:24:00,381 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:24:00,382 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:24:00] "POST /token HTTP/1.1" 200 -
2015-08-20 16:24:01,186 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:24:01] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:24:11,507 oic.oic.provider:DEBUG - token -
2015-08-20 16:24:11,507 oic.oic.provider:INFO token_request: http_signature=eyJhbGciOiJSUzI1NiIsImtpZCI6ImEwIn0.eyJwIjogIi91c2VyaW5mbyIsICJ1IjogImxvY2FsaG9zdDo4MDkyIiwgIm0iOiAiUE9TVCIsICJoIjogW1siQXV0aG9yaXphdGlvbiIsICJDb250ZW50LVR5cGUiXSwgIjdlZWV6SzJrMW8wLWZvLVUzNjNjVVF3VUxpQUJMOWlURXJ4UGhaVTBuWkE9Il19.E3OYJB37EJDMS5ZCjmFeHSP9Sv6ZA7dP6vnqEKQ2LgSnA6GJvb-Ih9c7-DZKfxfU7DuHwjNiEnNtLwCvH7zjxmLWyD_rJTWkT1ucacBMJwwGLxuUvOXpRPVbKCt_bPWzfQkQEH-PeL3wv7qJGG_HyMZhXmLgjkyOUus2mfpHu_I
2015-08-20 16:24:11,508 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'http_signature': 'eyJhbGciOiJSUzI1NiIsImtpZCI6ImEwIn0.eyJwIjogIi91c2VyaW5mbyIsICJ1IjogImxvY2FsaG9zdDo4MDkyIiwgIm0iOiAiUE9TVCIsICJoIjogW1siQXV0aG9yaXphdGlvbiIsICJDb250ZW50LVR5cGUiXSwgIjdlZWV6SzJrMW8wLWZvLVUzNjNjVVF3VUxpQUJMOWlURXJ4UGhaVTBuWkE9Il19.E3OYJB37EJDMS5ZCjmFeHSP9Sv6ZA7dP6vnqEKQ2LgSnA6GJvb-Ih9c7-DZKfxfU7DuHwjNiEnNtLwCvH7zjxmLWyD_rJTWkT1ucacBMJwwGLxuUvOXpRPVbKCt_bPWzfQkQEH-PeL3wv7qJGG_HyMZhXmLgjkyOUus2mfpHu_I'}
2015-08-20 16:24:11,508 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'http_signature': 'eyJhbGciOiJSUzI1NiIsImtpZCI6ImEwIn0.eyJwIjogIi91c2VyaW5mbyIsICJ1IjogImxvY2FsaG9zdDo4MDkyIiwgIm0iOiAiUE9TVCIsICJoIjogW1siQXV0aG9yaXphdGlvbiIsICJDb250ZW50LVR5cGUiXSwgIjdlZWV6SzJrMW8wLWZvLVUzNjNjVVF3VUxpQUJMOWlURXJ4UGhaVTBuWkE9Il19.E3OYJB37EJDMS5ZCjmFeHSP9Sv6ZA7dP6vnqEKQ2LgSnA6GJvb-Ih9c7-DZKfxfU7DuHwjNiEnNtLwCvH7zjxmLWyD_rJTWkT1ucacBMJwwGLxuUvOXpRPVbKCt_bPWzfQkQEH-PeL3wv7qJGG_HyMZhXmLgjkyOUus2mfpHu_I'}
2015-08-20 16:24:11,508 oic.oic.provider:ERROR Failed to verify client due to: AuthZ type I don't know
2015-08-20 16:25:03,355 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "use": "enc", "kty": "RSA", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "use": "sig", "kty": "RSA", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:25:03,355 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "use": "sig", "kty": "EC", "y": "5mkfFYWWaY9EUEuUienzliMl1uDJ1u1b_svAi9FaMCU", "x": "ZZgq7mSoM0fb30C0R7WrABhLTz6d5gbUivQy4RdFkG0", "crv": "P-256"}]}
2015-08-20 16:25:03,356 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "use": "enc", "kty": "EC", "y": "lOTiRsCzv2CylwlZ8s23nnZs_scKzk7E28RL_hNjOGI", "x": "B_hdvBUgK9qv86OXnB8WFVeGPXjFTkCgQWFNbNorBwo", "crv": "P-256"}]}
2015-08-20 16:25:03,383 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:25:03,387 werkzeug:INFO  * Restarting with stat
2015-08-20 16:25:05,088 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:25:05,088 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op2", "x": "fpERp7Bbk-uN4ZoRekRqnXMxCvBdoHE47LkmYJVDtkA", "use": "sig", "y": "Wn8Z2HS-xbtAMVD-4L9osqB_lDdfzSSxMrpDwzga-yk"}]}
2015-08-20 16:25:05,089 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op3", "x": "xVZVfpeQQdc4mgORhLWU4Bt_YnTRUNQLstOemQPLEjQ", "use": "enc", "y": "IFV9ilSWVET0wPD01iSewop7lsNYMrZsw01W4rL9ARs"}]}
2015-08-20 16:25:18,409 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:25:18] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:25:22,974 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:25:22,975 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:25:22,975 oic.oic.provider:INFO provider_info_response: {'scopes_supported': ['openid', 'phone', 'offline_access', 'address', 'email', 'profile', 'openid'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_parameter_supported': True, 'token_endpoint': 'https://localhost:8092/token', 'userinfo_signing_alg_values_supported': ['HS256', 'RS384', 'RS256', 'HS384', 'RS512', 'PS256', 'PS384', 'ES512', 'ES384', 'HS512', 'PS512', 'none', 'ES256'], 'id_token_signing_alg_values_supported': ['HS256', 'RS384', 'RS256', 'HS384', 'RS512', 'PS256', 'PS384', 'ES512', 'ES384', 'HS512', 'PS512', 'none', 'ES256'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_signing_alg_values_supported': ['HS256', 'RS384', 'RS256', 'HS384', 'RS512', 'PS256', 'PS384', 'ES512', 'ES384', 'HS512', 'PS512', 'ES256'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'claims_supported': ['phone_number_verified', 'name', 'picture', 'middle_name', 'gender', 'zoneinfo', 'given_name', 'updated_at', 'nickname', 'birthdate', 'family_name', 'sub', 'website', 'address', 'locale', 'email', 'email_verified', 'profile', 'phone_number', 'preferred_username'], 'version': '3.0', 'require_request_uri_registration': True, 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'subject_types_supported': ['public', 'pairwise'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'acr_values_supported': ['PASSWORD'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_uri_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'request_object_signing_alg_values_supported': ['HS256', 'RS384', 'RS256', 'HS384', 'RS512', 'PS256', 'PS384', 'ES512', 'ES384', 'HS512', 'PS512', 'none', 'ES256'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'claim_types_supported': ['normal', 'aggregated', 'distributed']}
2015-08-20 16:25:22,977 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:25:22] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:25:36,885 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "application_type": "web", "response_types": ["code"], "redirect_uris": ["https://localhost:8666/authz_cb"], "contacts": ["ops@example.com"]}>>
2015-08-20 16:25:36,886 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/authz_cb'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success']}
2015-08-20 16:25:36,893 oic.oic.provider:DEBUG _cinfo: {'client_secret': '3473c3fa65df8101b16fa72d6428ed396242e64b77ba2c70b9cac81e', 'registration_client_uri': 'https://localhost:8092/registration?client_id=sykNR4Lgvcjt', 'client_id': 'sykNR4Lgvcjt', 'client_secret_expires_at': 1440163536, 'client_id_issued_at': 1440077136, 'registration_access_token': 'VQFX9Y20JAv21ZCYfp0YWD0CjdPmdedd'}
2015-08-20 16:25:36,895 oic.utils.keyio:DEBUG loading keys for issuer: sykNR4Lgvcjt
2015-08-20 16:25:36,896 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/authz_cb'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success']}
2015-08-20 16:25:36,896 oic.oic.provider:DEBUG keys for sykNR4Lgvcjt: []
2015-08-20 16:25:36,899 oic.oic.provider:INFO Client info: {'response_types': ['code'], 'client_secret': '3473c3fa65df8101b16fa72d6428ed396242e64b77ba2c70b9cac81e', 'contacts': ['ops@example.com'], 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=sykNR4Lgvcjt', 'client_id': 'sykNR4Lgvcjt', 'client_secret_expires_at': 1440163536, 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1440077136, 'registration_access_token': 'VQFX9Y20JAv21ZCYfp0YWD0CjdPmdedd', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)]}
2015-08-20 16:25:36,899 oic.oic.provider:DEBUG registration_response: {'response_types': ['code'], 'client_secret': '3473c3fa65df8101b16fa72d6428ed396242e64b77ba2c70b9cac81e', 'contacts': ['ops@example.com'], 'application_type': 'web', 'registration_client_uri': 'https://localhost:8092/registration?client_id=sykNR4Lgvcjt', 'client_id': 'sykNR4Lgvcjt', 'client_secret_expires_at': 1440163536, 'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_id_issued_at': 1440077136, 'registration_access_token': 'VQFX9Y20JAv21ZCYfp0YWD0CjdPmdedd', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success']}
2015-08-20 16:25:36,900 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:25:36] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:25:36,924 oic.oauth2.provider:DEBUG Request: 'state=ktGpAkKqtDur91yC&nonce=lIUYsAM15giu1Hr6&scope=openid+profile+email+address+phone&client_id=sykNR4Lgvcjt&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'
2015-08-20 16:25:36,925 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105aa9b00>, <jwkest.jwk.RSAKey object at 0x105527278>, <jwkest.jwk.ECKey object at 0x105527710>]
2015-08-20 16:25:36,926 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'lIUYsAM15giu1Hr6', 'scope': 'openid profile email address phone', 'state': 'ktGpAkKqtDur91yC', 'client_id': 'sykNR4Lgvcjt', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-20 16:25:36,928 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'lIUYsAM15giu1Hr6', 'scope': 'openid profile email address phone', 'state': 'ktGpAkKqtDur91yC', 'client_id': 'sykNR4Lgvcjt', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-20 16:25:36,931 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:25:36,932 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:25:36,932 oic.utils.authn.user:INFO do_authentication argv: {'passwd_title': 'Password', 'tos_uri': '', 'acr': '', 'client_policy_title': 'Client Policy', 'login': '', 'submit_text': 'Submit', 'policy_uri': '', 'logo_uri': '', 'query': 'state=ktGpAkKqtDur91yC&nonce=lIUYsAM15giu1Hr6&scope=openid+profile+email+address+phone&client_id=sykNR4Lgvcjt&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code', 'login_title': 'Username', 'password': '', 'title': 'User log in', 'action': 'https://localhost:8092/verify'}
2015-08-20 16:25:36,937 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:25:36] "GET /authorization?state=ktGpAkKqtDur91yC&nonce=lIUYsAM15giu1Hr6&scope=openid+profile+email+address+phone&client_id=sykNR4Lgvcjt&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code HTTP/1.1" 200 -
2015-08-20 16:25:36,962 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:25:36] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:25:42,099 oic.utils.authn.user:DEBUG verify(query=state%3DktGpAkKqtDur91yC%26nonce%3DlIUYsAM15giu1Hr6%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26client_id%3DsykNR4Lgvcjt%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:25:42,099 oic.utils.authn.user:DEBUG dict: {'query': ['state=ktGpAkKqtDur91yC&nonce=lIUYsAM15giu1Hr6&scope=openid+profile+email+address+phone&client_id=sykNR4Lgvcjt&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code'], 'login': ['diana'], 'password': ['krall'], 'form.commit': ['Submit']}
2015-08-20 16:25:42,100 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-20 16:25:42,103 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['lIUYsAM15giu1Hr6'], 'scope': ['openid profile email address phone'], 'state': ['ktGpAkKqtDur91yC'], 'client_id': ['sykNR4Lgvcjt'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'response_type': ['code'], 'upm_answer': 'true'}
2015-08-20 16:25:42,105 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:25:42] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:25:42,138 oic.oauth2.provider:DEBUG Request: 'nonce=lIUYsAM15giu1Hr6&scope=openid+profile+email+address+phone&state=ktGpAkKqtDur91yC&client_id=sykNR4Lgvcjt&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&upm_answer=true'
2015-08-20 16:25:42,139 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105aa9b00>, <jwkest.jwk.RSAKey object at 0x105527278>, <jwkest.jwk.ECKey object at 0x105527710>]
2015-08-20 16:25:42,140 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'lIUYsAM15giu1Hr6', 'scope': 'openid profile email address phone', 'state': 'ktGpAkKqtDur91yC', 'client_id': 'sykNR4Lgvcjt', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-20 16:25:42,142 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'lIUYsAM15giu1Hr6', 'scope': 'openid profile email address phone', 'state': 'ktGpAkKqtDur91yC', 'client_id': 'sykNR4Lgvcjt', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-20 16:25:42,144 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:25:42,145 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:25:42,145 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:25:42,146 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'scope', 'state', 'client_id', 'redirect_uri', 'response_type', 'upm_answer']
2015-08-20 16:25:42,147 oic.utils.sdb:DEBUG uid2sid: {'diana': ['d3fe003307c11d4844cc68349254d4f09a6ec5b2c14706bca10f9e75']}
2015-08-20 16:25:42,148 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:25:42,148 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:25:42,153 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=1vse28F0q5bzd%2BjQH6wS%2B7szMOyVGTi2%2FUeWgjcOx0dVD3%2BSmjMkVjMQ4tc91YxUs2vfgL92mGa0QhumPlSv8%2B3kU7Nbs6amYtku7Ptg9Jk%3D&state=ktGpAkKqtDur91yC' (<class 'str'>)
2015-08-20 16:25:42,155 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:25:42] "GET /authorization?nonce=lIUYsAM15giu1Hr6&scope=openid+profile+email+address+phone&state=ktGpAkKqtDur91yC&client_id=sykNR4Lgvcjt&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&upm_answer=true HTTP/1.1" 302 -
2015-08-20 16:25:55,979 oic.oic.provider:DEBUG - token -
2015-08-20 16:25:55,980 oic.oic.provider:INFO token_request: client_id=sykNR4Lgvcjt&code=1vse28F0q5bzd%2BjQH6wS%2B7szMOyVGTi2%2FUeWgjcOx0dVD3%2BSmjMkVjMQ4tc91YxUs2vfgL92mGa0QhumPlSv8%2B3kU7Nbs6amYtku7Ptg9Jk%3D&key=eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJrdHkiOiAiUlNBIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ%3D%3D&grant_type=authorization_code&token_type=pop&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=3473c3fa65df8101b16fa72d6428ed396242e64b77ba2c70b9cac81e
2015-08-20 16:25:55,981 oic.oic.provider:DEBUG AccessTokenRequest: {'client_id': 'sykNR4Lgvcjt', 'client_secret': '3473c3fa65df8101b16fa72d6428ed396242e64b77ba2c70b9cac81e', 'code': '1vse28F0q5bzd+jQH6wS+7szMOyVGTi2/UeWgjcOx0dVD3+SmjMkVjMQ4tc91YxUs2vfgL92mGa0QhumPlSv8+3kU7Nbs6amYtku7Ptg9Jk=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'token_type': 'pop', 'key': 'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJrdHkiOiAiUlNBIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ=='}
2015-08-20 16:25:55,981 oic.utils.authn.client:DEBUG REQ: {'client_id': 'sykNR4Lgvcjt', 'client_secret': '3473c3fa65df8101b16fa72d6428ed396242e64b77ba2c70b9cac81e', 'code': '1vse28F0q5bzd+jQH6wS+7szMOyVGTi2/UeWgjcOx0dVD3+SmjMkVjMQ4tc91YxUs2vfgL92mGa0QhumPlSv8+3kU7Nbs6amYtku7Ptg9Jk=', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'token_type': 'pop', 'key': 'eyJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJrdHkiOiAiUlNBIiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEifQ=='}
2015-08-20 16:25:55,982 oic.utils.authn.client:DEBUG Verified Client ID: sykNR4Lgvcjt
2015-08-20 16:25:55,986 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:25:55,988 oic.oic:DEBUG authzreq: {'nonce': 'lIUYsAM15giu1Hr6', 'scope': 'openid profile email address phone', 'state': 'ktGpAkKqtDur91yC', 'client_id': 'sykNR4Lgvcjt', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-20 16:25:55,988 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:25:55,989 oic.oic:DEBUG authzreq: {'nonce': 'lIUYsAM15giu1Hr6', 'scope': 'openid profile email address phone', 'state': 'ktGpAkKqtDur91yC', 'client_id': 'sykNR4Lgvcjt', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true'}
2015-08-20 16:25:55,990 oic.oic.provider:DEBUG id_token: {'nonce': 'lIUYsAM15giu1Hr6', 'exp': 1440159955, 'auth_time': 1440080742, 'acr': 'PASSWORD', 'iat': 1440080755, 'sub': '5a002a6a175eeef8', 'iss': 'https://localhost:8092/', 'aud': ['sykNR4Lgvcjt']}
2015-08-20 16:25:55,993 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:25:55,993 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op2", "x": "fpERp7Bbk-uN4ZoRekRqnXMxCvBdoHE47LkmYJVDtkA", "use": "sig", "y": "Wn8Z2HS-xbtAMVD-4L9osqB_lDdfzSSxMrpDwzga-yk"}]}
2015-08-20 16:25:55,994 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "crv": "P-256", "kid": "op3", "x": "xVZVfpeQQdc4mgORhLWU4Bt_YnTRUNQLstOemQPLEjQ", "use": "enc", "y": "IFV9ilSWVET0wPD01iSewop7lsNYMrZsw01W4rL9ARs"}]}
2015-08-20 16:25:55,994 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x105527278>]
2015-08-20 16:25:56,002 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:25:56,002 oic.oic.provider:DEBUG _tinfo: {'access_token': '1vse28F0q5bzd+jQH6wS+7szMOyVGTi2/UeWgjcOx0dVD3+SmjMkVjMQ4tc91YxUdMy+gLhzuBWVE/s2XY2MiJHY52yFHE4uiUOIOk48Auc=', 'code': '1vse28F0q5bzd+jQH6wS+7szMOyVGTi2/UeWgjcOx0dVD3+SmjMkVjMQ4tc91YxUs2vfgL92mGa0QhumPlSv8+3kU7Nbs6amYtku7Ptg9Jk=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJsSVVZc0FNMTVnaXUxSHI2IiwgImV4cCI6IDE0NDAxNTk5NTUsICJhdXRoX3RpbWUiOiAxNDQwMDgwNzQyLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0NDAwODA3NTUsICJzdWIiOiAiNWEwMDJhNmExNzVlZWVmOCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyJzeWtOUjRMZ3ZjanQiXX0.ZJdiv4zJM5MoZnA-YocecnHww9BSkDX-PR0aQmlRwwYHL3HUDo9R1GXIMu3o1E9Lev4-6R6qidTjrkH3Gx0OqTCBP0YWpywsC5YnOFtmG2n__AjWwQOquV9jajoYehpInChRuSKO2Og56UThIYr-vlAkhL0mtlAmzTmEAx2ogxPo7pKr-_sGXzJz9S18_L79cgyywShXsxZ48vTnig_B6Fculgck8U4XPiOjLlxk2akXBMZ_Le3W1VxYKI8vunCnJr5qdrMeVETzhR8SuSHjcRGTFRKZlxHDbXOSYatJBZBU3UaIrhSmu-OTmAnq1RhMuZnG-uEqDckwt_xhRjGonA', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105aae358>, 'client_id': 'sykNR4Lgvcjt', 'token_type': 'Bearer', 'state': 'ktGpAkKqtDur91yC', 'nonce': 'lIUYsAM15giu1Hr6', 'oauth_state': 'token', 'revoked': False, 'code_used': True, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'permission': '', 'token_expires_at': 1440080755, 'expires_in': 3600, 'redirect_uri': 'https://localhost:8666/authz_cb', 'access_token_scope': '?', 'sub': '5a002a6a175eeef8', 'refresh_token': '1vse28F0q5bzd+jQH6wS+7szMOyVGTi2/UeWgjcOx0dVD3+SmjMkVjMQ4tc91YxUv3fwiWr3fJe9Xdk0xUg4+D+ens2AOMRDA38jN9kDMAQ=', 'authzreq': '{"nonce": "lIUYsAM15giu1Hr6", "scope": "openid profile email address phone", "state": "ktGpAkKqtDur91yC", "client_id": "sykNR4Lgvcjt", "redirect_uri": "https://localhost:8666/authz_cb", "response_type": "code", "upm_answer": "true"}'}
2015-08-20 16:25:56,003 oic.oic.provider:DEBUG access_token_response: {'scope': 'openid profile email address phone', 'access_token': '1vse28F0q5bzd+jQH6wS+7szMOyVGTi2/UeWgjcOx0dVD3+SmjMkVjMQ4tc91YxUdMy+gLhzuBWVE/s2XY2MiJHY52yFHE4uiUOIOk48Auc=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJsSVVZc0FNMTVnaXUxSHI2IiwgImV4cCI6IDE0NDAxNTk5NTUsICJhdXRoX3RpbWUiOiAxNDQwMDgwNzQyLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0NDAwODA3NTUsICJzdWIiOiAiNWEwMDJhNmExNzVlZWVmOCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiYXVkIjogWyJzeWtOUjRMZ3ZjanQiXX0.ZJdiv4zJM5MoZnA-YocecnHww9BSkDX-PR0aQmlRwwYHL3HUDo9R1GXIMu3o1E9Lev4-6R6qidTjrkH3Gx0OqTCBP0YWpywsC5YnOFtmG2n__AjWwQOquV9jajoYehpInChRuSKO2Og56UThIYr-vlAkhL0mtlAmzTmEAx2ogxPo7pKr-_sGXzJz9S18_L79cgyywShXsxZ48vTnig_B6Fculgck8U4XPiOjLlxk2akXBMZ_Le3W1VxYKI8vunCnJr5qdrMeVETzhR8SuSHjcRGTFRKZlxHDbXOSYatJBZBU3UaIrhSmu-OTmAnq1RhMuZnG-uEqDckwt_xhRjGonA', 'state': 'ktGpAkKqtDur91yC', 'token_type': 'Bearer', 'expires_in': 3600, 'refresh_token': '1vse28F0q5bzd+jQH6wS+7szMOyVGTi2/UeWgjcOx0dVD3+SmjMkVjMQ4tc91YxUv3fwiWr3fJe9Xdk0xUg4+D+ens2AOMRDA38jN9kDMAQ='}
2015-08-20 16:26:12,073 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:26:18,305 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:26:18] "POST /token HTTP/1.1" 200 -
2015-08-20 16:26:18,331 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:26:18] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:27:15,824 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:27:15,937 werkzeug:INFO  * Restarting with stat
2015-08-20 16:27:19,893 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "kty": "RSA", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "kty": "RSA", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:27:19,894 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op2", "kty": "EC", "use": "sig", "y": "Hj-x-v5g7fsxsq0cgpRx2vqpy1kXKF9cyHtuBtsn0xU", "x": "7Wy6IxdzeVBfi3hcqT-RT_95yp0BFpuUKm0Afh3grPk"}]}
2015-08-20 16:27:19,895 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op3", "kty": "EC", "use": "enc", "y": "18MRAdysyM88Jz4CLc4k6D6nCLLyfEgz2Vrm_ga2tJ4", "x": "89OyGvuuit02dClnUPVSriy4iob6wAnnfke9C6Kj0xE"}]}
2015-08-20 16:27:19,918 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:27:19,922 werkzeug:INFO  * Restarting with stat
2015-08-20 16:27:22,680 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kty": "RSA"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kty": "RSA"}]}
2015-08-20 16:27:22,680 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "crv": "P-256", "x": "znhBRlLuFb_0wOyXp0V3mljgsr6gjZjgW2KSsD6knx0", "y": "mthhGZfLZFTcKZFj6Ah6UEzBgKZDRXuam5SH6GyYmcQ", "use": "sig", "kty": "EC"}]}
2015-08-20 16:27:22,681 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "crv": "P-256", "x": "EBsYk4QZk0Hk0ET6ie3-uXiO1oSIKdGtBwjF6czrYiU", "y": "ZlNXZAhhY_8Z26NqoGp1iEWMAR5TJ9jMvH2Fv9vhGyE", "use": "enc", "kty": "EC"}]}
2015-08-20 16:27:26,934 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:26] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:27:26,954 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:27:26,955 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:27:26,956 oic.oic.provider:INFO provider_info_response: {'userinfo_signing_alg_values_supported': ['HS512', 'RS512', 'HS384', 'PS256', 'HS256', 'ES384', 'ES256', 'none', 'RS384', 'RS256', 'PS512', 'ES512', 'PS384'], 'request_uri_parameter_supported': True, 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'claims_supported': ['given_name', 'phone_number', 'phone_number_verified', 'birthdate', 'email_verified', 'locale', 'zoneinfo', 'name', 'gender', 'email', 'sub', 'preferred_username', 'profile', 'family_name', 'middle_name', 'nickname', 'website', 'picture', 'address', 'updated_at'], 'id_token_signing_alg_values_supported': ['HS512', 'RS512', 'HS384', 'PS256', 'HS256', 'ES384', 'ES256', 'none', 'RS384', 'RS256', 'PS512', 'ES512', 'PS384'], 'scopes_supported': ['phone', 'openid', 'offline_access', 'profile', 'email', 'address', 'openid'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_parameter_supported': True, 'token_endpoint_auth_signing_alg_values_supported': ['HS512', 'RS512', 'HS384', 'PS256', 'HS256', 'ES384', 'ES256', 'RS384', 'RS256', 'PS512', 'ES512', 'PS384'], 'subject_types_supported': ['public', 'pairwise'], 'request_object_signing_alg_values_supported': ['HS512', 'RS512', 'HS384', 'PS256', 'HS256', 'ES384', 'ES256', 'none', 'RS384', 'RS256', 'PS512', 'ES512', 'PS384'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'require_request_uri_registration': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'acr_values_supported': ['PASSWORD'], 'token_endpoint': 'https://localhost:8092/token', 'version': '3.0', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-20 16:27:26,957 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:26] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:27:27,025 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "redirect_uris": ["https://localhost:8666/authz_cb"], "application_type": "web", "post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "response_types": ["code"]}>>
2015-08-20 16:27:27,026 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:27:27,033 oic.oic.provider:DEBUG _cinfo: {'client_secret': '0afedcf199312c2a5adea43b02ac3eb9e45f57aac919cafa01adc0fb', 'client_id_issued_at': 1440077247, 'client_id': 'M9rS2cV03SqV', 'registration_access_token': 'rsseSxdZ1v5shaiafDSuJZxwxNi8GYw8', 'client_secret_expires_at': 1440163647, 'registration_client_uri': 'https://localhost:8092/registration?client_id=M9rS2cV03SqV'}
2015-08-20 16:27:27,034 oic.utils.keyio:DEBUG loading keys for issuer: M9rS2cV03SqV
2015-08-20 16:27:27,034 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'response_types': ['code'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:27:27,035 oic.oic.provider:DEBUG keys for M9rS2cV03SqV: []
2015-08-20 16:27:27,037 oic.oic.provider:INFO Client info: {'client_secret': '0afedcf199312c2a5adea43b02ac3eb9e45f57aac919cafa01adc0fb', 'client_id_issued_at': 1440077247, 'client_id': 'M9rS2cV03SqV', 'application_type': 'web', 'registration_access_token': 'rsseSxdZ1v5shaiafDSuJZxwxNi8GYw8', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1440163647, 'registration_client_uri': 'https://localhost:8092/registration?client_id=M9rS2cV03SqV', 'response_types': ['code']}
2015-08-20 16:27:27,037 oic.oic.provider:DEBUG registration_response: {'client_secret': '0afedcf199312c2a5adea43b02ac3eb9e45f57aac919cafa01adc0fb', 'client_id_issued_at': 1440077247, 'client_id': 'M9rS2cV03SqV', 'application_type': 'web', 'registration_access_token': 'rsseSxdZ1v5shaiafDSuJZxwxNi8GYw8', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1440163647, 'registration_client_uri': 'https://localhost:8092/registration?client_id=M9rS2cV03SqV', 'response_types': ['code']}
2015-08-20 16:27:27,039 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:27] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:27:27,064 oic.oauth2.provider:DEBUG Request: 'client_id=M9rS2cV03SqV&state=WZ7z86BPfbHV1zlo&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=KGM2prtxouQW2Ohr'
2015-08-20 16:27:27,065 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10556c390>, <jwkest.jwk.RSAKey object at 0x1055280f0>, <jwkest.jwk.ECKey object at 0x105528470>]
2015-08-20 16:27:27,066 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'client_id': 'M9rS2cV03SqV', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'nonce': 'KGM2prtxouQW2Ohr', 'state': 'WZ7z86BPfbHV1zlo'}
2015-08-20 16:27:27,068 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'client_id': 'M9rS2cV03SqV', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'nonce': 'KGM2prtxouQW2Ohr', 'state': 'WZ7z86BPfbHV1zlo'}
2015-08-20 16:27:27,070 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:27:27,071 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:27:27,071 oic.utils.authn.user:INFO do_authentication argv: {'client_policy_title': 'Client Policy', 'logo_uri': '', 'login': '', 'policy_uri': '', 'login_title': 'Username', 'password': '', 'passwd_title': 'Password', 'tos_uri': '', 'acr': '', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'submit_text': 'Submit', 'query': 'client_id=M9rS2cV03SqV&state=WZ7z86BPfbHV1zlo&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=KGM2prtxouQW2Ohr'}
2015-08-20 16:27:27,076 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:27] "GET /authorization?client_id=M9rS2cV03SqV&state=WZ7z86BPfbHV1zlo&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=KGM2prtxouQW2Ohr HTTP/1.1" 200 -
2015-08-20 16:27:27,099 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:27] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:27:30,686 oic.utils.authn.user:DEBUG verify(query=client_id%3DM9rS2cV03SqV%26state%3DWZ7z86BPfbHV1zlo%26response_type%3Dcode%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26nonce%3DKGM2prtxouQW2Ohr&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:27:30,687 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'query': ['client_id=M9rS2cV03SqV&state=WZ7z86BPfbHV1zlo&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=KGM2prtxouQW2Ohr'], 'password': ['krall'], 'login': ['diana']}
2015-08-20 16:27:30,687 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-20 16:27:30,690 oic.utils.authn.user:DEBUG kwargs: {'scope': ['openid profile email address phone'], 'client_id': ['M9rS2cV03SqV'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'state': ['WZ7z86BPfbHV1zlo'], 'response_type': ['code'], 'nonce': ['KGM2prtxouQW2Ohr'], 'upm_answer': 'true'}
2015-08-20 16:27:30,694 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:30] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:27:30,719 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&client_id=M9rS2cV03SqV&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=WZ7z86BPfbHV1zlo&response_type=code&nonce=KGM2prtxouQW2Ohr&upm_answer=true'
2015-08-20 16:27:30,721 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10556c390>, <jwkest.jwk.RSAKey object at 0x1055280f0>, <jwkest.jwk.ECKey object at 0x105528470>]
2015-08-20 16:27:30,723 oic.oauth2.provider:DEBUG AuthzRequest: {'scope': 'openid profile email address phone', 'client_id': 'M9rS2cV03SqV', 'redirect_uri': 'https://localhost:8666/authz_cb', 'upm_answer': 'true', 'response_type': 'code', 'nonce': 'KGM2prtxouQW2Ohr', 'state': 'WZ7z86BPfbHV1zlo'}
2015-08-20 16:27:30,727 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'scope': 'openid profile email address phone', 'client_id': 'M9rS2cV03SqV', 'redirect_uri': 'https://localhost:8666/authz_cb', 'upm_answer': 'true', 'response_type': 'code', 'nonce': 'KGM2prtxouQW2Ohr', 'state': 'WZ7z86BPfbHV1zlo'}
2015-08-20 16:27:30,730 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:27:30,731 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:27:30,731 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:27:30,731 oic.oic.provider:DEBUG AREQ keys: ['scope', 'client_id', 'redirect_uri', 'state', 'response_type', 'nonce', 'upm_answer']
2015-08-20 16:27:30,733 oic.utils.sdb:DEBUG uid2sid: {'diana': ['cd0ba0ce424ad7f3e9da780747a2a63145614313011e295248f7bba0']}
2015-08-20 16:27:30,733 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:27:30,733 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:27:30,737 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?scope=openid+profile+email+address+phone&code=99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVR%2FJ0bfUy9fSN8bQK8L88UPZM3RPnjC%2Bv9ZX0acn8lHc%3D&state=WZ7z86BPfbHV1zlo' (<class 'str'>)
2015-08-20 16:27:30,742 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:30] "GET /authorization?scope=openid+profile+email+address+phone&client_id=M9rS2cV03SqV&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&state=WZ7z86BPfbHV1zlo&response_type=code&nonce=KGM2prtxouQW2Ohr&upm_answer=true HTTP/1.1" 302 -
2015-08-20 16:27:36,935 oic.oic.provider:DEBUG - token -
2015-08-20 16:27:36,936 oic.oic.provider:INFO token_request: client_id=M9rS2cV03SqV&client_secret=0afedcf199312c2a5adea43b02ac3eb9e45f57aac919cafa01adc0fb&grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&code=99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVR%2FJ0bfUy9fSN8bQK8L88UPZM3RPnjC%2Bv9ZX0acn8lHc%3D&token_type=pop&key=eyJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImt0eSI6ICJSU0EiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIifQ%3D%3D
2015-08-20 16:27:36,937 oic.oic.provider:DEBUG AccessTokenRequest: {'client_secret': '0afedcf199312c2a5adea43b02ac3eb9e45f57aac919cafa01adc0fb', 'key': 'eyJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImt0eSI6ICJSU0EiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIifQ==', 'client_id': 'M9rS2cV03SqV', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'code': '99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVR/J0bfUy9fSN8bQK8L88UPZM3RPnjC+v9ZX0acn8lHc=', 'token_type': 'pop'}
2015-08-20 16:27:36,937 oic.utils.authn.client:DEBUG REQ: {'client_secret': '0afedcf199312c2a5adea43b02ac3eb9e45f57aac919cafa01adc0fb', 'key': 'eyJraWQiOiAiYTAiLCAidXNlIjogInNpZyIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgIm4iOiAiMV9IcFZEbmt4eEtqbjBpQ3F3M3NSTlRQVmk4cmFFLWN5WFJTRDd2SlAtbmgwS2lRY0t2ZVdoZnFpSkpCRndoeFNhWW1kNjhPUVE0ajZfdWhlcEo0aHpTMHpfbkVUUlhKc2VvQmNKeXRRdnlKal9janFzbEVqb3NCR2U5NDg4LUhlUUk1bTg2RllXeHltMnV1Z3JhQWpOVERSTzE4blFUMlJNMWEzdkV2YjZNIiwgImt0eSI6ICJSU0EiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJlIjogIkFRQUIifQ==', 'client_id': 'M9rS2cV03SqV', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'code': '99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVR/J0bfUy9fSN8bQK8L88UPZM3RPnjC+v9ZX0acn8lHc=', 'token_type': 'pop'}
2015-08-20 16:27:36,938 oic.utils.authn.client:DEBUG Verified Client ID: M9rS2cV03SqV
2015-08-20 16:27:36,942 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:27:36,943 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'M9rS2cV03SqV', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'WZ7z86BPfbHV1zlo', 'response_type': 'code', 'nonce': 'KGM2prtxouQW2Ohr', 'upm_answer': 'true'}
2015-08-20 16:27:36,944 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:27:36,944 oic.oic:DEBUG authzreq: {'scope': 'openid profile email address phone', 'client_id': 'M9rS2cV03SqV', 'redirect_uri': 'https://localhost:8666/authz_cb', 'state': 'WZ7z86BPfbHV1zlo', 'response_type': 'code', 'nonce': 'KGM2prtxouQW2Ohr', 'upm_answer': 'true'}
2015-08-20 16:27:36,945 oic.oic.provider:DEBUG id_token: {'aud': ['M9rS2cV03SqV'], 'exp': 1440160056, 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/', 'iat': 1440080856, 'auth_time': 1440080850, 'nonce': 'KGM2prtxouQW2Ohr', 'sub': '-759c3ddabf08fb04'}
2015-08-20 16:27:36,947 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "kty": "RSA"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "kty": "RSA"}]}
2015-08-20 16:27:36,948 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op2", "crv": "P-256", "x": "znhBRlLuFb_0wOyXp0V3mljgsr6gjZjgW2KSsD6knx0", "y": "mthhGZfLZFTcKZFj6Ah6UEzBgKZDRXuam5SH6GyYmcQ", "use": "sig", "kty": "EC"}]}
2015-08-20 16:27:36,949 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op3", "crv": "P-256", "x": "EBsYk4QZk0Hk0ET6ie3-uXiO1oSIKdGtBwjF6czrYiU", "y": "ZlNXZAhhY_8Z26NqoGp1iEWMAR5TJ9jMvH2Fv9vhGyE", "use": "enc", "kty": "EC"}]}
2015-08-20 16:27:36,949 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1055280f0>]
2015-08-20 16:27:36,956 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:27:36,957 oic.oic.provider:DEBUG _tinfo: {'expires_in': 3600, 'access_token_scope': '?', 'token_expires_at': 1440080856, 'client_id': 'M9rS2cV03SqV', 'refresh_token': '99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVpllR9N3/E+wzVPoK+BBJXRhTiJlNL+JC7Tx0A3cg+0o=', 'redirect_uri': 'https://localhost:8666/authz_cb', 'permission': '', 'revoked': False, 'code': '99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVR/J0bfUy9fSN8bQK8L88UPZM3RPnjC+v9ZX0acn8lHc=', 'token_type': 'Bearer', 'sub': '-759c3ddabf08fb04', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiBbIk05clMyY1YwM1NxViJdLCAiZXhwIjogMTQ0MDE2MDA1NiwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQ0MDA4MDg1NiwgImF1dGhfdGltZSI6IDE0NDAwODA4NTAsICJub25jZSI6ICJLR00ycHJ0eG91UVcyT2hyIiwgInN1YiI6ICItNzU5YzNkZGFiZjA4ZmIwNCJ9.Zv32Byb9YyuinkNIqo18hqbS3jTSjDyz980K95GwFSwQZ1YD1fLqxcewGcmzsLliZMLSrfE9sf1OF95ieq5H5vw_0zqknSgzkjPI-wbtQ02ud--Od5XZfppYBi3Lh5DHbtmxC7H1yIG0JKmKlI2oPJ6QDGNJ6MLNoMFOarH8jeZXXvUH0uCfYBMmaCv31leakfDtsnkgW9RV0_ZIG_H_Ow6lF3OnCq5S6J5LXesXcACmcUSDg1HOHnk63KMoHimVdX9TcQuV9aWgsNJBwBdb8kXqxp0s9y_xzrHCzPGAU7E8G-xDt_I8U01k7dTrbJuTq6hYg3aMs3FzANMm8rahpQ', 'code_used': True, 'oauth_state': 'token', 'authzreq': '{"scope": "openid profile email address phone", "client_id": "M9rS2cV03SqV", "redirect_uri": "https://localhost:8666/authz_cb", "upm_answer": "true", "response_type": "code", "nonce": "KGM2prtxouQW2Ohr", "state": "WZ7z86BPfbHV1zlo"}', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105aa30f0>, 'nonce': 'KGM2prtxouQW2Ohr', 'access_token': '99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVrBeFAP+lHFDL6wulJjNYf62KddWXDR6wNLS7ljRePXU=', 'state': 'WZ7z86BPfbHV1zlo'}
2015-08-20 16:27:36,958 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'scope': 'openid profile email address phone', 'refresh_token': '99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVpllR9N3/E+wzVPoK+BBJXRhTiJlNL+JC7Tx0A3cg+0o=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiBbIk05clMyY1YwM1NxViJdLCAiZXhwIjogMTQ0MDE2MDA1NiwgImFjciI6ICJQQVNTV09SRCIsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQ0MDA4MDg1NiwgImF1dGhfdGltZSI6IDE0NDAwODA4NTAsICJub25jZSI6ICJLR00ycHJ0eG91UVcyT2hyIiwgInN1YiI6ICItNzU5YzNkZGFiZjA4ZmIwNCJ9.Zv32Byb9YyuinkNIqo18hqbS3jTSjDyz980K95GwFSwQZ1YD1fLqxcewGcmzsLliZMLSrfE9sf1OF95ieq5H5vw_0zqknSgzkjPI-wbtQ02ud--Od5XZfppYBi3Lh5DHbtmxC7H1yIG0JKmKlI2oPJ6QDGNJ6MLNoMFOarH8jeZXXvUH0uCfYBMmaCv31leakfDtsnkgW9RV0_ZIG_H_Ow6lF3OnCq5S6J5LXesXcACmcUSDg1HOHnk63KMoHimVdX9TcQuV9aWgsNJBwBdb8kXqxp0s9y_xzrHCzPGAU7E8G-xDt_I8U01k7dTrbJuTq6hYg3aMs3FzANMm8rahpQ', 'token_type': 'Bearer', 'access_token': '99QDbOCVxRP7jUM7rrmRklZURtq1jEAMN5csE97Ii1UVGODEiXFQyb3puXn88WtVrBeFAP+lHFDL6wulJjNYf62KddWXDR6wNLS7ljRePXU=', 'state': 'WZ7z86BPfbHV1zlo'}
2015-08-20 16:27:36,966 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:27:36,967 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:36] "POST /token HTTP/1.1" 200 -
2015-08-20 16:27:36,990 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:36] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:27:37,031 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:27:37] "POST /userinfo HTTP/1.1" 500 -
2015-08-20 16:29:48,719 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:29:48,808 werkzeug:INFO  * Restarting with stat
2015-08-20 16:29:50,785 root:INFO OC3 server keys: {"keys": [{"use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "kty": "RSA", "e": "AQAB"}, {"use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "kty": "RSA", "e": "AQAB"}]}
2015-08-20 16:29:50,786 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "WhngpBke6yE5AFPBoe2yYkMmvqFgsAymfcRvJg6PW84", "crv": "P-256", "y": "fKmHQOpvi35PVnz0SwmxyMmr6eOwgjc1JSmwCmmBOkY", "kid": "op2", "kty": "EC"}]}
2015-08-20 16:29:50,786 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "6HCz1oECX9v9LzaPDbgh2gMpNxK_AKUZP4ZjyUKCEZY", "crv": "P-256", "y": "MuM6f6DxzFj5kWQKSZBOoywoAem8YtHdtrj5e4Ch5oQ", "kid": "op3", "kty": "EC"}]}
2015-08-20 16:29:53,437 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "use": "enc", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "use": "sig", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:29:53,438 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op2", "kty": "EC", "y": "A5pnTCE1WxxV3SJAkcKRxTcGiI59tH3GGQsAO1ozF2s", "use": "sig", "x": "IoWrZU5Nw2CZtnJOtmJLlL2kYKmAuv_bUaSQGy9RBXQ"}]}
2015-08-20 16:29:53,439 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op3", "kty": "EC", "y": "WMooDblRPaJjDHvygTMD-udEslqfdxgx4MD4Li-eY0w", "use": "enc", "x": "v7SVngdB9tTBepRzztAGf7L0oXHO-aI2nYN_rpC1CIA"}]}
2015-08-20 16:29:53,489 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:29:53,494 werkzeug:INFO  * Restarting with stat
2015-08-20 16:29:56,478 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:29:56,479 root:INFO OC3 server keys: {"keys": [{"y": "hbkwKddSyyDkkehMegJGT0fXgE6XZC7Dw9CqHEI5wRA", "crv": "P-256", "use": "sig", "x": "v4n0sV8lKvzVOQ7UXXGEr7j2VV0vwDbBqbhgTeafSHE", "kty": "EC", "kid": "op2"}]}
2015-08-20 16:29:56,479 root:INFO OC3 server keys: {"keys": [{"y": "DSlDKqw7dav9FvP2-79EdbTBdogQ43ldfSiYan2FNd4", "crv": "P-256", "use": "enc", "x": "5RuEFeuJPY2HTyXFECEaR3YOe-_tbnkMYuU3yhfCuSw", "kty": "EC", "kid": "op3"}]}
2015-08-20 16:30:01,945 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:01] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:30:01,965 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:30:01,966 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:30:01,967 oic.oic.provider:INFO provider_info_response: {'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'scopes_supported': ['email', 'offline_access', 'phone', 'profile', 'openid', 'address', 'openid'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'RS256', 'RS512', 'PS256', 'ES384', 'RS384', 'PS384', 'ES512', 'HS256', 'PS512', 'ES256', 'HS512'], 'issuer': 'https://localhost:8092/', 'version': '3.0', 'claims_supported': ['email', 'phone_number_verified', 'picture', 'birthdate', 'zoneinfo', 'locale', 'updated_at', 'profile', 'website', 'address', 'name', 'family_name', 'nickname', 'gender', 'phone_number', 'middle_name', 'sub', 'preferred_username', 'given_name', 'email_verified'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_signing_alg_values_supported': ['none', 'HS384', 'RS256', 'RS512', 'PS256', 'ES384', 'RS384', 'PS384', 'ES512', 'HS256', 'PS512', 'ES256', 'HS512'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'id_token_signing_alg_values_supported': ['none', 'HS384', 'RS256', 'RS512', 'PS256', 'ES384', 'RS384', 'PS384', 'ES512', 'HS256', 'PS512', 'ES256', 'HS512'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'claims_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_uri_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'request_object_signing_alg_values_supported': ['none', 'HS384', 'RS256', 'RS512', 'PS256', 'ES384', 'RS384', 'PS384', 'ES512', 'HS256', 'PS512', 'ES256', 'HS512'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'acr_values_supported': ['PASSWORD'], 'registration_endpoint': 'https://localhost:8092/registration', 'require_request_uri_registration': True, 'token_endpoint': 'https://localhost:8092/token', 'authorization_endpoint': 'https://localhost:8092/authorization'}
2015-08-20 16:30:01,968 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:01] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:30:02,036 oic.oic.provider:DEBUG @registration_endpoint: <<{"contacts": ["ops@example.com"], "post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "application_type": "web", "redirect_uris": ["https://localhost:8666/authz_cb"], "response_types": ["code"]}>>
2015-08-20 16:30:02,037 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'response_types': ['code']}
2015-08-20 16:30:02,043 oic.oic.provider:DEBUG _cinfo: {'client_secret': 'ed9d9677b69320280e49596a1da06d11f51157b2ace0d0bca2400f8a', 'registration_client_uri': 'https://localhost:8092/registration?client_id=AplieORUk406', 'registration_access_token': 'IJhiScRieKqZ94OfX4PFCA9pNJH4K6sI', 'client_id_issued_at': 1440077402, 'client_id': 'AplieORUk406', 'client_secret_expires_at': 1440163802}
2015-08-20 16:30:02,045 oic.utils.keyio:DEBUG loading keys for issuer: AplieORUk406
2015-08-20 16:30:02,045 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'response_types': ['code']}
2015-08-20 16:30:02,046 oic.oic.provider:DEBUG keys for AplieORUk406: []
2015-08-20 16:30:02,048 oic.oic.provider:INFO Client info: {'client_secret': 'ed9d9677b69320280e49596a1da06d11f51157b2ace0d0bca2400f8a', 'contacts': ['ops@example.com'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=AplieORUk406', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'application_type': 'web', 'registration_access_token': 'IJhiScRieKqZ94OfX4PFCA9pNJH4K6sI', 'response_types': ['code'], 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'client_id_issued_at': 1440077402, 'client_id': 'AplieORUk406', 'client_secret_expires_at': 1440163802}
2015-08-20 16:30:02,049 oic.oic.provider:DEBUG registration_response: {'contacts': ['ops@example.com'], 'application_type': 'web', 'client_secret': 'ed9d9677b69320280e49596a1da06d11f51157b2ace0d0bca2400f8a', 'registration_client_uri': 'https://localhost:8092/registration?client_id=AplieORUk406', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'registration_access_token': 'IJhiScRieKqZ94OfX4PFCA9pNJH4K6sI', 'response_types': ['code'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_id_issued_at': 1440077402, 'client_id': 'AplieORUk406', 'client_secret_expires_at': 1440163802}
2015-08-20 16:30:02,050 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:02] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:30:04,618 oic.oauth2.provider:DEBUG Request: 'scope=openid+profile+email+address+phone&state=I6jqyKb7uDXpx33N&client_id=AplieORUk406&response_type=code&nonce=K9mzLU83132EsY1P&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-20 16:30:04,620 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10556f278>, <jwkest.jwk.RSAKey object at 0x10552a080>, <jwkest.jwk.ECKey object at 0x10552a400>]
2015-08-20 16:30:04,621 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'I6jqyKb7uDXpx33N', 'scope': 'openid profile email address phone', 'nonce': 'K9mzLU83132EsY1P', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:04,623 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'I6jqyKb7uDXpx33N', 'scope': 'openid profile email address phone', 'nonce': 'K9mzLU83132EsY1P', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:04,625 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:30:04,626 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:30:04,626 oic.utils.authn.user:INFO do_authentication argv: {'tos_uri': '', 'logo_uri': '', 'policy_uri': '', 'client_policy_title': 'Client Policy', 'action': 'https://localhost:8092/verify', 'login': '', 'submit_text': 'Submit', 'login_title': 'Username', 'passwd_title': 'Password', 'query': 'scope=openid+profile+email+address+phone&state=I6jqyKb7uDXpx33N&client_id=AplieORUk406&response_type=code&nonce=K9mzLU83132EsY1P&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'title': 'User log in', 'acr': '', 'password': ''}
2015-08-20 16:30:04,632 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:04] "GET /authorization?scope=openid+profile+email+address+phone&state=I6jqyKb7uDXpx33N&client_id=AplieORUk406&response_type=code&nonce=K9mzLU83132EsY1P&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 200 -
2015-08-20 16:30:04,648 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:04] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:30:12,172 oic.utils.authn.user:DEBUG verify(query=scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3DI6jqyKb7uDXpx33N%26client_id%3DAplieORUk406%26response_type%3Dcode%26nonce%3DK9mzLU83132EsY1P%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:30:12,172 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'password': ['krall'], 'login': ['diana'], 'query': ['scope=openid+profile+email+address+phone&state=I6jqyKb7uDXpx33N&client_id=AplieORUk406&response_type=code&nonce=K9mzLU83132EsY1P&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb']}
2015-08-20 16:30:12,173 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-20 16:30:12,176 oic.utils.authn.user:DEBUG kwargs: {'state': ['I6jqyKb7uDXpx33N'], 'scope': ['openid profile email address phone'], 'nonce': ['K9mzLU83132EsY1P'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'response_type': ['code'], 'upm_answer': 'true', 'client_id': ['AplieORUk406']}
2015-08-20 16:30:12,179 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:12] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:30:14,392 oic.oauth2.provider:DEBUG Request: 'state=I6jqyKb7uDXpx33N&scope=openid+profile+email+address+phone&nonce=K9mzLU83132EsY1P&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&upm_answer=true&client_id=AplieORUk406'
2015-08-20 16:30:14,393 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x10556f278>, <jwkest.jwk.RSAKey object at 0x10552a080>, <jwkest.jwk.ECKey object at 0x10552a400>]
2015-08-20 16:30:14,394 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'I6jqyKb7uDXpx33N', 'scope': 'openid profile email address phone', 'nonce': 'K9mzLU83132EsY1P', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:14,395 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'I6jqyKb7uDXpx33N', 'scope': 'openid profile email address phone', 'nonce': 'K9mzLU83132EsY1P', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:14,397 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:30:14,399 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:30:14,399 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:30:14,399 oic.oic.provider:DEBUG AREQ keys: ['state', 'scope', 'nonce', 'redirect_uri', 'response_type', 'upm_answer', 'client_id']
2015-08-20 16:30:14,400 oic.utils.sdb:DEBUG uid2sid: {'diana': ['989d8773aded12a2fd1ccaacb54f87da2762a2f72955004386094aee']}
2015-08-20 16:30:14,401 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:30:14,401 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:30:14,404 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=I6jqyKb7uDXpx33N&scope=openid+profile+email+address+phone&code=pa9jaz%2Fx%2B6wdZ%2BQzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfxUFddHT2ffLC7qkdbLNEF3UJUdKeWaTLOe8V6Jzr81Ck%3D' (<class 'str'>)
2015-08-20 16:30:14,407 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:14] "GET /authorization?state=I6jqyKb7uDXpx33N&scope=openid+profile+email+address+phone&nonce=K9mzLU83132EsY1P&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&upm_answer=true&client_id=AplieORUk406 HTTP/1.1" 302 -
2015-08-20 16:30:17,759 oic.oic.provider:DEBUG - token -
2015-08-20 16:30:17,759 oic.oic.provider:INFO token_request: client_id=AplieORUk406&token_type=pop&code=pa9jaz%2Fx%2B6wdZ%2BQzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfxUFddHT2ffLC7qkdbLNEF3UJUdKeWaTLOe8V6Jzr81Ck%3D&client_secret=ed9d9677b69320280e49596a1da06d11f51157b2ace0d0bca2400f8a&grant_type=authorization_code&key=eyJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-20 16:30:17,760 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'key': 'eyJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'token_type': 'pop', 'client_secret': 'ed9d9677b69320280e49596a1da06d11f51157b2ace0d0bca2400f8a', 'code': 'pa9jaz/x+6wdZ+QzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfxUFddHT2ffLC7qkdbLNEF3UJUdKeWaTLOe8V6Jzr81Ck=', 'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:17,761 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'key': 'eyJraWQiOiAiYTAiLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'token_type': 'pop', 'client_secret': 'ed9d9677b69320280e49596a1da06d11f51157b2ace0d0bca2400f8a', 'code': 'pa9jaz/x+6wdZ+QzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfxUFddHT2ffLC7qkdbLNEF3UJUdKeWaTLOe8V6Jzr81Ck=', 'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:17,762 oic.utils.authn.client:DEBUG Verified Client ID: AplieORUk406
2015-08-20 16:30:17,765 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:30:17,767 oic.oic:DEBUG authzreq: {'state': 'I6jqyKb7uDXpx33N', 'scope': 'openid profile email address phone', 'nonce': 'K9mzLU83132EsY1P', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:17,767 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:30:17,768 oic.oic:DEBUG authzreq: {'state': 'I6jqyKb7uDXpx33N', 'scope': 'openid profile email address phone', 'nonce': 'K9mzLU83132EsY1P', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'upm_answer': 'true', 'client_id': 'AplieORUk406'}
2015-08-20 16:30:17,769 oic.oic.provider:DEBUG id_token: {'auth_time': 1440081012, 'iat': 1440081017, 'exp': 1440160217, 'nonce': 'K9mzLU83132EsY1P', 'aud': ['AplieORUk406'], 'sub': '4acb86f4e4b8b318', 'acr': 'PASSWORD', 'iss': 'https://localhost:8092/'}
2015-08-20 16:30:17,772 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "kty": "RSA", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "kty": "RSA", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:30:17,772 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "hbkwKddSyyDkkehMegJGT0fXgE6XZC7Dw9CqHEI5wRA", "crv": "P-256", "use": "sig", "x": "v4n0sV8lKvzVOQ7UXXGEr7j2VV0vwDbBqbhgTeafSHE", "kty": "EC", "kid": "op2"}]}
2015-08-20 16:30:17,773 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"y": "DSlDKqw7dav9FvP2-79EdbTBdogQ43ldfSiYan2FNd4", "crv": "P-256", "use": "enc", "x": "5RuEFeuJPY2HTyXFECEaR3YOe-_tbnkMYuU3yhfCuSw", "kty": "EC", "kid": "op3"}]}
2015-08-20 16:30:17,773 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10552a080>]
2015-08-20 16:30:17,781 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:30:17,782 oic.oic.provider:DEBUG _tinfo: {'revoked': False, 'expires_in': 3600, 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105c04400>, 'nonce': 'K9mzLU83132EsY1P', 'state': 'I6jqyKb7uDXpx33N', 'access_token_scope': '?', 'refresh_token': 'pa9jaz/x+6wdZ+QzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfxmfte8lvBpCBwGQeKz6Davo97zb7VrEsalEqr5z80j60=', 'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': 'AplieORUk406', 'permission': '', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDQwMDgxMDEyLCAiaWF0IjogMTQ0MDA4MTAxNywgImV4cCI6IDE0NDAxNjAyMTcsICJub25jZSI6ICJLOW16TFU4MzEzMkVzWTFQIiwgImF1ZCI6IFsiQXBsaWVPUlVrNDA2Il0sICJzdWIiOiAiNGFjYjg2ZjRlNGI4YjMxOCIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIn0.ytZLVUO515xgPT40sXIS8lyj-hdDwjdqOSVbcUNm1IVe1T5txmxivNfI5kVwPh4kkqK74cDsj4A9HObLDDS2Y8laTtDTZDRCZGcnQ7KZalv9uR6Tagbk3ytrAIkEjMazwcGlNGFsqeX_HOsekXrYaIZIzfiJcN064GDj5So8XqmCYac5Ml71_aihAKOeyM-LEyMK_2Fq74nVo_Cg-7fEMSRb9V7tprdXhH7EDesxNxiP4EBgJPRs2HwzzH9OsACNeEQ78ZfkBGyyj2-UorCQCR6qvw8CRenMNIHUUliMQvJZqPx59KMa7mFwxfXIiTN_cKU_3BlM_YaYdPdbr-mLHA', 'authzreq': '{"state": "I6jqyKb7uDXpx33N", "scope": "openid profile email address phone", "nonce": "K9mzLU83132EsY1P", "redirect_uri": "https://localhost:8666/authz_cb", "response_type": "code", "upm_answer": "true", "client_id": "AplieORUk406"}', 'code_used': True, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'token_expires_at': 1440081017, 'token_type': 'Bearer', 'code': 'pa9jaz/x+6wdZ+QzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfxUFddHT2ffLC7qkdbLNEF3UJUdKeWaTLOe8V6Jzr81Ck=', 'sub': '4acb86f4e4b8b318', 'oauth_state': 'token', 'access_token': 'pa9jaz/x+6wdZ+QzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfx/i37vZtG7quVS/wkShxNXnN/9nrfoFH6lSqXKCmy/1o='}
2015-08-20 16:30:17,782 oic.oic.provider:DEBUG access_token_response: {'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDQwMDgxMDEyLCAiaWF0IjogMTQ0MDA4MTAxNywgImV4cCI6IDE0NDAxNjAyMTcsICJub25jZSI6ICJLOW16TFU4MzEzMkVzWTFQIiwgImF1ZCI6IFsiQXBsaWVPUlVrNDA2Il0sICJzdWIiOiAiNGFjYjg2ZjRlNGI4YjMxOCIsICJhY3IiOiAiUEFTU1dPUkQiLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIn0.ytZLVUO515xgPT40sXIS8lyj-hdDwjdqOSVbcUNm1IVe1T5txmxivNfI5kVwPh4kkqK74cDsj4A9HObLDDS2Y8laTtDTZDRCZGcnQ7KZalv9uR6Tagbk3ytrAIkEjMazwcGlNGFsqeX_HOsekXrYaIZIzfiJcN064GDj5So8XqmCYac5Ml71_aihAKOeyM-LEyMK_2Fq74nVo_Cg-7fEMSRb9V7tprdXhH7EDesxNxiP4EBgJPRs2HwzzH9OsACNeEQ78ZfkBGyyj2-UorCQCR6qvw8CRenMNIHUUliMQvJZqPx59KMa7mFwxfXIiTN_cKU_3BlM_YaYdPdbr-mLHA', 'state': 'I6jqyKb7uDXpx33N', 'scope': 'openid profile email address phone', 'token_type': 'Bearer', 'refresh_token': 'pa9jaz/x+6wdZ+QzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfxmfte8lvBpCBwGQeKz6Davo97zb7VrEsalEqr5z80j60=', 'access_token': 'pa9jaz/x+6wdZ+QzFNpCbD4S8Ko58MGQWHrVDST21eHNUBfbLfZaVsOI2vN0lkfx/i37vZtG7quVS/wkShxNXnN/9nrfoFH6lSqXKCmy/1o=', 'expires_in': 3600}
2015-08-20 16:30:17,790 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:30:17,792 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:17] "POST /token HTTP/1.1" 200 -
2015-08-20 16:30:17,816 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:17] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:30:20,565 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:30:20] "POST /userinfo HTTP/1.1" 500 -
2015-08-20 16:31:00,799 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:31:01,074 werkzeug:INFO  * Restarting with stat
2015-08-20 16:31:02,957 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"use": "sig", "kty": "RSA", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 16:31:02,957 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kty": "EC", "kid": "op2", "x": "vyX85PiMEk-WCkqDwPM0eltMu2oUY0tGCtloUTDK784", "y": "dhe6io4OcH00nkHIje6Y4SoCwpayRu0n5k6otbK_LN8", "crv": "P-256"}]}
2015-08-20 16:31:02,958 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kty": "EC", "kid": "op3", "x": "5b6Fi6HFg8wXsGggMg4nTDwutLey7EtIb-wJZ7s84-k", "y": "Wx1QvTf0xoG8QOeza0G0dNYUKMisFGliiIfIQWypNMM", "crv": "P-256"}]}
2015-08-20 16:31:06,007 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "use": "enc"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "use": "sig"}]}
2015-08-20 16:31:06,008 root:INFO OC3 server keys: {"keys": [{"y": "QyZ0mVXbWGCMKSsmzdS83awKP2VDXz_5BFREmjuXnLo", "crv": "P-256", "kty": "EC", "kid": "op2", "use": "sig", "x": "2UYyysYjhhH3hbkR-iq00P8x5kQjzX1IV1PTw0Frjk0"}]}
2015-08-20 16:31:06,009 root:INFO OC3 server keys: {"keys": [{"y": "XTvPdV4ISMFqmaxCCD7ar-K3XICiC53zgMhFsIk4zlE", "crv": "P-256", "kty": "EC", "kid": "op3", "use": "enc", "x": "pzDJ5yBsvtnwvoCWk7M0XDkuGyqgSepbsZjmmb71bes"}]}
2015-08-20 16:31:06,043 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:31:06,047 werkzeug:INFO  * Restarting with stat
2015-08-20 16:31:07,729 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "enc", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "sig", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-20 16:31:07,730 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "y": "1GKqezBAEG6iiEed6JdAGiVxQ8RnmUhjbBHqW3hdtd4", "crv": "P-256", "kid": "op2", "x": "depfiBSaaCegv4gCNNBCjnkL2aNBGzqJaf2Hf-ZqeA4"}]}
2015-08-20 16:31:07,730 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "y": "Yoa5hEBNmZDvtqDnOhLvuXv-dEGFBVX_wcMAuOUKN-4", "crv": "P-256", "kid": "op3", "x": "xgZLTf-1zSAUcAQS4ojj7hMK8mQnRopSRkmchGe3G0Q"}]}
2015-08-20 16:31:20,297 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:20] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:31:20,316 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:31:20,317 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:31:20,317 oic.oic.provider:INFO provider_info_response: {'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_parameter_supported': True, 'subject_types_supported': ['public', 'pairwise'], 'userinfo_signing_alg_values_supported': ['ES512', 'ES384', 'HS384', 'ES256', 'none', 'RS512', 'PS256', 'PS384', 'RS256', 'HS256', 'PS512', 'RS384', 'HS512'], 'id_token_signing_alg_values_supported': ['ES512', 'ES384', 'HS384', 'ES256', 'none', 'RS512', 'PS256', 'PS384', 'RS256', 'HS256', 'PS512', 'RS384', 'HS512'], 'claims_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'scopes_supported': ['profile', 'offline_access', 'openid', 'address', 'phone', 'email', 'openid'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'claims_supported': ['profile', 'zoneinfo', 'locale', 'updated_at', 'middle_name', 'preferred_username', 'sub', 'nickname', 'picture', 'website', 'name', 'email_verified', 'given_name', 'gender', 'address', 'family_name', 'birthdate', 'phone_number', 'phone_number_verified', 'email'], 'acr_values_supported': ['PASSWORD'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'version': '3.0', 'token_endpoint_auth_signing_alg_values_supported': ['ES512', 'ES384', 'HS384', 'ES256', 'RS512', 'PS256', 'PS384', 'RS256', 'HS256', 'PS512', 'RS384', 'HS512'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_signing_alg_values_supported': ['ES512', 'ES384', 'HS384', 'ES256', 'none', 'RS512', 'PS256', 'PS384', 'RS256', 'HS256', 'PS512', 'RS384', 'HS512'], 'issuer': 'https://localhost:8092/', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint': 'https://localhost:8092/token', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'require_request_uri_registration': True, 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW']}
2015-08-20 16:31:20,318 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:20] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:31:20,385 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "redirect_uris": ["https://localhost:8666/authz_cb"], "application_type": "web", "contacts": ["ops@example.com"], "response_types": ["code"]}>>
2015-08-20 16:31:20,386 oic.oic.provider:INFO registration_request:{'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-20 16:31:20,394 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'yMwbeaa4W9KpRbyglq6xSUgNIuawo4A5', 'client_id': 'Nf1JRkv9cLWI', 'client_id_issued_at': 1440077480, 'client_secret': '939481e0b64497bb7c240ef351ee69c3ff342acd73c9d2b4072773af', 'client_secret_expires_at': 1440163880, 'registration_client_uri': 'https://localhost:8092/registration?client_id=Nf1JRkv9cLWI'}
2015-08-20 16:31:20,396 oic.utils.keyio:DEBUG loading keys for issuer: Nf1JRkv9cLWI
2015-08-20 16:31:20,396 oic.utils.keyio:DEBUG pcr: {'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code']}
2015-08-20 16:31:20,397 oic.oic.provider:DEBUG keys for Nf1JRkv9cLWI: []
2015-08-20 16:31:20,399 oic.oic.provider:INFO Client info: {'contacts': ['ops@example.com'], 'response_types': ['code'], 'registration_access_token': 'yMwbeaa4W9KpRbyglq6xSUgNIuawo4A5', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_id': 'Nf1JRkv9cLWI', 'client_id_issued_at': 1440077480, 'application_type': 'web', 'client_secret': '939481e0b64497bb7c240ef351ee69c3ff342acd73c9d2b4072773af', 'client_secret_expires_at': 1440163880, 'registration_client_uri': 'https://localhost:8092/registration?client_id=Nf1JRkv9cLWI', 'redirect_uris': [('https://localhost:8666/authz_cb', None)]}
2015-08-20 16:31:20,399 oic.oic.provider:DEBUG registration_response: {'contacts': ['ops@example.com'], 'response_types': ['code'], 'registration_access_token': 'yMwbeaa4W9KpRbyglq6xSUgNIuawo4A5', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'client_id': 'Nf1JRkv9cLWI', 'client_id_issued_at': 1440077480, 'application_type': 'web', 'client_secret': '939481e0b64497bb7c240ef351ee69c3ff342acd73c9d2b4072773af', 'client_secret_expires_at': 1440163880, 'registration_client_uri': 'https://localhost:8092/registration?client_id=Nf1JRkv9cLWI', 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:31:20,400 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:20] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:31:26,672 oic.oauth2.provider:DEBUG Request: 'response_type=code&client_id=Nf1JRkv9cLWI&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=orbzhEyq96LoCh3M&state=5hyJLOYJLi3x8cGs'
2015-08-20 16:31:26,674 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105a8cfd0>, <jwkest.jwk.RSAKey object at 0x10552a080>, <jwkest.jwk.ECKey object at 0x10552a400>]
2015-08-20 16:31:26,674 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'nonce': 'orbzhEyq96LoCh3M', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:26,676 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'nonce': 'orbzhEyq96LoCh3M', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:26,678 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:31:26,679 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:31:26,679 oic.utils.authn.user:INFO do_authentication argv: {'login': '', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'login_title': 'Username', 'policy_uri': '', 'tos_uri': '', 'client_policy_title': 'Client Policy', 'password': '', 'query': 'response_type=code&client_id=Nf1JRkv9cLWI&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=orbzhEyq96LoCh3M&state=5hyJLOYJLi3x8cGs', 'passwd_title': 'Password', 'acr': '', 'submit_text': 'Submit', 'logo_uri': ''}
2015-08-20 16:31:26,684 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:26] "GET /authorization?response_type=code&client_id=Nf1JRkv9cLWI&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=orbzhEyq96LoCh3M&state=5hyJLOYJLi3x8cGs HTTP/1.1" 200 -
2015-08-20 16:31:26,716 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:26] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:31:35,303 oic.utils.authn.user:DEBUG verify(query=response_type%3Dcode%26client_id%3DNf1JRkv9cLWI%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26nonce%3DorbzhEyq96LoCh3M%26state%3D5hyJLOYJLi3x8cGs&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:31:35,303 oic.utils.authn.user:DEBUG dict: {'login': ['diana'], 'query': ['response_type=code&client_id=Nf1JRkv9cLWI&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=orbzhEyq96LoCh3M&state=5hyJLOYJLi3x8cGs'], 'form.commit': ['Submit'], 'password': ['krall']}
2015-08-20 16:31:35,304 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'babs': 'howes', 'upper': 'crust'}
2015-08-20 16:31:35,306 oic.utils.authn.user:DEBUG kwargs: {'response_type': ['code'], 'upm_answer': 'true', 'client_id': ['Nf1JRkv9cLWI'], 'state': ['5hyJLOYJLi3x8cGs'], 'nonce': ['orbzhEyq96LoCh3M'], 'scope': ['openid profile email address phone'], 'redirect_uri': ['https://localhost:8666/authz_cb']}
2015-08-20 16:31:35,309 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:35] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:31:35,332 oic.oauth2.provider:DEBUG Request: 'response_type=code&upm_answer=true&client_id=Nf1JRkv9cLWI&state=5hyJLOYJLi3x8cGs&nonce=orbzhEyq96LoCh3M&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-20 16:31:35,334 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105a8cfd0>, <jwkest.jwk.RSAKey object at 0x10552a080>, <jwkest.jwk.ECKey object at 0x10552a400>]
2015-08-20 16:31:35,334 oic.oauth2.provider:DEBUG AuthzRequest: {'response_type': 'code', 'upm_answer': 'true', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'nonce': 'orbzhEyq96LoCh3M', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:35,336 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'response_type': 'code', 'upm_answer': 'true', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'nonce': 'orbzhEyq96LoCh3M', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:35,338 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:31:35,341 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:31:35,341 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:31:35,342 oic.oic.provider:DEBUG AREQ keys: ['response_type', 'upm_answer', 'client_id', 'state', 'nonce', 'scope', 'redirect_uri']
2015-08-20 16:31:35,343 oic.utils.sdb:DEBUG uid2sid: {'diana': ['088e8e3d5653ee56ba884477334ab3fe5edb7dd4aa666b42f5f7e5e5']}
2015-08-20 16:31:35,343 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:31:35,344 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:31:35,347 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?code=hRlIhoMhn%2Flj3AKXA8aarGZLF2PPQe2TT5J%2FQ6rgMZ7G%2BG7OqXL0cwaAIpDrcvoV7y5PKQo0FoBnet8NaSOayCcefViAgScMTytk1uDXPJA%3D&state=5hyJLOYJLi3x8cGs&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:31:35,350 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:35] "GET /authorization?response_type=code&upm_answer=true&client_id=Nf1JRkv9cLWI&state=5hyJLOYJLi3x8cGs&nonce=orbzhEyq96LoCh3M&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 302 -
2015-08-20 16:31:39,396 oic.oic.provider:DEBUG - token -
2015-08-20 16:31:39,396 oic.oic.provider:INFO token_request: token_type=pop&code=hRlIhoMhn%2Flj3AKXA8aarGZLF2PPQe2TT5J%2FQ6rgMZ7G%2BG7OqXL0cwaAIpDrcvoV7y5PKQo0FoBnet8NaSOayCcefViAgScMTytk1uDXPJA%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_secret=939481e0b64497bb7c240ef351ee69c3ff342acd73c9d2b4072773af&client_id=Nf1JRkv9cLWI&key=eyJraWQiOiAiYTAiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWcifQ%3D%3D&grant_type=authorization_code
2015-08-20 16:31:39,397 oic.oic.provider:DEBUG AccessTokenRequest: {'grant_type': 'authorization_code', 'client_id': 'Nf1JRkv9cLWI', 'key': 'eyJraWQiOiAiYTAiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWcifQ==', 'code': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoV7y5PKQo0FoBnet8NaSOayCcefViAgScMTytk1uDXPJA=', 'client_secret': '939481e0b64497bb7c240ef351ee69c3ff342acd73c9d2b4072773af', 'token_type': 'pop', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:39,397 oic.utils.authn.client:DEBUG REQ: {'grant_type': 'authorization_code', 'client_id': 'Nf1JRkv9cLWI', 'key': 'eyJraWQiOiAiYTAiLCAicSI6ICI2aERZMTdBdTEtd0pkVUk5U0pndnA3UFFpcU9kdzdNSHZ2bFI5czZwQ3IxVXY1eVBxY3ZSUDgzSlFPQzA3em1SSDBOZjdDWTFUNTFmY1A4TFZncW1xUSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJuIjogIjFfSHBWRG5reHhLam4waUNxdzNzUk5UUFZpOHJhRS1jeVhSU0Q3dkpQLW5oMEtpUWNLdmVXaGZxaUpKQkZ3aHhTYVltZDY4T1FRNGo2X3VoZXBKNGh6UzB6X25FVFJYSnNlb0JjSnl0UXZ5SmpfY2pxc2xFam9zQkdlOTQ4OC1IZVFJNW04NkZZV3h5bTJ1dWdyYUFqTlREUk8xOG5RVDJSTTFhM3ZFdmI2TSIsICJlIjogIkFRQUIiLCAicCI6ICI3QzVhSHl3OEdwc2dwZTFCbUdJemRxUDJyb3NIMDJWdFFKMU92c1MtbmJ4c2YxUlUzM01vNzBLQ0ZPNGhmd1BTdTRiTk5BMzR4SHF1d2MxUmlvVHZhdyIsICJrdHkiOiAiUlNBIiwgInVzZSI6ICJzaWcifQ==', 'code': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoV7y5PKQo0FoBnet8NaSOayCcefViAgScMTytk1uDXPJA=', 'client_secret': '939481e0b64497bb7c240ef351ee69c3ff342acd73c9d2b4072773af', 'token_type': 'pop', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:39,399 oic.utils.authn.client:DEBUG Verified Client ID: Nf1JRkv9cLWI
2015-08-20 16:31:39,402 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:31:39,404 oic.oic:DEBUG authzreq: {'response_type': 'code', 'upm_answer': 'true', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'nonce': 'orbzhEyq96LoCh3M', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:39,405 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:31:39,405 oic.oic:DEBUG authzreq: {'response_type': 'code', 'upm_answer': 'true', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'nonce': 'orbzhEyq96LoCh3M', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:39,406 oic.oic.provider:DEBUG id_token: {'auth_time': 1440081095, 'sub': '19904b7cb5e0ded8', 'nonce': 'orbzhEyq96LoCh3M', 'exp': 1440160299, 'iat': 1440081099, 'iss': 'https://localhost:8092/', 'acr': 'PASSWORD', 'aud': ['Nf1JRkv9cLWI']}
2015-08-20 16:31:39,408 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "enc", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "use": "sig", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-20 16:31:39,409 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "use": "sig", "y": "1GKqezBAEG6iiEed6JdAGiVxQ8RnmUhjbBHqW3hdtd4", "crv": "P-256", "kid": "op2", "x": "depfiBSaaCegv4gCNNBCjnkL2aNBGzqJaf2Hf-ZqeA4"}]}
2015-08-20 16:31:39,409 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "EC", "use": "enc", "y": "Yoa5hEBNmZDvtqDnOhLvuXv-dEGFBVX_wcMAuOUKN-4", "crv": "P-256", "kid": "op3", "x": "xgZLTf-1zSAUcAQS4ojj7hMK8mQnRopSRkmchGe3G0Q"}]}
2015-08-20 16:31:39,410 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10552a080>]
2015-08-20 16:31:39,418 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:31:39,419 oic.oic.provider:DEBUG _tinfo: {'authzreq': '{"response_type": "code", "upm_answer": "true", "client_id": "Nf1JRkv9cLWI", "state": "5hyJLOYJLi3x8cGs", "nonce": "orbzhEyq96LoCh3M", "scope": "openid profile email address phone", "redirect_uri": "https://localhost:8666/authz_cb"}', 'access_token_scope': '?', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'sub': '19904b7cb5e0ded8', 'code': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoV7y5PKQo0FoBnet8NaSOayCcefViAgScMTytk1uDXPJA=', 'nonce': 'orbzhEyq96LoCh3M', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105a8cb00>, 'oauth_state': 'token', 'redirect_uri': 'https://localhost:8666/authz_cb', 'token_expires_at': 1440081099, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDQwMDgxMDk1LCAic3ViIjogIjE5OTA0YjdjYjVlMGRlZDgiLCAibm9uY2UiOiAib3JiemhFeXE5NkxvQ2gzTSIsICJleHAiOiAxNDQwMTYwMjk5LCAiaWF0IjogMTQ0MDA4MTA5OSwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXVkIjogWyJOZjFKUmt2OWNMV0kiXX0.ixcmEzBzHKKh02yR5Q6yWcryOEk_IH75p3VXK36pL6EHtR6ZQPx_mLDzHsQXamz2kOAnUf6mlt9Wl3MOj5LfGTDH-rk2bBhHC84lGpl_Hclc6dvb_M-1UFcYLUOdPK8gIJ00qkUyrM6gj_sZ8W6QVEVt6ki3MJyISREYgii2QQWD-ew0FGvdkNhUvUj6Omf0l-makY7Y194Z52picwShGYFA30cbAdNKRN5ocq1SLlSp0QeS8XbGO6aVHWj2qe0PZLs8pfbOZAn8WyfTZmim0joWcy2VB8AI1ysrHBoAKDrmz4iQa6OgxLUSwaQMeffInkpX_hXwsRsmGSAa2LdaMQ', 'refresh_token': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoVC1HelJ3hRj9yYgMnRw3Wo8kBFBC833mEykAwHc3v5VY=', 'permission': '', 'access_token': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoVEyDsh1vc7W5NJEL0B7C396P2fAgrf5gr+//VVp2MqtU=', 'code_used': True, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'revoked': False, 'expires_in': 3600, 'token_type': 'Bearer'}
2015-08-20 16:31:39,419 oic.oic.provider:DEBUG access_token_response: {'expires_in': 3600, 'scope': 'openid profile email address phone', 'access_token': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoVEyDsh1vc7W5NJEL0B7C396P2fAgrf5gr+//VVp2MqtU=', 'state': '5hyJLOYJLi3x8cGs', 'refresh_token': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoVC1HelJ3hRj9yYgMnRw3Wo8kBFBC833mEykAwHc3v5VY=', 'token_type': 'Bearer', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDQwMDgxMDk1LCAic3ViIjogIjE5OTA0YjdjYjVlMGRlZDgiLCAibm9uY2UiOiAib3JiemhFeXE5NkxvQ2gzTSIsICJleHAiOiAxNDQwMTYwMjk5LCAiaWF0IjogMTQ0MDA4MTA5OSwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXVkIjogWyJOZjFKUmt2OWNMV0kiXX0.ixcmEzBzHKKh02yR5Q6yWcryOEk_IH75p3VXK36pL6EHtR6ZQPx_mLDzHsQXamz2kOAnUf6mlt9Wl3MOj5LfGTDH-rk2bBhHC84lGpl_Hclc6dvb_M-1UFcYLUOdPK8gIJ00qkUyrM6gj_sZ8W6QVEVt6ki3MJyISREYgii2QQWD-ew0FGvdkNhUvUj6Omf0l-makY7Y194Z52picwShGYFA30cbAdNKRN5ocq1SLlSp0QeS8XbGO6aVHWj2qe0PZLs8pfbOZAn8WyfTZmim0joWcy2VB8AI1ysrHBoAKDrmz4iQa6OgxLUSwaQMeffInkpX_hXwsRsmGSAa2LdaMQ'}
2015-08-20 16:31:39,431 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:31:39,433 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:39] "POST /token HTTP/1.1" 200 -
2015-08-20 16:31:39,475 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:39] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:31:40,816 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-20 16:31:40,819 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-20 16:31:40,819 oic.oic.provider:DEBUG access_token type: 'T'
2015-08-20 16:31:40,820 oic.oic:DEBUG authzreq: {'response_type': 'code', 'upm_answer': 'true', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'nonce': 'orbzhEyq96LoCh3M', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:31:40,821 oic.oic.provider:DEBUG userinfo_claim: {'profile': None, 'zoneinfo': None, 'middle_name': None, 'address': None, 'locale': None, 'updated_at': None, 'sub': None, 'nickname': None, 'picture': None, 'website': None, 'preferred_username': None, 'phone_number': None, 'name': None, 'email_verified': None, 'given_name': None, 'gender': None, 'phone_number_verified': None, 'family_name': None, 'birthdate': None, 'email': None}
2015-08-20 16:31:40,821 oic.oic.provider:DEBUG Session info: {'authzreq': '{"response_type": "code", "upm_answer": "true", "client_id": "Nf1JRkv9cLWI", "state": "5hyJLOYJLi3x8cGs", "nonce": "orbzhEyq96LoCh3M", "scope": "openid profile email address phone", "redirect_uri": "https://localhost:8666/authz_cb"}', 'access_token_scope': '?', 'client_id': 'Nf1JRkv9cLWI', 'state': '5hyJLOYJLi3x8cGs', 'sub': '19904b7cb5e0ded8', 'code': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoV7y5PKQo0FoBnet8NaSOayCcefViAgScMTytk1uDXPJA=', 'nonce': 'orbzhEyq96LoCh3M', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105a8cb00>, 'oauth_state': 'token', 'redirect_uri': 'https://localhost:8666/authz_cb', 'token_expires_at': 1440081099, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDQwMDgxMDk1LCAic3ViIjogIjE5OTA0YjdjYjVlMGRlZDgiLCAibm9uY2UiOiAib3JiemhFeXE5NkxvQ2gzTSIsICJleHAiOiAxNDQwMTYwMjk5LCAiaWF0IjogMTQ0MDA4MTA5OSwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJhY3IiOiAiUEFTU1dPUkQiLCAiYXVkIjogWyJOZjFKUmt2OWNMV0kiXX0.ixcmEzBzHKKh02yR5Q6yWcryOEk_IH75p3VXK36pL6EHtR6ZQPx_mLDzHsQXamz2kOAnUf6mlt9Wl3MOj5LfGTDH-rk2bBhHC84lGpl_Hclc6dvb_M-1UFcYLUOdPK8gIJ00qkUyrM6gj_sZ8W6QVEVt6ki3MJyISREYgii2QQWD-ew0FGvdkNhUvUj6Omf0l-makY7Y194Z52picwShGYFA30cbAdNKRN5ocq1SLlSp0QeS8XbGO6aVHWj2qe0PZLs8pfbOZAn8WyfTZmim0joWcy2VB8AI1ysrHBoAKDrmz4iQa6OgxLUSwaQMeffInkpX_hXwsRsmGSAa2LdaMQ', 'refresh_token': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoVC1HelJ3hRj9yYgMnRw3Wo8kBFBC833mEykAwHc3v5VY=', 'permission': '', 'access_token': 'hRlIhoMhn/lj3AKXA8aarGZLF2PPQe2TT5J/Q6rgMZ7G+G7OqXL0cwaAIpDrcvoVEyDsh1vc7W5NJEL0B7C396P2fAgrf5gr+//VVp2MqtU=', 'code_used': True, 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'revoked': False, 'expires_in': 3600, 'token_type': 'Bearer'}
2015-08-20 16:31:40,821 oic.oic.provider:DEBUG user_info_response: {'name': 'Diana Krall', 'sub': '19904b7cb5e0ded8', 'email_verified': False, 'given_name': 'Diana', 'phone_number': '+46 90 7865000', 'nickname': 'Dina', 'address': {'locality': 'Ume', 'country': 'Sweden', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187'}, 'family_name': 'Krall', 'email': 'diana@example.org'}
2015-08-20 16:31:40,824 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:31:40] "POST /userinfo HTTP/1.1" 200 -
2015-08-20 16:31:52,740 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:31:52,852 werkzeug:INFO  * Restarting with stat
2015-08-20 16:31:54,902 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1"}]}
2015-08-20 16:31:54,903 root:INFO OC3 server keys: {"keys": [{"y": "t311W86kdJWFYHSjLSj_xVd1J61vL9d7ppKWk4Qzfc0", "use": "sig", "kty": "EC", "x": "kKnGyh3_XuqZjx8UlS1v_e7lF6wDq959iusglGwOHPI", "crv": "P-256", "kid": "op2"}]}
2015-08-20 16:31:54,903 root:INFO OC3 server keys: {"keys": [{"y": "7MufWvYgeWGZdLgUYTlq0_TIX6zpUBEa126jgn5lvNc", "use": "enc", "kty": "EC", "x": "KF70YoAzJAOSb-ya5zjEQBzPaYEsC_2WoCMX1VVLvEs", "crv": "P-256", "kid": "op3"}]}
2015-08-20 16:32:01,068 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:32:01,207 werkzeug:INFO  * Restarting with stat
2015-08-20 16:32:03,196 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "use": "enc", "kid": "op0"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kty": "RSA", "use": "sig", "kid": "op1"}]}
2015-08-20 16:32:03,196 root:INFO OC3 server keys: {"keys": [{"x": "JjtGcN9V6Jp5hKPKWO0tjQLaxVjP3SeXWcNuMl_pVD8", "y": "1cSVK0HGz2PTe0gBBSrcyAMGkqoI0ieVM90EQ5hHegU", "kty": "EC", "kid": "op2", "use": "sig", "crv": "P-256"}]}
2015-08-20 16:32:03,197 root:INFO OC3 server keys: {"keys": [{"x": "MFaZDDRC2_5furQat5AGMJJMVsXFpT3O-pnKTIMQsG4", "y": "bM2CVci5TwNmXrgUtcJdluy-u17VWskRY5rP2SWv3oo", "kty": "EC", "kid": "op3", "use": "enc", "crv": "P-256"}]}
2015-08-20 16:32:33,807 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:32:33,879 werkzeug:INFO  * Restarting with stat
2015-08-20 16:32:35,509 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "enc", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "use": "sig", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 16:32:35,509 root:INFO OC3 server keys: {"keys": [{"kid": "op2", "kty": "EC", "x": "MH1h1N1ysdOwOU-2zqF6E4lVQMW_gnE0golNSf13BtI", "y": "lYGXEpVbctbaR2UMoNDfrep5I6wMkct7IJBz-aEhvC8", "crv": "P-256", "use": "sig"}]}
2015-08-20 16:32:35,510 root:INFO OC3 server keys: {"keys": [{"kid": "op3", "kty": "EC", "x": "iH7YGH4PIbLZ4QtBd6Pof0nPF1dDqlXqmN4tu0Ou82Q", "y": "wgji1FqsxjjcmtqltNnQ3ZKY-_9RJHIkZkLlsZZ49jo", "crv": "P-256", "use": "enc"}]}
2015-08-20 16:32:43,718 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:32:43,812 werkzeug:INFO  * Restarting with stat
2015-08-20 16:32:45,570 root:INFO OC3 server keys: {"keys": [{"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "e": "AQAB", "kty": "RSA"}, {"q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "e": "AQAB", "kty": "RSA"}]}
2015-08-20 16:32:45,570 root:INFO OC3 server keys: {"keys": [{"x": "Z6o81HD1JVu5mfRcHa9qsJZqyxdqIwQizyDc0dxkp7Q", "use": "sig", "crv": "P-256", "y": "4frSDZESlfIDWJ2WMEuxnxABH4muiOyw4cZYKEPb4DY", "kid": "op2", "kty": "EC"}]}
2015-08-20 16:32:45,571 root:INFO OC3 server keys: {"keys": [{"x": "xkrN_PKI2KOv80ufahnWzTJLS1IL6iyytawBjlMPzN0", "use": "enc", "crv": "P-256", "y": "3oRVqVYQ0wS55-iuHHXTiGrKqHUUzejzvf-XSDkY8j0", "kid": "op3", "kty": "EC"}]}
2015-08-20 16:32:48,501 root:INFO OC3 server keys: {"keys": [{"use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "kid": "op0", "e": "AQAB"}, {"use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "kid": "op1", "e": "AQAB"}]}
2015-08-20 16:32:48,502 root:INFO OC3 server keys: {"keys": [{"use": "sig", "kid": "op2", "kty": "EC", "x": "14Y6VSp0IwZbLIWqfO3OxQWXmMA3DyL2fcrrCjmzzHY", "crv": "P-256", "y": "bM4D4FAmJndwGDoNmlQo6qO9A51wwt35RF4F6mcGPkY"}]}
2015-08-20 16:32:48,502 root:INFO OC3 server keys: {"keys": [{"use": "enc", "kid": "op3", "kty": "EC", "x": "2ke1XOIkpHtlLv_dx_m4r6iym5AQaqAjm5DdrARQGZ0", "crv": "P-256", "y": "96-jLy9fYUH_NoDGYC0XJOWVWmVPPdt42ulAsilXIwQ"}]}
2015-08-20 16:32:48,535 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:32:48,540 werkzeug:INFO  * Restarting with stat
2015-08-20 16:32:50,736 root:INFO OC3 server keys: {"keys": [{"use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 16:32:50,737 root:INFO OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "y": "tSKxE7fqQ_qc8zbecDfgBjD1fqtH0LZQLY77a3C3m_0", "kid": "op2", "kty": "EC", "x": "N2ahFyNLL7HlKbxKpKyWuTrdcQSnhwxNk1XfUiArbPg"}]}
2015-08-20 16:32:50,737 root:INFO OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "y": "UUewgI7sE4FUm6H6jbTZa0NhUeILLiLB36Bda7qDv3Q", "kid": "op3", "kty": "EC", "x": "w7WkMyDVRKZxjKXx1YcDNdEHQnrFqTaSWPXOnoTJVb0"}]}
2015-08-20 16:32:57,075 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:32:57] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:32:57,097 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:32:57,097 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:32:57,098 oic.oic.provider:INFO provider_info_response: {'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['RS384', 'ES256', 'RS256', 'HS512', 'ES384', 'PS256', 'RS512', 'none', 'PS512', 'HS384', 'HS256', 'ES512', 'PS384'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'require_request_uri_registration': True, 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'version': '3.0', 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'claims_parameter_supported': True, 'claims_supported': ['address', 'phone_number_verified', 'email_verified', 'profile', 'name', 'family_name', 'sub', 'website', 'preferred_username', 'given_name', 'email', 'gender', 'phone_number', 'middle_name', 'picture', 'birthdate', 'nickname', 'zoneinfo', 'updated_at', 'locale'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'token_endpoint': 'https://localhost:8092/token', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_signing_alg_values_supported': ['RS384', 'ES256', 'RS256', 'HS512', 'ES384', 'PS256', 'RS512', 'none', 'PS512', 'HS384', 'HS256', 'ES512', 'PS384'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'scopes_supported': ['address', 'email', 'openid', 'profile', 'phone', 'offline_access', 'openid'], 'registration_endpoint': 'https://localhost:8092/registration', 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'token_endpoint_auth_signing_alg_values_supported': ['RS384', 'ES256', 'RS256', 'HS512', 'ES384', 'PS256', 'RS512', 'PS512', 'HS384', 'HS256', 'ES512', 'PS384'], 'subject_types_supported': ['public', 'pairwise'], 'acr_values_supported': ['PASSWORD'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'request_parameter_supported': True, 'issuer': 'https://localhost:8092/', 'request_uri_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_object_signing_alg_values_supported': ['RS384', 'ES256', 'RS256', 'HS512', 'ES384', 'PS256', 'RS512', 'none', 'PS512', 'HS384', 'HS256', 'ES512', 'PS384']}
2015-08-20 16:32:57,099 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:32:57] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:32:57,167 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "application_type": "web", "redirect_uris": ["https://localhost:8666/authz_cb"], "response_types": ["code"], "contacts": ["ops@example.com"]}>>
2015-08-20 16:32:57,167 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:32:57,174 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'BUuoxD576aa2gdTKR5eheAfmQpmecNvA', 'client_id': '7kQza7XgTVqR', 'registration_client_uri': 'https://localhost:8092/registration?client_id=7kQza7XgTVqR', 'client_id_issued_at': 1440077577, 'client_secret': '0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae', 'client_secret_expires_at': 1440163977}
2015-08-20 16:32:57,176 oic.utils.keyio:DEBUG loading keys for issuer: 7kQza7XgTVqR
2015-08-20 16:32:57,176 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:32:57,176 oic.oic.provider:DEBUG keys for 7kQza7XgTVqR: []
2015-08-20 16:32:57,179 oic.oic.provider:INFO Client info: {'registration_access_token': 'BUuoxD576aa2gdTKR5eheAfmQpmecNvA', 'client_id': '7kQza7XgTVqR', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'registration_client_uri': 'https://localhost:8092/registration?client_id=7kQza7XgTVqR', 'contacts': ['ops@example.com'], 'client_id_issued_at': 1440077577, 'application_type': 'web', 'client_secret': '0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae', 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'client_secret_expires_at': 1440163977, 'response_types': ['code']}
2015-08-20 16:32:57,179 oic.oic.provider:DEBUG registration_response: {'registration_access_token': 'BUuoxD576aa2gdTKR5eheAfmQpmecNvA', 'client_id': '7kQza7XgTVqR', 'response_types': ['code'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'registration_client_uri': 'https://localhost:8092/registration?client_id=7kQza7XgTVqR', 'client_id_issued_at': 1440077577, 'application_type': 'web', 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'client_secret_expires_at': 1440163977, 'client_secret': '0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae'}
2015-08-20 16:32:57,180 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:32:57] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:32:57,204 oic.oauth2.provider:DEBUG Request: 'client_id=7kQza7XgTVqR&response_type=code&state=nQrmugiBMparhnUC&nonce=fsjOfDpFNqkXkkkO&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-20 16:32:57,206 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105accd68>, <jwkest.jwk.RSAKey object at 0x105565eb8>, <jwkest.jwk.ECKey object at 0x10556c2b0>]
2015-08-20 16:32:57,206 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'nonce': 'fsjOfDpFNqkXkkkO', 'state': 'nQrmugiBMparhnUC', 'scope': 'openid profile email address phone'}
2015-08-20 16:32:57,209 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'nonce': 'fsjOfDpFNqkXkkkO', 'state': 'nQrmugiBMparhnUC', 'scope': 'openid profile email address phone'}
2015-08-20 16:32:57,211 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:32:57,212 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:32:57,212 oic.utils.authn.user:INFO do_authentication argv: {'action': 'https://localhost:8092/verify', 'login_title': 'Username', 'acr': '', 'query': 'client_id=7kQza7XgTVqR&response_type=code&state=nQrmugiBMparhnUC&nonce=fsjOfDpFNqkXkkkO&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb', 'login': '', 'logo_uri': '', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'password': '', 'submit_text': 'Submit', 'policy_uri': '', 'title': 'User log in', 'tos_uri': ''}
2015-08-20 16:32:57,217 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:32:57] "GET /authorization?client_id=7kQza7XgTVqR&response_type=code&state=nQrmugiBMparhnUC&nonce=fsjOfDpFNqkXkkkO&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 200 -
2015-08-20 16:32:57,232 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:32:57] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:33:00,969 oic.utils.authn.user:DEBUG verify(query=client_id%3D7kQza7XgTVqR%26response_type%3Dcode%26state%3DnQrmugiBMparhnUC%26nonce%3DfsjOfDpFNqkXkkkO%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:33:00,969 oic.utils.authn.user:DEBUG dict: {'password': ['krall'], 'query': ['client_id=7kQza7XgTVqR&response_type=code&state=nQrmugiBMparhnUC&nonce=fsjOfDpFNqkXkkkO&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-20 16:33:00,970 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'upper': 'crust', 'diana': 'krall'}
2015-08-20 16:33:00,972 oic.utils.authn.user:DEBUG kwargs: {'redirect_uri': ['https://localhost:8666/authz_cb'], 'client_id': ['7kQza7XgTVqR'], 'response_type': ['code'], 'nonce': ['fsjOfDpFNqkXkkkO'], 'state': ['nQrmugiBMparhnUC'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true'}
2015-08-20 16:33:00,975 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:00] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:33:00,998 oic.oauth2.provider:DEBUG Request: 'redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=7kQza7XgTVqR&response_type=code&nonce=fsjOfDpFNqkXkkkO&state=nQrmugiBMparhnUC&scope=openid+profile+email+address+phone&upm_answer=true'
2015-08-20 16:33:00,999 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x105accd68>, <jwkest.jwk.RSAKey object at 0x105565eb8>, <jwkest.jwk.ECKey object at 0x10556c2b0>]
2015-08-20 16:33:01,000 oic.oauth2.provider:DEBUG AuthzRequest: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'nonce': 'fsjOfDpFNqkXkkkO', 'state': 'nQrmugiBMparhnUC', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-20 16:33:01,001 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'nonce': 'fsjOfDpFNqkXkkkO', 'state': 'nQrmugiBMparhnUC', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-20 16:33:01,003 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:33:01,004 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:33:01,004 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:33:01,005 oic.oic.provider:DEBUG AREQ keys: ['redirect_uri', 'client_id', 'response_type', 'nonce', 'state', 'scope', 'upm_answer']
2015-08-20 16:33:01,006 oic.utils.sdb:DEBUG uid2sid: {'diana': ['ef46df8f121d5fd62aa04a43584d5474f27d797c8b7a17d51d34ad25']}
2015-08-20 16:33:01,006 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:33:01,006 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:33:01,012 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?code=Q%2FFaB2JB%2FE%2FCbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5em3o6mhG35xl7DA%2FG90m5EcNHIpRACfHLDN4LuxtbeM%3D&state=nQrmugiBMparhnUC&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:33:01,015 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:01] "GET /authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&client_id=7kQza7XgTVqR&response_type=code&nonce=fsjOfDpFNqkXkkkO&state=nQrmugiBMparhnUC&scope=openid+profile+email+address+phone&upm_answer=true HTTP/1.1" 302 -
2015-08-20 16:33:31,393 oic.oic.provider:DEBUG - token -
2015-08-20 16:33:31,394 oic.oic.provider:INFO token_request: code=Q%2FFaB2JB%2FE%2FCbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5em3o6mhG35xl7DA%2FG90m5EcNHIpRACfHLDN4LuxtbeM%3D&client_secret=0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae&grant_type=authorization_code&key=eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&client_id=7kQza7XgTVqR&token_type=pop&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-20 16:33:31,395 oic.oic.provider:DEBUG AccessTokenRequest: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'grant_type': 'authorization_code', 'key': 'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'code': 'Q/FaB2JB/E/CbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5em3o6mhG35xl7DA/G90m5EcNHIpRACfHLDN4LuxtbeM=', 'client_secret': '0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae', 'token_type': 'pop'}
2015-08-20 16:33:31,395 oic.utils.authn.client:DEBUG REQ: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'grant_type': 'authorization_code', 'key': 'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'code': 'Q/FaB2JB/E/CbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5em3o6mhG35xl7DA/G90m5EcNHIpRACfHLDN4LuxtbeM=', 'client_secret': '0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae', 'token_type': 'pop'}
2015-08-20 16:33:31,396 oic.utils.authn.client:DEBUG Verified Client ID: 7kQza7XgTVqR
2015-08-20 16:33:31,400 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:33:31,403 oic.oic:DEBUG authzreq: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'nonce': 'fsjOfDpFNqkXkkkO', 'state': 'nQrmugiBMparhnUC', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-20 16:33:31,403 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:33:31,404 oic.oic:DEBUG authzreq: {'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'nonce': 'fsjOfDpFNqkXkkkO', 'state': 'nQrmugiBMparhnUC', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-20 16:33:31,404 oic.oic.provider:DEBUG id_token: {'auth_time': 1440081180, 'iat': 1440081211, 'nonce': 'fsjOfDpFNqkXkkkO', 'acr': 'PASSWORD', 'exp': 1440160411, 'iss': 'https://localhost:8092/', 'sub': '5ecb4ed3fdb81781', 'aud': ['7kQza7XgTVqR']}
2015-08-20 16:33:31,407 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 16:33:31,408 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "sig", "crv": "P-256", "y": "tSKxE7fqQ_qc8zbecDfgBjD1fqtH0LZQLY77a3C3m_0", "kid": "op2", "kty": "EC", "x": "N2ahFyNLL7HlKbxKpKyWuTrdcQSnhwxNk1XfUiArbPg"}]}
2015-08-20 16:33:31,408 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "crv": "P-256", "y": "UUewgI7sE4FUm6H6jbTZa0NhUeILLiLB36Bda7qDv3Q", "kid": "op3", "kty": "EC", "x": "w7WkMyDVRKZxjKXx1YcDNdEHQnrFqTaSWPXOnoTJVb0"}]}
2015-08-20 16:33:31,409 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x105565eb8>]
2015-08-20 16:33:31,416 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:33:31,417 oic.oic.provider:DEBUG _tinfo: {'redirect_uri': 'https://localhost:8666/authz_cb', 'refresh_token': 'Q/FaB2JB/E/CbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5mQ1Vsv8O70E4paszNDqGvi+oOGBbC9XIJsIRDxt9lx8=', 'nonce': 'fsjOfDpFNqkXkkkO', 'access_token_scope': '?', 'code': 'Q/FaB2JB/E/CbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5em3o6mhG35xl7DA/G90m5EcNHIpRACfHLDN4LuxtbeM=', 'permission': '', 'oauth_state': 'token', 'code_used': True, 'sub': '5ecb4ed3fdb81781', 'expires_in': 3600, 'client_id': '7kQza7XgTVqR', 'authzreq': '{"redirect_uri": "https://localhost:8666/authz_cb", "client_id": "7kQza7XgTVqR", "response_type": "code", "nonce": "fsjOfDpFNqkXkkkO", "state": "nQrmugiBMparhnUC", "scope": "openid profile email address phone", "upm_answer": "true"}', 'token_expires_at': 1440081211, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDQwMDgxMTgwLCAiaWF0IjogMTQ0MDA4MTIxMSwgIm5vbmNlIjogImZzak9mRHBGTnFrWGtra08iLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0NDAxNjA0MTEsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAic3ViIjogIjVlY2I0ZWQzZmRiODE3ODEiLCAiYXVkIjogWyI3a1F6YTdYZ1RWcVIiXX0.OCf8WtblLbt1_vxWOQl2wwgIyEQ6X9zMLUFrph1tU66Ja01IqdjkgDzA6TNI6wfjj5jgs7IoTDs6fLXTM8mX7oW7ciVuLpaydeYh8spfc7YuLiNpIZkIjDr1atsZL223iyEeRzT4E7SZ8fMLixaO2WGPkQqFMf98Q7lkCFrXJdI2lumfn6n0b2TtfsItl_qyhncZ7Z4SM89ijX7dCZXllvwYoTW3QqzTk_EMDuJ08t0v4Yek8rkv__7LswC170ndilxTO-vbf0zIzT6-ARfebmQyyJigehTS7QTLqHF7wRgoI1jMbAiWEdmuyULwXQOwsZIKw9nJSuvTn-IpKf_g-g', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x105af10f0>, 'state': 'nQrmugiBMparhnUC', 'access_token': 'Q/FaB2JB/E/CbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5evL2SQYjpl7fkq18ItG877aFtzprexnMb4qpoJmVFIA=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'revoked': False, 'token_type': 'Bearer'}
2015-08-20 16:33:31,418 oic.oic.provider:DEBUG access_token_response: {'token_type': 'Bearer', 'refresh_token': 'Q/FaB2JB/E/CbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5mQ1Vsv8O70E4paszNDqGvi+oOGBbC9XIJsIRDxt9lx8=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJhdXRoX3RpbWUiOiAxNDQwMDgxMTgwLCAiaWF0IjogMTQ0MDA4MTIxMSwgIm5vbmNlIjogImZzak9mRHBGTnFrWGtra08iLCAiYWNyIjogIlBBU1NXT1JEIiwgImV4cCI6IDE0NDAxNjA0MTEsICJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAic3ViIjogIjVlY2I0ZWQzZmRiODE3ODEiLCAiYXVkIjogWyI3a1F6YTdYZ1RWcVIiXX0.OCf8WtblLbt1_vxWOQl2wwgIyEQ6X9zMLUFrph1tU66Ja01IqdjkgDzA6TNI6wfjj5jgs7IoTDs6fLXTM8mX7oW7ciVuLpaydeYh8spfc7YuLiNpIZkIjDr1atsZL223iyEeRzT4E7SZ8fMLixaO2WGPkQqFMf98Q7lkCFrXJdI2lumfn6n0b2TtfsItl_qyhncZ7Z4SM89ijX7dCZXllvwYoTW3QqzTk_EMDuJ08t0v4Yek8rkv__7LswC170ndilxTO-vbf0zIzT6-ARfebmQyyJigehTS7QTLqHF7wRgoI1jMbAiWEdmuyULwXQOwsZIKw9nJSuvTn-IpKf_g-g', 'state': 'nQrmugiBMparhnUC', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'access_token': 'Q/FaB2JB/E/CbwW5mWGnyVzs9D7jxk6TZPr6HBPBdVLPileAbGlhcGbRGBM9EaM5evL2SQYjpl7fkq18ItG877aFtzprexnMb4qpoJmVFIA='}
2015-08-20 16:33:31,428 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:33:31,430 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:31] "POST /token HTTP/1.1" 200 -
2015-08-20 16:33:31,456 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:31] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:33:31,490 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:31] "POST /userinfo HTTP/1.1" 405 -
2015-08-20 16:33:47,928 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:33:48,011 werkzeug:INFO  * Restarting with stat
2015-08-20 16:33:49,683 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA"}, {"use": "sig", "e": "AQAB", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA"}]}
2015-08-20 16:33:49,684 root:INFO OC3 server keys: {"keys": [{"use": "sig", "x": "g2oOFs-_ga25-sHpvq7Q5ecpgPI3aHH7iJkfaRqYUR0", "crv": "P-256", "kid": "op2", "y": "nKza1ca0FruuNtn5zNqpPV3Iu0q5KQGxI9MhVZdD1zM", "kty": "EC"}]}
2015-08-20 16:33:49,685 root:INFO OC3 server keys: {"keys": [{"use": "enc", "x": "hwusbBap2WXiFncbsLDIFzpU8tBfBKL0xAr6CxpvQLs", "crv": "P-256", "kid": "op3", "y": "-AnWOV4ubJPvNDO583sCe7MKD_fgWgWrLHFyMiR49sw", "kty": "EC"}]}
2015-08-20 16:33:51,608 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}, {"e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ"}]}
2015-08-20 16:33:51,608 root:INFO OC3 server keys: {"keys": [{"y": "wRBCpn_C0KMqACSC1nznE-MeIK88bDunEgjFZaBHpD0", "use": "sig", "kid": "op2", "kty": "EC", "crv": "P-256", "x": "vY_EjHyvnjqpDvly2Y5VRg--zgDalsuYRaQy0FkTEsI"}]}
2015-08-20 16:33:51,609 root:INFO OC3 server keys: {"keys": [{"y": "YRaRYGAR7uWusATd0pbVvxkQPchi0aXAXT2avdlmC5c", "use": "enc", "kid": "op3", "kty": "EC", "crv": "P-256", "x": "Srzk8JEkXOYajKCvN7G3uSILSfjYVyJ5mq87S2mPGDo"}]}
2015-08-20 16:33:51,631 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:33:51,636 werkzeug:INFO  * Restarting with stat
2015-08-20 16:33:53,330 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "kid": "op0", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kty": "RSA", "kid": "op1", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:33:53,331 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "kid": "op2", "use": "sig", "x": "Pt6e0Q5G1Q7jD7nfVG8KCQ_TD9PsSbX9LUjo7zZCM1k", "y": "npb1bV2473gdcXlnA9zIwtCkYkuqMmPdETq4wEcnAVI"}]}
2015-08-20 16:33:53,331 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "kid": "op3", "use": "enc", "x": "hjoqGshJ_y0jSlraqobt3Hm0PyrWB3U925ViEcW-rtY", "y": "31hHGd4sPpztb0BjxjiVzEmMSDSlQVecwQ0NILVyJjM"}]}
2015-08-20 16:33:59,007 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:59] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:33:59,029 oic.oauth2.provider:DEBUG Request: 'client_id=7kQza7XgTVqR&response_type=code&state=FOkmKfLFhcs4sFWs&nonce=lEETxhrxvJcedIT4&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-20 16:33:59,031 oic.oic:DEBUG verify keys: [<jwkest.jwk.RSAKey object at 0x105564e80>, <jwkest.jwk.ECKey object at 0x10556b320>]
2015-08-20 16:33:59,032 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'FOkmKfLFhcs4sFWs', 'nonce': 'lEETxhrxvJcedIT4', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '7kQza7XgTVqR', 'scope': 'openid profile email address phone'}
2015-08-20 16:33:59,034 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'FOkmKfLFhcs4sFWs', 'nonce': 'lEETxhrxvJcedIT4', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '7kQza7XgTVqR', 'scope': 'openid profile email address phone'}
2015-08-20 16:33:59,036 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:33:59,037 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:33:59,038 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'passwd_title': 'Password', 'password': '', 'tos_uri': '', 'action': 'https://localhost:8092/verify', 'acr': '', 'login_title': 'Username', 'client_policy_title': 'Client Policy', 'login': '', 'logo_uri': '', 'title': 'User log in', 'policy_uri': '', 'query': 'client_id=7kQza7XgTVqR&response_type=code&state=FOkmKfLFhcs4sFWs&nonce=lEETxhrxvJcedIT4&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'}
2015-08-20 16:33:59,043 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:59] "GET /authorization?client_id=7kQza7XgTVqR&response_type=code&state=FOkmKfLFhcs4sFWs&nonce=lEETxhrxvJcedIT4&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 200 -
2015-08-20 16:33:59,062 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:33:59] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:34:02,962 oic.utils.authn.user:DEBUG verify(query=client_id%3D7kQza7XgTVqR%26response_type%3Dcode%26state%3DFOkmKfLFhcs4sFWs%26nonce%3DlEETxhrxvJcedIT4%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:34:02,963 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'login': ['diana'], 'query': ['client_id=7kQza7XgTVqR&response_type=code&state=FOkmKfLFhcs4sFWs&nonce=lEETxhrxvJcedIT4&scope=openid+profile+email+address+phone&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'], 'password': ['krall']}
2015-08-20 16:34:02,963 oic.utils.authn.user:DEBUG passwd: {'babs': 'howes', 'diana': 'krall', 'upper': 'crust'}
2015-08-20 16:34:02,966 oic.utils.authn.user:DEBUG kwargs: {'state': ['FOkmKfLFhcs4sFWs'], 'nonce': ['lEETxhrxvJcedIT4'], 'client_id': ['7kQza7XgTVqR'], 'response_type': ['code'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true'}
2015-08-20 16:34:02,969 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:34:02] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:34:02,985 oic.oauth2.provider:DEBUG Request: 'state=FOkmKfLFhcs4sFWs&nonce=lEETxhrxvJcedIT4&client_id=7kQza7XgTVqR&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&upm_answer=true'
2015-08-20 16:34:02,986 oic.oic:DEBUG verify keys: [<jwkest.jwk.RSAKey object at 0x105564e80>, <jwkest.jwk.ECKey object at 0x10556b320>]
2015-08-20 16:34:02,987 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'FOkmKfLFhcs4sFWs', 'nonce': 'lEETxhrxvJcedIT4', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '7kQza7XgTVqR', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-20 16:34:02,990 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'FOkmKfLFhcs4sFWs', 'nonce': 'lEETxhrxvJcedIT4', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code', 'client_id': '7kQza7XgTVqR', 'upm_answer': 'true', 'scope': 'openid profile email address phone'}
2015-08-20 16:34:02,993 oic.utils.authn.user:DEBUG kwargs: {'authorization': '', 'max_age': 0}
2015-08-20 16:34:02,995 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:34:02,995 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:34:02,996 oic.oic.provider:DEBUG AREQ keys: ['state', 'nonce', 'client_id', 'response_type', 'redirect_uri', 'scope', 'upm_answer']
2015-08-20 16:34:02,997 oic.utils.sdb:DEBUG uid2sid: {'diana': ['e1ba50c998f16ade7d0a8ac9e8841933d237bde69f6a5488a638e7c9']}
2015-08-20 16:34:02,998 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:34:02,998 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:34:03,001 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=FOkmKfLFhcs4sFWs&code=jgdQOy3LOSs%2FYJktO5zNneakkQ%2BjCzVBiy4QswextP%2BTLgezXviVQVaHSY1eIIMxwS0hq7O3mEJyQkwj5mZEUD3cYS0waD5uxfSGtb1W9V4%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:34:03,004 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:34:03] "GET /authorization?state=FOkmKfLFhcs4sFWs&nonce=lEETxhrxvJcedIT4&client_id=7kQza7XgTVqR&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&upm_answer=true HTTP/1.1" 302 -
2015-08-20 16:34:03,029 oic.oic.provider:DEBUG - token -
2015-08-20 16:34:03,030 oic.oic.provider:INFO token_request: code=jgdQOy3LOSs%2FYJktO5zNneakkQ%2BjCzVBiy4QswextP%2BTLgezXviVQVaHSY1eIIMxwS0hq7O3mEJyQkwj5mZEUD3cYS0waD5uxfSGtb1W9V4%3D&client_secret=0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae&grant_type=authorization_code&key=eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ%3D%3D&client_id=7kQza7XgTVqR&token_type=pop&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb
2015-08-20 16:34:03,031 oic.oic.provider:DEBUG AccessTokenRequest: {'code': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxwS0hq7O3mEJyQkwj5mZEUD3cYS0waD5uxfSGtb1W9V4=', 'key': 'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'grant_type': 'authorization_code', 'client_id': '7kQza7XgTVqR', 'client_secret': '0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae', 'token_type': 'pop', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:34:03,032 oic.utils.authn.client:DEBUG REQ: {'code': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxwS0hq7O3mEJyQkwj5mZEUD3cYS0waD5uxfSGtb1W9V4=', 'key': 'eyJlIjogIkFRQUIiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJxIjogIjZoRFkxN0F1MS13SmRVSTlTSmd2cDdQUWlxT2R3N01IdnZsUjlzNnBDcjFVdjV5UHFjdlJQODNKUU9DMDd6bVJIME5mN0NZMVQ1MWZjUDhMVmdxbXFRIiwgImQiOiAidjc0OXdGdm5tQndrelRwRlREMkFuVjJZX0ozRm5VbVRuZzE3RUIxZUJUSlhJRC1NZ1g4YVlFVDhLMmd5QTVHcmhnblJfbE9pQklIWnc2QWJNZ3I4bU9fVzN5UEZZamFNektvSUlPelpWNDZrQmVzbHRRZG53UWJaOC1wRXVMMjBvSWIxLWtXNHpkTGppTmpqVXNhWFc3c2FRdGcwaU0yM2dpU2FoVUxkclFFIiwgImt0eSI6ICJSU0EiLCAia2lkIjogImEwIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXcifQ==', 'grant_type': 'authorization_code', 'client_id': '7kQza7XgTVqR', 'client_secret': '0fb314f5460452db802eac3f6e73216edd56bfca4819f87f5cf1beae', 'token_type': 'pop', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:34:03,034 oic.utils.authn.client:DEBUG Verified Client ID: 7kQza7XgTVqR
2015-08-20 16:34:03,038 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:34:03,040 oic.oic:DEBUG authzreq: {'state': 'FOkmKfLFhcs4sFWs', 'nonce': 'lEETxhrxvJcedIT4', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-20 16:34:03,040 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:34:03,041 oic.oic:DEBUG authzreq: {'state': 'FOkmKfLFhcs4sFWs', 'nonce': 'lEETxhrxvJcedIT4', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-20 16:34:03,041 oic.oic.provider:DEBUG id_token: {'iss': 'https://localhost:8092/', 'iat': 1440081243, 'acr': 'PASSWORD', 'exp': 1440160443, 'aud': ['7kQza7XgTVqR'], 'auth_time': 1440081242, 'sub': '-3e95dd8b5ce21a7f', 'nonce': 'lEETxhrxvJcedIT4'}
2015-08-20 16:34:03,043 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kty": "RSA", "kid": "op0", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kty": "RSA", "kid": "op1", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:34:03,044 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "kid": "op2", "use": "sig", "x": "Pt6e0Q5G1Q7jD7nfVG8KCQ_TD9PsSbX9LUjo7zZCM1k", "y": "npb1bV2473gdcXlnA9zIwtCkYkuqMmPdETq4wEcnAVI"}]}
2015-08-20 16:34:03,044 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "kid": "op3", "use": "enc", "x": "hjoqGshJ_y0jSlraqobt3Hm0PyrWB3U925ViEcW-rtY", "y": "31hHGd4sPpztb0BjxjiVzEmMSDSlQVecwQ0NILVyJjM"}]}
2015-08-20 16:34:03,045 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x105564e80>]
2015-08-20 16:34:03,055 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:34:03,056 oic.oic.provider:DEBUG _tinfo: {'refresh_token': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxASLewulr7nwytRu9D6VBgvglstSfqQGUlBTYdeaQ/TY=', 'access_token_scope': '?', 'access_token': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxLROKuhjh81lcml4frR8OOkNSk4ZnyQn844Z/vqE+37M=', 'nonce': 'lEETxhrxvJcedIT4', 'oauth_state': 'token', 'authzreq': '{"state": "FOkmKfLFhcs4sFWs", "nonce": "lEETxhrxvJcedIT4", "redirect_uri": "https://localhost:8666/authz_cb", "response_type": "code", "client_id": "7kQza7XgTVqR", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'expires_in': 3600, 'sub': '-3e95dd8b5ce21a7f', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1055efef0>, 'state': 'FOkmKfLFhcs4sFWs', 'code': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxwS0hq7O3mEJyQkwj5mZEUD3cYS0waD5uxfSGtb1W9V4=', 'code_used': True, 'token_expires_at': 1440081243, 'redirect_uri': 'https://localhost:8666/authz_cb', 'permission': '', 'client_id': '7kQza7XgTVqR', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQ0MDA4MTI0MywgImFjciI6ICJQQVNTV09SRCIsICJleHAiOiAxNDQwMTYwNDQzLCAiYXVkIjogWyI3a1F6YTdYZ1RWcVIiXSwgImF1dGhfdGltZSI6IDE0NDAwODEyNDIsICJzdWIiOiAiLTNlOTVkZDhiNWNlMjFhN2YiLCAibm9uY2UiOiAibEVFVHhocnh2SmNlZElUNCJ9.TM1qCmg04e9Sid7_GwwXWZJbJy1JxJDu01F97GypvhCNBNlDv3HF5DbCatsVIMTy0IszAgOVhUcvCC2P43ndhztcCZXivLMqDCQJLAAaDuvksPKT80FeTgBdzHtwp0tct9u2wCe7M63okcEe1uO8oG8gQQimGAGgLx6Gz7ZKyRDl2hG_co0D3O4yILgUPBIEkhir-NcjYTGhSm7knPyuhFraObehOqwlKwOf0WxcmVOYvD1by3bblyY4KHcG2WKcKEhC9Yl2Bs4jYGuc0LWpkLoUdJMshWWYIUblXyc5MBQ6km5tYccDpGGeAa9m_KpmqQ79N9ksPMcBA8NtX75dOw', 'token_type': 'Bearer', 'scope': ['openid', 'profile', 'email', 'address', 'phone']}
2015-08-20 16:34:03,056 oic.oic.provider:DEBUG access_token_response: {'state': 'FOkmKfLFhcs4sFWs', 'refresh_token': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxASLewulr7nwytRu9D6VBgvglstSfqQGUlBTYdeaQ/TY=', 'scope': 'openid profile email address phone', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQ0MDA4MTI0MywgImFjciI6ICJQQVNTV09SRCIsICJleHAiOiAxNDQwMTYwNDQzLCAiYXVkIjogWyI3a1F6YTdYZ1RWcVIiXSwgImF1dGhfdGltZSI6IDE0NDAwODEyNDIsICJzdWIiOiAiLTNlOTVkZDhiNWNlMjFhN2YiLCAibm9uY2UiOiAibEVFVHhocnh2SmNlZElUNCJ9.TM1qCmg04e9Sid7_GwwXWZJbJy1JxJDu01F97GypvhCNBNlDv3HF5DbCatsVIMTy0IszAgOVhUcvCC2P43ndhztcCZXivLMqDCQJLAAaDuvksPKT80FeTgBdzHtwp0tct9u2wCe7M63okcEe1uO8oG8gQQimGAGgLx6Gz7ZKyRDl2hG_co0D3O4yILgUPBIEkhir-NcjYTGhSm7knPyuhFraObehOqwlKwOf0WxcmVOYvD1by3bblyY4KHcG2WKcKEhC9Yl2Bs4jYGuc0LWpkLoUdJMshWWYIUblXyc5MBQ6km5tYccDpGGeAa9m_KpmqQ79N9ksPMcBA8NtX75dOw', 'expires_in': 3600, 'access_token': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxLROKuhjh81lcml4frR8OOkNSk4ZnyQn844Z/vqE+37M=', 'token_type': 'Bearer'}
2015-08-20 16:34:03,065 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:34:03,067 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:34:03] "POST /token HTTP/1.1" 200 -
2015-08-20 16:34:03,103 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-20 16:34:03,106 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-20 16:34:03,107 oic.oic.provider:DEBUG access_token type: 'T'
2015-08-20 16:34:03,108 oic.oic:DEBUG authzreq: {'state': 'FOkmKfLFhcs4sFWs', 'nonce': 'lEETxhrxvJcedIT4', 'client_id': '7kQza7XgTVqR', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'scope': 'openid profile email address phone', 'upm_answer': 'true'}
2015-08-20 16:34:03,108 oic.oic.provider:DEBUG userinfo_claim: {'name': None, 'family_name': None, 'zoneinfo': None, 'picture': None, 'updated_at': None, 'website': None, 'profile': None, 'email': None, 'birthdate': None, 'phone_number_verified': None, 'address': None, 'given_name': None, 'locale': None, 'preferred_username': None, 'nickname': None, 'gender': None, 'sub': None, 'middle_name': None, 'phone_number': None, 'email_verified': None}
2015-08-20 16:34:03,108 oic.oic.provider:DEBUG Session info: {'refresh_token': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxASLewulr7nwytRu9D6VBgvglstSfqQGUlBTYdeaQ/TY=', 'access_token_scope': '?', 'access_token': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxLROKuhjh81lcml4frR8OOkNSk4ZnyQn844Z/vqE+37M=', 'nonce': 'lEETxhrxvJcedIT4', 'oauth_state': 'token', 'authzreq': '{"state": "FOkmKfLFhcs4sFWs", "nonce": "lEETxhrxvJcedIT4", "redirect_uri": "https://localhost:8666/authz_cb", "response_type": "code", "client_id": "7kQza7XgTVqR", "upm_answer": "true", "scope": "openid profile email address phone"}', 'revoked': False, 'expires_in': 3600, 'sub': '-3e95dd8b5ce21a7f', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x1055efef0>, 'state': 'FOkmKfLFhcs4sFWs', 'code': 'jgdQOy3LOSs/YJktO5zNneakkQ+jCzVBiy4QswextP+TLgezXviVQVaHSY1eIIMxwS0hq7O3mEJyQkwj5mZEUD3cYS0waD5uxfSGtb1W9V4=', 'code_used': True, 'token_expires_at': 1440081243, 'redirect_uri': 'https://localhost:8666/authz_cb', 'permission': '', 'client_id': '7kQza7XgTVqR', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiAiaHR0cHM6Ly9sb2NhbGhvc3Q6ODA5Mi8iLCAiaWF0IjogMTQ0MDA4MTI0MywgImFjciI6ICJQQVNTV09SRCIsICJleHAiOiAxNDQwMTYwNDQzLCAiYXVkIjogWyI3a1F6YTdYZ1RWcVIiXSwgImF1dGhfdGltZSI6IDE0NDAwODEyNDIsICJzdWIiOiAiLTNlOTVkZDhiNWNlMjFhN2YiLCAibm9uY2UiOiAibEVFVHhocnh2SmNlZElUNCJ9.TM1qCmg04e9Sid7_GwwXWZJbJy1JxJDu01F97GypvhCNBNlDv3HF5DbCatsVIMTy0IszAgOVhUcvCC2P43ndhztcCZXivLMqDCQJLAAaDuvksPKT80FeTgBdzHtwp0tct9u2wCe7M63okcEe1uO8oG8gQQimGAGgLx6Gz7ZKyRDl2hG_co0D3O4yILgUPBIEkhir-NcjYTGhSm7knPyuhFraObehOqwlKwOf0WxcmVOYvD1by3bblyY4KHcG2WKcKEhC9Yl2Bs4jYGuc0LWpkLoUdJMshWWYIUblXyc5MBQ6km5tYccDpGGeAa9m_KpmqQ79N9ksPMcBA8NtX75dOw', 'token_type': 'Bearer', 'scope': ['openid', 'profile', 'email', 'address', 'phone']}
2015-08-20 16:34:03,109 oic.oic.provider:DEBUG user_info_response: {'name': 'Diana Krall', 'family_name': 'Krall', 'email': 'diana@example.org', 'nickname': 'Dina', 'email_verified': False, 'given_name': 'Diana', 'phone_number': '+46 90 7865000', 'sub': '-3e95dd8b5ce21a7f', 'address': {'postal_code': 'SE-90187', 'country': 'Sweden', 'locality': 'Ume', 'street_address': 'Ume Universitet'}}
2015-08-20 16:34:03,113 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:34:03] "POST /userinfo HTTP/1.1" 200 -
2015-08-20 16:34:19,948 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:34:20,057 werkzeug:INFO  * Restarting with stat
2015-08-20 16:34:21,820 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "use": "enc", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "e": "AQAB", "kty": "RSA", "use": "sig", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:34:21,821 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op2", "y": "MrpYiTiKqNpjGI97IhYXvgheG1X1AzN6azJAAcGdtqc", "use": "sig", "x": "jNAQbygS41xSDTk-oAwDPv-lXZnjINsOo3QaRhLNdUg", "kty": "EC"}]}
2015-08-20 16:34:21,821 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kid": "op3", "y": "8RxibWv7hBWB1BVh0k13NAACEH9_DhJbaA5hQB-1pio", "use": "enc", "x": "e4YsWvLZFBVDI8CaCqZL8tWeVqOXuuZXvUT4pqVLJC0", "kty": "EC"}]}
2015-08-20 16:34:30,032 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:34:30,123 werkzeug:INFO  * Restarting with stat
2015-08-20 16:34:31,715 root:INFO OC3 server keys: {"keys": [{"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "use": "enc", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "use": "sig", "kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:34:31,715 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "y": "25mE7WDoLGfvBKAde9qYgbQbKBpZwwTrKKifncsO1-w", "use": "sig", "x": "sJL-9Gdgjcjt20VWGNkJeLn__CTyj3jtP37HdIjzS7A", "kty": "EC", "kid": "op2"}]}
2015-08-20 16:34:31,716 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "y": "_xF0iXP-YDJ5TdTxjIrIN4n3XDUiFun9Gpw2XulzFdw", "use": "enc", "x": "Per3rl0AoKpf9Bd7Q2mxQC8LWBeqq2RDHJy3Oz19tYQ", "kty": "EC", "kid": "op3"}]}
2015-08-20 16:34:34,813 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 16:34:34,889 werkzeug:INFO  * Restarting with stat
2015-08-20 16:34:36,562 root:INFO OC3 server keys: {"keys": [{"use": "enc", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"use": "sig", "e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:34:36,563 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "sig", "kid": "op2", "y": "jQR_XFS-Bxdys-G5TzutvCgNEv2TqdTvCkC2oF-Nxr4", "kty": "EC", "x": "kuj5nelZJ3yLR_ze6gdL4inUwEHbCS0_f1CY1_HeSEU"}]}
2015-08-20 16:34:36,563 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "use": "enc", "kid": "op3", "y": "OlSmLK6V3VoqykU-7ehVbXrprbIsVImU6ZyZqnCJlo8", "kty": "EC", "x": "Iv1VauN8TQ2i-VvICGJVo9vf1CqO6nqK0aaLYKNInXE"}]}
2015-08-20 16:51:22,397 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "kid": "op0", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"kty": "RSA", "kid": "op1", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-20 16:51:22,397 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "kid": "op2", "y": "5kadgJrPn-cXwzQL1GCbQ2NX9uy5YVhfnoo61deEkZs", "crv": "P-256", "x": "df5Eb1AeGaEoCDrxkrozt61ZS2xe8lO5WjqBSMxYm14", "use": "sig"}]}
2015-08-20 16:51:22,398 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "kid": "op3", "y": "etUpcHVhdj80dmPLunXXjsDCqozYgIh_jaWbjxxN1Cg", "crv": "P-256", "x": "4Ol9CNxBRtpy_NUjptQDrF5pSmFeSq2EAcAAhU0MnI0", "use": "enc"}]}
2015-08-20 16:58:39,526 root:INFO OC3 server keys: {"keys": [{"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "e": "AQAB", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "e": "AQAB", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:58:39,526 root:INFO OC3 server keys: {"keys": [{"x": "JIuFD15rGuH3X7ZZ7-guPHRiraaLS7ImH22kyPZCp4A", "kty": "EC", "crv": "P-256", "kid": "op2", "y": "qGdydK4RSYruL3ZVqyu0PUkGlhbIG4L4aNXlngkYVPA", "use": "sig"}]}
2015-08-20 16:58:39,527 root:INFO OC3 server keys: {"keys": [{"x": "kTANO80pnKj2qvbUG9AVvzlN-JSqWOSfFavCVyDdkY4", "kty": "EC", "crv": "P-256", "kid": "op3", "y": "zeLUQbu2tCYufn3D0QWcpPPibNgHZmO7Ny2IrB3FYJk", "use": "enc"}]}
2015-08-20 16:58:39,557 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:58:39,563 werkzeug:INFO  * Restarting with stat
2015-08-20 16:58:41,150 root:INFO OC3 server keys: {"keys": [{"e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op0", "use": "enc"}, {"e": "AQAB", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kty": "RSA", "kid": "op1", "use": "sig"}]}
2015-08-20 16:58:41,151 root:INFO OC3 server keys: {"keys": [{"y": "5M9reI1WiWBDePBi6Wanh6q9LWqd1C2hie91etHUBZY", "crv": "P-256", "x": "2xLageQbFPcraJjIyHnqRapAAOjc37lrGvqlJorKtQ4", "kty": "EC", "kid": "op2", "use": "sig"}]}
2015-08-20 16:58:41,151 root:INFO OC3 server keys: {"keys": [{"y": "7Hm8zB6RRTYJ3wvNTjqn0Bw4TjGD_Dk6tuP-6JvMFyI", "crv": "P-256", "x": "oxcoQpAJYW0qB7UDBNQH_C5O--cwvs0pdlFy0fbczro", "kty": "EC", "kid": "op3", "use": "enc"}]}
2015-08-20 16:58:48,864 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:58:48] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:58:48,883 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:58:48,883 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:58:48,884 oic.oic.provider:INFO provider_info_response: {'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'issuer': 'https://localhost:8092/', 'claims_supported': ['preferred_username', 'address', 'phone_number', 'phone_number_verified', 'nickname', 'name', 'zoneinfo', 'sub', 'gender', 'email', 'given_name', 'birthdate', 'email_verified', 'family_name', 'website', 'picture', 'profile', 'locale', 'middle_name', 'updated_at'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'acr_values_supported': ['PASSWORD'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint': 'https://localhost:8092/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'version': '3.0', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_signing_alg_values_supported': ['none', 'HS384', 'PS384', 'PS512', 'ES384', 'ES512', 'RS512', 'ES256', 'HS256', 'PS256', 'HS512', 'RS384', 'RS256'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'token_endpoint_auth_signing_alg_values_supported': ['HS384', 'PS384', 'PS512', 'ES384', 'ES512', 'RS512', 'ES256', 'HS256', 'PS256', 'HS512', 'RS384', 'RS256'], 'scopes_supported': ['address', 'openid', 'phone', 'offline_access', 'profile', 'email', 'openid'], 'registration_endpoint': 'https://localhost:8092/registration', 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'require_request_uri_registration': True, 'request_uri_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_signing_alg_values_supported': ['none', 'HS384', 'PS384', 'PS512', 'ES384', 'ES512', 'RS512', 'ES256', 'HS256', 'PS256', 'HS512', 'RS384', 'RS256'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claims_parameter_supported': True, 'id_token_signing_alg_values_supported': ['none', 'HS384', 'PS384', 'PS512', 'ES384', 'ES512', 'RS512', 'ES256', 'HS256', 'PS256', 'HS512', 'RS384', 'RS256'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'request_parameter_supported': True, 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise']}
2015-08-20 16:58:48,885 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:58:48] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:58:48,950 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "redirect_uris": ["https://localhost:8666/authz_cb"], "application_type": "web", "contacts": ["ops@example.com"], "response_types": ["code"]}>>
2015-08-20 16:58:48,951 oic.oic.provider:INFO registration_request:{'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:58:48,957 oic.oic.provider:DEBUG _cinfo: {'client_id_issued_at': 1440079128, 'registration_client_uri': 'https://localhost:8092/registration?client_id=4uyYmKJlic9b', 'client_secret_expires_at': 1440165528, 'client_id': '4uyYmKJlic9b', 'client_secret': 'f0b3d1f29b1cf98718d30e8c6c835c18f20dec42b19bee94fda83ce6', 'registration_access_token': 'l2OohU8CRao9JrazKUfsx4ArEwregTqE'}
2015-08-20 16:58:48,959 oic.utils.keyio:DEBUG loading keys for issuer: 4uyYmKJlic9b
2015-08-20 16:58:48,959 oic.utils.keyio:DEBUG pcr: {'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com'], 'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:58:48,959 oic.oic.provider:DEBUG keys for 4uyYmKJlic9b: []
2015-08-20 16:58:48,963 oic.oic.provider:INFO Client info: {'client_id_issued_at': 1440079128, 'registration_client_uri': 'https://localhost:8092/registration?client_id=4uyYmKJlic9b', 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1440165528, 'client_id': '4uyYmKJlic9b', 'application_type': 'web', 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_secret': 'f0b3d1f29b1cf98718d30e8c6c835c18f20dec42b19bee94fda83ce6', 'registration_access_token': 'l2OohU8CRao9JrazKUfsx4ArEwregTqE', 'response_types': ['code'], 'redirect_uris': [('https://localhost:8666/authz_cb', None)]}
2015-08-20 16:58:48,964 oic.oic.provider:DEBUG registration_response: {'client_id_issued_at': 1440079128, 'registration_client_uri': 'https://localhost:8092/registration?client_id=4uyYmKJlic9b', 'contacts': ['ops@example.com'], 'client_secret_expires_at': 1440165528, 'client_id': '4uyYmKJlic9b', 'application_type': 'web', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'client_secret': 'f0b3d1f29b1cf98718d30e8c6c835c18f20dec42b19bee94fda83ce6', 'registration_access_token': 'l2OohU8CRao9JrazKUfsx4ArEwregTqE', 'response_types': ['code'], 'redirect_uris': ['https://localhost:8666/authz_cb']}
2015-08-20 16:58:48,965 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:58:48] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:58:48,988 oic.oauth2.provider:DEBUG Request: 'response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=0zl8ZgXYZO4hi6LG&state=7R12aMYObDE2PoSD&client_id=4uyYmKJlic9b'
2015-08-20 16:58:48,990 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1046dfb70>, <jwkest.jwk.RSAKey object at 0x1052e96a0>, <jwkest.jwk.ECKey object at 0x1052e9a58>]
2015-08-20 16:58:48,990 oic.oauth2.provider:DEBUG AuthzRequest: {'client_id': '4uyYmKJlic9b', 'response_type': 'code', 'scope': 'openid profile email address phone', 'nonce': '0zl8ZgXYZO4hi6LG', 'state': '7R12aMYObDE2PoSD', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:58:48,993 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'client_id': '4uyYmKJlic9b', 'response_type': 'code', 'scope': 'openid profile email address phone', 'nonce': '0zl8ZgXYZO4hi6LG', 'state': '7R12aMYObDE2PoSD', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:58:48,995 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:58:48,996 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:58:48,997 oic.utils.authn.user:INFO do_authentication argv: {'title': 'User log in', 'client_policy_title': 'Client Policy', 'passwd_title': 'Password', 'action': 'https://localhost:8092/verify', 'policy_uri': '', 'query': 'response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=0zl8ZgXYZO4hi6LG&state=7R12aMYObDE2PoSD&client_id=4uyYmKJlic9b', 'tos_uri': '', 'submit_text': 'Submit', 'login_title': 'Username', 'acr': '', 'logo_uri': '', 'login': '', 'password': ''}
2015-08-20 16:58:49,004 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:58:49] "GET /authorization?response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&scope=openid+profile+email+address+phone&nonce=0zl8ZgXYZO4hi6LG&state=7R12aMYObDE2PoSD&client_id=4uyYmKJlic9b HTTP/1.1" 200 -
2015-08-20 16:58:49,019 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:58:49] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:58:53,163 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:58:53] "POST /verify HTTP/1.1" 405 -
2015-08-20 16:59:32,159 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/pop_op/server.py', reloading
2015-08-20 16:59:32,260 werkzeug:INFO  * Restarting with stat
2015-08-20 16:59:34,160 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB"}]}
2015-08-20 16:59:34,160 root:INFO OC3 server keys: {"keys": [{"y": "jR9zMSgtymmpe_W0bH8Vlh6In9pE_y4QtNTNDXFTS-w", "use": "sig", "x": "hQ_Sjp0wBwdI0vB8-AsRTtvtUa2lF0WKWoz5t-qRefg", "kid": "op2", "kty": "EC", "crv": "P-256"}]}
2015-08-20 16:59:34,161 root:INFO OC3 server keys: {"keys": [{"y": "DuwbxvxmorHKYeIZB1CFynwX8WpAvrU2CeM9wbFU8r4", "use": "enc", "x": "pxe1EuKl5clO36AfrMG6D-dQcVXhCKmfb5_iICcqcHM", "kid": "op3", "kty": "EC", "crv": "P-256"}]}
2015-08-20 16:59:35,226 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/pop_op/server.py', reloading
2015-08-20 16:59:35,335 werkzeug:INFO  * Restarting with stat
2015-08-20 16:59:36,901 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "use": "enc", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kty": "RSA", "use": "sig", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-20 16:59:36,902 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "I-0g-VEV1XXmGfj2NBu9M_cSmSHVMmZEgzxcsrYBjGo", "use": "sig", "x": "Ep4UswmN-MWip_efH72Bru-FfAOCLmp6IipvBktDU_o", "crv": "P-256", "kid": "op2"}]}
2015-08-20 16:59:36,902 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "y": "ToocmIbDHWmV90Rw4jYVahBkDofwtvmoUjlLFc7RIGk", "use": "enc", "x": "YL2XDcjEt9tQ0B0OXxOx_WbtZWZb4wIvA4OrIlvlR5k", "crv": "P-256", "kid": "op3"}]}
2015-08-20 16:59:39,141 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "kid": "op0", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"kty": "RSA", "kid": "op1", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-20 16:59:39,142 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "x": "uh_9Wtsppn6nDA5Gw__25YckY7_bQi_yGXF8pQDOCQc", "crv": "P-256", "use": "sig", "y": "I70okaV8LIdmxziUzPJRh9IEdRv3TYsyUettLpQlBnI", "kid": "op2"}]}
2015-08-20 16:59:39,143 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "x": "GuhyeGegVvTll4oBKy6Ny1WlTXWyFeGaD99NBPAEK2A", "crv": "P-256", "use": "enc", "y": "lHr4SrD_y9UskTuE--ajlxUBPEfxLhv13W5oRlwZ4-Y", "kid": "op3"}]}
2015-08-20 16:59:39,178 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-20 16:59:39,187 werkzeug:INFO  * Restarting with stat
2015-08-20 16:59:40,992 root:INFO OC3 server keys: {"keys": [{"use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}, {"use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}]}
2015-08-20 16:59:40,993 root:INFO OC3 server keys: {"keys": [{"x": "K1rGdSnUEwa77T7w_c51Fa_9zAR8i2vtzrdr4Z4_LXU", "use": "sig", "y": "6h2YTbyPL44NoSZKP8UJ38EwzIFsyiTKfMt2zqrBSLQ", "kty": "EC", "crv": "P-256", "kid": "op2"}]}
2015-08-20 16:59:40,993 root:INFO OC3 server keys: {"keys": [{"x": "DTeSiMD7E5MdPNBK0JWToxgdOqoWB_w5_DyfJcDwPjE", "use": "enc", "y": "lV2Kh1fYURHS0qf58JdrKX1azLSPNzF6IKXU1kb0bXE", "kty": "EC", "crv": "P-256", "kid": "op3"}]}
2015-08-20 16:59:54,087 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:54] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-20 16:59:54,106 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-20 16:59:54,107 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-20 16:59:54,108 oic.oic.provider:INFO provider_info_response: {'subject_types_supported': ['public', 'pairwise'], 'request_uri_parameter_supported': True, 'scopes_supported': ['openid', 'email', 'profile', 'offline_access', 'phone', 'address', 'openid'], 'issuer': 'https://localhost:8092/', 'version': '3.0', 'authorization_endpoint': 'https://localhost:8092/authorization', 'request_object_signing_alg_values_supported': ['PS384', 'RS384', 'ES512', 'ES256', 'RS256', 'PS256', 'ES384', 'PS512', 'HS384', 'HS512', 'RS512', 'none', 'HS256'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'registration_endpoint': 'https://localhost:8092/registration', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'acr_values_supported': ['PASSWORD'], 'token_endpoint_auth_signing_alg_values_supported': ['PS384', 'RS384', 'ES512', 'ES256', 'RS256', 'PS256', 'ES384', 'PS512', 'HS384', 'HS512', 'RS512', 'HS256'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'end_session_endpoint': 'https://localhost:8092/end_session', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'require_request_uri_registration': True, 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'userinfo_signing_alg_values_supported': ['PS384', 'RS384', 'ES512', 'ES256', 'RS256', 'PS256', 'ES384', 'PS512', 'HS384', 'HS512', 'RS512', 'none', 'HS256'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_signing_alg_values_supported': ['PS384', 'RS384', 'ES512', 'ES256', 'RS256', 'PS256', 'ES384', 'PS512', 'HS384', 'HS512', 'RS512', 'none', 'HS256'], 'token_endpoint': 'https://localhost:8092/token', 'request_parameter_supported': True, 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'claims_parameter_supported': True, 'claims_supported': ['email', 'profile', 'given_name', 'picture', 'middle_name', 'zoneinfo', 'locale', 'preferred_username', 'phone_number_verified', 'website', 'family_name', 'name', 'updated_at', 'sub', 'birthdate', 'phone_number', 'email_verified', 'address', 'nickname', 'gender'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}
2015-08-20 16:59:54,109 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:54] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-20 16:59:54,175 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "response_types": ["code"], "contacts": ["ops@example.com"], "redirect_uris": ["https://localhost:8666/authz_cb"], "application_type": "web"}>>
2015-08-20 16:59:54,175 oic.oic.provider:INFO registration_request:{'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:59:54,182 oic.oic.provider:DEBUG _cinfo: {'client_secret': '6bdd177572bd1aae80e8307a156e9bcf8d9f2ed53c8a9727370577f5', 'client_secret_expires_at': 1440165594, 'client_id_issued_at': 1440079194, 'registration_client_uri': 'https://localhost:8092/registration?client_id=QfQIHrmdRwgM', 'registration_access_token': '5Cj61aTcijimwkF8iDh9Z1vFcpft6Rmr', 'client_id': 'QfQIHrmdRwgM'}
2015-08-20 16:59:54,184 oic.utils.keyio:DEBUG loading keys for issuer: QfQIHrmdRwgM
2015-08-20 16:59:54,184 oic.utils.keyio:DEBUG pcr: {'application_type': 'web', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'response_types': ['code'], 'contacts': ['ops@example.com']}
2015-08-20 16:59:54,185 oic.oic.provider:DEBUG keys for QfQIHrmdRwgM: []
2015-08-20 16:59:54,188 oic.oic.provider:INFO Client info: {'client_secret': '6bdd177572bd1aae80e8307a156e9bcf8d9f2ed53c8a9727370577f5', 'application_type': 'web', 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'client_secret_expires_at': 1440165594, 'response_types': ['code'], 'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'client_id_issued_at': 1440079194, 'registration_client_uri': 'https://localhost:8092/registration?client_id=QfQIHrmdRwgM', 'contacts': ['ops@example.com'], 'registration_access_token': '5Cj61aTcijimwkF8iDh9Z1vFcpft6Rmr', 'client_id': 'QfQIHrmdRwgM'}
2015-08-20 16:59:54,188 oic.oic.provider:DEBUG registration_response: {'client_secret': '6bdd177572bd1aae80e8307a156e9bcf8d9f2ed53c8a9727370577f5', 'redirect_uris': ['https://localhost:8666/authz_cb'], 'application_type': 'web', 'client_secret_expires_at': 1440165594, 'response_types': ['code'], 'contacts': ['ops@example.com'], 'client_id_issued_at': 1440079194, 'registration_client_uri': 'https://localhost:8092/registration?client_id=QfQIHrmdRwgM', 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'registration_access_token': '5Cj61aTcijimwkF8iDh9Z1vFcpft6Rmr', 'client_id': 'QfQIHrmdRwgM'}
2015-08-20 16:59:54,190 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:54] "POST /registration HTTP/1.1" 200 -
2015-08-20 16:59:54,209 oic.oauth2.provider:DEBUG Request: 'state=mfuwBlDB79pX6i2b&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=WulhrjdVCeD2YyDh&scope=openid+profile+email+address+phone&response_type=code&client_id=QfQIHrmdRwgM'
2015-08-20 16:59:54,211 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1045beb70>, <jwkest.jwk.RSAKey object at 0x1051cb710>, <jwkest.jwk.ECKey object at 0x1051cbb70>]
2015-08-20 16:59:54,212 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'mfuwBlDB79pX6i2b', 'scope': 'openid profile email address phone', 'nonce': 'WulhrjdVCeD2YyDh', 'client_id': 'QfQIHrmdRwgM', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:54,214 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'mfuwBlDB79pX6i2b', 'scope': 'openid profile email address phone', 'nonce': 'WulhrjdVCeD2YyDh', 'client_id': 'QfQIHrmdRwgM', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:54,216 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:59:54,217 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:59:54,217 oic.utils.authn.user:INFO do_authentication argv: {'action': 'https://localhost:8092/verify', 'policy_uri': '', 'login_title': 'Username', 'passwd_title': 'Password', 'query': 'state=mfuwBlDB79pX6i2b&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=WulhrjdVCeD2YyDh&scope=openid+profile+email+address+phone&response_type=code&client_id=QfQIHrmdRwgM', 'password': '', 'logo_uri': '', 'title': 'User log in', 'client_policy_title': 'Client Policy', 'login': '', 'tos_uri': '', 'acr': '', 'submit_text': 'Submit'}
2015-08-20 16:59:54,222 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:54] "GET /authorization?state=mfuwBlDB79pX6i2b&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=WulhrjdVCeD2YyDh&scope=openid+profile+email+address+phone&response_type=code&client_id=QfQIHrmdRwgM HTTP/1.1" 200 -
2015-08-20 16:59:54,249 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:54] "GET /css/main.css HTTP/1.1" 404 -
2015-08-20 16:59:57,525 oic.utils.authn.user:DEBUG verify(query=state%3DmfuwBlDB79pX6i2b%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26nonce%3DWulhrjdVCeD2YyDh%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26response_type%3Dcode%26client_id%3DQfQIHrmdRwgM&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-20 16:59:57,526 oic.utils.authn.user:DEBUG dict: {'form.commit': ['Submit'], 'query': ['state=mfuwBlDB79pX6i2b&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&nonce=WulhrjdVCeD2YyDh&scope=openid+profile+email+address+phone&response_type=code&client_id=QfQIHrmdRwgM'], 'login': ['diana'], 'password': ['krall']}
2015-08-20 16:59:57,526 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-20 16:59:57,528 oic.utils.authn.user:DEBUG kwargs: {'state': ['mfuwBlDB79pX6i2b'], 'scope': ['openid profile email address phone'], 'response_type': ['code'], 'redirect_uri': ['https://localhost:8666/authz_cb'], 'upm_answer': 'true', 'nonce': ['WulhrjdVCeD2YyDh'], 'client_id': ['QfQIHrmdRwgM']}
2015-08-20 16:59:57,531 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:57] "POST /verify HTTP/1.1" 302 -
2015-08-20 16:59:57,551 oic.oauth2.provider:DEBUG Request: 'state=mfuwBlDB79pX6i2b&scope=openid+profile+email+address+phone&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true&nonce=WulhrjdVCeD2YyDh&client_id=QfQIHrmdRwgM'
2015-08-20 16:59:57,552 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1045beb70>, <jwkest.jwk.RSAKey object at 0x1051cb710>, <jwkest.jwk.ECKey object at 0x1051cbb70>]
2015-08-20 16:59:57,553 oic.oauth2.provider:DEBUG AuthzRequest: {'state': 'mfuwBlDB79pX6i2b', 'scope': 'openid profile email address phone', 'nonce': 'WulhrjdVCeD2YyDh', 'client_id': 'QfQIHrmdRwgM', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:57,557 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'state': 'mfuwBlDB79pX6i2b', 'scope': 'openid profile email address phone', 'nonce': 'WulhrjdVCeD2YyDh', 'client_id': 'QfQIHrmdRwgM', 'upm_answer': 'true', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:57,559 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-20 16:59:57,560 oic.oauth2.provider:INFO No active authentication
2015-08-20 16:59:57,561 oic.oic.provider:DEBUG - authenticated -
2015-08-20 16:59:57,561 oic.oic.provider:DEBUG AREQ keys: ['state', 'scope', 'response_type', 'redirect_uri', 'upm_answer', 'nonce', 'client_id']
2015-08-20 16:59:57,562 oic.utils.sdb:DEBUG uid2sid: {'diana': ['ffe5b41fb961c7828619b2af6ea5f29e9771c86d5a865e408d8be769']}
2015-08-20 16:59:57,562 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-20 16:59:57,562 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-20 16:59:57,566 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=mfuwBlDB79pX6i2b&code=%2Bi7cdoVp16S%2BD9AO5cOi%2BXd2PnLl7Uprl1CesmTXHZ%2BYqlQephjUoqERwICsnoY5y0zb2XAevjlje0h3OYzXsCWa0yQMsWAwft0eE18tFX8%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-20 16:59:57,568 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:57] "GET /authorization?state=mfuwBlDB79pX6i2b&scope=openid+profile+email+address+phone&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&upm_answer=true&nonce=WulhrjdVCeD2YyDh&client_id=QfQIHrmdRwgM HTTP/1.1" 302 -
2015-08-20 16:59:57,597 oic.oic.provider:DEBUG - token -
2015-08-20 16:59:57,597 oic.oic.provider:INFO token_request: token_type=pop&client_secret=6bdd177572bd1aae80e8307a156e9bcf8d9f2ed53c8a9727370577f5&key=eyJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIifQ%3D%3D&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&grant_type=authorization_code&code=%2Bi7cdoVp16S%2BD9AO5cOi%2BXd2PnLl7Uprl1CesmTXHZ%2BYqlQephjUoqERwICsnoY5y0zb2XAevjlje0h3OYzXsCWa0yQMsWAwft0eE18tFX8%3D&client_id=QfQIHrmdRwgM
2015-08-20 16:59:57,598 oic.oic.provider:DEBUG AccessTokenRequest: {'client_secret': '6bdd177572bd1aae80e8307a156e9bcf8d9f2ed53c8a9727370577f5', 'key': 'eyJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIifQ==', 'grant_type': 'authorization_code', 'token_type': 'pop', 'client_id': 'QfQIHrmdRwgM', 'code': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5y0zb2XAevjlje0h3OYzXsCWa0yQMsWAwft0eE18tFX8=', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:57,598 oic.utils.authn.client:DEBUG REQ: {'client_secret': '6bdd177572bd1aae80e8307a156e9bcf8d9f2ed53c8a9727370577f5', 'key': 'eyJraWQiOiAiYTAiLCAia3R5IjogIlJTQSIsICJkIjogInY3NDl3RnZubUJ3a3pUcEZURDJBblYyWV9KM0ZuVW1UbmcxN0VCMWVCVEpYSUQtTWdYOGFZRVQ4SzJneUE1R3JoZ25SX2xPaUJJSFp3NkFiTWdyOG1PX1czeVBGWWphTXpLb0lJT3paVjQ2a0Jlc2x0UWRud1FiWjgtcEV1TDIwb0liMS1rVzR6ZExqaU5qalVzYVhXN3NhUXRnMGlNMjNnaVNhaFVMZHJRRSIsICJwIjogIjdDNWFIeXc4R3BzZ3BlMUJtR0l6ZHFQMnJvc0gwMlZ0UUoxT3ZzUy1uYnhzZjFSVTMzTW83MEtDRk80aGZ3UFN1NGJOTkEzNHhIcXV3YzFSaW9UdmF3IiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAidXNlIjogInNpZyIsICJlIjogIkFRQUIifQ==', 'grant_type': 'authorization_code', 'token_type': 'pop', 'client_id': 'QfQIHrmdRwgM', 'code': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5y0zb2XAevjlje0h3OYzXsCWa0yQMsWAwft0eE18tFX8=', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:57,600 oic.utils.authn.client:DEBUG Verified Client ID: QfQIHrmdRwgM
2015-08-20 16:59:57,605 oic.oic.provider:DEBUG All checks OK
2015-08-20 16:59:57,608 oic.oic:DEBUG authzreq: {'state': 'mfuwBlDB79pX6i2b', 'scope': 'openid profile email address phone', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'WulhrjdVCeD2YyDh', 'client_id': 'QfQIHrmdRwgM'}
2015-08-20 16:59:57,609 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-20 16:59:57,609 oic.oic:DEBUG authzreq: {'state': 'mfuwBlDB79pX6i2b', 'scope': 'openid profile email address phone', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'WulhrjdVCeD2YyDh', 'client_id': 'QfQIHrmdRwgM'}
2015-08-20 16:59:57,610 oic.oic.provider:DEBUG id_token: {'iat': 1440082797, 'iss': 'https://localhost:8092/', 'sub': '2a62dc0f0b38259b', 'aud': ['QfQIHrmdRwgM'], 'acr': 'PASSWORD', 'auth_time': 1440082797, 'nonce': 'WulhrjdVCeD2YyDh', 'exp': 1440161997}
2015-08-20 16:59:57,612 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"use": "enc", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op0", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}, {"use": "sig", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kid": "op1", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "e": "AQAB"}]}
2015-08-20 16:59:57,613 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "K1rGdSnUEwa77T7w_c51Fa_9zAR8i2vtzrdr4Z4_LXU", "use": "sig", "y": "6h2YTbyPL44NoSZKP8UJ38EwzIFsyiTKfMt2zqrBSLQ", "kty": "EC", "crv": "P-256", "kid": "op2"}]}
2015-08-20 16:59:57,614 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "DTeSiMD7E5MdPNBK0JWToxgdOqoWB_w5_DyfJcDwPjE", "use": "enc", "y": "lV2Kh1fYURHS0qf58JdrKX1azLSPNzF6IKXU1kb0bXE", "kty": "EC", "crv": "P-256", "kid": "op3"}]}
2015-08-20 16:59:57,614 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x1051cb710>]
2015-08-20 16:59:57,624 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:59:57,625 oic.oic.provider:DEBUG _tinfo: {'token_type': 'Bearer', 'oauth_state': 'token', 'permission': '', 'expires_in': 3600, 'access_token': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5m0n9LiHCsX0nPbNTu79pNlJQvMVK7Y3+F9xj/1ccjfI=', 'code': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5y0zb2XAevjlje0h3OYzXsCWa0yQMsWAwft0eE18tFX8=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token_scope': '?', 'authzreq': '{"state": "mfuwBlDB79pX6i2b", "scope": "openid profile email address phone", "nonce": "WulhrjdVCeD2YyDh", "client_id": "QfQIHrmdRwgM", "upm_answer": "true", "response_type": "code", "redirect_uri": "https://localhost:8666/authz_cb"}', 'state': 'mfuwBlDB79pX6i2b', 'token_expires_at': 1440082797, 'refresh_token': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5MK/9WTb3KADvRVq3kjL/k41u167VNUacOQyxIqxTmbw=', 'sub': '2a62dc0f0b38259b', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10473cba8>, 'code_used': True, 'nonce': 'WulhrjdVCeD2YyDh', 'revoked': False, 'client_id': 'QfQIHrmdRwgM', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDQwMDgyNzk3LCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICIyYTYyZGMwZjBiMzgyNTliIiwgImF1ZCI6IFsiUWZRSUhybWRSd2dNIl0sICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQ0MDA4Mjc5NywgIm5vbmNlIjogIld1bGhyamRWQ2VEMll5RGgiLCAiZXhwIjogMTQ0MDE2MTk5N30.NQPA1Uge-Q6m_ho8PtXQ8iwgJqeQSMvwGFuc8CBfJ-g2P7KNIZnYwvES1f4tPDQQw1sZ1ELlLKSZNLvz4MLCaeRD7GYKTo1QUTRLvnw9j_NfFSWv5Qzj0Q4tTxJoGWGLnAl3fzd1rOYH4VbsCDxMgwI6JontSti4FAJYpdSsbYfyrtp3ylOsGNr5_OPqB-JdtL2t-7DK1rFD751LVDE5ywKu68B9vF5pAZSiFVvCbRZgmJQzZiQq2w8XziutISA1CxkdsX0I59ZL8N8tTz2vaESRe5LhtKrn2AFdL3pZrmMvap_CgNzxWMpXnUCoPH7s1jF2rdp4AyL-d4GYl3B9Rg', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:57,626 oic.oic.provider:DEBUG access_token_response: {'state': 'mfuwBlDB79pX6i2b', 'refresh_token': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5MK/9WTb3KADvRVq3kjL/k41u167VNUacOQyxIqxTmbw=', 'access_token': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5m0n9LiHCsX0nPbNTu79pNlJQvMVK7Y3+F9xj/1ccjfI=', 'expires_in': 3600, 'token_type': 'Bearer', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDQwMDgyNzk3LCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICIyYTYyZGMwZjBiMzgyNTliIiwgImF1ZCI6IFsiUWZRSUhybWRSd2dNIl0sICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQ0MDA4Mjc5NywgIm5vbmNlIjogIld1bGhyamRWQ2VEMll5RGgiLCAiZXhwIjogMTQ0MDE2MTk5N30.NQPA1Uge-Q6m_ho8PtXQ8iwgJqeQSMvwGFuc8CBfJ-g2P7KNIZnYwvES1f4tPDQQw1sZ1ELlLKSZNLvz4MLCaeRD7GYKTo1QUTRLvnw9j_NfFSWv5Qzj0Q4tTxJoGWGLnAl3fzd1rOYH4VbsCDxMgwI6JontSti4FAJYpdSsbYfyrtp3ylOsGNr5_OPqB-JdtL2t-7DK1rFD751LVDE5ywKu68B9vF5pAZSiFVvCbRZgmJQzZiQq2w8XziutISA1CxkdsX0I59ZL8N8tTz2vaESRe5LhtKrn2AFdL3pZrmMvap_CgNzxWMpXnUCoPH7s1jF2rdp4AyL-d4GYl3B9Rg', 'scope': 'openid profile email address phone'}
2015-08-20 16:59:57,634 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-20 16:59:57,635 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:57] "POST /token HTTP/1.1" 200 -
2015-08-20 16:59:57,662 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:57] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-20 16:59:57,698 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-20 16:59:57,701 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-20 16:59:57,701 oic.oic.provider:DEBUG access_token type: 'T'
2015-08-20 16:59:57,702 oic.oic:DEBUG authzreq: {'state': 'mfuwBlDB79pX6i2b', 'scope': 'openid profile email address phone', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'upm_answer': 'true', 'nonce': 'WulhrjdVCeD2YyDh', 'client_id': 'QfQIHrmdRwgM'}
2015-08-20 16:59:57,702 oic.oic.provider:DEBUG userinfo_claim: {'email': None, 'profile': None, 'phone_number_verified': None, 'given_name': None, 'picture': None, 'middle_name': None, 'locale': None, 'preferred_username': None, 'website': None, 'family_name': None, 'name': None, 'zoneinfo': None, 'sub': None, 'birthdate': None, 'email_verified': None, 'nickname': None, 'updated_at': None, 'address': None, 'gender': None, 'phone_number': None}
2015-08-20 16:59:57,703 oic.oic.provider:DEBUG Session info: {'token_type': 'Bearer', 'oauth_state': 'token', 'permission': '', 'expires_in': 3600, 'access_token': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5m0n9LiHCsX0nPbNTu79pNlJQvMVK7Y3+F9xj/1ccjfI=', 'code': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5y0zb2XAevjlje0h3OYzXsCWa0yQMsWAwft0eE18tFX8=', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'access_token_scope': '?', 'authzreq': '{"state": "mfuwBlDB79pX6i2b", "scope": "openid profile email address phone", "nonce": "WulhrjdVCeD2YyDh", "client_id": "QfQIHrmdRwgM", "upm_answer": "true", "response_type": "code", "redirect_uri": "https://localhost:8666/authz_cb"}', 'state': 'mfuwBlDB79pX6i2b', 'token_expires_at': 1440082797, 'refresh_token': '+i7cdoVp16S+D9AO5cOi+Xd2PnLl7Uprl1CesmTXHZ+YqlQephjUoqERwICsnoY5MK/9WTb3KADvRVq3kjL/k41u167VNUacOQyxIqxTmbw=', 'sub': '2a62dc0f0b38259b', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x10473cba8>, 'code_used': True, 'nonce': 'WulhrjdVCeD2YyDh', 'revoked': False, 'client_id': 'QfQIHrmdRwgM', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Im9wMSJ9.eyJpYXQiOiAxNDQwMDgyNzk3LCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwOTIvIiwgInN1YiI6ICIyYTYyZGMwZjBiMzgyNTliIiwgImF1ZCI6IFsiUWZRSUhybWRSd2dNIl0sICJhY3IiOiAiUEFTU1dPUkQiLCAiYXV0aF90aW1lIjogMTQ0MDA4Mjc5NywgIm5vbmNlIjogIld1bGhyamRWQ2VEMll5RGgiLCAiZXhwIjogMTQ0MDE2MTk5N30.NQPA1Uge-Q6m_ho8PtXQ8iwgJqeQSMvwGFuc8CBfJ-g2P7KNIZnYwvES1f4tPDQQw1sZ1ELlLKSZNLvz4MLCaeRD7GYKTo1QUTRLvnw9j_NfFSWv5Qzj0Q4tTxJoGWGLnAl3fzd1rOYH4VbsCDxMgwI6JontSti4FAJYpdSsbYfyrtp3ylOsGNr5_OPqB-JdtL2t-7DK1rFD751LVDE5ywKu68B9vF5pAZSiFVvCbRZgmJQzZiQq2w8XziutISA1CxkdsX0I59ZL8N8tTz2vaESRe5LhtKrn2AFdL3pZrmMvap_CgNzxWMpXnUCoPH7s1jF2rdp4AyL-d4GYl3B9Rg', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-20 16:59:57,703 oic.oic.provider:DEBUG user_info_response: {'email': 'diana@example.org', 'phone_number': '+46 90 7865000', 'sub': '2a62dc0f0b38259b', 'nickname': 'Dina', 'given_name': 'Diana', 'email_verified': False, 'name': 'Diana Krall', 'address': {'country': 'Sweden', 'street_address': 'Ume Universitet', 'locality': 'Ume', 'postal_code': 'SE-90187'}, 'family_name': 'Krall'}
2015-08-20 16:59:57,708 werkzeug:INFO 127.0.0.1 - - [20/Aug/2015 16:59:57] "POST /userinfo HTTP/1.1" 200 -
2015-08-20 17:00:12,696 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/src_flask_oidc/flask_oidc/op/op_blueprint.py', reloading
2015-08-20 17:00:12,788 werkzeug:INFO  * Restarting with stat
2015-08-20 17:00:14,400 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op0", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}, {"kty": "RSA", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "kid": "op1", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8"}]}
2015-08-20 17:00:14,401 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "use": "sig", "x": "GZUm76oMkO6lXGtnUqxoEIzfZNLW4a0FgHeyqHBv_oI", "y": "Lb2RnirxDPehdzjCP7NOje9BNrQOhLVTj5CApSAWhdI", "kid": "op2"}]}
2015-08-20 17:00:14,401 root:INFO OC3 server keys: {"keys": [{"crv": "P-256", "kty": "EC", "use": "enc", "x": "citdpJnMoNE6fuawLBi6fpmBfYvq7X0ugzbz3d83XiA", "y": "NAm45PDZrPjP1GtGk6zfR6PIKsuWbgPHfH7NdlpQGOI", "kid": "op3"}]}
2015-08-21 08:08:11,658 werkzeug:INFO  * Detected change in '/Users/mathiashedstrom/work/DIRG/proof-of-possession/example/pop_op/server.py', reloading
2015-08-21 08:08:11,749 werkzeug:INFO  * Restarting with stat
2015-08-21 08:08:13,829 root:INFO OC3 server keys: {"keys": [{"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op0", "e": "AQAB", "use": "enc", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}, {"kty": "RSA", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "kid": "op1", "e": "AQAB", "use": "sig", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80"}]}
2015-08-21 08:08:13,830 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "x": "arLX1qiYRl20WjyJj0f-xN6gH46YVYtporwqhPqCRIk", "kid": "op2", "use": "sig", "crv": "P-256", "y": "umSdZ6178u6IBfa0qH1HyDDND8CWlAQzWzNA5Xy6MI8"}]}
2015-08-21 08:08:13,830 root:INFO OC3 server keys: {"keys": [{"kty": "EC", "x": "kDE6MbzMyPQiaFA6pImoNBJ0phMTYez_UwGOG583WFY", "kid": "op3", "use": "enc", "crv": "P-256", "y": "SCkl677UV8xvvXpIPxmH_y1L12gUlI0mJztVmKz7oVM"}]}
2015-08-21 08:48:40,072 root:INFO OC3 server keys: {"keys": [{"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "enc", "e": "AQAB", "kid": "op0", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}, {"p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "use": "sig", "e": "AQAB", "kid": "op1", "kty": "RSA", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw"}]}
2015-08-21 08:48:40,072 root:INFO OC3 server keys: {"keys": [{"x": "0w1olRMVe1XHKasirzVJrEylbUQDAkufvwVh1EgSNhY", "crv": "P-256", "use": "sig", "y": "FsrwlG19GIoRrKb3jdHM6RQmvX_yEJHQPQZCNwcOfio", "kid": "op2", "kty": "EC"}]}
2015-08-21 08:48:40,072 root:INFO OC3 server keys: {"keys": [{"x": "EAjpDDvoPppSKD7ixDKOtWssxBJPDuJCtuk4RO9unv0", "crv": "P-256", "use": "enc", "y": "9_-hOGqZi3r9iZ1f6uO6A1BvWtJ3ZMTwPvo88I8SoE0", "kid": "op3", "kty": "EC"}]}
2015-08-21 08:48:40,087 werkzeug:INFO  * Running on https://0.0.0.0:8092/ (Press CTRL+C to quit)
2015-08-21 08:48:40,089 werkzeug:INFO  * Restarting with stat
2015-08-21 08:48:40,516 root:INFO OC3 server keys: {"keys": [{"kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}, {"kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}]}
2015-08-21 08:48:40,516 root:INFO OC3 server keys: {"keys": [{"x": "cOZ0ySFe6BeUYtIskseyROosRLAypbcPmyHAgr4skbA", "kid": "op2", "y": "5M10Tj-isINJvc75s2E1j9egqlm5bl3K9jGLtmGcdyI", "use": "sig", "crv": "P-256", "kty": "EC"}]}
2015-08-21 08:48:40,517 root:INFO OC3 server keys: {"keys": [{"x": "GgMT6bknzet0DUd6Tk7NavoRPwVMRAh-xchok73doiA", "kid": "op3", "y": "XRmcSPNnLuxgqEv923IJIMK9lFKVif5i1I4HA7NT0_I", "use": "enc", "crv": "P-256", "kty": "EC"}]}
2015-08-21 08:48:53,611 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:53] "GET /.well-known/webfinger?resource=https%3A%2F%2Flocalhost%3A8092&rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1" 200 -
2015-08-21 08:48:53,618 flask.ext.oidc.op.op_blueprint:INFO op_info
2015-08-21 08:48:53,618 oic.oic.provider:INFO @providerinfo_endpoint
2015-08-21 08:48:53,618 oic.oic.provider:INFO provider_info_response: {'scopes_supported': ['email', 'phone', 'offline_access', 'openid', 'address', 'profile', 'openid'], 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'userinfo_endpoint': 'https://localhost:8092/userinfo', 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_signing_alg_values_supported': ['ES384', 'HS384', 'RS512', 'RS256', 'ES256', 'PS256', 'ES512', 'RS384', 'PS512', 'none', 'PS384', 'HS256', 'HS512'], 'jwks_uri': 'https://localhost:8092/static/jwks.json', 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_uri_parameter_supported': True, 'acr_values_supported': ['PASSWORD'], 'version': '3.0', 'claims_parameter_supported': True, 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'registration_endpoint': 'https://localhost:8092/registration', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'token_endpoint': 'https://localhost:8092/token', 'token_endpoint_auth_signing_alg_values_supported': ['ES384', 'HS384', 'RS512', 'RS256', 'ES256', 'PS256', 'ES512', 'RS384', 'PS512', 'PS384', 'HS256', 'HS512'], 'require_request_uri_registration': True, 'userinfo_signing_alg_values_supported': ['ES384', 'HS384', 'RS512', 'RS256', 'ES256', 'PS256', 'ES512', 'RS384', 'PS512', 'none', 'PS384', 'HS256', 'HS512'], 'subject_types_supported': ['public', 'pairwise'], 'claims_supported': ['middle_name', 'email_verified', 'phone_number', 'given_name', 'name', 'nickname', 'gender', 'birthdate', 'preferred_username', 'family_name', 'website', 'phone_number_verified', 'address', 'profile', 'email', 'picture', 'sub', 'updated_at', 'zoneinfo', 'locale'], 'end_session_endpoint': 'https://localhost:8092/end_session', 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'issuer': 'https://localhost:8092/', 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'authorization_endpoint': 'https://localhost:8092/authorization', 'id_token_signing_alg_values_supported': ['ES384', 'HS384', 'RS512', 'RS256', 'ES256', 'PS256', 'ES512', 'RS384', 'PS512', 'none', 'PS384', 'HS256', 'HS512'], 'request_parameter_supported': True}
2015-08-21 08:48:53,619 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:53] "GET /.well-known/openid-configuration HTTP/1.1" 200 -
2015-08-21 08:48:53,664 oic.oic.provider:DEBUG @registration_endpoint: <<{"post_logout_redirect_uris": ["https://localhost:8666/logout_success"], "application_type": "web", "redirect_uris": ["https://localhost:8666/authz_cb"], "contacts": ["ops@example.com"], "response_types": ["code"]}>>
2015-08-21 08:48:53,664 oic.oic.provider:INFO registration_request:{'redirect_uris': ['https://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'application_type': 'web', 'response_types': ['code']}
2015-08-21 08:48:53,669 oic.oic.provider:DEBUG _cinfo: {'registration_access_token': 'GDBWBnlifPuj466nuKVomQlOuJoAATDw', 'client_id': 'PZlNlIPDx2yd', 'client_id_issued_at': 1440136133, 'client_secret_expires_at': 1440222533, 'client_secret': 'e8db6ee9e00bc6891b2ba4a224ecd82999730d1968e98fd9468f69fd', 'registration_client_uri': 'https://localhost:8092/registration?client_id=PZlNlIPDx2yd'}
2015-08-21 08:48:53,670 oic.utils.keyio:DEBUG loading keys for issuer: PZlNlIPDx2yd
2015-08-21 08:48:53,670 oic.utils.keyio:DEBUG pcr: {'redirect_uris': ['https://localhost:8666/authz_cb'], 'contacts': ['ops@example.com'], 'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'application_type': 'web', 'response_types': ['code']}
2015-08-21 08:48:53,670 oic.oic.provider:DEBUG keys for PZlNlIPDx2yd: []
2015-08-21 08:48:53,673 oic.oic.provider:INFO Client info: {'post_logout_redirect_uris': [('https://localhost:8666/logout_success', None)], 'contacts': ['ops@example.com'], 'redirect_uris': [('https://localhost:8666/authz_cb', None)], 'application_type': 'web', 'registration_access_token': 'GDBWBnlifPuj466nuKVomQlOuJoAATDw', 'response_types': ['code'], 'client_id': 'PZlNlIPDx2yd', 'client_id_issued_at': 1440136133, 'client_secret_expires_at': 1440222533, 'client_secret': 'e8db6ee9e00bc6891b2ba4a224ecd82999730d1968e98fd9468f69fd', 'registration_client_uri': 'https://localhost:8092/registration?client_id=PZlNlIPDx2yd'}
2015-08-21 08:48:53,673 oic.oic.provider:DEBUG registration_response: {'post_logout_redirect_uris': ['https://localhost:8666/logout_success'], 'contacts': ['ops@example.com'], 'redirect_uris': ['https://localhost:8666/authz_cb'], 'application_type': 'web', 'registration_access_token': 'GDBWBnlifPuj466nuKVomQlOuJoAATDw', 'response_types': ['code'], 'client_id': 'PZlNlIPDx2yd', 'client_id_issued_at': 1440136133, 'client_secret_expires_at': 1440222533, 'client_secret': 'e8db6ee9e00bc6891b2ba4a224ecd82999730d1968e98fd9468f69fd', 'registration_client_uri': 'https://localhost:8092/registration?client_id=PZlNlIPDx2yd'}
2015-08-21 08:48:53,673 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:53] "POST /registration HTTP/1.1" 200 -
2015-08-21 08:48:53,684 oic.oauth2.provider:DEBUG Request: 'nonce=pzxV4MPpeT5LXnfa&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&state=gKOqmaW9FYqOOpE2&client_id=PZlNlIPDx2yd'
2015-08-21 08:48:53,685 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1043b8978>, <jwkest.jwk.RSAKey object at 0x10431bfd0>, <jwkest.jwk.ECKey object at 0x1043163c8>]
2015-08-21 08:48:53,685 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'pzxV4MPpeT5LXnfa', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'response_type': 'code'}
2015-08-21 08:48:53,687 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'pzxV4MPpeT5LXnfa', 'scope': 'openid profile email address phone', 'redirect_uri': 'https://localhost:8666/authz_cb', 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'response_type': 'code'}
2015-08-21 08:48:53,689 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-21 08:48:53,689 oic.oauth2.provider:INFO No active authentication
2015-08-21 08:48:53,689 oic.utils.authn.user:INFO do_authentication argv: {'submit_text': 'Submit', 'logo_uri': '', 'acr': '', 'client_policy_title': 'Client Policy', 'login_title': 'Username', 'policy_uri': '', 'action': 'https://localhost:8092/verify', 'title': 'User log in', 'query': 'nonce=pzxV4MPpeT5LXnfa&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&state=gKOqmaW9FYqOOpE2&client_id=PZlNlIPDx2yd', 'tos_uri': '', 'password': '', 'login': '', 'passwd_title': 'Password'}
2015-08-21 08:48:53,692 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:53] "GET /authorization?nonce=pzxV4MPpeT5LXnfa&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&state=gKOqmaW9FYqOOpE2&client_id=PZlNlIPDx2yd HTTP/1.1" 200 -
2015-08-21 08:48:53,708 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:53] "GET /css/main.css HTTP/1.1" 404 -
2015-08-21 08:48:58,298 oic.utils.authn.user:DEBUG verify(query=nonce%3DpzxV4MPpeT5LXnfa%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A8666%252Fauthz_cb%26response_type%3Dcode%26scope%3Dopenid%2Bprofile%2Bemail%2Baddress%2Bphone%26state%3DgKOqmaW9FYqOOpE2%26client_id%3DPZlNlIPDx2yd&acr_values=&login=diana&password=krall&form.commit=Submit)
2015-08-21 08:48:58,299 oic.utils.authn.user:DEBUG dict: {'query': ['nonce=pzxV4MPpeT5LXnfa&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&response_type=code&scope=openid+profile+email+address+phone&state=gKOqmaW9FYqOOpE2&client_id=PZlNlIPDx2yd'], 'password': ['krall'], 'login': ['diana'], 'form.commit': ['Submit']}
2015-08-21 08:48:58,299 oic.utils.authn.user:DEBUG passwd: {'diana': 'krall', 'upper': 'crust', 'babs': 'howes'}
2015-08-21 08:48:58,299 oic.utils.authn.user:DEBUG kwargs: {'nonce': ['pzxV4MPpeT5LXnfa'], 'scope': ['openid profile email address phone'], 'upm_answer': 'true', 'client_id': ['PZlNlIPDx2yd'], 'state': ['gKOqmaW9FYqOOpE2'], 'response_type': ['code'], 'redirect_uri': ['https://localhost:8666/authz_cb']}
2015-08-21 08:48:58,300 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:58] "POST /verify HTTP/1.1" 302 -
2015-08-21 08:48:58,327 oic.oauth2.provider:DEBUG Request: 'nonce=pzxV4MPpeT5LXnfa&scope=openid+profile+email+address+phone&upm_answer=true&client_id=PZlNlIPDx2yd&state=gKOqmaW9FYqOOpE2&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb'
2015-08-21 08:48:58,327 oic.oic:DEBUG verify keys: [<jwkest.jwk.SYMKey object at 0x1043b8978>, <jwkest.jwk.RSAKey object at 0x10431bfd0>, <jwkest.jwk.ECKey object at 0x1043163c8>]
2015-08-21 08:48:58,327 oic.oauth2.provider:DEBUG AuthzRequest: {'nonce': 'pzxV4MPpeT5LXnfa', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-21 08:48:58,328 oic.oic.provider:DEBUG AuthzRequest+oidc_request: {'nonce': 'pzxV4MPpeT5LXnfa', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'redirect_uri': 'https://localhost:8666/authz_cb', 'response_type': 'code'}
2015-08-21 08:48:58,330 oic.utils.authn.user:DEBUG kwargs: {'max_age': 0, 'authorization': ''}
2015-08-21 08:48:58,330 oic.oauth2.provider:INFO No active authentication
2015-08-21 08:48:58,330 oic.oic.provider:DEBUG - authenticated -
2015-08-21 08:48:58,330 oic.oic.provider:DEBUG AREQ keys: ['nonce', 'scope', 'upm_answer', 'client_id', 'state', 'response_type', 'redirect_uri']
2015-08-21 08:48:58,330 oic.utils.sdb:DEBUG uid2sid: {'diana': ['eec02838e478645d57164a96d660a0c86d23c7328f058ef10d679e50']}
2015-08-21 08:48:58,331 oic.oauth2.provider:DEBUG - in authenticated() -
2015-08-21 08:48:58,331 oic.oauth2.provider:DEBUG response type: ['code']
2015-08-21 08:48:58,332 oic.oic.provider:DEBUG Redirected to: 'https://localhost:8666/authz_cb?state=gKOqmaW9FYqOOpE2&code=tk0G4QUkXMDouYIsnA%2BtvZ%2FhrxnwfiAQCBR4TQmS1GNH8P%2BfGkJqNjgjf95E0KOLKHfuHPqaJRRhCs3TNr0oo97yJtzxkLC3A%2BP0rroeGDg%3D&scope=openid+profile+email+address+phone' (<class 'str'>)
2015-08-21 08:48:58,333 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:58] "GET /authorization?nonce=pzxV4MPpeT5LXnfa&scope=openid+profile+email+address+phone&upm_answer=true&client_id=PZlNlIPDx2yd&state=gKOqmaW9FYqOOpE2&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb HTTP/1.1" 302 -
2015-08-21 08:48:58,344 oic.oic.provider:DEBUG - token -
2015-08-21 08:48:58,344 oic.oic.provider:INFO token_request: key=eyJ1c2UiOiAic2lnIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ%3D%3D&client_secret=e8db6ee9e00bc6891b2ba4a224ecd82999730d1968e98fd9468f69fd&grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8666%2Fauthz_cb&token_type=pop&code=tk0G4QUkXMDouYIsnA%2BtvZ%2FhrxnwfiAQCBR4TQmS1GNH8P%2BfGkJqNjgjf95E0KOLKHfuHPqaJRRhCs3TNr0oo97yJtzxkLC3A%2BP0rroeGDg%3D&client_id=PZlNlIPDx2yd
2015-08-21 08:48:58,345 oic.oic.provider:DEBUG AccessTokenRequest: {'key': 'eyJ1c2UiOiAic2lnIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ==', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'token_type': 'pop', 'client_id': 'PZlNlIPDx2yd', 'code': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLKHfuHPqaJRRhCs3TNr0oo97yJtzxkLC3A+P0rroeGDg=', 'client_secret': 'e8db6ee9e00bc6891b2ba4a224ecd82999730d1968e98fd9468f69fd'}
2015-08-21 08:48:58,345 oic.utils.authn.client:DEBUG REQ: {'key': 'eyJ1c2UiOiAic2lnIiwgInAiOiAiN0M1YUh5dzhHcHNncGUxQm1HSXpkcVAycm9zSDAyVnRRSjFPdnNTLW5ieHNmMVJVMzNNbzcwS0NGTzRoZndQU3U0Yk5OQTM0eEhxdXdjMVJpb1R2YXciLCAiZCI6ICJ2NzQ5d0Z2bm1Cd2t6VHBGVEQyQW5WMllfSjNGblVtVG5nMTdFQjFlQlRKWElELU1nWDhhWUVUOEsyZ3lBNUdyaGduUl9sT2lCSUhadzZBYk1ncjhtT19XM3lQRllqYU16S29JSU96WlY0NmtCZXNsdFFkbndRYlo4LXBFdUwyMG9JYjEta1c0emRMamlOampVc2FYVzdzYVF0ZzBpTTIzZ2lTYWhVTGRyUUUiLCAibiI6ICIxX0hwVkRua3h4S2puMGlDcXczc1JOVFBWaThyYUUtY3lYUlNEN3ZKUC1uaDBLaVFjS3ZlV2hmcWlKSkJGd2h4U2FZbWQ2OE9RUTRqNl91aGVwSjRoelMwel9uRVRSWEpzZW9CY0p5dFF2eUpqX2NqcXNsRWpvc0JHZTk0ODgtSGVRSTVtODZGWVd4eW0ydXVncmFBak5URFJPMThuUVQyUk0xYTN2RXZiNk0iLCAia2lkIjogImEwIiwgInEiOiAiNmhEWTE3QXUxLXdKZFVJOVNKZ3ZwN1BRaXFPZHc3TUh2dmxSOXM2cENyMVV2NXlQcWN2UlA4M0pRT0MwN3ptUkgwTmY3Q1kxVDUxZmNQOExWZ3FtcVEiLCAiZSI6ICJBUUFCIiwgImt0eSI6ICJSU0EifQ==', 'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8666/authz_cb', 'token_type': 'pop', 'client_id': 'PZlNlIPDx2yd', 'code': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLKHfuHPqaJRRhCs3TNr0oo97yJtzxkLC3A+P0rroeGDg=', 'client_secret': 'e8db6ee9e00bc6891b2ba4a224ecd82999730d1968e98fd9468f69fd'}
2015-08-21 08:48:58,346 oic.utils.authn.client:DEBUG Verified Client ID: PZlNlIPDx2yd
2015-08-21 08:48:58,349 oic.oic.provider:DEBUG All checks OK
2015-08-21 08:48:58,349 oic.oic:DEBUG authzreq: {'nonce': 'pzxV4MPpeT5LXnfa', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-21 08:48:58,349 oic.oic.provider:DEBUG Signing alg: RS256 [RSA]
2015-08-21 08:48:58,350 oic.oic:DEBUG authzreq: {'nonce': 'pzxV4MPpeT5LXnfa', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-21 08:48:58,350 oic.oic.provider:DEBUG id_token: {'nonce': 'pzxV4MPpeT5LXnfa', 'iss': 'https://localhost:8092/', 'sub': '1a0cebf445d47cd3', 'aud': ['PZlNlIPDx2yd'], 'acr': 'PASSWORD', 'iat': 1440139738, 'exp': 1440218938, 'auth_time': 1440139738}
2015-08-21 08:48:58,351 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"kid": "op0", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "enc", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}, {"kid": "op1", "n": "1ECrSVVGxHDjCm-gLdGoTPCTeIgTRvin0cE9M6s_GkD0ta3Ty6DClu8GiBml-PQfQtSya5Ezv8EuUXhFhNCpR-3_vMwUjYLBzH5ybAB_NBRL8MJ1M7WUzm-WSnl1hdYMolX1xy2cy2Um5saItubMONhhVG-hFAsyy9iCDX-FV8anrOPpCBuYK1B0BaBSafMDus3SR-xq8T6LgTelwr3srJm6Q6A2AzdBsCkm-WcKW534ClRbMYfMaJQlBYpmtnQt_k8ctUWX1k_kIAJ7GR5Wh_7555wCcVJbnoc4iNgPs1KyNfmHv2RiEr2lf0BmxpkzUGnNQNaOVqB1_D1ygsNMAw", "e": "AQAB", "p": "7VtNYey6jqytjhwQkmUn8LtbbfuJQzan0yR47Bx7BJe2BjX2MBshqVjOf7IgcuozInUfhwDWwFcGig2-SNV37ueIFsTx27YvId_hq-E0c3a2Aog6OmMYKyK0sSqHJCZRSVgLfPy1BuH31vt-qfaQEOeF1JY-iMTHzh5dDvUiEw8", "use": "sig", "q": "5OyVDaJPdyrKit7TZg6J4PBKDufh-UA88bpxMYZB47Iek2WVPL1T_DIQGscYZIKSMci4MgIe1jHIGYvpvQfkjJPi-fVbGbX15zLzNu4rsubB3-JZF8qUav5hC57P-YdVwIZgyhC9LqPxY6tDG3bB04w1q2Al4lLPrpNpHLZBZ80", "d": "1DDqjF-SZeStNcuuiN_mrzR7Wa5AB12i-FGFS9hRN3_kpJRo_lNy9c1z7DAn-yCi9_8Hd_4ri_Imyg_BACxSb7SBTE-B5I7qC_QFk-9TO89mtATTgqRvZYms6DtQwEHjU484LK1u6O_w2hl0p9VIKTQ46V7H2-_uElgafEAWIE6JP3cf52cnsGbFbZArJ8K5tumNpPJ4cpy5tZxpEAW0SsHkCeTtz67K2YUTvTlyddFiv5WB1akZ7uHWpvIj_CRys-QkDfzu8dByOVRxwJdAM-PmGXvMK3TYYLZJDoRscDrSCuUN3lfLLedWAaVmzIg7UOd4IYrFrcjc4BMqYTpLMQ", "kty": "RSA"}]}
2015-08-21 08:48:58,351 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "cOZ0ySFe6BeUYtIskseyROosRLAypbcPmyHAgr4skbA", "kid": "op2", "y": "5M10Tj-isINJvc75s2E1j9egqlm5bl3K9jGLtmGcdyI", "use": "sig", "crv": "P-256", "kty": "EC"}]}
2015-08-21 08:48:58,351 oic.oic.provider:DEBUG OC3 server keys: {"keys": [{"x": "GgMT6bknzet0DUd6Tk7NavoRPwVMRAh-xchok73doiA", "kid": "op3", "y": "XRmcSPNnLuxgqEv923IJIMK9lFKVif5i1I4HA7NT0_I", "use": "enc", "crv": "P-256", "kty": "EC"}]}
2015-08-21 08:48:58,351 oic.oic.provider:DEBUG ckey: [<jwkest.jwk.RSAKey object at 0x10431bfd0>]
2015-08-21 08:48:58,357 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-21 08:48:58,358 oic.oic.provider:DEBUG _tinfo: {'nonce': 'pzxV4MPpeT5LXnfa', 'permission': '', 'redirect_uri': 'https://localhost:8666/authz_cb', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x104a08b00>, 'token_expires_at': 1440139738, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJwenhWNE1QcGVUNUxYbmZhIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJzdWIiOiAiMWEwY2ViZjQ0NWQ0N2NkMyIsICJhdWQiOiBbIlBabE5sSVBEeDJ5ZCJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0NDAxMzk3MzgsICJleHAiOiAxNDQwMjE4OTM4LCAiYXV0aF90aW1lIjogMTQ0MDEzOTczOH0.aklY7DCjTfUTk4FjYYcbHWXkfvDG_aglWi6mbEuHM4yMSwyJBygVx3GE2fyRSKcHsnDdzA-YQpf5uhZqiO5kbmDFcLr_9BGkYj2XRnu40ghRe68FkRpdQ05DZYzAdO-ym81-F9gNF_cK1XIdQXOQc7SmdLT3QRFM2IQ75DNeHOoWqW7xPpqBwixxi7A4mi5JS_L6j51kwIUU2OjSS7ucVa-Ehwa_rXxT4yeBmq3qCl1AAZhdSUb_kOrTwvjmkJv4Ez7cMXd6fyUEfMxLLIzJu4U3WXZ6Jroc2VHJJL2khtGkYOPGQ1fNEeIxx5tcKgnHGA2yA0FUR02_aDT257BBxg', 'code': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLKHfuHPqaJRRhCs3TNr0oo97yJtzxkLC3A+P0rroeGDg=', 'token_type': 'Bearer', 'oauth_state': 'token', 'revoked': False, 'access_token': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLTLt1cTDOwUJ1HNNIZt9m+UN3oWTXmyRNodC1yvYwIoU=', 'access_token_scope': '?', 'expires_in': 3600, 'sub': '1a0cebf445d47cd3', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code_used': True, 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'authzreq': '{"nonce": "pzxV4MPpeT5LXnfa", "scope": "openid profile email address phone", "upm_answer": "true", "client_id": "PZlNlIPDx2yd", "state": "gKOqmaW9FYqOOpE2", "redirect_uri": "https://localhost:8666/authz_cb", "response_type": "code"}', 'refresh_token': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLS7QsjGaq8xvsh7Nc6Ew8IgX58K3UQTmwujEirAgyJy0='}
2015-08-21 08:48:58,359 oic.oic.provider:DEBUG access_token_response: {'access_token': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLTLt1cTDOwUJ1HNNIZt9m+UN3oWTXmyRNodC1yvYwIoU=', 'expires_in': 3600, 'scope': 'openid profile email address phone', 'token_type': 'Bearer', 'state': 'gKOqmaW9FYqOOpE2', 'refresh_token': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLS7QsjGaq8xvsh7Nc6Ew8IgX58K3UQTmwujEirAgyJy0=', 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJwenhWNE1QcGVUNUxYbmZhIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJzdWIiOiAiMWEwY2ViZjQ0NWQ0N2NkMyIsICJhdWQiOiBbIlBabE5sSVBEeDJ5ZCJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0NDAxMzk3MzgsICJleHAiOiAxNDQwMjE4OTM4LCAiYXV0aF90aW1lIjogMTQ0MDEzOTczOH0.aklY7DCjTfUTk4FjYYcbHWXkfvDG_aglWi6mbEuHM4yMSwyJBygVx3GE2fyRSKcHsnDdzA-YQpf5uhZqiO5kbmDFcLr_9BGkYj2XRnu40ghRe68FkRpdQ05DZYzAdO-ym81-F9gNF_cK1XIdQXOQc7SmdLT3QRFM2IQ75DNeHOoWqW7xPpqBwixxi7A4mi5JS_L6j51kwIUU2OjSS7ucVa-Ehwa_rXxT4yeBmq3qCl1AAZhdSUb_kOrTwvjmkJv4Ez7cMXd6fyUEfMxLLIzJu4U3WXZ6Jroc2VHJJL2khtGkYOPGQ1fNEeIxx5tcKgnHGA2yA0FUR02_aDT257BBxg'}
2015-08-21 08:48:58,365 jwkest.jws:DEBUG Signed message using key with kid=op1
2015-08-21 08:48:58,365 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:58] "POST /token HTTP/1.1" 200 -
2015-08-21 08:48:58,375 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:58] "GET /static/jwks.json HTTP/1.1" 200 -
2015-08-21 08:48:58,389 jwkest.jws:DEBUG Verified message using key with kid=op1
2015-08-21 08:48:58,391 jwkest.jws:DEBUG Verified message using key with kid=a0
2015-08-21 08:48:58,392 oic.oic.provider:DEBUG access_token type: 'T'
2015-08-21 08:48:58,392 oic.oic:DEBUG authzreq: {'nonce': 'pzxV4MPpeT5LXnfa', 'scope': 'openid profile email address phone', 'upm_answer': 'true', 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'response_type': 'code', 'redirect_uri': 'https://localhost:8666/authz_cb'}
2015-08-21 08:48:58,392 oic.oic.provider:DEBUG userinfo_claim: {'middle_name': None, 'nickname': None, 'phone_number': None, 'given_name': None, 'name': None, 'preferred_username': None, 'family_name': None, 'gender': None, 'updated_at': None, 'profile': None, 'email': None, 'sub': None, 'address': None, 'locale': None, 'email_verified': None, 'birthdate': None, 'picture': None, 'phone_number_verified': None, 'website': None, 'zoneinfo': None}
2015-08-21 08:48:58,392 oic.oic.provider:DEBUG Session info: {'nonce': 'pzxV4MPpeT5LXnfa', 'permission': '', 'redirect_uri': 'https://localhost:8666/authz_cb', 'authn_event': <oic.utils.sdb.AuthnEvent object at 0x104a08b00>, 'token_expires_at': 1440139738, 'id_token': 'eyJraWQiOiJvcDEiLCJhbGciOiJSUzI1NiJ9.eyJub25jZSI6ICJwenhWNE1QcGVUNUxYbmZhIiwgImlzcyI6ICJodHRwczovL2xvY2FsaG9zdDo4MDkyLyIsICJzdWIiOiAiMWEwY2ViZjQ0NWQ0N2NkMyIsICJhdWQiOiBbIlBabE5sSVBEeDJ5ZCJdLCAiYWNyIjogIlBBU1NXT1JEIiwgImlhdCI6IDE0NDAxMzk3MzgsICJleHAiOiAxNDQwMjE4OTM4LCAiYXV0aF90aW1lIjogMTQ0MDEzOTczOH0.aklY7DCjTfUTk4FjYYcbHWXkfvDG_aglWi6mbEuHM4yMSwyJBygVx3GE2fyRSKcHsnDdzA-YQpf5uhZqiO5kbmDFcLr_9BGkYj2XRnu40ghRe68FkRpdQ05DZYzAdO-ym81-F9gNF_cK1XIdQXOQc7SmdLT3QRFM2IQ75DNeHOoWqW7xPpqBwixxi7A4mi5JS_L6j51kwIUU2OjSS7ucVa-Ehwa_rXxT4yeBmq3qCl1AAZhdSUb_kOrTwvjmkJv4Ez7cMXd6fyUEfMxLLIzJu4U3WXZ6Jroc2VHJJL2khtGkYOPGQ1fNEeIxx5tcKgnHGA2yA0FUR02_aDT257BBxg', 'code': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLKHfuHPqaJRRhCs3TNr0oo97yJtzxkLC3A+P0rroeGDg=', 'token_type': 'Bearer', 'oauth_state': 'token', 'revoked': False, 'access_token': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLTLt1cTDOwUJ1HNNIZt9m+UN3oWTXmyRNodC1yvYwIoU=', 'access_token_scope': '?', 'expires_in': 3600, 'sub': '1a0cebf445d47cd3', 'scope': ['openid', 'profile', 'email', 'address', 'phone'], 'code_used': True, 'client_id': 'PZlNlIPDx2yd', 'state': 'gKOqmaW9FYqOOpE2', 'authzreq': '{"nonce": "pzxV4MPpeT5LXnfa", "scope": "openid profile email address phone", "upm_answer": "true", "client_id": "PZlNlIPDx2yd", "state": "gKOqmaW9FYqOOpE2", "redirect_uri": "https://localhost:8666/authz_cb", "response_type": "code"}', 'refresh_token': 'tk0G4QUkXMDouYIsnA+tvZ/hrxnwfiAQCBR4TQmS1GNH8P+fGkJqNjgjf95E0KOLS7QsjGaq8xvsh7Nc6Ew8IgX58K3UQTmwujEirAgyJy0='}
2015-08-21 08:48:58,392 oic.oic.provider:DEBUG user_info_response: {'email': 'diana@example.org', 'nickname': 'Dina', 'phone_number': '+46 90 7865000', 'given_name': 'Diana', 'name': 'Diana Krall', 'family_name': 'Krall', 'sub': '1a0cebf445d47cd3', 'email_verified': False, 'address': {'country': 'Sweden', 'locality': 'Ume', 'street_address': 'Ume Universitet', 'postal_code': 'SE-90187'}}
2015-08-21 08:48:58,395 werkzeug:INFO 127.0.0.1 - - [21/Aug/2015 08:48:58] "POST /userinfo HTTP/1.1" 200 -
